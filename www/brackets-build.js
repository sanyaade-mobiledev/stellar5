/*
 RequireJS 2.1.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

/* ============================================================
 * bootstrap-dropdown.js v1.4.0
 * http://twitter.github.com/bootstrap/javascript.html#dropdown
 * ============================================================
 * Copyright 2011 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* =========================================================
 * bootstrap-modal.js v1.4.0
 * http://twitter.github.com/bootstrap/javascript.html#modal
 * =========================================================
 * Copyright 2011 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

// path-utils.js - version 0.1
// Copyright (c) 2011, Kin Blas
// All rights reserved.
// 
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the <organization> nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
// 
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
// ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
// DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
// DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
// LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
// ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

/**
 * Smart Auto Complete plugin 
 * 
 * Copyright (c) 2011 Lakshan Perera (laktek.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)  licenses.
 * 
*/

/**
 * @license RequireJS text 1.0.8 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

/*
 * Copyright (c) 2012 Adobe Systems Incorporated. All rights reserved.
 *  
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"), 
 * to deal in the Software without restriction, including without limitation 
 * the rights to use, copy, modify, merge, publish, distribute, sublicense, 
 * and/or sell copies of the Software, and to permit persons to whom the 
 * Software is furnished to do so, subject to the following conditions:
 *  
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *  
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER 
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING 
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER 
 * DEALINGS IN THE SOFTWARE.
 * 
 */

/*
 * jsTree 1.0-rc3
 * http://jstree.com/
 *
 * Copyright (c) 2010 Ivan Bozhanov (vakata.com)
 *
 * Licensed same as jquery - under the terms of either the MIT License or the GPL Version 2 License
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * $Date: 2011-02-09 01:17:14 +0200 (ср, 09 февр 2011) $
 * $Revision: 236 $
 */

/**
 * @license RequireJS i18n 1.0.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

// Copyright (c) 2002 Douglas Crockford  (www.JSLint.com)

// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:

// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.

/*
 * Copyright (c) 2013 Adobe Systems Incorporated. All rights reserved.
 *  
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"), 
 * to deal in the Software without restriction, including without limitation 
 * the rights to use, copy, modify, merge, publish, distribute, sublicense, 
 * and/or sell copies of the Software, and to permit persons to whom the 
 * Software is furnished to do so, subject to the following conditions:
 *  
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *  
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER 
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING 
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER 
 * DEALINGS IN THE SOFTWARE.
 * 
 */

var requirejs,require,define;(function(W){function D(e){return M.call(e)==="[object Function]"}function E(e){return M.call(e)==="[object Array]"}function t(e,t){if(e){var n;for(n=0;n<e.length;n+=1)if(e[n]&&t(e[n],n,e))break}}function N(e,t){if(e){var n;for(n=e.length-1;n>-1;n-=1)if(e[n]&&t(e[n],n,e))break}}function A(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n],n))break}function O(e,t,n,r){return t&&A(t,function(t,i){if(n||!F.call(e,i))r&&typeof t!="string"?(e[i]||(e[i]={}),O(e[i],t,n,r)):e[i]=t}),e}function r(e,t){return function(){return t.apply(e,arguments)}}function X(e){if(!e)return e;var n=W;return t(e.split("."),function(e){n=n[e]}),n}function G(e,t,n,r){return t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e),t.requireType=e,t.requireModules=r,n&&(t.originalError=n),t}function ba(){return H&&H.readyState==="interactive"?H:(N(document.getElementsByTagName("script"),function(e){if(e.readyState==="interactive")return H=e}),H)}var g,s,u,y,q,B,H,I,Y,Z,ca=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,da=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,$=/\.js$/,ea=/^\.\//;s=Object.prototype;var M=s.toString,F=s.hasOwnProperty,fa=Array.prototype.splice,v=typeof window!="undefined"&&!!navigator&&!!document,aa=!v&&typeof importScripts!="undefined",ga=v&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,R=typeof opera!="undefined"&&opera.toString()==="[object Opera]",w={},n={},P=[],J=!1;if(typeof define=="undefined"){if(typeof requirejs!="undefined"){if(D(requirejs))return;n=requirejs,requirejs=void 0}typeof require!="undefined"&&!D(require)&&(n=require,require=void 0),g=requirejs=function(e,t,n,r){var i,s="_";return!E(e)&&typeof e!="string"&&(i=e,E(t)?(e=t,t=n,n=r):e=[]),i&&i.context&&(s=i.context),(r=w[s])||(r=w[s]=g.s.newContext(s)),i&&r.configure(i),r.require(e,t,n)},g.config=function(e){return g(e)},g.nextTick=typeof setTimeout!="undefined"?function(e){setTimeout(e,4)}:function(e){e()},require||(require=g),g.version="2.1.1",g.jsExtRegExp=/^\/|:|\?|\.js$/,g.isBrowser=v,s=g.s={contexts:w,newContext:function(e){function n(e,t,n){var r,i,s,o,u,a,f,l=t&&t.split("/");r=l;var c=N.map,h=c&&c["*"];if(e&&e.charAt(0)===".")if(t){r=N.pkgs[t]?l=[t]:l.slice(0,l.length-1),t=e=r.concat(e.split("/"));for(r=0;t[r];r+=1)if(i=t[r],i===".")t.splice(r,1),r-=1;else if(i===".."){if(r===1&&(t[2]===".."||t[0]===".."))break;r>0&&(t.splice(r-1,2),r-=2)}r=N.pkgs[t=e[0]],e=e.join("/"),r&&e===t+"/"+r.main&&(e=t)}else e.indexOf("./")===0&&(e=e.substring(2));if(n&&(l||h)&&c){t=e.split("/");for(r=t.length;r>0;r-=1){s=t.slice(0,r).join("/");if(l)for(i=l.length;i>0;i-=1)if(n=c[l.slice(0,i).join("/")])if(n=n[s]){o=n,u=r;break}if(o)break;!a&&h&&h[s]&&(a=h[s],f=r)}!o&&a&&(o=a,u=f),o&&(t.splice(0,u,o),e=t.join("/"))}return e}function i(e){v&&t(document.getElementsByTagName("script"),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===S.contextName)return t.parentNode.removeChild(t),!0})}function s(e){var t=N.paths[e];if(t&&E(t)&&t.length>1)return i(e),t.shift(),S.require.undef(e),S.require([e]),!0}function o(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function u(e,t,r,i){var s,u,a=null,f=t?t.name:null,l=e,c=!0,h="";return e||(c=!1,e="_@r"+(B+=1)),e=o(e),a=e[0],e=e[1],a&&(a=n(a,f,i),u=M[a]),e&&(a?h=u&&u.normalize?u.normalize(e,function(e){return n(e,f,i)}):n(e,f,i):(h=n(e,f,i),e=o(h),a=e[0],h=e[1],r=!0,s=S.nameToUrl(h))),r=a&&!u&&!r?"_unnormalized"+(j+=1):"",{prefix:a,name:h,parentMap:t,unnormalized:!!r,url:s,originalName:l,isDefine:c,id:(a?a+"!"+h:h)+r}}function a(e){var t=e.id,n=C[t];return n||(n=C[t]=new S.Module(e)),n}function f(e,t,n){var r=e.id,i=C[r];F.call(M,r)&&(!i||i.defineEmitComplete)?t==="defined"&&n(M[r]):a(e).on(t,n)}function l(e,n){var r=e.requireModules,i=!1;n?n(e):(t(r,function(t){if(t=C[t])t.error=e,t.events.error&&(i=!0,t.emit("error",e))}),!i)&&g.onError(e)}function c(){P.length&&(fa.apply(L,[L.length-1,0].concat(P)),P=[])}function h(e,n,r){var i=e.map.id;e.error?e.emit("error",e.error):(n[i]=!0,t(e.depMaps,function(t,i){var s=t.id,o=C[s];o&&!e.depMatched[i]&&!r[s]&&(n[s]?(e.defineDep(i,M[s]),e.check()):h(o,n,r))}),r[i]=!0)}function p(){var e,n,r,o,u=(r=N.waitSeconds*1e3)&&S.startTime+r<(new Date).getTime(),a=[],f=[],c=!1,d=!0;if(!b){b=!0,A(C,function(t){e=t.map,n=e.id;if(t.enabled&&(e.isDefine||f.push(t),!t.error))if(!t.inited&&u)s(n)?c=o=!0:(a.push(n),i(n));else if(!t.inited&&t.fetched&&e.isDefine&&(c=!0,!e.prefix))return d=!1});if(u&&a.length)return r=G("timeout","Load timeout for modules: "+a,null,a),r.contextName=S.contextName,l(r);d&&t(f,function(e){h(e,{},{})}),(!u||o)&&c&&(v||aa)&&!T&&(T=setTimeout(function(){T=0,p()},50)),b=!1}}function d(e){a(u(e[0],null,!0)).init(e[1],e[2])}function m(e){var e=e.currentTarget||e.srcElement,t=S.onScriptLoad;return e.detachEvent&&!R?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1),t=S.onScriptError,e.detachEvent&&!R||e.removeEventListener("error",t,!1),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function y(){var e;for(c();L.length;){if(e=L.shift(),e[0]===null)return l(G("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));d(e)}}var b,w,S,x,T,N={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},map:{},config:{}},C={},k={},L=[],M={},_={},B=1,j=1;return x={require:function(e){return e.require?e.require:e.require=S.makeRequire(e.map)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports?e.exports:e.exports=M[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return N.config&&N.config[e.map.id]||{}},exports:M[e.map.id]}}},w=function(e){this.events=k[e.id]||{},this.map=e,this.shim=N.shim[e.id],this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},w.prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=r(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,S.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();S.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],r(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;_[e]||(_[e]=!0,S.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id;t=this.depExports;var r=this.exports,i=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(D(i)){if(this.events.error)try{r=S.execCb(n,i,t,r)}catch(s){e=s}else r=S.execCb(n,i,t,r);this.map.isDefine&&((t=this.module)&&t.exports!==void 0&&t.exports!==this.exports?r=t.exports:r===void 0&&this.usingExports&&(r=this.exports));if(e)return e.requireMap=this.map,e.requireModules=[this.map.id],e.requireType="define",l(this.error=e)}else r=i;this.exports=r,this.map.isDefine&&!this.ignore&&(M[n]=r,g.onResourceLoad)&&g.onResourceLoad(S,this.map,this.depMaps),delete C[n],this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=u(e.prefix);this.depMaps.push(i),f(i,"defined",r(this,function(i){var s,o;o=this.map.name;var c=this.map.parentMap?this.map.parentMap.name:null,h=S.makeRequire(e.parentMap,{enableBuildCallback:!0,skipMap:!0});if(this.map.unnormalized){if(i.normalize&&(o=i.normalize(o,function(e){return n(e,c,!0)})||""),i=u(e.prefix+"!"+o,this.map.parentMap),f(i,"defined",r(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),o=C[i.id])this.depMaps.push(i),this.events.error&&o.on("error",r(this,function(e){this.emit("error",e)})),o.enable()}else s=r(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),s.error=r(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],A(C,function(e){e.map.id.indexOf(t+"_unnormalized")===0&&delete C[e.map.id]}),l(e)}),s.fromText=r(this,function(t,n){var r=e.name,i=u(r),o=J;n&&(t=n),o&&(J=!1),a(i);try{g.exec(t)}catch(f){throw Error("fromText eval for "+r+" failed: "+f)}o&&(J=!0),this.depMaps.push(i),S.completeLoad(r),h([r],s)}),i.load(e.name,h,s,N)})),S.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){this.enabling=this.enabled=!0,t(this.depMaps,r(this,function(e,t){var n,i;if(typeof e=="string"){e=u(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e;if(n=x[e.id]){this.depExports[t]=n(this);return}this.depCount+=1,f(e,"defined",r(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&f(e,"error",this.errback)}n=e.id,i=C[n],!x[n]&&i&&!i.enabled&&S.enable(e,this)})),A(this.pluginMaps,r(this,function(e){var t=C[e.id];t&&!t.enabled&&S.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,n){t(this.events[e],function(e){e(n)}),e==="error"&&delete this.events[e]}},S={config:N,contextName:e,registry:C,defined:M,urlFetched:_,defQueue:L,Module:w,makeModuleMap:u,nextTick:g.nextTick,configure:function(e){e.baseUrl&&e.baseUrl.charAt(e.baseUrl.length-1)!=="/"&&(e.baseUrl+="/");var n=N.pkgs,r=N.shim,i={paths:!0,config:!0,map:!0};A(e,function(e,t){i[t]?t==="map"?O(N[t],e,!0,!0):O(N[t],e,!0):N[t]=e}),e.shim&&(A(e.shim,function(e,t){E(e)&&(e={deps:e}),e.exports&&!e.exportsFn&&(e.exportsFn=S.makeShimExports(e)),r[t]=e}),N.shim=r),e.packages&&(t(e.packages,function(e){e=typeof e=="string"?{name:e}:e,n[e.name]={name:e.name,location:e.location||e.name,main:(e.main||"main").replace(ea,"").replace($,"")}}),N.pkgs=n),A(C,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=u(t))}),(e.deps||e.callback)&&S.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(W,arguments)),t||X(e.exports)}},makeRequire:function(t,r){function i(n,s,o){var f,c;return r.enableBuildCallback&&s&&D(s)&&(s.__requireJsBuild=!0),typeof n=="string"?D(s)?l(G("requireargs","Invalid require call"),o):t&&x[n]?x[n](C[t.id]):g.get?g.get(S,n,t):(f=u(n,t,!1,!0),f=f.id,F.call(M,f)?M[f]:l(G("notloaded",'Module name "'+f+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(y(),S.nextTick(function(){y(),c=a(u(null,t)),c.skipMap=r.skipMap,c.init(n,s,o,{enabled:!0}),p()}),i)}return r=r||{},O(i,{isBrowser:v,toUrl:function(e){var r=e.lastIndexOf("."),i=null;return r!==-1&&(i=e.substring(r,e.length),e=e.substring(0,r)),S.nameToUrl(n(e,t&&t.id,!0),i)},defined:function(e){return e=u(e,t,!1,!0).id,F.call(M,e)},specified:function(e){return e=u(e,t,!1,!0).id,F.call(M,e)||F.call(C,e)}}),t||(i.undef=function(e){c();var n=u(e,t,!0),r=C[e];delete M[e],delete _[n.url],delete k[e],r&&(r.events.defined&&(k[e]=r.events),delete C[e])}),i},enable:function(e){C[e.id]&&a(e).enable()},completeLoad:function(e){var t,n,r=N.shim[e]||{},i=r.exports;for(c();L.length;){n=L.shift();if(n[0]===null){n[0]=e;if(t)break;t=!0}else n[0]===e&&(t=!0);d(n)}n=C[e];if(!t&&!M[e]&&n&&!n.inited){if(N.enforceDefine&&(!i||!X(i))){if(s(e))return;return l(G("nodefine","No define call for "+e,null,[e]))}d([e,r.deps||[],r.exportsFn])}p()},nameToUrl:function(e,t){var n,r,i,s,o,u;if(g.jsExtRegExp.test(e))s=e+(t||"");else{n=N.paths,r=N.pkgs,s=e.split("/");for(o=s.length;o>0;o-=1){if(u=s.slice(0,o).join("/"),i=r[u],u=n[u]){E(u)&&(u=u[0]),s.splice(0,o,u);break}if(i){n=e===i.name?i.location+"/"+i.main:i.location,s.splice(0,o,n);break}}s=s.join("/"),s+=t||(/\?/.test(s)?"":".js"),s=(s.charAt(0)==="/"||s.match(/^[\w\+\.\-]+:/)?"":N.baseUrl)+s}return N.urlArgs?s+((s.indexOf("?")===-1?"?":"&")+N.urlArgs):s},load:function(e,t){g.load(S,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if(e.type==="load"||ga.test((e.currentTarget||e.srcElement).readyState))H=null,e=m(e),S.completeLoad(e.id)},onScriptError:function(e){var t=m(e);if(!s(t.id))return l(G("scripterror","Script error",e,[t.id]))}},S.require=S.makeRequire(),S}},g({}),t(["toUrl","undef","defined","specified"],function(e){g[e]=function(){var t=w._;return t.require[e].apply(t,arguments)}}),v&&(u=s.head=document.getElementsByTagName("head")[0],y=document.getElementsByTagName("base")[0])&&(u=s.head=y.parentNode),g.onError=function(e){throw e},g.load=function(e,t,n){var r=e&&e.config||{},i;if(v)return i=r.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),i.type=r.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),i.attachEvent&&!(i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0)&&!R?(J=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)):(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)),i.src=n,I=i,y?u.insertBefore(i,y):u.appendChild(i),I=null,i;aa&&(importScripts(n),e.completeLoad(t))},v&&N(document.getElementsByTagName("script"),function(e){u||(u=e.parentNode);if(q=e.getAttribute("data-main"))return n.baseUrl||(B=q.split("/"),Y=B.pop(),Z=B.length?B.join("/")+"/":"./",n.baseUrl=Z,q=Y),q=q.replace($,""),n.deps=n.deps?n.deps.concat(q):[q],!0}),define=function(e,t,n){var r,i;typeof e!="string"&&(n=t,t=e,e=null),E(t)||(n=t,t=[]),!t.length&&D(n)&&n.length&&(n.toString().replace(ca,"").replace(da,function(e,n){t.push(n)}),t=(n.length===1?["require"]:["require","exports","module"]).concat(t)),J&&(r=I||ba())&&(e||(e=r.getAttribute("data-requiremodule")),i=w[r.getAttribute("data-requirecontext")]),(i?i.defQueue:P).push([e,t,n])},define.amd={jQuery:!0},g.exec=function(b){return eval(b)},g(n)}})(this),define("requireLib",function(){}),!function(e){"use strict";function n(){e(t).parent("li").removeClass("open")}e.fn.dropdown=function(r){return this.each(function(){e(this).delegate(r||t,"click",function(t){var r=e(this).parent("li"),i=r.hasClass("open");return n(),!i&&r.toggleClass("open"),!1})})};var t="a.menu, .dropdown-toggle";e(function(){e("html").bind("click",n),e("body").dropdown("[data-dropdown] a.menu, [data-dropdown] .dropdown-toggle")})}(window.jQuery||window.ender),define("widgets/bootstrap-dropdown",function(){}),!function(e){"use strict";function r(){var e=this,n=setTimeout(function(){e.$element.unbind(t),i.call(e)},500);this.$element.one(t,function(){clearTimeout(n),i.call(e)})}function i(e){this.$element.hide().trigger("hidden"),s.call(this)}function s(n){var r=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.settings.backdrop){var s=e.support.transition&&i;this.$backdrop=e('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.settings.backdrop!="static"&&this.$backdrop.click(e.proxy(this.hide,this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),s?this.$backdrop.one(t,n):n()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t,e.proxy(o,this)):o.call(this)):n&&n()}function o(){this.$backdrop.remove(),this.$backdrop=null}function u(){var t=this;this.isShown&&this.settings.keyboard?e(document).bind("keyup.modal",function(e){e.which==27&&t.hide()}):this.isShown||e(document).unbind("keyup.modal")}var t;e(document).ready(function(){e.support.transition=function(){var e=document.body||document.documentElement,t=e.style,n=t.transition!==undefined||t.WebkitTransition!==undefined||t.MozTransition!==undefined||t.MsTransition!==undefined||t.OTransition!==undefined;return n}(),e.support.transition&&(t="TransitionEnd",e.browser.webkit?t="webkitTransitionEnd":e.browser.mozilla?t="transitionend":e.browser.opera&&(t="oTransitionEnd"))});var n=function(t,n){return this.settings=e.extend({},e.fn.modal.defaults,n),this.$element=e(t).delegate(".close","click.modal",e.proxy(this.hide,this)),this.settings.show&&this.show(),this};n.prototype={toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var n=this;return this.isShown=!0,this.$element.trigger("show"),u.call(this),s.call(this,function(){var r=e.support.transition&&n.$element.hasClass("fade");n.$element.appendTo(document.body).show(),r&&n.$element[0].offsetWidth,n.$element.addClass("in"),r?n.$element.one(t,function(){n.$element.trigger("shown")}):n.$element.trigger("shown")}),this},hide:function(t){t&&t.preventDefault();if(!this.isShown)return this;var n=this;return this.isShown=!1,u.call(this),this.$element.trigger("hide").removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?r.call(this):i.call(this),this}},e.fn.modal=function(t){var r=this.data("modal");return r?t===!0?r:(typeof t=="string"?r[t]():r&&r.toggle(),this):(typeof t=="string"&&(t={show:/show|toggle/.test(t)}),this.each(function(){e(this).data("modal",new n(this,t))}))},e.fn.modal.Modal=n,e.fn.modal.defaults={backdrop:!1,keyboard:!1,show:!1},e(document).ready(function(){e("body").delegate("[data-controls-modal]","click",function(t){t.preventDefault();var n=e(this).data("show",!0);e("#"+n.attr("data-controls-modal")).modal(n.data())})})}(window.jQuery||window.ender),define("widgets/bootstrap-modal",function(){}),function(e){function t(e){return function(t){return n.parseUrl(t)[e]}}var n={urlParseRE:/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#\.]*(?:\.[^\?#\.]+)*(\.[^\?#\.]+)|[^\?#]*)))?(\?[^#]+)?)(#.*)?/,parsedUrlPropNames:"href,hrefNoHash,hrefNoSearch,domain,protocol,doubleSlash,authority,userinfo,username,password,host,hostname,port,pathname,directory,filename,filenameExtension,search,hash".split(","),defaultPorts:{http:"80",https:"443",ftp:"20",ftps:"990"},parseUrl:function(e){if(e&&typeof e=="object")return e;var e=n.urlParseRE.exec(e||"")||[],t=n.parsedUrlPropNames,r=t.length,i={},s;for(s=0;s<r;s++)i[t[s]]=e[s]||"";return i},port:function(e){return e=n.parseUrl(e),e.port||n.defaultPorts[e.protocol]},isSameDomain:function(e,t){return n.parseUrl(e).domain===n.parseUrl(t).domain},isRelativeUrl:function(e){return n.parseUrl(e).protocol===""},isAbsoluteUrl:function(e){return n.parseUrl(e).protocol!==""},makePathAbsolute:function(e,t){if(e&&e.charAt(0)==="/")return e;for(var e=e||"",n=(t=t?t.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"")?t.split("/"):[],r=e.split("/"),i=0;i<r.length;i++){var s=r[i];switch(s){case".":break;case"..":n.length&&n.pop();break;default:n.push(s)}}return"/"+n.join("/")},makePathRelative:function(e,t){for(var t=t?t.replace(/^\/|\/?[^\/]*$/g,""):"",e=e?e.replace(/^\//,""):"",n=t?t.split("/"):[],r=e.split("/"),i=[],s=n.length,o=!1,u=0;u<s;u++)(o=o||r[0]!==n[u])?i.push(".."):r.shift();return i.concat(r).join("/")},makeUrlAbsolute:function(e,t){if(!n.isRelativeUrl(e))return e;var r=n.parseUrl(e),i=n.parseUrl(t),s=r.protocol||i.protocol,o=r.protocol?r.doubleSlash:r.doubleSlash||i.doubleSlash,u=r.authority||i.authority,a=r.pathname!=="",f=n.makePathAbsolute(r.pathname||i.filename,i.pathname);return s+o+u+f+(r.search||!a&&i.search||"")+r.hash}},r,i,s=n.parsedUrlPropNames,o=s.length;for(r=0;r<o;r++)i=s[r],n[i]||(n[i]=t(i));e.PathUtils=n}(window),define("thirdparty/path-utils/path-utils.min",function(){}),function(e){e.fn.smartAutoComplete=function(){if(arguments.length<1){var t=this[0];return e(t).data("smart-autocomplete")}var n=function(t,n,r){var i=new RegExp(t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");return e.grep(n,function(e){return i.test(e)})},r={minCharLimit:1,maxCharLimit:null,maxResults:null,delay:0,disabled:!1,forceSelect:!1,typeAhead:!1,resultElement:"li",resultFormatter:function(e){return"<li>"+e+"</li>"},filter:function(t,r){var i=this,s=e(i).data("smart-autocomplete");if(e.type(r)==="array"){var o=n(t,r,i);return o}if(e.type(r)==="string")return e.Deferred(function(s){e.ajax({url:r,data:{term:t},dataType:"json"}).success(function(e){s.resolve(n(t,e,i))})}).promise()},alignResultsContainer:!1,clearResults:function(){var t=e(this.context).prev(".smart_autocomplete_type_ahead_field");e(this.context).css({background:t.css("background")}),t.remove(),e(this.resultsContainer).html("")},setCurrentSelectionToContext:function(){this.rawResults.length>0&&this.currentSelection>=0&&e(this.context).val(this.rawResults[this.currentSelection])},setItemSelected:function(e){this.itemSelected=e},autocompleteFocused:!1,setAutocompleteFocused:function(e){this.autocompleteFocused=e}};e.event.special.keyIn={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=r.source||null,s=r.filter,o=r.maxCharLimit>0?r.maxCharLimit:Number.POSITIVE_INFINITY,u=t.smartAutocompleteData.query;if(r.disabled||u.length>o)return!1;r.setItemSelected(!1),r.setAutocompleteFocused(!0),setTimeout(function(){e.when(s.apply(r,[u,r.source])).done(function(t){var i=r.maxResults>0?t.splice(0,r.maxResults):t;e(n).trigger("resultsReady",[i])})},r.delay)}},e.event.special.resultsReady={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=t.smartAutocompleteData.results;if(r.disabled)return!1;e(n).smartAutoComplete().clearResults(),r.rawResults=i;if(i.length<1)return e(n).trigger("noResults"),!1;var s=e.map(i,function(e){return r.resultFormatter.apply(r,[e])}),o=s.join("");r.resultsContainer&&e(r.resultsContainer).append(o),e(n).trigger("showResults",[i])}},e.event.special.showResults={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=e(r.resultsContainer),s=t.smartAutocompleteData.results;if(r.typeAhead&&s[0].substr(0,e(n).val().length)==e(n).val()){var o=s[0];e(n).before("<input class='smart_autocomplete_type_ahead_field' type='text' autocomplete='off' disabled='disabled' value='"+o+"'/>"),e(n).css({position:"relative",zIndex:2,background:"transparent"});var u=e(n).prev("input");u.css({position:"absolute",zIndex:1,overflow:"hidden",background:e(n).css("background"),borderColor:"transparent",width:e(n).width(),color:"silver"}),r.currentSelection=0,i&&e(n).trigger("itemFocus",i.children()[r.currentSelection])}i&&(r.alignResultsContainer&&i.css({position:"absolute",top:function(){return e(n).offset().top+e(n).height()},left:function(){return e(n).offset().left},width:function(){return e(n).width()},zIndex:1e3}),i.show())}},e.event.special.noResults={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=e(r.resultsContainer);i&&r.clearResults()}},e.event.special.itemSelect={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete"),i=t.smartAutocompleteData.item,s=e(i).text()||e(i).val();e(n).val(s),r.setItemSelected(!0),r.originalCharCount=e(n).val().length,e(n).trigger("lostFocus")}},e.event.special.itemFocus={setup:function(){return!1},_default:function(t){var n=t.smartAutocompleteData.item;e(n).addClass("smart_autocomplete_highlight")}},e.event.special.itemUnfocus={setup:function(){return!1},_default:function(t){var n=t.smartAutocompleteData.item;e(n).removeClass("smart_autocomplete_highlight")}},e.event.special.lostFocus={setup:function(){return!1},_default:function(t){var n=t.target,r=e(n).data("smart-autocomplete");r.forceSelect&&!r.itemSelected&&e(r.context).val(""),r.setAutocompleteFocused(!1),r.clearResults(),r.resultsContainer&&e(r.resultsContainer).hide(),r.currentSelection=null}};var i=arguments[0];return this.each(function(t){var n=e.extend(r,e(this).data("smart-autocomplete"),i);n.context=this;if(e.type(n.resultsContainer)==="undefined"){var s=e("<ul class='smart_autocomplete_container' style='display:none'></ul>");s.appendTo("body"),n.resultsContainer=s,n.alignResultsContainer=!0}e(this).data("smart-autocomplete",n),e(this).keyup(function(t){var n=e(this).data("smart-autocomplete");if(t.keyCode=="38"){if(n.resultsContainer){var r=n.currentSelection||0,i=e(n.resultsContainer).children();r>=0&&e(n.context).trigger("itemUnfocus",i[r]),--r<=0&&(r=0),n.currentSelection=r,e(n.context).trigger("itemFocus",[i[r]])}}else if(t.keyCode=="40")if(n.resultsContainer&&n.resultsContainer.is(":visible")){var r=n.currentSelection,i=e(n.resultsContainer).children();r>=0&&e(n.context).trigger("itemUnfocus",i[r]);if(isNaN(r)||null==r||++r>=i.length)r=0;n.currentSelection=r,e(n.context).trigger("itemFocus",[i[r]])}else e(n.context).trigger("keyIn",[e(this).val()]);else{if(t.keyCode=="39"||t.keyCode=="13"){var s=e(n.context).prev(".smart_autocomplete_type_ahead_field");if(n.resultsContainer&&e(n.resultsContainer).is(":visible")){var r=n.currentSelection,i=e(n.resultsContainer).children();e(n.context).trigger("itemSelect",[i[r]])}else n.typeAhead&&s.is(":visible")&&e(n.context).trigger("itemSelect",[s]);return!1}var o=e(n.context).val().length;if(n.originalCharCount==o)return;o>=n.minCharLimit?e(n.context).trigger("keyIn",[e(this).val()]):n.autocompleteFocused&&(n.currentSelection=null,e(n.context).trigger("lostFocus"))}}),e(this).focus(function(){e(this).closest("form").bind("keydown.block_for_smart_autocomplete",function(t){var r=e(n.context).prev(".smart_autocomplete_type_ahead_field");if(t.keyCode=="13"){if(n.resultsContainer&&e(n.resultsContainer).is(":visible")){var i=n.currentSelection,s=e(n.resultsContainer).children();return e(n.context).trigger("itemSelect",[s[i]]),!1}if(n.typeAhead&&r.is(":visible"))return e(n.context).trigger("itemSelect",[r]),!1}}),n.forceSelect&&e(this).select()}),e(document).bind("focusin click",function(t){if(n.autocompleteFocused){var r=e.contains(n.resultsContainer[0],t.target);if(t.target==n.resultsContainer[0]||t.target==n.context||r)return;e(n.context).closest("form").unbind("keydown.block_for_smart_autocomplete"),e(n.context).trigger("lostFocus")}}),e(n.resultsContainer).delegate(n.resultElement,"mouseenter.smart_autocomplete",function(){var t=n.currentSelection||0,r=e(n.resultsContainer).children();n.currentSelection=e(this).prevAll().length,e(n.context).trigger("itemFocus",[this])}),e(n.resultsContainer).delegate(n.resultElement,"mouseleave.smart_autocomplete",function(){e(n.context).trigger("itemUnfocus",[this])}),e(n.resultsContainer).delegate(n.resultElement,"click.smart_autocomplete",function(){return e(n.context).trigger("itemSelect",[this]),!1}),e(this).bind({keyIn:function(e,t){e.smartAutocompleteData={query:t}},resultsReady:function(e,t){e.smartAutocompleteData={results:t}},showResults:function(e,t){e.smartAutocompleteData={results:t}},noResults:function(){},lostFocus:function(){},itemSelect:function(e,t){e.smartAutocompleteData={item:t}},itemFocus:function(e,t){e.smartAutocompleteData={item:t}},itemUnfocus:function(e,t){e.smartAutocompleteData={item:t}}})})}}(jQuery),define("thirdparty/smart-auto-complete/jquery.smart_autocomplete",function(){}),function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=typeof location!="undefined"&&location.href,i=r&&location.protocol&&location.protocol.replace(/\:/,""),s=r&&location.hostname,o=r&&(location.port||undefined),u=[];define("text",[],function(){var a,f;return a={version:"1.0.8",strip:function(e){if(e){e=e.replace(t,"");var r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}return t},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=a.xdRegExp.exec(e),s,o,u;return i?(s=i[2],o=i[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===t)&&(!o||o===n)&&(!u&&!o||u===r)):!0},finishLoad:function(e,t,n,r,i){n=t?a.strip(n):n,i.isBuild&&(u[e]=n),r(n)},load:function(e,t,n,u){if(u.isBuild&&!u.inlineText){n();return}var f=a.parseName(e),l=f.moduleName+"."+f.ext,c=t.toUrl(l),h=u&&u.text&&u.text.useXhr||a.useXhr;!r||h(c,i,s,o)?a.get(c,function(t){a.finishLoad(e,f.strip,t,n,u)}):t([l],function(e){a.finishLoad(f.moduleName+"."+f.ext,f.strip,e,n,u)})},write:function(e,t,n,r){if(u.hasOwnProperty(t)){var i=a.jsEscape(u[t]);n.asModule(e+"!"+t,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,t,n,r,i){var s=a.parseName(t),o=s.moduleName+"."+s.ext,u=n.toUrl(s.moduleName+"."+s.ext)+".js";a.load(o,n,function(t){var n=function(e){return r(u,e)};n.asModule=function(e,t){return r.asModule(e,u,t)},a.write(e,o,n,i)},i)}},a.createXhr()?a.get=function(e,t){var n=a.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(e){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&!!process.versions.node?(f=require.nodeRequire("fs"),a.get=function(e,t){var n=f.readFileSync(e,"utf8");n.indexOf("﻿")===0&&(n=n.substring(1)),t(n)}):typeof Packages!="undefined"&&(a.get=function(e,t){var n="utf-8",r=new java.io.File(e),i=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),n)),o,u,a="";try{o=new java.lang.StringBuffer,u=s.readLine(),u&&u.length()&&u.charAt(0)===65279&&(u=u.substring(1)),o.append(u);while((u=s.readLine())!==null)o.append(i),o.append(u);a=String(o.toString())}finally{s.close()}t(a)}),a})}(),define("text!config.json",[],function(){return'{\n    "config": {\n        "app_title": "Brackets",\n        "app_name_about": "Brackets",\n        "about_icon": "styles/images/brackets_icon.svg",\n        "show_debug_menu": true,\n        "enable_jslint": true,\n        "update_info_url": "http://dev.brackets.io/updates/stable/",\n        "how_to_use_url": "https://github.com/adobe/brackets/wiki/How-to-Use-Brackets",\n        "forum_url": "https://groups.google.com/forum/?fromgroups#!forum/brackets-dev",\n        "release_notes_url": "https://github.com/adobe/brackets/wiki/Release-Notes",\n        "report_issue_url": "https://github.com/adobe/brackets/wiki/How-to-Report-an-Issue",\n        "twitter_url": "https://twitter.com/brackets",\n        "troubleshoot_url": "https://github.com/adobe/brackets/wiki/Troubleshooting#wiki-livedev",\n        "twitter_name": "@brackets"\n    },\n    "name": "Brackets",\n    "version": "0.20.0-0",\n    "homepage": "http://brackets.io",\n    "issues": {\n        "url": "http://github.com/adobe/brackets/issues"\n    },\n    "repository": {\n        "type": "git",\n        "url": "https://github.com/adobe/brackets.git",\n        "branch": "",\n        "SHA": ""\n    },\n    "devDependencies": {\n        "grunt": ">=0.4.0rc5",\n        "grunt-cli": ">=0.1.6",\n        "grunt-contrib-jshint": ">=0.1.1rc6",\n        "grunt-contrib-watch": ">=0.2.0rc5",\n        "grunt-contrib-jasmine": ">=0.3.0rc7",\n        "grunt-template-jasmine-requirejs": ">=0.1.0"\n    },\n    "scripts": {\n        "postinstall": "grunt install",\n        "test": "grunt test"\n    }\n}'}),define("command/CommandManager",["require","exports","module"],function(e,t,n){function s(e,t,n){this._name=e,this._id=t,this._commandFn=n,this._checked=undefined,this._enabled=!0}function o(e,n,i){if(r[n])return console.log("Attempting to register an already-registered command: "+n),null;if(!e||!n||!i)return console.error("Attempting to register a command with a missing name, id, or command function:"+e+" "+n),null;var o=new s(e,n,i);return r[n]=o,$(t).triggerHandler("commandRegistered",[o]),o}function u(){i=r,r={}}function a(){r=i,i={}}function f(e){return r[e]}function l(){return Object.keys(r)}function c(e){var t=r[e];return t?t.execute.apply(t,Array.prototype.slice.call(arguments,1)):(new $.Deferred).reject().promise()}var r={},i={};s.prototype.getID=function(){return this._id},s.prototype.execute=function(){if(!this._enabled)return;var e=this._commandFn.apply(this,arguments);return e?e:(new $.Deferred).resolve().promise()},s.prototype.getEnabled=function(){return this._enabled},s.prototype.setEnabled=function(e){var t=this._enabled!==e;this._enabled=e,t&&$(this).triggerHandler("enabledStateChange")},s.prototype.setChecked=function(e){var t=this._checked!==e;this._checked=e,t&&$(this).triggerHandler("checkedStateChange")},s.prototype.getChecked=function(){return this._checked},s.prototype.setName=function(e){var t=this._name!==e;this._name=e,t&&$(this).triggerHandler("nameChange")},s.prototype.getName=function(){return this._name},t.register=o,t.execute=c,t.get=f,t.getAll=l,t._testReset=u,t._testRestore=a}),define("utils/ShellAPI",["require","exports","module","command/CommandManager"],function(e,t,n){function i(e){if($(".modal.instance").length)return!1;var t=r.execute(e);return t&&t.state()==="rejected"?!1:!0}var r=e("command/CommandManager");t.executeCommand=i}),define("utils/Global",["require","exports","module","text!config.json","utils/ShellAPI"],function(e,t,n){var r=e("text!config.json"),i=Function,s=(new i("return this"))();s.brackets||(s.brackets={});try{s.brackets.metadata=JSON.parse(r),s.brackets.config=s.brackets.metadata.config}catch(o){console.log(o)}s.brackets.shellAPI=e("utils/ShellAPI"),s.brackets.inBrowser=location.protocol!=="file:",s.navigator.platform==="MacIntel"||s.navigator.platform==="MacPPC"?s.brackets.platform="mac":s.navigator.platform.indexOf("Linux")>=0?s.brackets.platform="linux":s.brackets.platform="win",s.brackets.getLocale=function(){return s.localStorage.getItem("locale")||s.require.s.contexts._.config.locale},s.brackets.setLocale=function(e){e?s.localStorage.setItem("locale",e):s.localStorage.removeItem("locale")},s.brackets.app||(s.brackets.app={}),s.brackets.libRequire=s.require,s.brackets.getModule=e,t.global=s}),define("utils/AppInit",["require","exports","module"],function(e,t,n){function u(e){try{e()}catch(t){console.error("Exception when calling a 'brackets done loading' handler:"),console.log(t.stack)}}function a(e){var t,n=o[e];s[e]=!0;for(t=0;t<n.length;t++)u(n[t]);o[e]=[]}function f(e,t){s[e]?u(t):o[e].push(t)}function l(e){f(i,e)}function c(e){f(r,e)}var r="htmlReady",i="appReady",s={HTML_READY:!1,APP_READY:!1},o={};o[r]=[],o[i]=[],t.appReady=l,t.htmlReady=c,t.HTML_READY=r,t.APP_READY=i,t._dispatchReady=a}),function(){if(jQuery&&jQuery.jstree)return;var e=!1,t=!1,n=!1;(function(r){r.vakata={},r.vakata.css={get_css:function(e,t,n){e=e.toLowerCase();var r=n.cssRules||n.rules,i=0;do{if(r.length&&i>r.length+5)return!1;if(r[i].selectorText&&r[i].selectorText.toLowerCase()==e)return t===!0?(n.removeRule&&n.removeRule(i),n.deleteRule&&n.deleteRule(i),!0):r[i]}while(r[++i]);return!1},add_css:function(e,t){return r.jstree.css.get_css(e,!1,t)?!1:(t.insertRule?t.insertRule(e+" { }",0):t.addRule(e,null,0),r.vakata.css.get_css(e))},remove_css:function(e,t){return r.vakata.css.get_css(e,!0,t)},add_sheet:function(e){var t=!1,n=!0;if(e.str)return e.title&&(t=r("style[id='"+e.title+"-stylesheet']")[0]),t?n=!1:(t=document.createElement("style"),t.setAttribute("type","text/css"),e.title&&t.setAttribute("id",e.title+"-stylesheet")),t.styleSheet?n?(document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet.cssText=e.str):t.styleSheet.cssText=t.styleSheet.cssText+" "+e.str:(t.appendChild(document.createTextNode(e.str)),document.getElementsByTagName("head")[0].appendChild(t)),t.sheet||t.styleSheet;if(e.url){if(!document.createStyleSheet)return t=document.createElement("link"),t.rel="stylesheet",t.type="text/css",t.media="all",t.href=e.url,document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet;try{t=document.createStyleSheet(e.url)}catch(i){}}}};var i=[],s=-1,o={},u={};r.fn.jstree=function(e){var t=typeof e=="string",n=Array.prototype.slice.call(arguments,1),s=this;if(t){if(e.substring(0,1)=="_")return s;this.each(function(){var t=i[r.data(this,"jstree_instance_id")],o=t&&r.isFunction(t[e])?t[e].apply(t,n):t;if(typeof o!="undefined"&&(e.indexOf("is_")===0||o!==!0&&o!==!1))return s=o,!1})}else this.each(function(){var t=r.data(this,"jstree_instance_id"),s=[],u=e?r.extend({},!0,e):{},a=r(this),f=!1,l=[];s=s.concat(n),a.data("jstree")&&s.push(a.data("jstree")),u=s.length?r.extend.apply(null,[!0,u].concat(s)):u,typeof t!="undefined"&&i[t]&&i[t].destroy(),t=parseInt(i.push({}),10)-1,r.data(this,"jstree_instance_id",t),u.plugins=r.isArray(u.plugins)?u.plugins:r.jstree.defaults.plugins.slice(),u.plugins.unshift("core"),u.plugins=u.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),f=r.extend(!0,{},r.jstree.defaults,u),f.plugins=u.plugins,r.each(o,function(e,t){r.inArray(e,f.plugins)===-1?(f[e]=null,delete f[e]):l.push(e)}),f.plugins=l,i[t]=new r.jstree._instance(t,r(this).addClass("jstree jstree-"+t),f),r.each(i[t]._get_settings().plugins,function(e,n){i[t].data[n]={}}),r.each(i[t]._get_settings().plugins,function(e,n){o[n]&&o[n].__init.apply(i[t])}),setTimeout(function(){i[t]&&i[t].init()},0)});return s},r.jstree={defaults:{plugins:[]},_focused:function(){return i[s]||null},_reference:function(e){if(i[e])return i[e];var t=r(e);return!t.length&&typeof e=="string"&&(t=r("#"+e)),t.length?i[t.closest(".jstree").data("jstree_instance_id")]||null:null},_instance:function(e,t,n){this.data={core:{}},this.get_settings=function(){return r.extend(!0,{},n)},this._get_settings=function(){return n},this.get_index=function(){return e},this.get_container=function(){return t},this.get_container_ul=function(){return t.children("ul:eq(0)")},this._set_settings=function(e){n=r.extend(!0,{},n,e)}},_fn:{},plugin:function(e,t){t=r.extend({},{__init:r.noop,__destroy:r.noop,_fn:{},defaults:!1},t),o[e]=t,r.jstree.defaults[e]=t.defaults,r.each(t._fn,function(t,n){n.plugin=e,n.old=r.jstree._fn[t],r.jstree._fn[t]=function(){var e,i=n,s=Array.prototype.slice.call(arguments),o=new r.Event("before.jstree"),u=!1;if(this.data.core.locked===!0&&t!=="unlock"&&t!=="is_locked")return;do{if(i&&i.plugin&&r.inArray(i.plugin,this._get_settings().plugins)!==-1)break;i=i.old}while(i);if(!i)return;if(t.indexOf("_")===0)e=i.apply(this,s);else{e=this.get_container().triggerHandler(o,{func:t,inst:this,args:s,plugin:i.plugin});if(e===!1)return;typeof e!="undefined"&&(s=e),e=i.apply(r.extend({},this,{__callback:function(e){this.get_container().triggerHandler(t+".jstree",{inst:this,args:s,rslt:e,rlbk:u})},__rollback:function(){return u=this.get_rollback(),u},__call_old:function(e){return i.old.apply(this,e?Array.prototype.slice.call(arguments,1):s)}}),s)}return e},r.jstree._fn[t].old=n.old,r.jstree._fn[t].plugin=e})},rollback:function(e){e&&(r.isArray(e)||(e=[e]),r.each(e,function(e,t){i[t.i].set_rollback(t.h,t.d)}))}},r.jstree._fn=r.jstree._instance.prototype={},r(function(){var i=navigator.userAgent.toLowerCase(),s=(i.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],o=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(/msie/.test(i)&&parseInt(s,10)==6){e=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(u){}o+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(i)&&parseInt(s,10)==7&&(t=!0,o+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "),!/compatible/.test(i)&&/mozilla/.test(i)&&parseFloat(s,10)<1.9&&(n=!0,o+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } "),r.vakata.css.add_sheet({str:o,title:"jstree"})}),r.jstree.plugin("core",{__init:function(){this.data.core.locked=!1,this.data.core.to_open=this.get_settings().core.initially_open,this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus(),this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl"),this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>"),this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18,this.get_container().delegate("li > ins","click.jstree",r.proxy(function(e){var t=r(e.target);this.toggle_node(t)},this)).bind("mousedown.jstree",r.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(e){var t;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(n){}}}),this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",r.proxy(function(e,t){var n=this._get_node(t.rslt.obj),i=this;n===-1&&(n=this.get_container_ul());if(!n.length)return;n.find("li").each(function(){var e=r(this);e.data("jstree")&&r.each(e.data("jstree"),function(t,n){i.data[t]&&r.isFunction(i["_"+t+"_notify"])&&i["_"+t+"_notify"].call(i,e,n)})})},this)),this._get_settings().core.load_open&&this.get_container().bind("load_node.jstree",r.proxy(function(e,t){var n=this._get_node(t.rslt.obj),i=this;n===-1&&(n=this.get_container_ul());if(!n.length)return;n.find("li.jstree-open:not(:has(ul))").each(function(){i.load_node(this,r.noop,r.noop)})},this)),this.__callback(),this.load_node(-1,function(){this.loaded(),this.reload_nodes()})},destroy:function(){var e,t=this.get_index(),n=this._get_settings(),u=this;r.each(n.plugins,function(e,t){try{o[t].__destroy.apply(u)}catch(n){}}),this.__callback();if(this.is_focused())for(e in i)if(i.hasOwnProperty(e)&&e!=t){i[e].set_focus();break}t===s&&(s=-1),this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")}),r(document).unbind(".jstree-"+t).undelegate(".jstree-"+t),i[t]=null,delete i[t]},_core_notify:function(e,t){t.opened&&this.open_node(e,!1,!0)},lock:function(){this.data.core.locked=!0,this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7"),this.__callback({})},unlock:function(){this.data.core.locked=!1,this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1"),this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var e=this;this.data.core.to_open=[],this.get_container_ul().find("li.jstree-open").each(function(){this.id&&e.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(e.data.core.to_open)},save_loaded:function(){},reload_nodes:function(e){var t=this,n=!0,i=[],s=[];e||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=r.map(r.makeArray(this.data.core.to_open),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=r.map(r.makeArray(this.data.core.to_load),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open))),this.data.core.to_load.length&&(r.each(this.data.core.to_load,function(e,t){if(t=="#")return!0;r(t).length?i.push(t):s.push(t)}),i.length&&(this.data.core.to_load=s,r.each(i,function(e,r){t._is_loaded(r)||(t.load_node(r,function(){t.reload_nodes(!0)},function(){t.reload_nodes(!0)}),n=!1)}))),this.data.core.to_open.length&&r.each(this.data.core.to_open,function(e,n){t.open_node(n,!1,!0)}),n&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){t.__callback({},t)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var e=this;this.data.core.to_open.length&&r.each(this.data.core.to_open,function(t,n){e.open_node(n,!1,!0)}),this.__callback({})},refresh:function(e){var t=this;this.save_opened(),e||(e=-1),e=this._get_node(e),e||(e=-1),e!==-1?e.children("UL").remove():this.get_container_ul().empty(),this.load_node(e,function(){t.__callback({obj:e}),t.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(this.is_focused())return;var e=r.jstree._focused();e&&e.unset_focus(),this.get_container().addClass("jstree-focused"),s=this.get_index(),this.__callback()},is_focused:function(){return s==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),s=-1),this.__callback()},_get_node:function(e){var t=r(e,this.get_container());return t.is(".jstree")||e==-1?-1:(t=t.closest("li",this.get_container()),t.length?t:!1)},_get_next:function(e,t){return e=this._get_node(e),e===-1?this.get_container().find("> ul > li:first-child"):e.length?t?e.nextAll("li").size()>0?e.nextAll("li:eq(0)"):!1:e.hasClass("jstree-open")?e.find("li:eq(0)"):e.nextAll("li").size()>0?e.nextAll("li:eq(0)"):e.parentsUntil(".jstree","li").next("li").eq(0):!1},_get_prev:function(e,t){e=this._get_node(e);if(e===-1)return this.get_container().find("> ul > li:last-child");if(!e.length)return!1;if(t)return e.prevAll("li").length>0?e.prevAll("li:eq(0)"):!1;if(e.prev("li").length){e=e.prev("li").eq(0);while(e.hasClass("jstree-open"))e=e.children("ul:eq(0)").children("li:last");return e}var n=e.parentsUntil(".jstree","li:eq(0)");return n.length?n:!1},_get_parent:function(e){e=this._get_node(e);if(e==-1||!e.length)return!1;var t=e.parentsUntil(".jstree","li:eq(0)");return t.length?t:-1},_get_children:function(e){return e=this._get_node(e),e===-1?this.get_container().children("ul:eq(0)").children("li"):e.length?e.children("ul:eq(0)").children("li"):!1},get_path:function(e,t){var n=[],r=this;return e=this._get_node(e),e===-1||!e||!e.length?!1:(e.parentsUntil(".jstree","li").each(function(){n.push(t?this.id:r.get_text(this))}),n.reverse(),n.push(t?e.attr("id"):this.get_text(e)),n)},_get_string:function(e){return this._get_settings().core.strings[e]||e},is_open:function(e){return e=this._get_node(e),e&&e!==-1&&e.hasClass("jstree-open")},is_closed:function(e){return e=this._get_node(e),e&&e!==-1&&e.hasClass("jstree-closed")},is_leaf:function(e){return e=this._get_node(e),e&&e!==-1&&e.hasClass("jstree-leaf")},correct_state:function(e){e=this._get_node(e);if(!e||e===-1)return!1;e.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:e})},open_node:function(t,n,r){t=this._get_node(t);if(!t.length)return!1;if(!t.hasClass("jstree-closed"))return n&&n.call(),!1;var i=r||e?0:this._get_settings().core.animation,s=this;this._is_loaded(t)?(this._get_settings().core.open_parents&&t.parentsUntil(".jstree",".jstree-closed").each(function(){s.open_node(this,!1,!0)}),i&&t.children("ul").css("display","none"),t.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),i?t.children("ul").stop(!0,!0).slideDown(i,function(){this.style.display="",s.after_open(t)}):s.after_open(t),this.__callback({obj:t}),n&&n.call()):(t.children("a").addClass("jstree-loading"),this.load_node(t,function(){s.open_node(t,n,r)},n))},after_open:function(e){this.__callback({obj:e})},close_node:function(t,n){t=this._get_node(t);var r=n||e?0:this._get_settings().core.animation,i=this;if(!t.length||!t.hasClass("jstree-open"))return!1;r&&t.children("ul").attr("style","display:block !important"),t.removeClass("jstree-open").addClass("jstree-closed"),r?t.children("ul").stop(!0,!0).slideUp(r,function(){this.style.display="",i.after_close(t)}):i.after_close(t),this.__callback({obj:t})},after_close:function(e){this.__callback({obj:e})},toggle_node:function(e){e=this._get_node(e);if(e.hasClass("jstree-closed"))return this.open_node(e);if(e.hasClass("jstree-open"))return this.close_node(e)},open_all:function(e,t,n){e=e?this._get_node(e):-1;if(!e||e===-1)e=this.get_container_ul();n?e=e.find("li.jstree-closed"):(n=e,e.is(".jstree-closed")?e=e.find("li.jstree-closed").andSelf():e=e.find("li.jstree-closed"));var r=this;e.each(function(){var e=this;r._is_loaded(this)?r.open_node(this,!1,!t):r.open_node(this,function(){r.open_all(e,t,n)},!t)}),n.find("li.jstree-closed").length===0&&this.__callback({obj:n})},close_all:function(e,t){var n=this;e=e?this._get_node(e):this.get_container();if(!e||e===-1)e=this.get_container_ul();e.find("li.jstree-open").andSelf().each(function(){n.close_node(this,!t)}),this.__callback({obj:e})},clean_node:function(e){e=e&&e!=-1?r(e):this.get_container_ul(),e=e.is("li")?e.find("li").andSelf():e.find("li"),e.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed"),e.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:e})},get_rollback:function(){return this.__callback(),{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(e,t){this.get_container().empty().append(e),this.data=t,this.__callback()},load_node:function(e,t,n){this.__callback({obj:e})},_is_loaded:function(e){return!0},create_node:function(e,t,n,i,s){e=this._get_node(e),t=typeof t=="undefined"?"last":t;var o=r("<li />"),u=this._get_settings().core,a;if(e!==-1&&!e.length)return!1;if(!s&&!this._is_loaded(e))return this.load_node(e,function(){this.create_node(e,t,n,i,!0)}),!1;this.__rollback(),typeof n=="string"&&(n={data:n}),n||(n={}),n.attr&&o.attr(n.attr),n.metadata&&o.data(n.metadata),n.state&&o.addClass("jstree-"+n.state),n.data||(n.data=this._get_string("new_node")),r.isArray(n.data)||(a=n.data,n.data=[],n.data.push(a)),r.each(n.data,function(e,t){a=r("<a />"),r.isFunction(t)&&(t=t.call(this,n)),typeof t=="string"?a.attr("href","#")[u.html_titles?"html":"text"](t):(t.attr||(t.attr={}),t.attr.href||(t.attr.href="#"),a.attr(t.attr)[u.html_titles?"html":"text"](t.title),t.language&&a.addClass(t.language)),a.prepend("<ins class='jstree-icon'>&#160;</ins>"),!t.icon&&n.icon&&(t.icon=n.icon),t.icon&&(t.icon.indexOf("/")===-1?a.children("ins").addClass(t.icon):a.children("ins").css("background","url('"+t.icon+"') center center no-repeat")),o.append(a)}),o.prepend("<ins class='jstree-icon'>&#160;</ins>"),e===-1&&(e=this.get_container(),t==="before"&&(t="first"),t==="after"&&(t="last"));switch(t){case"before":e.before(o),a=this._get_parent(e);break;case"after":e.after(o),a=this._get_parent(e);break;case"inside":case"first":e.children("ul").length||e.append("<ul />"),e.children("ul").prepend(o),a=e;break;case"last":e.children("ul").length||e.append("<ul />"),e.children("ul").append(o),a=e;break;default:e.children("ul").length||e.append("<ul />"),t||(t=0),a=e.children("ul").children("li").eq(t),a.length?a.before(o):e.children("ul").append(o),a=e}if(a===-1||a.get(0)===this.get_container().get(0))a=-1;return this.clean_node(a),this.__callback({obj:o,parent:a}),i&&i.call(this,o),o},get_text:function(e){e=this._get_node(e);if(!e.length)return!1;var t=this._get_settings().core.html_titles;return e=e.children("a:eq(0)"),t?(e=e.clone(),e.children("INS").remove(),e.html()):(e=e.contents().filter(function(){return this.nodeType==3})[0],e.nodeValue)},set_text:function(e,t){e=this._get_node(e);if(!e.length)return!1;e=e.children("a:eq(0)");if(this._get_settings().core.html_titles){var n=e.children("INS").clone();return e.html(t).prepend(n),this.__callback({obj:e,name:t}),!0}return e=e.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:e,name:t}),e.nodeValue=t},rename_node:function(e,t){e=this._get_node(e),this.__rollback(),e&&e.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))&&this.__callback({obj:e,name:t})},delete_node:function(e){e=this._get_node(e);if(!e.length)return!1;this.__rollback();var t=this._get_parent(e),n=r([]),i=this;return e.each(function(){n=n.add(i._get_prev(this))}),e=e.detach(),t!==-1&&t.find("> ul > li").length===0&&t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),this.clean_node(t),this.__callback({obj:e,prev:n,parent:t}),e},prepare_move:function(e,t,n,i,s){var o={};o.ot=r.jstree._reference(e)||this,o.o=o.ot._get_node(e),o.r=t===-1?-1:this._get_node(t),o.p=typeof n=="undefined"||n===!1?"last":n;if(!s&&u.o&&u.o[0]===o.o[0]&&u.r[0]===o.r[0]&&u.p===o.p){this.__callback(u),i&&i.call(this,u);return}o.ot=r.jstree._reference(o.o)||this,o.rt=r.jstree._reference(o.r)||this;if(o.r===-1||!o.r){o.cr=-1;switch(o.p){case"first":case"before":case"inside":o.cp=0;break;case"after":case"last":o.cp=o.rt.get_container().find(" > ul > li").length;break;default:o.cp=o.p}}else{if(!/^(before|after)$/.test(o.p)&&!this._is_loaded(o.r))return this.load_node(o.r,function(){this.prepare_move(e,t,n,i,!0)});switch(o.p){case"before":o.cp=o.r.index(),o.cr=o.rt._get_parent(o.r);break;case"after":o.cp=o.r.index()+1,o.cr=o.rt._get_parent(o.r);break;case"inside":case"first":o.cp=0,o.cr=o.r;break;case"last":o.cp=o.r.find(" > ul > li").length,o.cr=o.r;break;default:o.cp=o.p,o.cr=o.r}}o.np=o.cr==-1?o.rt.get_container():o.cr,o.op=o.ot._get_parent(o.o),o.cop=o.o.index(),o.op===-1&&(o.op=o.ot?o.ot.get_container():this.get_container()),!/^(before|after)$/.test(o.p)&&o.op&&o.np&&o.op[0]===o.np[0]&&o.o.index()<o.cp&&o.cp++,o.or=o.np.find(" > ul > li:nth-child("+(o.cp+1)+")"),u=o,this.__callback(u),i&&i.call(this,u)},check_move:function(){var e=u,t=!0,n=e.r===-1?this.get_container():e.r;return!e||!e.o||e.or[0]===e.o[0]?!1:e.op&&e.np&&e.op[0]===e.np[0]&&e.cp-1===e.o.index()?!1:(e.o.each(function(){if(n.parentsUntil(".jstree","li").andSelf().index(this)!==-1)return t=!1,!1}),t)},move_node:function(e,t,n,i,s,o){if(!s)return this.prepare_move(e,t,n,function(e){this.move_node(e,!1,!1,i,!0,o)});i&&(u.cy=!0);if(!o&&!this.check_move())return!1;this.__rollback();var a=!1;i?(a=e.o.clone(!0),a.find("*[id]").andSelf().each(function(){this.id&&(this.id="copy_"+this.id)})):a=e.o,e.or.length?e.or.before(a):(e.np.children("ul").length||r("<ul />").appendTo(e.np),e.np.children("ul:eq(0)").append(a));try{e.ot.clean_node(e.op),e.rt.clean_node(e.np),e.op.find("> ul > li").length||e.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(f){}return i&&(u.cy=!0,u.oc=a),this.__callback(u),u},_get_move:function(){return u}}})})(jQuery),function(e){var t,n,r;e(function(){/msie/.test(navigator.userAgent.toLowerCase())?(n=e('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),r=e('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),t=n.width()-r.width(),n.add(r).remove()):(n=e("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200}),t=100-n.width(),n.parent().remove())}),e.jstree.plugin("ui",{__init:function(){this.data.ui.selected=e(),this.data.ui.last_selected=!1,this.data.ui.hovered=null,this.data.ui.to_select=this.get_settings().ui.initially_select,this.get_container().delegate("a","click.jstree",e.proxy(function(t){t.preventDefault(),t.currentTarget.blur(),e(t.currentTarget).hasClass("jstree-loading")||this.select_node(t.currentTarget,!0,t)},this)).delegate("a","mouseenter.jstree",e.proxy(function(t){e(t.currentTarget).hasClass("jstree-loading")||this.hover_node(t.target)},this)).delegate("a","mouseleave.jstree",e.proxy(function(t){e(t.currentTarget).hasClass("jstree-loading")||this.dehover_node(t.target)},this)).bind("reopen.jstree",e.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",e.proxy(function(){this.dehover_node(),this.save_selected()},this)).bind("set_rollback.jstree",e.proxy(function(){this.reselect()},this)).bind("close_node.jstree",e.proxy(function(t,n){var r=this._get_settings().ui,i=this._get_node(n.rslt.obj),s=i&&i.length?i.children("ul").find("a.jstree-clicked"):e(),o=this;if(r.selected_parent_close===!1||!s.length)return;s.each(function(){o.deselect_node(this),r.selected_parent_close==="select_parent"&&o.select_node(i)})},this)).bind("delete_node.jstree",e.proxy(function(e,t){var n=this._get_settings().ui.select_prev_on_delete,r=this._get_node(t.rslt.obj),i=r&&r.length?r.find("a.jstree-clicked"):[],s=this;i.each(function(){s.deselect_node(this)}),n&&i.length&&t.rslt.prev.each(function(){if(this.parentNode)return s.select_node(this),!1})},this)).bind("move_node.jstree",e.proxy(function(e,t){t.rslt.cy&&t.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(t,n){if(typeof t=="undefined"||t===null)return n?this.data.ui.selected:this.data.ui.last_selected;var r=e(t,this.get_container());return r.is(".jstree")||t==-1?-1:(r=r.closest("li",this.get_container()),r.length?r:!1)},_ui_notify:function(e,t){t.selected&&this.select_node(e,!1)},save_selected:function(){var e=this;this.data.ui.to_select=[],this.data.ui.selected.each(function(){this.id&&e.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}),this.__callback(this.data.ui.to_select)},reselect:function(){var t=this,n=this.data.ui.to_select;n=e.map(e.makeArray(n),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),e.each(n,function(e,n){n&&n!=="#"&&t.select_node(n)}),this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode}),this.__callback()},refresh:function(e){return this.save_selected(),this.__call_old()},hover_node:function(e){e=this._get_node(e);if(!e.length)return!1;e.hasClass("jstree-hovered")||this.dehover_node(),this.data.ui.hovered=e.children("a").addClass("jstree-hovered").parent(),this.__callback({obj:e})},dehover_node:function(){var e=this.data.ui.hovered,t;if(!e||!e.length)return!1;t=e.children("a").removeClass("jstree-hovered").parent(),this.data.ui.hovered[0]===t[0]&&(this.data.ui.hovered=null),this.__callback({obj:e})},select_node:function(e,t,n){e=this._get_node(e);if(e==-1||!e||!e.length)return!1;var r=this._get_settings().ui,i=r.select_multiple_modifier=="on"||r.select_multiple_modifier!==!1&&n&&n[r.select_multiple_modifier+"Key"],s=r.select_range_modifier!==!1&&n&&n[r.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==e[0]&&this.data.ui.last_selected.parent()[0]===e.parent()[0],o=this.is_selected(e),u=!0,a=this;if(t){if(r.disable_selecting_children&&i&&(e.parentsUntil(".jstree","li").children("a.jstree-clicked").length||e.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;u=!1;switch(!0){case s:this.data.ui.last_selected.addClass("jstree-last-selected"),e=e[e.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf(),r.select_limit==-1||e.length<r.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==a.data.ui.last_selected[0]&&a.deselect_node(this)}),o=!1,u=!0):u=!1;break;case o&&!i:this.deselect_all(),o=!1,u=!0;break;case!o&&!i:if(r.select_limit==-1||r.select_limit>0)this.deselect_all(),u=!0;break;case o&&i:this.deselect_node(e);break;case!o&&i:if(r.select_limit==-1||this.data.ui.selected.length+1<=r.select_limit)u=!0}}u&&!o&&(s||(this.data.ui.last_selected=e),e.children("a").addClass("jstree-clicked"),r.selected_parent_open&&e.parents(".jstree-closed").each(function(){a.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(e),this._fix_scroll(e.eq(0)),this.__callback({obj:e,e:n}))},_fix_scroll:function(e){var n=this.get_container()[0],r;if(n.scrollHeight>n.offsetHeight){e=this._get_node(e);if(!e||e===-1||!e.length||!e.is(":visible"))return;r=e.offset().top-this.get_container().offset().top,r<0&&(n.scrollTop=n.scrollTop+r-1),r+this.data.core.li_height+(n.scrollWidth>n.offsetWidth?t:0)>n.offsetHeight&&(n.scrollTop=n.scrollTop+(r-n.offsetHeight+this.data.core.li_height+1+(n.scrollWidth>n.offsetWidth?t:0)))}},deselect_node:function(e){e=this._get_node(e);if(!e.length)return!1;this.is_selected(e)&&(e.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(e),this.data.ui.last_selected.get(0)===e.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:e}))},toggle_select:function(e){e=this._get_node(e);if(!e.length)return!1;this.is_selected(e)?this.deselect_node(e):this.select_node(e)},is_selected:function(e){return this.data.ui.selected.index(this._get_node(e))>=0},get_selected:function(t){return t?e(t).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(t){var n=t?e(t).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();n.children("a.jstree-clicked").removeClass("jstree-clicked"),this.data.ui.selected=e([]),this.data.ui.last_selected=!1,this.__callback({obj:n})}}}),e.jstree.defaults.plugins.push("ui")}(jQuery),function(e){e.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",e.proxy(function(e,t){if(this._get_settings().crrm.move.open_onmove){var n=this;t.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){n.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(e){return!0}}},_fn:{_show_input:function(t,n){t=this._get_node(t);var r=this._get_settings().core.rtl,i=this._get_settings().crrm.input_width_limit,s=t.children("ins").width(),o=t.find("> a:visible > ins").width()*t.find("> a:visible > ins").length,u=this.get_text(t),a=e("<div />",{css:{position:"absolute",top:"-200px",left:r?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),f=t.css("position","relative").append(e("<input />",{value:u,"class":"jstree-rename-input",css:{right:r?s+o+4+"px":"auto",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px"},blur:e.proxy(function(){var e=t.children(".jstree-rename-input"),r=e.val();r===""&&(r=u),a.remove(),e.remove(),this.set_text(t,u),this.rename_node(t,r),n.call(this,t,r,u),t.css("position","")},this),keyup:function(e){var t=e.keyCode||e.which;if(t==27){this.value=u,this.blur();return}if(t==13){this.blur();return}f.width(Math.min(a.text("pW"+this.value).width(),i))},keypress:function(e){var t=e.keyCode||e.which;if(t==13)return!1}})).children(".jstree-rename-input");this.set_text(t,""),a.css({fontFamily:f.css("fontFamily")||"",fontSize:f.css("fontSize")||"",fontWeight:f.css("fontWeight")||"",fontStyle:f.css("fontStyle")||"",fontStretch:f.css("fontStretch")||"",fontVariant:f.css("fontVariant")||"",letterSpacing:f.css("letterSpacing")||"",wordSpacing:f.css("wordSpacing")||""}),f.width(Math.min(a.text("pW"+f[0].value).width(),i))[0].select()},rename:function(e){e=this._get_node(e),this.__rollback();var t=this.__callback;this._show_input(e,function(e,n,r){t.call(this,{obj:e,new_name:n,old_name:r})})},create:function(t,n,r,i,s){var o,u=this;return t=this._get_node(t),t||(t=-1),this.__rollback(),o=this.create_node(t,n,r,function(t){var n=this._get_parent(t),r=e(t).index();i&&i.call(this,t),n.length&&n.hasClass("jstree-closed")&&this.open_node(n,!1,!0),s?u.__callback({obj:t,name:this.get_text(t),parent:n,position:r}):this._show_input(t,function(e,t,i){u.__callback({obj:e,name:t,parent:n,position:r})})}),o},remove:function(e){e=this._get_node(e,!0);var t=this._get_parent(e),n=this._get_prev(e);this.__rollback(),e=this.delete_node(e),e!==!1&&this.__callback({obj:e,prev:n,parent:t})},check_move:function(){if(!this.__call_old())return!1;var e=this._get_settings().crrm.move;return e.check_move.call(this,this._get_move())?!0:!1},move_node:function(e,t,n,r,i,s){var o=this._get_settings().crrm.move;if(!i)return typeof n=="undefined"&&(n=o.default_position),n==="inside"&&!o.default_position.match(/^(before|after)$/)&&(n=o.default_position),this.__call_old(!0,e,t,n,r,!1,s);if(o.always_copy===!0||o.always_copy==="multitree"&&e.rt.get_index()!==e.ot.get_index())r=!0;this.__call_old(!0,e,t,n,r,!0,s)},cut:function(e){e=this._get_node(e,!0);if(!e||!e.length)return!1;this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=e,this.__callback({obj:e})},copy:function(e){e=this._get_node(e,!0);if(!e||!e.length)return!1;this.data.crrm.ct_nodes=!1,this.data.crrm.cp_nodes=e,this.__callback({obj:e})},paste:function(e){e=this._get_node(e);if(!e||!e.length)return!1;var t=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,e),this.data.crrm.ct_nodes=!1),this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,e,!1,!0),this.__callback({obj:e,nodes:t})}}})}(jQuery),function(e){var t=[];e.jstree._themes=!1,e.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",e.proxy(function(){var e=this._get_settings().themes;this.data.themes.dots=e.dots,this.data.themes.icons=e.icons,this.set_theme(e.theme,e.url)},this)).bind("loaded.jstree",e.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(n,r){if(!n)return!1;r||(r=e.jstree._themes+n+"/style.css"),e.inArray(r,t)==-1&&(e.vakata.css.add_sheet({url:r}),t.push(r)),this.data.themes.theme!=n&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=n),this.get_container().addClass("jstree-"+n),this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons(),this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0,this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1,this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0,this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1,this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}}),e(function(){e.jstree._themes===!1&&e("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return e.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1}),e.jstree._themes===!1&&(e.jstree._themes="themes/")}),e.jstree.defaults.plugins.push("themes")}(jQuery),function(e){function n(t,n){var r=e.jstree._focused(),i;if(r&&r.data&&r.data.hotkeys&&r.data.hotkeys.enabled){i=r._get_settings().hotkeys[t];if(i)return i.call(r,n)}}var t=[];e.jstree.plugin("hotkeys",{__init:function(){if(typeof e.hotkeys=="undefined")throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";e.each(this._get_settings().hotkeys,function(r,i){i!==!1&&e.inArray(r,t)==-1&&(e(document).bind("keydown",r,function(e){return n(r,e)}),t.push(r))}),this.get_container().bind("lock.jstree",e.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",e.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this)),this.enable_hotkeys()},defaults:{up:function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},"ctrl+up":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},"shift+up":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(e)),!1},down:function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},"ctrl+down":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},"shift+down":function(){var e=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(e)),!1},left:function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},"ctrl+left":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},"shift+left":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e))),!1},right:function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},"ctrl+right":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},"shift+right":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;return e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e))),!1},space:function(){return this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click(),!1},"ctrl+space":function(e){return e.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(e),!1},"shift+space":function(e){return e.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(e),!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})}(jQuery),function(e){e.jstree.plugin("json_data",{__init:function(){var e=this._get_settings().json_data;e.progressive_unload&&this.get_container().bind("after_close.jstree",function(e,t){t.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(e,t,n){var r=this;this.load_node_json(e,function(){r.__callback({obj:r._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){var n=this._get_settings().json_data;return t=this._get_node(t),t==-1||!t||!n.ajax&&!n.progressive_render&&!e.isFunction(n.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").length>0},refresh:function(t){t=this._get_node(t);var n=this._get_settings().json_data;return t&&t!==-1&&n.progressive_unload&&(e.isFunction(n.data)||!!n.ajax)&&t.removeData("jstree_children"),this.__call_old()},load_node_json:function(t,n,r){var i=this.get_settings().json_data,s,o=function(){},u=function(){};t=this._get_node(t);if(t&&t!==-1&&(i.progressive_render||i.progressive_unload)&&!t.is(".jstree-open, .jstree-leaf")&&t.children("ul").children("li").length===0&&t.data("jstree_children")){s=this._parse_json(t.data("jstree_children"),t),s&&(t.append(s),i.progressive_unload||t.removeData("jstree_children")),this.clean_node(t),n&&n.call(this);return}if(t&&t!==-1){if(t.data("jstree_is_loading"))return;t.data("jstree_is_loading",!0)}switch(!0){case!i.data&&!i.ajax:throw"Neither data nor ajax settings supplied.";case e.isFunction(i.data):i.data.call(this,t,e.proxy(function(e){e=this._parse_json(e,t),e?(t===-1||!t?this.get_container().children("ul").empty().append(e.children()):(t.append(e).children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):(t===-1||!t?i.correct_state&&this.get_container().children("ul").empty():(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&this.correct_state(t)),r&&r.call(this))},this));break;case!!i.data&&!i.ajax||!!i.data&&!!i.ajax&&(!t||t===-1):if(!t||t==-1)s=this._parse_json(i.data,t),s?(this.get_container().children("ul").empty().append(s.children()),this.clean_node()):i.correct_state&&this.get_container().children("ul").empty();n&&n.call(this);break;case!i.data&&!!i.ajax||!!i.data&&!!i.ajax&&t&&t!==-1:o=function(e,n,s){var o=this.get_settings().json_data.ajax.error;o&&o.call(this,e,n,s),t!=-1&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),n==="success"&&i.correct_state&&this.correct_state(t)):n==="success"&&i.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},u=function(r,s,u){var a=this.get_settings().json_data.ajax.success;a&&(r=a.call(this,r,s,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")===""||!e.isArray(r)&&!e.isPlainObject(r))return o.call(this,u,s,"");r=this._parse_json(r,t),r?(t===-1||!t?this.get_container().children("ul").empty().append(r.children()):(t.append(r).children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):t===-1||!t?i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&(this.correct_state(t),n&&n.call(this)))},i.ajax.context=this,i.ajax.error=o,i.ajax.success=u,i.ajax.dataType||(i.ajax.dataType="json"),e.isFunction(i.ajax.url)&&(i.ajax.url=i.ajax.url.call(this,t)),e.isFunction(i.ajax.data)&&(i.ajax.data=i.ajax.data.call(this,t)),e.ajax(i.ajax)}},_parse_json:function(t,n,r){var i=!1,s=this._get_settings(),o=s.json_data,u=s.core.html_titles,a,f,l,c,h;if(!t)return i;o.progressive_unload&&n&&n!==-1&&n.data("jstree_children",i);if(e.isArray(t)){i=e();if(!t.length)return!1;for(f=0,l=t.length;f<l;f++)a=this._parse_json(t[f],n,!0),a.length&&(i=i.add(a))}else{typeof t=="string"&&(t={data:t});if(!t.data&&t.data!=="")return i;i=e("<li />"),t.attr&&i.attr(t.attr),t.metadata&&i.data(t.metadata),t.state&&i.addClass("jstree-"+t.state),e.isArray(t.data)||(a=t.data,t.data=[],t.data.push(a)),e.each(t.data,function(n,r){a=e("<a />"),e.isFunction(r)&&(r=r.call(this,t)),typeof r=="string"?a.attr("href","#")[u?"html":"text"](r):(r.attr||(r.attr={}),r.attr.href||(r.attr.href="#"),a.attr(r.attr)[u?"html":"text"](r.title),r.language&&a.addClass(r.language)),a.prepend("<ins class='jstree-icon'>&#160;</ins>"),!r.icon&&t.icon&&(r.icon=t.icon),r.icon&&(r.icon.indexOf("/")===-1?a.children("ins").addClass(r.icon):a.children("ins").css("background","url('"+r.icon+"') center center no-repeat")),i.append(a)}),i.prepend("<ins class='jstree-icon'>&#160;</ins>"),t.children&&(o.progressive_render&&t.state!=="open"?i.addClass("jstree-closed").data("jstree_children",t.children):(o.progressive_unload&&i.data("jstree_children",t.children),e.isArray(t.children)&&t.children.length&&(a=this._parse_json(t.children,n,!0),a.length&&(h=e("<ul />"),h.append(a),i.append(h)))))}return r||(c=e("<ul />"),c.append(i),i=c),i},get_json:function(t,n,r,i){var s=[],o=this._get_settings(),u=this,a,f,l,c,h,p;t=this._get_node(t);if(!t||t===-1)t=this.get_container().find("> ul > li");return n=e.isArray(n)?n:["id","class"],!i&&this.data.types&&n.push(o.types.type_attr),r=e.isArray(r)?r:[],t.each(function(){l=e(this),a={data:[]},n.length&&(a.attr={}),e.each(n,function(e,t){f=l.attr(t),f&&f.length&&f.replace(/jstree[^ ]*/ig,"").length&&(a.attr[t]=(" "+f).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))}),l.hasClass("jstree-open")&&(a.state="open"),l.hasClass("jstree-closed")&&(a.state="closed"),l.data()&&(a.metadata=l.data()),c=l.children("a"),c.each(function(){h=e(this),r.length||e.inArray("languages",o.plugins)!==-1||h.children("ins").get(0).style.backgroundImage.length||h.children("ins").get(0).className&&h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length?(p=!1,e.inArray("languages",o.plugins)!==-1&&e.isArray(o.languages)&&o.languages.length&&e.each(o.languages,function(e,t){if(h.hasClass(t))return p=t,!1}),f={attr:{},title:u.get_text(h,p)},e.each(r,function(e,t){f.attr[t]=(" "+(h.attr(t)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}),e.inArray("languages",o.plugins)!==-1&&e.isArray(o.languages)&&o.languages.length&&e.each(o.languages,function(e,t){if(h.hasClass(t))return f.language=t,!0}),h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(f.icon=h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")),h.children("ins").get(0).style.backgroundImage.length&&(f.icon=h.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))):f=u.get_text(h),c.length>1?a.data.push(f):a.data=f}),l=l.find("> ul > li"),l.length&&(a.children=u.get_json(l,n,r,!0)),s.push(a)}),s}}})}(jQuery),function(e){e.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(t){var n=this._get_settings().languages,r=!1,i=".jstree-"+this.get_index()+" a";if(!e.isArray(n)||n.length===0)return!1;if(e.inArray(t,n)==-1){if(!n[t])return!1;t=n[t]}return t==this.data.languages.current_language?!0:(r=e.vakata.css.get_css(i+"."+this.data.languages.current_language,!1,this.data.languages.language_css),r!==!1&&(r.style.display="none"),r=e.vakata.css.get_css(i+"."+t,!1,this.data.languages.language_css),r!==!1&&(r.style.display=""),this.data.languages.current_language=t,this.__callback(t),!0)},get_lang:function(){return this.data.languages.current_language},_get_string:function(t,n){var r=this._get_settings().languages,i=this._get_settings().core.strings;return e.isArray(r)&&r.length&&(n=n&&e.inArray(n,r)!=-1?n:this.data.languages.current_language),i[n]&&i[n][t]?i[n][t]:i[t]?i[t]:t},get_text:function(t,n){t=this._get_node(t)||this.data.ui.last_selected;if(!t.size())return!1;var r=this._get_settings().languages,i=this._get_settings().core.html_titles;return e.isArray(r)&&r.length?(n=n&&e.inArray(n,r)!=-1?n:this.data.languages.current_language,t=t.children("a."+n)):t=t.children("a:eq(0)"),i?(t=t.clone(),t.children("INS").remove(),t.html()):(t=t.contents().filter(function(){return this.nodeType==3})[0],t.nodeValue)},set_text:function(t,n,r){t=this._get_node(t)||this.data.ui.last_selected;if(!t.size())return!1;var i=this._get_settings().languages,s=this._get_settings().core.html_titles,o;return e.isArray(i)&&i.length?(r=r&&e.inArray(r,i)!=-1?r:this.data.languages.current_language,t=t.children("a."+r)):t=t.children("a:eq(0)"),s?(o=t.children("INS").clone(),t.html(n).prepend(o),this.__callback({obj:t,name:n,lang:r}),!0):(t=t.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:t,name:n,lang:r}),t.nodeValue=n)},_load_css:function(){var t=this._get_settings().languages,n="/* languages css */",r=".jstree-"+this.get_index()+" a",i;if(e.isArray(t)&&t.length){this.data.languages.current_language=t[0];for(i=0;i<t.length;i++)n+=r+"."+t[i]+" {",t[i]!=this.data.languages.current_language&&(n+=" display:none; "),n+=" } ";this.data.languages.language_css=e.vakata.css.add_sheet({str:n,title:"jstree-languages"})}},create_node:function(t,n,r,i){var s=this.__call_old(!0,t,n,r,function(t){var n=this._get_settings().languages,r=t.children("a"),s;if(e.isArray(n)&&n.length){for(s=0;s<n.length;s++)r.is("."+n[s])||t.append(r.eq(0).clone().removeClass(n.join(" ")).addClass(n[s]));r.not("."+n.join(", .")).remove()}i&&i.call(this,t)});return s}}})}(jQuery),function(e){e.jstree.plugin("cookies",{__init:function(){if(typeof e.cookie=="undefined")throw"jsTree cookie: jQuery cookie plugin not included.";var t=this._get_settings().cookies,n;!t.save_loaded||(n=e.cookie(t.save_loaded),n&&n.length&&(this.data.core.to_load=n.split(","))),!t.save_opened||(n=e.cookie(t.save_opened),n&&n.length&&(this.data.core.to_open=n.split(","))),!t.save_selected||(n=e.cookie(t.save_selected),n&&n.length&&this.data.ui&&(this.data.ui.to_select=n.split(","))),this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",e.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",e.proxy(function(e){this._get_settings().cookies.auto_save&&this.save_cookie((e.handleObj.namespace+e.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(t){if(this.data.core.refreshing)return;var n=this._get_settings().cookies;if(!t){n.save_loaded&&(this.save_loaded(),e.cookie(n.save_loaded,this.data.core.to_load.join(","),n.cookie_options)),n.save_opened&&(this.save_opened(),e.cookie(n.save_opened,this.data.core.to_open.join(","),n.cookie_options)),n.save_selected&&this.data.ui&&(this.save_selected(),e.cookie(n.save_selected,this.data.ui.to_select.join(","),n.cookie_options));return}switch(t){case"open_node":case"close_node":!n.save_opened||(this.save_opened(),e.cookie(n.save_opened,this.data.core.to_open.join(","),n.cookie_options)),!n.save_loaded||(this.save_loaded(),e.cookie(n.save_loaded,this.data.core.to_load.join(","),n.cookie_options));break;case"select_node":case"deselect_node":!!n.save_selected&&this.data.ui&&(this.save_selected(),e.cookie(n.save_selected,this.data.ui.to_select.join(","),n.cookie_options))}}}})}(jQuery),function(e){e.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",e.proxy(function(e,t){var n=this._get_node(t.rslt.obj);n=n===-1?this.get_container().children("ul"):n.children("ul"),this.sort(n)},this)).bind("rename_node.jstree create_node.jstree create.jstree",e.proxy(function(e,t){this.sort(t.rslt.obj.parent())},this)).bind("move_node.jstree",e.proxy(function(e,t){var n=t.rslt.np==-1?this.get_container():t.rslt.np;this.sort(n.children("ul"))},this))},defaults:function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},_fn:{sort:function(t){var n=this._get_settings().sort,r=this;t.append(e.makeArray(t.children("li")).sort(e.proxy(n,r))),t.find("> li > ul").each(function(){r.sort(e(this))}),this.clean_node(t)}}})}(jQuery),function(e){var t=!1,n=!1,r=!1,i=!1,s=!1,o=!1,u=!1,a=!1,f=!1;e.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(t,n,r){e.vakata.dnd.is_drag&&e.vakata.drag_stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.MozUserSelect="none")}catch(i){}return e.vakata.dnd.init_x=t.pageX,e.vakata.dnd.init_y=t.pageY,e.vakata.dnd.user_data=n,e.vakata.dnd.is_down=!0,e.vakata.dnd.helper=e("<div id='vakata-dragged' />").html(r),e(document).bind("mousemove",e.vakata.dnd.drag),e(document).bind("mouseup",e.vakata.dnd.drag_stop),!1},drag:function(t){if(!e.vakata.dnd.is_down)return;if(!e.vakata.dnd.is_drag){if(!(Math.abs(t.pageX-e.vakata.dnd.init_x)>5||Math.abs(t.pageY-e.vakata.dnd.init_y)>5))return;e.vakata.dnd.helper.appendTo("body"),e.vakata.dnd.is_drag=!0,e(document).triggerHandler("drag_start.vakata",{event:t,data:e.vakata.dnd.user_data})}if(t.type==="mousemove"){var n=e(document),r=n.scrollTop(),i=n.scrollLeft();t.pageY-r<20?(o&&u==="down"&&(clearInterval(o),o=!1),o||(u="up",o=setInterval(function(){e(document).scrollTop(e(document).scrollTop()-e.vakata.dnd.scroll_spd)},150))):o&&u==="up"&&(clearInterval(o),o=!1),e(window).height()-(t.pageY-r)<20?(o&&u==="up"&&(clearInterval(o),o=!1),o||(u="down",o=setInterval(function(){e(document).scrollTop(e(document).scrollTop()+e.vakata.dnd.scroll_spd)},150))):o&&u==="down"&&(clearInterval(o),o=!1),t.pageX-i<20?(s&&a==="right"&&(clearInterval(s),s=!1),s||(a="left",s=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()-e.vakata.dnd.scroll_spd)},150))):s&&a==="left"&&(clearInterval(s),s=!1),e(window).width()-(t.pageX-i)<20?(s&&a==="left"&&(clearInterval(s),s=!1),s||(a="right",s=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()+e.vakata.dnd.scroll_spd)},150))):s&&a==="right"&&(clearInterval(s),s=!1)}e.vakata.dnd.helper.css({left:t.pageX+e.vakata.dnd.helper_left+"px",top:t.pageY+e.vakata.dnd.helper_top+"px"}),e(document).triggerHandler("drag.vakata",{event:t,data:e.vakata.dnd.user_data})},drag_stop:function(t){s&&clearInterval(s),o&&clearInterval(o),e(document).unbind("mousemove",e.vakata.dnd.drag),e(document).unbind("mouseup",e.vakata.dnd.drag_stop),e(document).triggerHandler("drag_stop.vakata",{event:t,data:e.vakata.dnd.user_data}),e.vakata.dnd.helper.remove(),e.vakata.dnd.init_x=0,e.vakata.dnd.init_y=0,e.vakata.dnd.user_data={},e.vakata.dnd.is_down=!1,e.vakata.dnd.is_drag=!1}},e(function(){var t="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";e.vakata.css.add_sheet({str:t,title:"vakata"})}),e.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1},this.get_container().bind("mouseenter.jstree",e.proxy(function(n){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){this.data.themes&&(r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));if(n.currentTarget===n.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==n.target){var s=e.jstree._reference(n.target),o;s.data.dnd.foreign?(o=s._get_settings().dnd.drag_check.call(this,{o:t,r:s.get_container(),is_root:!0}),(o===!0||o.inside===!0||o.before===!0||o.after===!0)&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(s.prepare_move(t,s.get_container(),"last"),s.check_move()&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"))}}},this)).bind("mouseup.jstree",e.proxy(function(n){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&n.currentTarget===n.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==n.target){var r=e.jstree._reference(n.currentTarget),i;r.data.dnd.foreign?(i=r._get_settings().dnd.drag_check.call(this,{o:t,r:r.get_container(),is_root:!0}),(i===!0||i.inside===!0||i.before===!0||i.after===!0)&&r._get_settings().dnd.drag_finish.call(this,{o:t,r:r.get_container(),is_root:!0})):r.move_node(t,r.get_container(),"last",n[r._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",e.proxy(function(t){if(t.relatedTarget&&t.relatedTarget.id&&t.relatedTarget.id==="jstree-marker-line")return!1;e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"))},this)).bind("mousemove.jstree",e.proxy(function(t){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){var n=this.get_container()[0];t.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft+=e.vakata.dnd.scroll_spd},n),100)):t.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft-=e.vakata.dnd.scroll_spd},n),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1),t.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop+=e.vakata.dnd.scroll_spd},n),100)):t.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop-=e.vakata.dnd.scroll_spd},n),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&r&&i&&(r.hide(),i.hide())},this)).delegate("a","mousedown.jstree",e.proxy(function(e){if(e.which===1)return this.start_drag(e.currentTarget,e),!1},this)).delegate("a","mouseenter.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_enter(t.currentTarget)},this)).delegate("a","mousemove.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&((!n||!n.length||n.children("a")[0]!==t.currentTarget)&&this.dnd_enter(t.currentTarget),typeof this.data.dnd.off.top=="undefined"&&(this.data.dnd.off=e(t.target).offset()),this.data.dnd.w=(t.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,this.data.dnd.w<0&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",e.proxy(function(t){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){if(t.relatedTarget&&t.relatedTarget.id&&t.relatedTarget.id==="jstree-marker-line")return!1;r&&r.hide(),i&&i.hide(),this.data.dnd.mto=setTimeout(function(e){return function(){e.dnd_leave(t)}}(this),0)}},this)).delegate("a","mouseup.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_finish(t)},this)),e(document).bind("drag_stop.vakata",e.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,this.data.dnd.off=!1,this.data.dnd.prepared=!1,this.data.dnd.w=!1,this.data.dnd.to1=!1,this.data.dnd.to2=!1,this.data.dnd.i1=!1,this.data.dnd.i2=!1,this.data.dnd.active=!1,this.data.dnd.foreign=!1,r&&r.css({top:"-2000px"}),i&&i.css({top:"-2000px"})},this)).bind("drag_start.vakata",e.proxy(function(t,n){if(n.data.jstree){var r=e(n.event.target);r.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(r)}},this));var s=this._get_settings().dnd;s.drag_target&&e(document).delegate(s.drag_target,"mousedown.jstree-"+this.get_index(),e.proxy(function(n){t=n.target,e.vakata.dnd.drag_start(n,{jstree:!0,obj:n.target},"<ins class='jstree-icon'></ins>"+e(n.target).text()),this.data.themes&&(r&&r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var s=this.get_container();this.data.dnd.cof=s.offset(),this.data.dnd.cw=parseInt(s.width(),10),this.data.dnd.ch=parseInt(s.height(),10),this.data.dnd.foreign=!0,n.preventDefault()},this)),s.drop_target&&e(document).delegate(s.drop_target,"mouseenter.jstree-"+this.get_index(),e.proxy(function(n){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:t,r:e(n.target),e:n})&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(s.drop_target,"mouseleave.jstree-"+this.get_index(),e.proxy(function(t){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(s.drop_target,"mouseup.jstree-"+this.get_index(),e.proxy(function(n){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:t,r:e(n.target),e:n})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(e){return!0},drop_finish:e.noop,drag_target:".jstree-draggable",drag_finish:e.noop,drag_check:function(e){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(!n||!n.length)return;this.data.dnd.off=n.offset(),this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+n.width());if(this.data.dnd.foreign){var e=this._get_settings().dnd.drag_check.call(this,{o:t,r:n});return this.data.dnd.after=e.after,this.data.dnd.before=e.before,this.data.dnd.inside=e.inside,this.data.dnd.prepared=!0,this.dnd_show()}return this.prepare_move(t,n,"before"),this.data.dnd.before=this.check_move(),this.prepare_move(t,n,"after"),this.data.dnd.after=this.check_move(),this._is_loaded(n)?(this.prepare_move(t,n,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1,this.data.dnd.prepared=!0,this.dnd_show()},dnd_show:function(){if(!this.data.dnd.prepared)return;var t=["before","inside","after"],n=!1,s=this._get_settings().core.rtl,o;this.data.dnd.w<this.data.core.li_height/3?t=["before","inside","after"]:this.data.dnd.w<=this.data.core.li_height*2/3?t=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:t=["after","inside","before"],e.each(t,e.proxy(function(t,r){if(this.data.dnd[r])return e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),n=r,!1},this)),n===!1&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),o=s?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(n){case"before":r.css({left:o+"px",top:this.data.dnd.off.top-6+"px"}).show(),i&&i.css({left:o+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case"after":r.css({left:o+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show(),i&&i.css({left:o+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case"inside":r.css({left:o+(s?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show(),i&&i.hide();break;default:r.hide(),i&&i.hide()}return f=n,n},dnd_open:function(){this.data.dnd.to2=!1,this.open_node(n,e.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(e){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:t,r:n,p:f}):(this.dnd_prepare(),this.move_node(t,n,f,e[this._get_settings().dnd.copy_modifier+"Key"])),t=!1,n=!1,r.hide(),i&&i.hide()},dnd_enter:function(t){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=!1);var r=this._get_settings().dnd;this.data.dnd.prepared=!1,n=this._get_node(t),r.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(e.proxy(this.dnd_prepare,this),r.check_timeout)):this.dnd_prepare(),r.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),n&&n.length&&n.hasClass("jstree-closed")&&(this.data.dnd.to2=setTimeout(e.proxy(this.dnd_open,this),r.open_timeout))):n&&n.length&&n.hasClass("jstree-closed")&&this.dnd_open()},dnd_leave:function(t){this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),r.hide(),i&&i.hide(),n&&n[0]===t.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1))},start_drag:function(n,s){t=this._get_node(n),this.data.ui&&this.is_selected(t)&&(t=this._get_node(null,!0));var o=t.length>1?this._get_string("multiple_selection"):this.get_text(t),u=this.get_container();this._get_settings().core.html_titles||(o=o.replace(/</ig,"&lt;").replace(/>/ig,"&gt;")),e.vakata.dnd.drag_start(s,{jstree:!0,obj:t},"<ins class='jstree-icon'></ins>"+o),this.data.themes&&(r&&r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),this.data.dnd.cof=u.offset(),this.data.dnd.cw=parseInt(u.width(),10),this.data.dnd.ch=parseInt(u.height(),10),this.data.dnd.active=!0}}}),e(function(){var t="#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }";e.vakata.css.add_sheet({str:t,title:"jstree"}),r=e("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(e){return r.hide(),i.hide(),e.preventDefault(),e.stopImmediatePropagation(),!1}).appendTo("body"),i=e("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(e){if(n&&n.length)return n.children("a").trigger(e),e.preventDefault(),e.stopImmediatePropagation(),!1}).bind("mouseleave",function(t){var s=e(t.relatedTarget);if(s.is(".jstree")||s.closest(".jstree").length===0)if(n&&n.length)return n.children("a").trigger(t),r.hide(),i.hide(),t.preventDefault(),t.stopImmediatePropagation(),!1}).appendTo("body"),e(document).bind("drag_start.vakata",function(e,t){t.data.jstree&&(r.show(),i&&i.show())}),e(document).bind("drag_stop.vakata",function(e,t){t.data.jstree&&(r.hide(),i&&i.hide())})})}(jQuery),function(e){e.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui,this.data.ui&&this.data.checkbox.noui&&(this.select_node=this.deselect_node=this.deselect_all=e.noop,this.get_selected=this.get_checked),this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",e.proxy(function(e,t){this._prepare_checkboxes(t.rslt.obj)},this)).bind("loaded.jstree",e.proxy(function(e){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",e.proxy(function(e){e.preventDefault(),this._get_node(e.target).hasClass("jstree-checked")?this.uncheck_node(e.target):this.check_node(e.target);if(!this.data.ui||!this.data.checkbox.noui)return e.stopImmediatePropagation(),!1;this.save_selected(),this.data.cookies&&this.save_cookie("select_node")},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(e){return["check_"+(e[0].id||Math.ceil(Math.random()*1e4)),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(e,t){t.checked&&this.check_node(e,!1)},_prepare_checkboxes:function(t){t=!t||t==-1?this.get_container().find("> ul > li"):this._get_node(t);if(t===!1)return;var n,r=this,i,s=this._get_settings().checkbox.two_state,o=this._get_settings().checkbox.real_checkboxes,u=this._get_settings().checkbox.real_checkboxes_names;t.each(function(){i=e(this),n=i.is("li")&&(i.hasClass("jstree-checked")||o&&i.children(":checked").length)?"jstree-checked":"jstree-unchecked",i.find("li").andSelf().each(function(){var t=e(this),i;t.children("a"+(r.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(s?"jstree-unchecked":n),o&&(t.children(":checkbox").length?t.children(":checkbox").addClass("jstree-real-checkbox"):(i=u.call(r,t),t.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+i[0]+"' name='"+i[0]+"' value='"+i[1]+"' />"))),s?(t.hasClass("jstree-checked")||t.children(":checked").length)&&t.addClass("jstree-checked").children(":checkbox").prop("checked",!0):(n==="jstree-checked"||t.hasClass("jstree-checked")||t.children(":checked").length)&&t.find("li").andSelf().addClass("jstree-checked").children(":checkbox").prop("checked",!0)})}),s||t.find(".jstree-checked").parent().parent().each(function(){r._repair_state(this)})},change_state:function(t,n){t=this._get_node(t);var r=!1,i=this._get_settings().checkbox.real_checkboxes;if(!t||t===-1)return!1;n=n===!1||n===!0?n:t.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state)n?(t.removeClass("jstree-checked").addClass("jstree-unchecked"),i&&t.children(":checkbox").prop("checked",!1)):(t.removeClass("jstree-unchecked").addClass("jstree-checked"),i&&t.children(":checkbox").prop("checked",!0));else{if(n){r=t.find("li").andSelf();if(!r.filter(".jstree-checked, .jstree-undetermined").length)return!1;r.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),i&&r.children(":checkbox").prop("checked",!1)}else{r=t.find("li").andSelf();if(!r.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;r.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),i&&r.children(":checkbox").prop("checked",!0),this.data.ui&&(this.data.ui.last_selected=t),this.data.checkbox.last_selected=t}t.parentsUntil(".jstree","li").each(function(){var t=e(this);if(n){if(t.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return t.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),i&&t.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1),!1;t.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"),i&&t.children(":checkbox").prop("checked",!1)}else{if(t.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return t.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),i&&t.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1),!1;t.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),i&&t.children(":checkbox").prop("checked",!0)}})}return this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked()),this.__callback(t),!0},check_node:function(e){if(this.change_state(e,!1)){e=this._get_node(e);if(this._get_settings().checkbox.checked_parent_open){var t=this;e.parents(".jstree-closed").each(function(){t.open_node(this,!1,!0)})}this.__callback({obj:e})}},uncheck_node:function(e){this.change_state(e,!0)&&this.__callback({obj:this._get_node(e)})},check_all:function(){var e=this,t=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");t.each(function(){e.change_state(this,!1)}),this.__callback()},uncheck_all:function(){var e=this,t=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");t.each(function(){e.change_state(this,!0)}),this.__callback()},is_checked:function(e){return e=this._get_node(e),e.length?e.is(".jstree-checked"):!1},get_checked:function(e,t){return e=!e||e===-1?this.get_container():this._get_node(e),t||this._get_settings().checkbox.two_state?e.find(".jstree-checked"):e.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(e,t){return e=!e||e===-1?this.get_container():this._get_node(e),t||this._get_settings().checkbox.two_state?e.find(".jstree-unchecked"):e.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(e){e=this._get_node(e);if(!e.length)return;if(this._get_settings().checkbox.two_state){e.find("li").andSelf().not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",!0);return}var t=this._get_settings().checkbox.real_checkboxes,n=e.find("> ul > .jstree-checked").length,r=e.find("> ul > .jstree-undetermined").length,i=e.find("> ul > li").length;i===0?e.hasClass("jstree-undetermined")&&this.change_state(e,!1):n===0&&r===0?this.change_state(e,!0):n===i?this.change_state(e,!1):(e.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),t&&e.parentsUntil(".jstree","li").andSelf().children(":checkbox").prop("checked",!1))},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var t=this,n=this.data.ui.to_select;n=e.map(e.makeArray(n),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.deselect_all(),e.each(n,function(e,n){t.check_node(n)}),this.__callback()}else this.__call_old()},save_loaded:function(){var e=this;this.data.core.to_load=[],this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&e.data.core.to_load.push("#"+this.id)})}}}),e(function(){var t=".jstree .jstree-real-checkbox { display:none; } ";e.vakata.css.add_sheet({str:t,title:"jstree"})})}(jQuery),function(e){e.vakata.xslt=function(t,n,r){var i="",s,o,u,a;return document.recalc?(s=document.createElement("xml"),o=document.createElement("xml"),s.innerHTML=t,o.innerHTML=n,e("body").append(s).append(o),setTimeout(function(t,n,r){return function(){r.call(null,t.transformNode(n.XMLDocument)),setTimeout(function(t,n){return function(){e(t).remove(),e(n).remove()}}(t,n),200)}}(s,o,r),100),!0):(typeof window.DOMParser!="undefined"&&typeof window.XMLHttpRequest!="undefined"&&typeof window.XSLTProcessor=="undefined"&&(t=(new DOMParser).parseFromString(t,"text/xml"),n=(new DOMParser).parseFromString(n,"text/xml")),typeof window.DOMParser!="undefined"&&typeof window.XMLHttpRequest!="undefined"&&typeof window.XSLTProcessor!="undefined"?(u=new XSLTProcessor,a=e.isFunction(u.transformDocument)?typeof window.XMLSerializer!="undefined":!0,a?(t=(new DOMParser).parseFromString(t,"text/xml"),n=(new DOMParser).parseFromString(n,"text/xml"),e.isFunction(u.transformDocument)?(i=document.implementation.createDocument("","",null),u.transformDocument(t,n,i,null),r.call(null,(new XMLSerializer).serializeToString(i)),!0):(u.importStylesheet(n),i=u.transformToFragment(t,document),r.call(null,e("<div />").append(i).html()),!0)):!1):!1)};var t={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:attribute name="class">				<xsl:if test="position() = last()">jstree-last </xsl:if>				<xsl:choose>					<xsl:when test="@state = \'open\'">jstree-open </xsl:when>					<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>					<xsl:otherwise>jstree-leaf </xsl:otherwise>				</xsl:choose>				<xsl:value-of select="@class" />			</xsl:attribute>			<xsl:for-each select="@*">				<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>				</xsl:if>			</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>			<xsl:for-each select="content/name">				<a>				<xsl:attribute name="href">					<xsl:choose>					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>					<xsl:otherwise>#</xsl:otherwise>					</xsl:choose>				</xsl:attribute>				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>				<xsl:for-each select="@*">					<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>					</xsl:if>				</xsl:for-each>					<ins>						<xsl:attribute name="class">jstree-icon 							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>						</xsl:attribute>						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>						<xsl:text>&#xa0;</xsl:text>					</ins>					<xsl:copy-of select="./child::node()" />				</a>			</xsl:for-each>			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />			<xsl:with-param name="is_last" select="number(position() = last())" />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:param name="is_last" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>	<xsl:attribute name="class">		<xsl:if test="$is_last = true()">jstree-last </xsl:if>		<xsl:choose>			<xsl:when test="@state = \'open\'">jstree-open </xsl:when>			<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>			<xsl:otherwise>jstree-leaf </xsl:otherwise>		</xsl:choose>		<xsl:value-of select="@class" />	</xsl:attribute>	<xsl:for-each select="@*">		<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>		</xsl:if>	</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>	<xsl:for-each select="content/name">		<a>		<xsl:attribute name="href">			<xsl:choose>			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>			<xsl:otherwise>#</xsl:otherwise>			</xsl:choose>		</xsl:attribute>		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>		<xsl:for-each select="@*">			<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>			<ins>				<xsl:attribute name="class">jstree-icon 					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>				</xsl:attribute>				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>				<xsl:text>&#xa0;</xsl:text>			</ins>			<xsl:copy-of select="./child::node()" />		</a>	</xsl:for-each>	<xsl:if test="$children">		<ul>		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">			<xsl:call-template name="nodes">				<xsl:with-param name="node" select="." />				<xsl:with-param name="is_last" select="number(position() = last())" />			</xsl:call-template>		</xsl:for-each>		</ul>	</xsl:if>	</li></xsl:template></xsl:stylesheet>'},n=function(e){return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};e.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(e,t,n){var r=this;this.load_node_xml(e,function(){r.__callback({obj:r._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){var n=this._get_settings().xml_data;return t=this._get_node(t),t==-1||!t||!n.ajax&&!e.isFunction(n.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").size()>0},load_node_xml:function(t,n,r){var i=this.get_settings().xml_data,s=function(){},o=function(){};t=this._get_node(t);if(t&&t!==-1){if(t.data("jstree_is_loading"))return;t.data("jstree_is_loading",!0)}switch(!0){case!i.data&&!i.ajax:throw"Neither data nor ajax settings supplied.";case e.isFunction(i.data):i.data.call(this,t,e.proxy(function(r){this.parse_xml(r,e.proxy(function(r){r&&(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10?(r=e(r),t===-1||!t?this.get_container().children("ul").empty().append(r.children()):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r),t.removeData("jstree_is_loading")),i.clean_node&&this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&(this.correct_state(t),n&&n.call(this))):i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)))},this))},this));break;case!!i.data&&!i.ajax||!!i.data&&!!i.ajax&&(!t||t===-1):(!t||t==-1)&&this.parse_xml(i.data,e.proxy(function(r){r?(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10&&(r=e(r),this.get_container().children("ul").empty().append(r.children()),i.clean_node&&this.clean_node(t),n&&n.call(this))):i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},this));break;case!i.data&&!!i.ajax||!!i.data&&!!i.ajax&&t&&t!==-1:s=function(e,n,s){var o=this.get_settings().xml_data.ajax.error;o&&o.call(this,e,n,s),t!==-1&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),n==="success"&&i.correct_state&&this.correct_state(t)):n==="success"&&i.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},o=function(r,o,u){r=u.responseText;var a=this.get_settings().xml_data.ajax.success;a&&(r=a.call(this,r,o,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")==="")return s.call(this,u,o,"");this.parse_xml(r,e.proxy(function(r){r&&(r=r.replace(/ ?xmlns="[^"]*"/ig,""),r.length>10?(r=e(r),t===-1||!t?this.get_container().children("ul").empty().append(r.children()):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r),t.removeData("jstree_is_loading")),i.clean_node&&this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),i.correct_state&&(this.correct_state(t),n&&n.call(this))):i.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this)))},this))},i.ajax.context=this,i.ajax.error=s,i.ajax.success=o,i.ajax.dataType||(i.ajax.dataType="xml"),e.isFunction(i.ajax.url)&&(i.ajax.url=i.ajax.url.call(this,t)),e.isFunction(i.ajax.data)&&(i.ajax.data=i.ajax.data.call(this,t)),e.ajax(i.ajax)}},parse_xml:function(n,r){var i=this._get_settings().xml_data;e.vakata.xslt(n,t[i.xsl],r)},get_xml:function(t,r,i,s,o){var u="",a=this._get_settings(),f=this,l,c,h,p,d;t||(t="flat"),o||(o=0),r=this._get_node(r);if(!r||r===-1)r=this.get_container().find("> ul > li");return i=e.isArray(i)?i:["id","class"],!o&&this.data.types&&e.inArray(a.types.type_attr,i)===-1&&i.push(a.types.type_attr),s=e.isArray(s)?s:[],o||(a.xml_data.get_include_preamble&&(u+='<?xml version="1.0" encoding="UTF-8"?>'),u+="<root>"),r.each(function(){u+="<item",h=e(this),e.each(i,function(e,t){var r=h.attr(t);if(!a.xml_data.get_skip_empty||typeof r!="undefined")u+=" "+t+'="'+n((" "+(r||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}),h.hasClass("jstree-open")&&(u+=' state="open"'),h.hasClass("jstree-closed")&&(u+=' state="closed"'),t==="flat"&&(u+=' parent_id="'+n(o)+'"'),u+=">",u+="<content>",p=h.children("a"),p.each(function(){l=e(this),d=!1,u+="<name",e.inArray("languages",a.plugins)!==-1&&e.each(a.languages,function(e,t){if(l.hasClass(t))return u+=' lang="'+n(t)+'"',d=t,!1}),s.length&&e.each(s,function(e,t){var r=l.attr(t);if(!a.xml_data.get_skip_empty||typeof r!="undefined")u+=" "+t+'="'+n((" "+r||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}),l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(u+=' icon="'+n(l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'),l.children("ins").get(0).style.backgroundImage.length&&(u+=' icon="'+n(l.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"'),u+=">",u+="<![CDATA["+f.get_text(l,d)+"]]>",u+="</name>"}),u+="</content>",c=h[0].id||!0,h=h.find("> ul > li"),h.length?c=f.get_xml(t,h,i,s,c):c="",t=="nest"&&(u+=c),u+="</item>",t=="flat"&&(u+=c)}),o||(u+="</root>"),u}}})}(jQuery),function(e){e.expr[":"].jstree_contains=function(e,t,n){return(e.textContent||e.innerText||"").toLowerCase().indexOf(n[3].toLowerCase())>=0},e.expr[":"].jstree_title_contains=function(e,t,n){return(e.getAttribute("title")||"").toLowerCase().indexOf(n[3].toLowerCase())>=0},e.jstree.plugin("search",{__init:function(){this.data.search.str="",this.data.search.result=e(),this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",function(t,n){e(this).children("ul").find("li").hide().removeClass("jstree-last"),n.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){e(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){e(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(t,n){if(e.trim(t)===""){this.clear_search();return}var r=this.get_settings().search,i=this,s=function(){},o=function(){};this.data.search.str=t;if(!n&&r.ajax!==!1&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0){this.search.supress_callback=!0,s=function(){},o=function(e,t,n){var r=this.get_settings().search.ajax.success;r&&(e=r.call(this,e,t,n)||e),this.data.search.to_open=e,this._search_open()},r.ajax.context=this,r.ajax.error=s,r.ajax.success=o,e.isFunction(r.ajax.url)&&(r.ajax.url=r.ajax.url.call(this,t)),e.isFunction(r.ajax.data)&&(r.ajax.data=r.ajax.data.call(this,t)),r.ajax.data||(r.ajax.data={search_string:t});if(!r.ajax.dataType||/^json/.exec(r.ajax.dataType))r.ajax.dataType="json";e.ajax(r.ajax);return}this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+r.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){i.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,str:t})},clear_search:function(t){this.data.search.result.removeClass("jstree-search"),this.__callback(this.data.search.result),this.data.search.result=e()},_search_open:function(t){var n=this,r=!0,i=[],s=[];this.data.search.to_open.length&&(e.each(this.data.search.to_open,function(t,n){if(n=="#")return!0;e(n).length&&e(n).is(".jstree-closed")?i.push(n):s.push(n)}),i.length&&(this.data.search.to_open=s,e.each(i,function(e,t){n.open_node(t,function(){n._search_open(!0)})}),r=!1)),r&&this.search(this.data.search.str,!0)}}})}(jQuery),function(e){e.vakata.context={hide_on_mouseleave:!1,cnt:e("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(t,n,r,i,s,o,u){e.vakata.context.rtl=!!u;var a=e.vakata.context.parse(t),f,l;if(!a)return;e.vakata.context.vis=!0,e.vakata.context.tgt=n,e.vakata.context.par=o||n||null,e.vakata.context.data=s||null,e.vakata.context.cnt.html(a).css({visibility:"hidden",display:"block",left:0,top:0}),e.vakata.context.hide_on_mouseleave&&e.vakata.context.cnt.one("mouseleave",function(t){e.vakata.context.hide()}),f=e.vakata.context.cnt.height(),l=e.vakata.context.cnt.width(),r+l>e(document).width()&&(r=e(document).width()-(l+5),e.vakata.context.cnt.find("li > ul").addClass("right")),i+f>e(document).height()&&(i-=f+n[0].offsetHeight,e.vakata.context.cnt.find("li > ul").addClass("bottom")),e.vakata.context.cnt.css({left:r,top:i}).find("li:has(ul)").bind("mouseenter",function(t){var n=e(document).width(),r=e(document).height(),i=e(this).children("ul").show();n!==e(document).width()&&i.toggleClass("right"),r!==e(document).height()&&i.toggleClass("bottom")}).bind("mouseleave",function(t){e(this).children("ul").hide()}).end().css({visibility:"visible"}).show(),e(document).triggerHandler("context_show.vakata")},hide:function(){e.vakata.context.vis=!1,e.vakata.context.cnt.attr("class","").css({visibility:"hidden"}),e(document).triggerHandler("context_hide.vakata")},parse:function(t,n){if(!t)return!1;var r="",i=!1,s=!0;return n||(e.vakata.context.func={}),r+="<ul>",e.each(t,function(t,n){if(!n)return!0;e.vakata.context.func[t]=n.action,!s&&n.separator_before&&(r+="<li class='vakata-separator vakata-separator-before'></li>"),s=!1,r+="<li class='"+(n._class||"")+(n._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ",n.icon&&n.icon.indexOf("/")===-1&&(r+=" class='"+n.icon+"' "),n.icon&&n.icon.indexOf("/")!==-1&&(r+=" style='background:url("+n.icon+") center center no-repeat;' "),r+=">&#160;</ins><a href='#' rel='"+t+"'>",n.submenu&&(r+="<span style='float:"+(e.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"),r+=n.label+"</a>",n.submenu&&(i=e.vakata.context.parse(n.submenu,!0),i&&(r+=i)),r+="</li>",n.separator_after&&(r+="<li class='vakata-separator vakata-separator-after'></li>",s=!0)}),r=r.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,""),r+="</ul>",e(document).triggerHandler("context_parse.vakata"),r.length>10?r:!1},exec:function(t){return e.isFunction(e.vakata.context.func[t])?(e.vakata.context.func[t].call(e.vakata.context.data,e.vakata.context.par),!0):!1}},e(function(){var t="#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";e.vakata.css.add_sheet({str:t,title:"vakata"}),e.vakata.context.cnt.delegate("a","click",function(e){e.preventDefault()}).delegate("a","mouseup",function(t){!e(this).parent().hasClass("jstree-contextmenu-disabled")&&e.vakata.context.exec(e(this).attr("rel"))?e.vakata.context.hide():e(this).blur()}).delegate("a","mouseover",function(){e.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body"),e(document).bind("mousedown",function(t){e.vakata.context.vis&&!e.contains(e.vakata.context.cnt[0],t.target)&&e.vakata.context.hide()}),typeof e.hotkeys!="undefined"&&e(document).bind("keydown","up",function(t){if(e.vakata.context.vis){var n=e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();n.length||(n=e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()),n.addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault()}}).bind("keydown","down",function(t){if(e.vakata.context.vis){var n=e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();n.length||(n=e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()),n.addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault()}}).bind("keydown","right",function(t){e.vakata.context.vis&&(e.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","left",function(t){e.vakata.context.vis&&(e.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","esc",function(t){e.vakata.context.hide(),t.preventDefault()}).bind("keydown","space",function(t){e.vakata.context.cnt.find(".vakata-hover").last().children("a").click(),t.preventDefault()})}),e.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",e.proxy(function(t){t.preventDefault(),e(t.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(t.currentTarget,t.pageX,t.pageY)},this)).delegate("a","click.jstree",e.proxy(function(t){this.data.contextmenu&&e.vakata.context.hide()},this)).bind("destroy.jstree",e.proxy(function(){this.data.contextmenu&&e.vakata.context.hide()},this)),e(document).bind("context_hide.vakata",e.proxy(function(){this.data.contextmenu=!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(e){this.create(e)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(e){this.rename(e)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(e){this.is_selected(e)?this.remove():this.remove(e)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(e){this.cut(e)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(e){this.copy(e)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(e){this.paste(e)}}}}}},_fn:{show_contextmenu:function(t,n,r){t=this._get_node(t);var i=this.get_settings().contextmenu,s=t.children("a:visible:eq(0)"),o=!1,u=!1;i.select_node&&this.data.ui&&!this.is_selected(t)&&(this.deselect_all(),this.select_node(t,!0));if(i.show_at_node||typeof n=="undefined"||typeof r=="undefined")o=s.offset(),n=o.left,r=o.top+this.data.core.li_height;u=t.data("jstree")&&t.data("jstree").contextmenu?t.data("jstree").contextmenu:i.items,e.isFunction(u)&&(u=u.call(this,t)),this.data.contextmenu=!0,e.vakata.context.show(u,s,n,r,this,t,this._get_settings().core.rtl),this.data.themes&&e.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})}(jQuery),function(t){t.jstree.plugin("types",{__init:function(){var n=this._get_settings().types;this.data.types.attach_to=[],this.get_container().bind("init.jstree",t.proxy(function(){var e=n.types,r=n.type_attr,i="",o=this;t.each(e,function(e,n){t.each(n,function(e,t){/^(max_depth|max_children|icon|valid_children)$/.test(e)||o.data.types.attach_to.push(e)});if(!n.icon)return!0;if(n.icon.image||n.icon.position)e=="default"?i+=".jstree-"+o.get_index()+" a > .jstree-icon { ":i+=".jstree-"+o.get_index()+" li["+r+'="'+e+'"] > a > .jstree-icon { ',n.icon.image&&(i+=" background-image:url("+n.icon.image+"); "),n.icon.position?i+=" background-position:"+n.icon.position+"; ":i+=" background-position:0 0; ",i+="} "}),i!==""&&t.vakata.css.add_sheet({str:i,title:"jstree-types"})},this)).bind("before.jstree",t.proxy(function(e,n){var r,i,s=this._get_settings().types.use_data?this._get_node(n.args[0]):!1,o=s&&s!==-1&&s.length?s.data("jstree"):!1;if(o&&o.types&&o.types[n.func]===!1)return e.stopImmediatePropagation(),!1;if(t.inArray(n.func,this.data.types.attach_to)!==-1){if(!n.args[0]||!n.args[0].tagName&&!n.args[0].jquery)return;r=this._get_settings().types.types,i=this._get_type(n.args[0]);if((r[i]&&typeof r[i][n.func]!="undefined"||r["default"]&&typeof r["default"][n.func]!="undefined")&&this._check(n.func,n.args[0])===!1)return e.stopImmediatePropagation(),!1}},this)),e&&this.get_container().bind("load_node.jstree set_type.jstree",t.proxy(function(e,n){var r=n&&n.rslt&&n.rslt.obj&&n.rslt.obj!==-1?this._get_node(n.rslt.obj).parent():this.get_container_ul(),i=!1,s=this._get_settings().types;t.each(s.types,function(e,t){t.icon&&(t.icon.image||t.icon.position)&&(i=e==="default"?r.find("li > a > .jstree-icon"):r.find("li["+s.type_attr+"='"+e+"'] > a > .jstree-icon"),t.icon.image&&i.css("backgroundImage","url("+t.icon.image+")"),i.css("backgroundPosition",t.icon.position||"0 0"))})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(e,t){t.type&&this._get_settings().types.use_data&&this.set_type(t.type,e)},_get_type:function(e){return e=this._get_node(e),!e||!e.length?!1:e.attr(this._get_settings().types.type_attr)||"default"},set_type:function(e,t){t=this._get_node(t);var n=!t.length||!e?!1:t.attr(this._get_settings().types.type_attr,e);return n&&this.__callback({obj:t,type:e}),n},_check:function(e,n,r){n=this._get_node(n);var i=!1,s=this._get_type(n),o=0,u=this,a=this._get_settings().types,f=!1;if(n===-1){if(!a[e])return;i=a[e]}else{if(s===!1)return;f=a.use_data?n.data("jstree"):!1,f&&f.types&&typeof f.types[e]!="undefined"?i=f.types[e]:!a.types[s]||typeof a.types[s][e]=="undefined"?!!a.types["default"]&&typeof a.types["default"][e]!="undefined"&&(i=a.types["default"][e]):i=a.types[s][e]}return t.isFunction(i)&&(i=i.call(this,n)),e==="max_depth"&&n!==-1&&r!==!1&&a.max_depth!==-2&&i!==0&&n.children("a:eq(0)").parentsUntil(".jstree","li").each(function(t){if(a.max_depth!==-1&&a.max_depth-(t+1)<=0)return i=0,!1;o=t===0?i:u._check(e,this,!1);if(o!==-1&&o-(t+1)<=0)return i=0,!1;o>=0&&(o-(t+1)<i||i<0)&&(i=o-(t+1)),a.max_depth>=0&&(a.max_depth-(t+1)<i||i<0)&&(i=a.max_depth-(t+1))}),i},check_move:function(){if(!this.__call_old())return!1;var e=this._get_move(),n=e.rt._get_settings().types,r=e.rt._check("max_children",e.cr),i=e.rt._check("max_depth",e.cr),s=e.rt._check("valid_children",e.cr),o=0,u=1,a;if(s==="none")return!1;if(t.isArray(s)&&e.ot&&e.ot._get_type){e.o.each(function(){if(t.inArray(e.ot._get_type(this),s)===-1)return u=!1,!1});if(u===!1)return!1}if(n.max_children!==-2&&r!==-1){o=e.cr===-1?this.get_container().find("> ul > li").not(e.o).length:e.cr.find("> ul > li").not(e.o).length;if(o+e.o.length>r)return!1}if(n.max_depth!==-2&&i!==-1){u=0;if(i===0)return!1;if(typeof e.o.d=="undefined"){a=e.o;while(a.length>0)a=a.find("> ul > li"),u++;e.o.d=u}if(i-e.o.d<0)return!1}return!0},create_node:function(e,n,r,i,s,o){if(!o&&(s||this._is_loaded(e))){var u=typeof n=="string"&&n.match(/^before|after$/i)&&e!==-1?this._get_parent(e):this._get_node(e),a=this._get_settings().types,f=this._check("max_children",u),l=this._check("max_depth",u),c=this._check("valid_children",u),h;typeof r=="string"&&(r={data:r}),r||(r={});if(c==="none")return!1;if(t.isArray(c))if(!r.attr||!r.attr[a.type_attr])r.attr||(r.attr={}),r.attr[a.type_attr]=c[0];else if(t.inArray(r.attr[a.type_attr],c)===-1)return!1;if(a.max_children!==-2&&f!==-1){h=u===-1?this.get_container().find("> ul > li").length:u.find("> ul > li").length;if(h+1>f)return!1}if(a.max_depth!==-2&&l!==-1&&l-1<0)return!1}return this.__call_old(!0,e,n,r,i,s,o)}}})}(jQuery),function(e){e.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0),this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(e,t,n){var r=this;this.load_node_html(e,function(){r.__callback({obj:r._get_node(e)}),t.call(this)},n)},_is_loaded:function(t){return t=this._get_node(t),t==-1||!t||!this._get_settings().html_data.ajax&&!e.isFunction(this._get_settings().html_data.data)||t.is(".jstree-open, .jstree-leaf")||t.children("ul").children("li").size()>0},load_node_html:function(t,n,r){var i,s=this.get_settings().html_data,o=function(){},u=function(){};t=this._get_node(t);if(t&&t!==-1){if(t.data("jstree_is_loading"))return;t.data("jstree_is_loading",!0)}switch(!0){case e.isFunction(s.data):s.data.call(this,t,e.proxy(function(r){r&&r!==""&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")!==""?(r=e(r),r.is("ul")||(r=e("<ul />").append(r)),t==-1||!t?this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(t),n&&n.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},this));break;case!s.data&&!s.ajax:if(!t||t==-1)this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();n&&n.call(this);break;case!!s.data&&!s.ajax||!!s.data&&!!s.ajax&&(!t||t===-1):if(!t||t==-1)i=e(s.data),i.is("ul")||(i=e("<ul />").append(i)),this.get_container().children("ul").empty().append(i.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();n&&n.call(this);break;case!s.data&&!!s.ajax||!!s.data&&!!s.ajax&&t&&t!==-1:t=this._get_node(t),o=function(e,n,i){var o=this.get_settings().html_data.ajax.error;o&&o.call(this,e,n,i),t!=-1&&t.length?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),n==="success"&&s.correct_state&&this.correct_state(t)):n==="success"&&s.correct_state&&this.get_container().children("ul").empty(),r&&r.call(this)},u=function(r,i,u){var a=this.get_settings().html_data.ajax.success;a&&(r=a.call(this,r,i,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")==="")return o.call(this,u,i,"");r?(r=e(r),r.is("ul")||(r=e("<ul />").append(r)),t==-1||!t?this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(t.children("a.jstree-loading").removeClass("jstree-loading"),t.append(r).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),t.removeData("jstree_is_loading")),this.clean_node(t),n&&n.call(this)):t&&t!==-1?(t.children("a.jstree-loading").removeClass("jstree-loading"),t.removeData("jstree_is_loading"),s.correct_state&&(this.correct_state(t),n&&n.call(this))):s.correct_state&&(this.get_container().children("ul").empty(),n&&n.call(this))},s.ajax.context=this,s.ajax.error=o,s.ajax.success=u,s.ajax.dataType||(s.ajax.dataType="html"),e.isFunction(s.ajax.url)&&(s.ajax.url=s.ajax.url.call(this,t)),e.isFunction(s.ajax.data)&&(s.ajax.data=s.ajax.data.call(this,t)),e.ajax(s.ajax)}}}}),e.jstree.defaults.plugins.push("html_data")}(jQuery),function(e){e.jstree.plugin("themeroller",{__init:function(){var t=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(n){e(n.currentTarget).hasClass("jstree-loading")||e(this).addClass(t.item_h)}).delegate("a","mouseleave.jstree",function(){e(this).removeClass(t.item_h)}).bind("init.jstree",e.proxy(function(e,t){t.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh"),this._themeroller(t.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",e.proxy(function(e){this._themeroller()},this)).bind("close_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.obj)},this)).bind("delete_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.parent)},this)).bind("correct_state.jstree",e.proxy(function(e,n){n.rslt.obj.children("ins.jstree-icon").removeClass(t.opened+" "+t.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_open+" "+t.item_clsd).addClass(t.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",e.proxy(function(e,n){n.rslt.obj.children("a").addClass(t.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",e.proxy(function(e,n){this.get_container().find("a."+t.item_a).removeClass(t.item_a).end().find("a.jstree-clicked").addClass(t.item_a)},this)).bind("dehover_node.jstree",e.proxy(function(e,n){n.rslt.obj.children("a").removeClass(t.item_h)},this)).bind("hover_node.jstree",e.proxy(function(e,n){this.get_container().find("a."+t.item_h).not(n.rslt.obj).removeClass(t.item_h),n.rslt.obj.children("a").addClass(t.item_h)},this)).bind("move_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.o),this._themeroller(t.rslt.op)},this))},__destroy:function(){var t=this._get_settings().themeroller,n=["ui-icon"];e.each(t,function(e,t){t=t.split(" "),t.length&&(n=n.concat(t))}),this.get_container().removeClass("ui-widget-content").find("."+n.join(", .")).removeClass(n.join(" "))},_fn:{_themeroller:function(e){var t=this._get_settings().themeroller;e=!e||e==-1?this.get_container_ul():this._get_node(e).parent(),e.find("li.jstree-closed").children("ins.jstree-icon").removeClass(t.opened).addClass("ui-icon "+t.closed).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_leaf+" "+t.item_open).addClass(t.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(t.closed).addClass("ui-icon "+t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_leaf+" "+t.item_clsd).addClass(t.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(t.closed+" ui-icon "+t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(t.item_clsd+" "+t.item_open).addClass(t.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}}),e(function(){var t=".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }";e.vakata.css.add_sheet({str:t,title:"jstree"})})}(jQuery),function(e){e.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",e.proxy(function(t,n){var r=[],i=!0,s,o;n.func=="move_node"&&n.args[4]===!0&&n.args[0].o&&n.args[0].o.length&&(n.args[0].o.children("a").each(function(){r.push(e(this).text().replace(/^\s+/g,""))}),i=this._check_unique(r,n.args[0].np.find("> ul > li").not(n.args[0].o),"move_node"));if(n.func=="create_node")if(n.args[4]||this._is_loaded(n.args[0])){s=this._get_node(n.args[0]);if(n.args[1]&&(n.args[1]==="before"||n.args[1]==="after")){s=this._get_parent(n.args[0]);if(!s||s===-1)s=this.get_container()}typeof n.args[2]=="string"?r.push(n.args[2]):!n.args[2]||!n.args[2].data?r.push(this._get_string("new_node")):r.push(n.args[2].data),i=this._check_unique(r,s.find("> ul > li"),"create_node")}if(n.func=="rename_node"){r.push(n.args[1]),o=this._get_node(n.args[0]),s=this._get_parent(o);if(!s||s===-1)s=this.get_container();i=this._check_unique(r,s.find("> ul > li").not(o),"rename_node")}if(!i)return t.stopPropagation(),!1},this))},defaults:{error_callback:e.noop},_fn:{_check_unique:function(t,n,r){var i=[];return n.children("a").each(function(){i.push(e(this).text().replace(/^\s+/g,""))}),!i.length||!t.length?!0:(i=i.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),i.length+t.length!=i.concat(t).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length?(this._get_settings().unique.error_callback.call(null,t,n,r),!1):!0)},check_move:function(){if(!this.__call_old())return!1;var t=this._get_move(),n=[];return t.o&&t.o.length?(t.o.children("a").each(function(){n.push(e(this).text().replace(/^\s+/g,""))}),this._check_unique(n,t.np.find("> ul > li").not(t.o),"check_move")):!0}}})}(jQuery),function(r){r.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1,this.data.wholerow.to=!1,this.get_container().bind("init.jstree",r.proxy(function(e,t){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",r.proxy(function(e,t){this._prepare_wholerow_span(t&&t.rslt&&t.rslt.obj?t.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",r.proxy(function(e,t){this.data.to&&clearTimeout(this.data.to),this.data.to=setTimeout(function(e,t){return function(){e._prepare_wholerow_ul(t)}}(this,t&&t.rslt&&t.rslt.obj?t.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",r.proxy(function(e,t){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",r.proxy(function(e,t){t.rslt.obj.each(function(){var e=t.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((r(this).offset().top-t.inst.get_container().offset().top+t.inst.get_container()[0].scrollTop)/t.inst.data.core.li_height,10)+")");e.children("a").attr("class",t.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",r.proxy(function(e,t){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));if(e.type==="hover_node"){var n=this.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((t.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")");n.children("a").attr("class",t.rslt.obj.children(".jstree-hovered").attr("class"))}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(e){var t=r(e.currentTarget);if(e.target.tagName==="A"||e.target.tagName==="INS"&&t.closest("li").is(".jstree-open, .jstree-closed"))return;t.closest("li").children("a:visible:eq(0)").click(),e.stopImmediatePropagation()}).delegate("li","mouseover.jstree",r.proxy(function(e){return e.stopImmediatePropagation(),r(e.currentTarget).children(".jstree-hovered, .jstree-clicked").length?!1:(this.hover_node(e.currentTarget),!1)},this)).delegate("li","mouseleave.jstree",r.proxy(function(e){if(r(e.currentTarget).children("a").hasClass("jstree-hovered").length)return;this.dehover_node(e.currentTarget)},this)),(t||e)&&r.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove(),this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(e){e=!e||e==-1?this.get_container().find("> ul > li"):this._get_node(e);if(e===!1)return;e.each(function(){r(this).find("li").andSelf().each(function(){var e=r(this);if(e.children(".jstree-wholerow-span").length)return!0;e.prepend("<span class='jstree-wholerow-span' style='width:"+e.parentsUntil(".jstree","li").length*18+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var e=this.get_container().children("ul").eq(0),n=e.html();e.addClass("jstree-wholerow-real"),this.data.wholerow.last_html!==n&&(this.data.wholerow.last_html=n,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(e.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(e.parent()[0].scrollWidth).css("top",(e.height()+(t?5:0))*-1).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}}),r(function(){var i=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";n&&(i+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");if(t||e)i+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";r.vakata.css.add_sheet({str:i,title:"jstree"})})}(jQuery),function(e){var t=["getChildren","getChildrenCount","getAttr","getName","getProps"],n=function(t,n){var r=!0;return t=t||{},n=[].concat(n),e.each(n,function(n,i){if(!e.isFunction(t[i]))return r=!1,!1}),r};e.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(r,i){var s=r==-1?this._get_settings().model.object:r.data("jstree_model");if(!n(s,t))return i.call(null,!1);this._get_settings().model.async?s.getChildren(e.proxy(function(e){this.model_done(e,i)},this)):this.model_done(s.getChildren(),i)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(t,n){var r=[],i=this._get_settings(),s=this;e.isArray(t)||(t=[t]),e.each(t,function(t,n){var o=n.getProps()||{};o.attr=n.getAttr()||{},n.getChildrenCount()&&(o.state="closed"),o.data=n.getName(),e.isArray(o.data)||(o.data=[o.data]),s.data.types&&e.isFunction(n.getType)&&(o.attr[i.types.type_attr]=n.getType()),o.attr.id&&i.model.id_prefix&&(o.attr.id=i.model.id_prefix+o.attr.id),o.metadata||(o.metadata={}),o.metadata.jstree_model=n,r.push(o)}),n.call(null,r)}}})}(jQuery)}(),define("thirdparty/jstree_pre1.0_fix_1/jquery.jstree",function(){}),define("utils/Async",["require","exports","module"],function(e,t,n){function r(e,t,n){var r=[],i=new $.Deferred;if(e.length===0)i.resolve();else{var s=0,o=!1;e.forEach(function(u,a){var f=t(u,a);r.push(f),f.fail(function(){n?i.reject():o=!0}),f.always(function(){s++,s===e.length&&(o?i.reject():i.resolve())})})}return i.promise()}function i(e,t,n){function s(o){if(o>=e.length){i?r.reject():r.resolve();return}var u=t(e[o],o);u.done(function(){s(o+1)}),u.fail(function(){n?r.reject():(i=!0,s(o+1))})}var r=new $.Deferred,i=!1;return s(0),r.promise()}function s(e,t,n,r){n=n||15,r=r||30;var s=(new Date).getTime();return i(e,function(e,i){var o=new $.Deferred;return t(e,i),(new Date).getTime()-s>=n?window.setTimeout(function(){s=(new Date).getTime(),o.resolve()},r):o.resolve(),o},!1)}function o(e,t){var n=[],i=new $.Deferred,s=r(e,function(e,r){var i=t(e,r);return i.fail(function(t){n.push({item:e,error:t})}),i},!1);return s.done(function(){i.resolve()}).fail(function(){i.reject(n)}),i.promise()}function a(e,t){var n=new $.Deferred,r=window.setTimeout(function(){n.reject(u)},t);return e.always(function(){window.clearTimeout(r)}),e.pipe(n.resolve,n.reject),n.promise()}var u={};t.doInParallel=r,t.doSequentially=i,t.doSequentiallyInBackground=s,t.doInParallel_aggregateErrors=o,t.withTimeout=a,t.ERROR_TIMEOUT=u}),define("file/NativeFileError",[],function(){var e=function(e){Object.defineProperty(this,"name",{value:e,writable:!1})};return e.NOT_FOUND_ERR="NotFoundError",e.SECURITY_ERR="SecurityError",e.ABORT_ERR="AbortError",e.NOT_READABLE_ERR="NotReadableError",e.NO_MODIFICATION_ALLOWED_ERR="NoModificationAllowedError",e.INVALID_STATE_ERR="InvalidStateError",e.SYNTAX_ERR="SyntaxError",e.INVALID_MODIFICATION_ERR="InvalidModificationError",e.QUOTA_EXCEEDED_ERR="QuotaExceededError",e.TYPE_MISMATCH_ERR="TypeMismatchError",e.PATH_EXISTS_ERR="PathExistsError",e}),define("file/NativeFileSystem",["require","exports","module","utils/Async","file/NativeFileError"],function(e,t,n){var r=e("utils/Async"),i=e("file/NativeFileError"),s={ASYNC_TIMEOUT:brackets.inBrowser?5e4:2e3,showOpenDialog:function(e,t,n,r,o,u,a){if(!u)return;var f=brackets.fs.showOpenDialog(e,t,n,r,o,function(e,t){e?a&&a(new i(s._fsErrorToDOMErrorName(e))):u(t)})},requestNativeFileSystem:function(e,t,n){brackets.fs.stat(e,function(r,o){r?n&&n(new i(s._fsErrorToDOMErrorName(r))):t(new s.FileSystem(e))})},resolveNativeFileSystemPath:function(e,t,n){brackets.fs.stat(e,function(r,o){if(!r){var u;o.isDirectory()?u=new s.DirectoryEntry(e):u=new s.FileEntry(e),t(u)}else n&&n(new i(s._fsErrorToDOMErrorName(r)))})},_fsErrorToDOMErrorName:function(e){var t;switch(e){case brackets.fs.ERR_UNKNOWN:case brackets.fs.ERR_INVALID_PARAMS:t=i.SECURITY_ERR;break;case brackets.fs.ERR_NOT_FOUND:t=i.NOT_FOUND_ERR;break;case brackets.fs.ERR_CANT_READ:t=i.NOT_READABLE_ERR;break;case brackets.fs.ERR_UNSUPPORTED_ENCODING:t=i.NOT_READABLE_ERR;break;case brackets.fs.ERR_CANT_WRITE:t=i.NO_MODIFICATION_ALLOWED_ERR;break;case brackets.fs.ERR_OUT_OF_SPACE:t=i.QUOTA_EXCEEDED_ERR;break;case brackets.fs.PATH_EXISTS_ERR:t=i.PATH_EXISTS_ERR;break;default:t=i.SECURITY_ERR}return t}};s.Encodings={},s.Encodings.UTF8="UTF-8",s.Encodings.UTF16="UTF-16",s._FSEncodings={},s._FSEncodings.UTF8="utf8",s._FSEncodings.UTF16="utf16",s.Encodings._IANAToFS=function(e){e=e.toUpperCase();switch(e){case s.Encodings.UTF8:return s._FSEncodings.UTF8;case s.Encodings.UTF16:return s._FSEncodings.UTF16;default:return undefined}};var o=s.Encodings,u=s._FSEncodings;s.Entry=function(e,t,n){this.isDirectory=t,this.isFile=!t,e&&t&&e.charAt(e.length-1)!=="/"&&(e=e.concat("/")),this.fullPath=e,this.name=null;if(e){var r=e.split("/");while(!this.name&&r.length)this.name=r.pop()}this.filesystem=n},s.Entry.prototype.moveTo=function(e,t,n,r){},s.Entry.prototype.copyTo=function(e,t,n,r){},s.Entry.prototype.toURL=function(e){},s.Entry.prototype.remove=function(e,t){},s.Entry.prototype.getParent=function(e,t){},s.Entry.prototype.getMetadata=function(e,t){brackets.fs.stat(this.fullPath,function(n,r){if(n===brackets.fs.NO_ERROR){var o=new s.Metadata(r.mtime);e(o)}else t(new i(s._fsErrorToDOMErrorName(n)))})},s.Metadata=function(e){this.modificationTime=e},s.FileEntry=function(e,t){s.Entry.call(this,e,!1,t)},s.FileEntry.prototype=Object.create(s.Entry.prototype),s.FileEntry.prototype.constructor=s.FileEntry,s.FileEntry.prototype.parentClass=s.Entry.prototype,s.FileEntry.prototype.toString=function(){return"[FileEntry "+this.fullPath+"]"},s.FileEntry.prototype.createWriter=function(e,t){var n=this,r=function(e){s.FileSaver.call(this,e),this._length=0,this._position=0};r.prototype.length=function(){return this._length},r.prototype.position=function(){return this._position},r.prototype.write=function(e){(e===null||e===undefined)&&console.error("FileWriter.write() called with null or undefined data.");if(this.readyState===s.FileSaver.WRITING)throw new s.FileException(s.FileException.INVALID_STATE_ERR);this._readyState=s.FileSaver.WRITING,this.onwritestart&&this.onwritestart();var t=this;brackets.fs.writeFile(n.fullPath,e,u.UTF8,function(e){if(e!==brackets.fs.NO_ERROR&&t.onerror){var n=new i(s._fsErrorToDOMErrorName(e));t.onerror(n)}t._readyState=s.FileSaver.DONE,t.onwrite&&t.onwrite(),t.onwriteend&&t.onwriteend()})},r.prototype.seek=function(e){},r.prototype.truncate=function(e){};var o=new r,a=new $.Deferred;brackets.fs.readFile(n.fullPath,u.UTF8,function(e,t){e!==brackets.fs.ERR_NOT_FOUND&&(o._err=e),t&&(o._length=t.length),a.resolve()}),a.done(function(){o._err&&t!==undefined?t(new i(s._fsErrorToDOMErrorName(o._err))):e!==undefined&&e(o)})},s.FileEntry.prototype.file=function(e,t){var n=new s.File(this);e(n)},s.FileException=function(e){this.code=e||0},Object.defineProperties(s.FileException,{NOT_FOUND_ERR:{value:1,writable:!1},SECURITY_ERR:{value:2,writable:!1},ABORT_ERR:{value:3,writable:!1},NOT_READABLE_ERR:{value:4,writable:!1},ENCODING_ERR:{value:5,writable:!1},NO_MODIFICATION_ALLOWED_ERR:{value:6,writable:!1},INVALID_STATE_ERR:{value:7,writable:!1},SYNTAX_ERR:{value:8,writable:!1},QUOTA_EXCEEDED_ERR:{value:10,writable:!1}}),s.FileSaver=function(e){this._data=e,this._readyState=s.FileSaver.INIT,this._error=null},Object.defineProperties(s.FileSaver,{INIT:{value:1,writable:!1},WRITING:{value:2,writable:!1},DONE:{value:3,writable:!1}}),s.FileSaver.prototype.readyState=function(){return this._readyState},s.FileSaver.prototype.abort=function(){if(this._readyState===s.FileSaver.INIT||this._readyState===s.FileSaver.DONE)return;this._error=new i(i.ABORT_ERR),this._readyState=s.FileSaver.DONE},s.DirectoryEntry=function(e,t){s.Entry.call(this,e,!0,t)},s.DirectoryEntry.prototype=Object.create(s.Entry.prototype),s.DirectoryEntry.prototype.constructor=s.DirectoryEntry,s.DirectoryEntry.prototype.parentClass=s.Entry.prototype,s.DirectoryEntry.prototype.toString=function(){return"[DirectoryEntry "+this.fullPath+"]"},s.DirectoryEntry.prototype.getDirectory=function(e,t,n,r){function a(e){return e.indexOf(":")!==-1?!1:e[0]!=="/"}var o=e,u=this.filesystem;a(e)&&(o=this.fullPath+e);var f=function(){n&&n(new s.DirectoryEntry(o,u))},l=function(e){r&&r(new i(s._fsErrorToDOMErrorName(e)))};brackets.fs.stat(o,function(e,n){if(e===brackets.fs.NO_ERROR){if(!n.isDirectory()){r&&r(new i(i.TYPE_MISMATCH_ERR));return}if(t.create&&t.exclusive){r&&r(new i(i.PATH_EXISTS_ERR));return}f()}else if(e===brackets.fs.ERR_NOT_FOUND){if(t.create){brackets.fs.makedir(o,0,function(e){e?l(e):f()});return}r&&r(new i(i.NOT_FOUND_ERR))}else l(e)})},s.DirectoryEntry.prototype.removeRecursively=function(e,t){},s.DirectoryEntry.prototype.createReader=function(){var e=new s.DirectoryReader;return e._directory=this,e},s.DirectoryEntry.prototype.getFile=function(e,t,n,r){function f(e){return e.indexOf(":")!==-1?!1:e[0]!=="/"}var o=e,a=this.filesystem;f(e)&&(o=this.fullPath+e);var l=function(){n&&n(new s.FileEntry(o,a))},c=function(e){r&&r(new i(s._fsErrorToDOMErrorName(e)))};brackets.fs.stat(o,function(e,n){if(e===brackets.fs.NO_ERROR){if(n.isDirectory()){r&&r(new i(i.TYPE_MISMATCH_ERR));return}if(t.create&&t.exclusive){r&&r(new i(i.PATH_EXISTS_ERR));return}l()}else if(e===brackets.fs.ERR_NOT_FOUND){if(t.create){brackets.fs.writeFile(o,"",u.UTF8,function(e){e?c(e):l()});return}r&&r(new i(i.NOT_FOUND_ERR))}else c(e)})},s.DirectoryReader=function(){},s.DirectoryReader.prototype.readEntries=function(e,t){var n=this._directory.fullPath,o=this.filesystem;brackets.fs.readdir(n,function(u,a){if(!u){var f=[],l=null;if(a.length===0){e(f);return}var c=r.doInParallel(a,function(e,t){var r=new $.Deferred,u=n+a[t];return brackets.fs.stat(u,function(e,n){e?(l=new i(s._fsErrorToDOMErrorName(e)),r.reject(l)):(n.isDirectory()?f[t]=new s.DirectoryEntry(u,o):n.isFile()?f[t]=new s.FileEntry(u,o):f[t]=null,r.resolve())}),r.promise()},!0),h=r.withTimeout(c,s.ASYNC_TIMEOUT);h.done(function(){var t=[],n;for(n=0;n<f.length;n++)f[n]&&t.push(f[n]);e(t)}).fail(function(e){e===r.ERROR_TIMEOUT?e=new i(i.SECURITY_ERR):e=l,t&&t(e)})}else t(new i(s._fsErrorToDOMErrorName(u)))})},s.FileReader=function(){this.EMPTY=0,this.LOADING=1,this.DONE=2,this.readyState=this.EMPTY,this.onloadstart=null,this.onprogress=null,this.onload=null,this.onabort=null,this.onerror=null,this.onloadend=null},s.FileReader.prototype.readAsArrayBuffer=function(e){},s.FileReader.prototype.readAsBinaryString=function(e){},s.FileReader.prototype.readAsDataURL=function(e){},s.FileReader.prototype.abort=function(){},s.FileReader.prototype.readAsText=function(e,t){var n=this;t||(t=o.UTF8);var r=o._IANAToFS(t);if(this.readyState===this.LOADING)throw new InvalidateStateError;this.readyState=this.LOADING,this.onloadstart&&this.onloadstart(),brackets.fs.readFile(e._fullPath,r,function(e,t){var r={loaded:0,total:0};r.target=n,n.result=t,n.error=new i(s._fsErrorToDOMErrorName(e)),e?(n.readyState=n.DONE,n.onerror&&n.onerror(r)):(n.readyState=n.DONE,r.loaded=1,r.total=1,n.onprogress&&n.onprogress(r),n.onload&&n.onload(r),n.onloadend&&n.onloadend())})},s.Blob=function(e){this._fullPath=e,this.size=0,this.type=null},s.Blob.prototype.slice=function(e,t,n){},s.File=function(e){s.Blob.call(this,e.fullPath),this.name="",this.lastModifiedDate=null},s.FileSystem=function(e){Object.defineProperty(this,"name",{value:e,writable:!1}),Object.defineProperty(this,"root",{value:new s.DirectoryEntry(e,this),writable:!1})},t.NativeFileSystem=s}),define("utils/KeyEvent",{DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_SEMICOLON:186,DOM_VK_EQUALS:187,DOM_VK_COMMA:188,DOM_VK_DASH:189,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224}),function(){function n(e,t,n,r,i,s){t[e]&&(n.push(e),(t[e]===!0||t[e]===1)&&r.push(i+e+"/"+s))}function r(e,t,n,r,i){var s=r+t+"/"+i;require._fileExists(e.toUrl(s))&&n.push(s)}function i(e,n,r){for(var i in n)!(i in t)&&(!(i in e)||r)&&(e[i]=n[i])}var e=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/,t={};define("i18n",{version:"1.0.0",load:function(t,s,o,u){u=u||{};var a,f=e.exec(t),l=f[1],c=f[4],h=f[5],p=c.split("-"),d=[],v={},m,g,y="";f[5]?(l=f[1],a=l+h):(a=t,h=f[4],c=u.locale||(u.locale=typeof navigator=="undefined"?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),p=c.split("-"));if(u.isBuild){d.push(a),r(s,"root",d,l,h);for(m=0;g=p[m];m++)y+=(y?"-":"")+g,r(s,y,d,l,h);s(d,function(){o()})}else s([a],function(e){var t=[];n("root",e,t,d,l,h);for(m=0;g=p[m];m++)y+=(y?"-":"")+g,n(y,e,t,d,l,h);s(d,function(){var n,r;for(n=t.length-1;n>-1&&(g=t[n]);n--){r=e[g];if(r===!0||r===1)r=s(l+g+"/"+h);i(v,r)}o(v)})})}})}(),define("nls/strings",["require","exports","module"],function(e,t,n){n.exports={root:!0,de:!0,fr:!0,nb:!0,es:!0,it:!0,"pt-br":!0,"pt-pt":!0,ja:!0,tr:!0,ru:!0,sv:!0}}),define("utils/StringUtils",["require","exports","module"],function(e,t,n){function r(e){var t=[].slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(e,n){return typeof t[n]!="undefined"?t[n]:e})}function i(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function s(e){return e.replace(/([.?*+\^$\[\]\\(){}|\-])/g,"\\$1")}function o(e){return e.replace(/\./g,"\\.")}function u(e){return e.split("\n")}function a(e,t){if(Array.isArray(e)){var n=e,r=0,i;for(i=0;i<n.length;i++){if(!(r<t))return r===t?i:i-1;r+=n[i].length+1}return t<=r?i-1:undefined}return e.substr(0,t).split("\n").length-1}function f(e,t){return e.indexOf(t,e.length-t.length)!==-1}function l(e,t){function i(e){return e.lastIndexOf("/")+1<e.length}var n,r;return brackets.platform==="win"?(n=(i(e)?"1":"0")+e.toLowerCase(),r=(i(t)?"1":"0")+t.toLowerCase()):(n=e.toLowerCase(),r=t.toLowerCase()),n===r?0:n>r?1:-1}function c(e){return e.replace(new RegExp(s("/"),"g"),"/&#8203;")}t.format=r,t.htmlEscape=i,t.regexEscape=s,t.jQueryIdEscape=o,t.getLines=u,t.offsetToLineNum=a,t.urlSort=l,t.breakableUrl=c,t.endsWith=f}),define("strings",["require","exports","module","i18n!nls/strings","utils/Global","utils/StringUtils"],function(e,t,n){var r=e("i18n!nls/strings"),i=e("utils/Global"),s=e("utils/StringUtils"),o={},u=/([0-9]+)\.([0-9]+)\.([0-9]+)/.exec(brackets.metadata.version);o.APP_NAME=brackets.metadata.name||r.APP_NAME,o.APP_TITLE=brackets.config.app_title||r.APP_NAME,o.TWITTER_NAME=brackets.config.twitter_name,o.VERSION=brackets.metadata.version,o.VERSION_MAJOR=u[1],o.VERSION_MINOR=u[2],o.VERSION_PATCH=u[3];var a=!s.endsWith(decodeURI(window.location.pathname),"/www/index.html");o.BUILD_TYPE=a?r.DEVELOPMENT_BUILD:r.EXPERIMENTAL_BUILD,Object.keys(r).forEach(function(e){Object.keys(o).forEach(function(t){r[e]=r[e].replace(new RegExp("{"+t+"}","g"),o[t])})}),n.exports=r}),define("text!base-config/keyboard.json",[],function(){return'{\n    "file.new":  [\n        "Ctrl-N"\n    ],\n    "file.open":  [\n        "Ctrl-O"\n    ],\n    "file.close":  [\n        "Ctrl-W"\n    ],\n    "file.close_all":  [\n        "Ctrl-Shift-W"\n    ],\n    "file.save":  [\n        "Ctrl-S"\n    ],\n    "file.saveAll":  [\n        "Ctrl-Alt-S"\n    ],\n    "file.liveFilePreview":  [\n        "Ctrl-Alt-P"\n    ],\n    "file.previewHighlight":  [\n        "Ctrl-Shift-C"\n    ],\n    "file.quit":  [\n        "Ctrl-Q"\n    ],\n    "edit.undo": [\n        "Ctrl-Z"\n    ],\n    "edit.redo": [\n        {\n            "key": "Ctrl-Y"\n        },\n        {\n            "key": "Cmd-Shift-Z",\n            "platform": "mac"\n        }\n    ],\n    "edit.cut": [\n        "Ctrl-X"\n    ],\n    "edit.copy": [\n        "Ctrl-C"\n    ],\n    "edit.paste": [\n        "Ctrl-V"\n    ],\n    "edit.selectAll":  [\n        "Ctrl-A"\n    ],\n    "edit.selectLine":  [\n        {\n            "key": "Ctrl-L"\n        },\n        {\n            "key": "Ctrl-L",\n            "platform": "mac"\n        }\n    ],\n    "edit.find":  [\n        "Ctrl-F"\n    ],\n    "edit.findInFiles":  [\n        "Ctrl-Shift-F"\n    ],\n    "edit.findNext":  [\n        {\n            "key": "F3"\n        },\n        {\n            "key": "Cmd-G",\n            "platform": "mac"\n        }\n    ],\n    "edit.findPrevious":  [\n        {\n            "key": "Shift-F3"\n        },\n        {\n            "key": "Cmd-Shift-G",\n            "platform": "mac"\n        }\n    ],\n    "edit.replace":  [\n        {\n            "key": "Ctrl-H"\n        },\n        {\n            "key": "Cmd-Alt-F",\n            "platform": "mac"\n        }\n    ],\n    "edit.indent":  [\n        {\n            "key": "Ctrl-]"\n        }\n    ],\n    "edit.unindent":  [\n        {\n            "key": "Ctrl-["\n        }\n    ],\n    "edit.duplicate":  [\n        "Ctrl-D"\n    ],\n    "edit.deletelines":  [\n        "Ctrl-Shift-D"\n    ],\n    "edit.lineUp":  [\n        {\n            "key": "Ctrl-Shift-Up",\n            "displayKey": "Ctrl-Shift-↑"\n        },\n        {\n            "key": "Cmd-Ctrl-Up",\n            "displayKey": "Cmd-Ctrl-↑",\n            "platform": "mac"\n        }\n    ],\n    "edit.lineDown":  [\n        {\n            "key": "Ctrl-Shift-Down",\n            "displayKey": "Ctrl-Shift-↓"\n        },\n        {\n            "key": "Cmd-Ctrl-Down",\n            "displayKey": "Cmd-Ctrl-↓",\n            "platform": "mac"\n        }\n    ],\n    "edit.lineComment":  [\n        "Ctrl-/"\n    ],\n    "edit.blockComment":  [\n        {\n            "key": "Ctrl-Shift-/"\n        },\n        {\n            "key": "Cmd-Opt-/",\n            "platform": "mac"\n        }\n    ],\n    "view.hideSidebar":  [\n        "Ctrl-Shift-H"\n    ],\n    "view.increaseFontSize":  [\n        {\n            "key": "Ctrl-=",\n            "displayKey": "Cmd-+"\n        },\n        {\n            "key": "Ctrl-+",\n            "displayKey": "Cmd-+"\n        }\n    ],\n    "view.decreaseFontSize":  [\n        {\n            "key": "Ctrl--",\n            "displayKey": "Cmd-−"\n        }\n    ],\n    "view.restoreFontSize":  [\n        "Ctrl-0"\n    ],\n    "navigate.quickOpen":  [\n        "Ctrl-Shift-O"\n    ],\n    "navigate.gotoLine":  [\n        {\n            "key": "Ctrl-G"\n        },\n        {\n            "key": "Cmd-L",\n            "platform": "mac"\n        }\n    ],\n    "navigate.gotoDefinition":  [\n        "Ctrl-T"\n    ],\n    "navigate.gotoJSLintError":  [\n        {\n            "key": "F8"\n        },\n        {\n            "key": "Cmd-\'",\n            "platform": "mac"\n        }\n    ],\n    "navigate.nextDoc":  [\n        {\n            "key": "Ctrl-Tab"\n        },\n        {\n            "key": "Ctrl-Tab",\n            "platform": "mac"\n        }\n    ],\n    "navigate.prevDoc":  [\n        {\n            "key": "Ctrl-Shift-Tab"\n        },\n        {\n            "key": "Ctrl-Shift-Tab",\n            "platform": "mac"\n        }\n    ],\n    "navigate.toggleQuickEdit":  [\n        "Ctrl-E"\n    ],\n    "navigate.previousMatch":  [\n        {\n            "key": "Alt-Up",\n            "displayKey": "Alt-↑"\n        }\n    ],\n    "navigate.nextMatch":  [\n        {\n            "key": "Alt-Down",\n            "displayKey": "Alt-↓"\n        }\n    ],\n    "debug.showDeveloperTools":  [\n        {\n            "key": "F12"\n        },\n        {\n            "key": "Cmd-Opt-I",\n            "platform": "mac"\n        }\n    ],\n    "debug.refreshWindow":  [\n        {\n            "key": "F5"\n        },\n        {\n            "key": "Cmd-R",\n            "platform": "mac"\n        }\n    ],\n    "file.rename":  [\n        "F2"\n    ]\n}'}),define("command/KeyBindingManager",["require","exports","module","utils/Global","utils/AppInit","command/CommandManager","utils/KeyEvent","strings","text!base-config/keyboard.json"],function(e,t,n){function c(){a={},f={}}function h(e,t,n,r,i){if(!i)return console.log("KeyBindingManager _buildKeyDescriptor() - No key provided!"),"";var s=[];return e&&s.push("Ctrl"),n&&s.push("Alt"),r&&s.push("Shift"),t&&(brackets.platform==="mac"?s.push("Cmd"):s.unshift("Ctrl")),s.push(i),s.join("-")}function p(e){function u(e,t){return!e||!t?!1:(e=e.trim().toLowerCase(),t=t.trim().toLowerCase(),e.length>0&&e===t)}var t=!1,n=!1,r=!1,i=!1,s="",o=!1;return e.split("-").forEach(function(f,l,c){u("ctrl",f)?brackets.platform==="mac"?t=!0:n=!0:u("cmd",f)?n=!0:u("alt",f)?r=!0:u("opt",f)?r=!0:u("shift",f)?i=!0:s.length>0?(console.log("KeyBindingManager normalizeKeyDescriptorString() - Multiple keys defined. Using key: "+s+" from: "+e),o=!0):s=f}),o?null:(s===""&&e.search(/^.+--$/)!==-1&&(s="-"),s.indexOf("+")>=0&&s.length>1?null:h(t,n,r,i,s))}function d(e,t){if(e>=s.DOM_VK_0&&e<=s.DOM_VK_9)return String(e-s.DOM_VK_0);if(e>=s.DOM_VK_NUMPAD0&&e<=s.DOM_VK_NUMPAD9)return String(e-s.DOM_VK_NUMPAD0);switch(e){case s.DOM_VK_SEMICOLON:return";";case s.DOM_VK_EQUALS:return"=";case s.DOM_VK_COMMA:return",";case s.DOM_VK_SUBTRACT:case s.DOM_VK_DASH:return"-";case s.DOM_VK_ADD:return"+";case s.DOM_VK_DECIMAL:case s.DOM_VK_PERIOD:return".";case s.DOM_VK_DIVIDE:case s.DOM_VK_SLASH:return"/";case s.DOM_VK_BACK_QUOTE:return"`";case s.DOM_VK_OPEN_BRACKET:return"[";case s.DOM_VK_BACK_SLASH:return"\\";case s.DOM_VK_CLOSE_BRACKET:return"]";case s.DOM_VK_QUOTE:return"'";default:return t}}function v(e){var t=brackets.platform==="mac"?e.ctrlKey:!1,n=brackets.platform!=="mac"?e.ctrlKey:e.metaKey,r=e.altKey,i=e.shiftKey,s=String.fromCharCode(e.keyCode),o=e.keyIdentifier;return o&&(o.charAt(0)==="U"&&o.charAt(1)==="+"?s=String.fromCharCode(parseInt(o.substring(2),16)):s=o),s==="	"?s="Tab":s===" "?s="Space":s=d(e.keyCode,s),h(t,n,r,i,s)}function m(e){var t;return brackets.platform==="mac"?(t=e.replace(/-/g,""),t=t.replace("Ctrl","⌃"),t=t.replace("Cmd","⌘"),t=t.replace("Shift","⇧"),t=t.replace("Alt","⌥")):(t=e.replace("Ctrl",o.KEYBOARD_CTRL),t=t.replace("Shift",o.KEYBOARD_SHIFT),t=t.replace("Space",o.KEYBOARD_SPACE),t=t.replace(/-/g,"+")),t}function g(e){return a[e]!==undefined}function y(e,t){if(!e||t!==null&&t!==undefined&&t!==brackets.platform)return;var n=p(e);if(!n)console.log("Fail to nomalize "+e);else if(g(n)){var r=a[n],s=i.get(r.commandID),o=f[r.commandID];delete a[n],o&&(f[r.commandID]=o.filter(function(e){return e.key!==n}),s&&$(s).triggerHandler("keyBindingRemoved",[{key:n,displayKey:r.displayKey}]))}}function b(e,n,r){var s,o=null,u,l,c=n.platform||r,h=c||brackets.platform,d,v=[],m;s=n.key||n,brackets.platform==="mac"&&c===undefined&&(s=s.replace("Ctrl","Cmd"),n.displayKey!==undefined&&(n.displayKey=n.displayKey.replace("Ctrl","Cmd"))),u=p(s);if(!u)return console.log("Failed to normalize "+s),null;m=a[u];if(t.useWindowsCompatibleBindings&&c==="win"){if(m&&(!m.explicitPlatform||m.explicitPlatform===brackets.platform))return null;h=brackets.platform}if(h!==brackets.platform)return null;if(m){if(!!m.explicitPlatform)return console.log("Cannot assign "+u+" to "+e+". It is already assigned to "+a[u].commandID),null;y(u)}var g=f[e]||[],b,w;return g.forEach(function(e){b=t.useWindowsCompatibleBindings&&e.explicitPlatform==="win",w=!e.explicitPlatform&&c,(b||w)&&v.push(e)}),v.forEach(function(e){y(e.key)}),l=n.displayKey?p(n.displayKey):u,f[e]||(f[e]=[]),o={key:u,displayKey:l,explicitPlatform:c},f[e].push(o),a[u]={commandID:e,key:u,displayKey:l,explicitPlatform:c},d=i.get(e),d&&$(d).triggerHandler("keyBindingAdded",[o]),o}function w(){return $.extend({},a)}function E(e){if(l&&a[e]){var t=i.execute(a[e].commandID);return t&&t.state()==="rejected"?!1:!0}return!1}function S(e){l=e}function x(e,t,n){if(e===null||e===undefined||!t)return;var r=[],i;if(Array.isArray(t)){var s;i=[],t.forEach(function(n){s=b(e,n,n.platform),s&&i.push(s)})}else i=b(e,t,n);return i}function T(e){var t=f[e];return t||[]}function N(e,t){var n=t.getID(),r=u[n];r&&x(n,r)}e("utils/Global");var r=e("utils/AppInit"),i=e("command/CommandManager"),s=e("utils/KeyEvent"),o=e("strings"),u=JSON.parse(e("text!base-config/keyboard.json")),a={},f={},l=!0;r.htmlReady(function(){window.document.body.addEventListener("keydown",function(e){E(v(e))&&(e.stopPropagation(),e.preventDefault())},!0),t.useWindowsCompatibleBindings=brackets.platform!=="mac"&&brackets.platform!=="win"}),$(i).on("commandRegistered",N),t._reset=c,t.getKeymap=w,t.handleKey=E,t.setEnabled=S,t.addBinding=x,t.removeBinding=y,t.formatKeyDescriptor=m,t.getKeyBindings=T,t.useWindowsCompatibleBindings=!1}),define("utils/NativeApp",["require","exports","module","utils/Async"],function(e,t,n){function i(e){return e===brackets.fs.ERR_NOT_FOUND?FileError.NOT_FOUND_ERR:FileError.SECURITY_ERR}function o(e,t){var n=new $.Deferred;return brackets.app.openLiveBrowser(e,t,function(t,r){t?n.reject(i(t)):(s.push(r),n.resolve(r))}),n.promise()}function u(e){var t=new $.Deferred;return isNaN(e)&&(e=0),brackets.app.closeLiveBrowser(function(n){if(!n){var r=s.indexOf(e);r!==-1&&s.splice(r,1),t.resolve()}else t.reject(i(n))},e),t.promise()}function a(){var e=s.concat();return r.doSequentially(e,u,!1)}function f(e){brackets.app.openURLInDefaultBrowser(function(e){},e)}var r=e("utils/Async"),s=[];t.openLiveBrowser=o,t.closeLiveBrowser=u,t.closeAllLiveBrowsers=a,t.openURLInDefaultBrowser=f}),define("widgets/Dialogs",["require","exports","module","utils/Global","command/KeyBindingManager","utils/KeyEvent","utils/NativeApp"],function(e,t,n){function g(e,t){e.data("buttonId",t),$(".clickable-link",e).off("click"),e.modal(!0).hide()}function y(e,t){return e.find("[data-button-id='"+t+"']")}function w(e,t,n){var i=$.Deferred(),u=i.promise(),a=$(e).addClass("instance").appendTo(window.document.body);a.data("promise",u),t&&$(".dialog-title",a).html(t),n&&$(".dialog-message",a).html(n),$(".clickable-link",a).on("click",function(t){t.target.dataset&&t.target.dataset.href&&s.openURLInDefaultBrowser(t.target.dataset.href)});var f=b.bind(a);return a.one("hidden",function(){var e=a.data("buttonId");e||(e=o),window.setTimeout(function(){i.resolve(e)},0),a.remove(),window.document.body.removeEventListener("keydown",f,!0),r.setEnabled(!0)}).one("shown",function(){var e=a.find(".primary");e&&e.focus(),window.document.body.addEventListener("keydown",f,!0),r.setEnabled(!1)}),a.one("click",".dialog-button",function(e){g(a,$(this).attr("data-button-id"))}),a.modal({backdrop:"static",show:!0,keyboard:!0}),u}function E(e,t,n){var r=$("."+e+".template").clone().removeClass("template");if(r.length===0){console.error("Dialog id "+e+" does not exist");return}return w(r,t,n)}function S(e){$("."+e+".instance").each(function(e,t){$(t).is(":visible")&&g($(t),f)})}e("utils/Global");var r=e("command/KeyBindingManager"),i=e("utils/KeyEvent"),s=e("utils/NativeApp"),o="cancel",u="ok",a="dontsave",f="_canceled",l="download",c="error-dialog",h="error-dialog",p="save-close-dialog",d="ext-changed-dialog",v="ext-deleted-dialog",m="live-development-error-dialog",b=function(e){var t=this.find(".primary"),n=null,r=String.fromCharCode(e.which),s=$(e.target).filter(":input").length>0,u=e.target.tagName==="TEXTAREA";e.which===i.DOM_VK_RETURN&&!u?t&&(n=t.attr("data-button-id")):e.which===i.DOM_VK_SPACE?this.find(".dialog-button:focus").click():brackets.platform==="mac"?e.metaKey&&r==="D"?y(this,a)&&(n=a):e.metaKey&&e.which===i.DOM_VK_PERIOD&&(n=o):r==="N"&&!s&&y(this,a)&&(n=a);if(n)g(this,n);else if(!$.contains(this.get(0),e.target)||!s)e.stopPropagation(),e.preventDefault()};t.DIALOG_BTN_CANCEL=o,t.DIALOG_BTN_OK=u,t.DIALOG_BTN_DONTSAVE=a,t.DIALOG_CANCELED=f,t.DIALOG_BTN_DOWNLOAD=l,t.DIALOG_ID_ERROR=c,t.DIALOG_ID_INFO=h,t.DIALOG_ID_SAVE_CLOSE=p,t.DIALOG_ID_EXT_CHANGED=d,t.DIALOG_ID_EXT_DELETED=v,t.DIALOG_ID_LIVE_DEVELOPMENT=m,t.showModalDialog=E,t.showModalDialogUsingTemplate=w,t.cancelModalDialogIfOpen=S}),define("preferences/PreferenceStorage",["require","exports","module","preferences/PreferencesManager"],function(e,t,n){function i(e,t){if(typeof e=="string"){var n={},r=null;n[e]=t;try{n=JSON.parse(JSON.stringify(n))}catch(i){r=i}return!r&&n[e]!==undefined?!0:(console.error("Value '"+t+"' for key '"+e+"' must be a valid JSON value"),!1)}return console.error("Preference key '"+e+"' must be a string"),!1}function s(){r.savePreferences()}function o(e,t){this._clientID=e,this._json=t}var r=e("preferences/PreferencesManager");o.prototype.getClientID=function(){return this._clientID},o.prototype.remove=function(e){delete this._json[e],s()},o.prototype.setValue=function(e,t){i(e,t)&&(this._json[e]=t,s())},o.prototype.getValue=function(e){return this._json[e]},o.prototype.getAllValues=function(){return JSON.parse(JSON.stringify(this._json))},o.prototype.setAllValues=function(e,t){var n=this,r=null;$.each(e,function(e,t){try{i(e,t)}catch(n){return r=n,!1}});if(r){console.error(r);return}t||$.each(this._json,function(e,t){delete n._json[e]}),$.each(e,function(e,t){n._json[e]=t}),s()},t.PreferenceStorage=o}),define("preferences/PreferencesManager",["require","exports","module","preferences/PreferenceStorage"],function(e,t,n){function f(e,t){if(e===undefined||e===null){console.error("Invalid clientID");return}var n=o[e];return n===undefined?(n=t&&JSON.stringify(t)?t:{},o[e]=n):t&&Object.keys(t).forEach(function(e){n[e]===undefined&&(n[e]=t[e])}),new r(e,n)}function l(){u.setItem(s,JSON.stringify(o))}function c(){o={},u.setItem(s,JSON.stringify(o))}function h(e){u=e,a&&(o=JSON.parse(u.getItem(s))),o||c()}var r=e("preferences/PreferenceStorage").PreferenceStorage,i="com.adobe.brackets.preferences",s,o,u,a=!1;s=localStorage.getItem("preferencesKey"),s?a=!!localStorage.getItem("doLoadPreferences"):(s=i,a=!0),h(localStorage),t.getPreferenceStorage=f,t.savePreferences=l,t._reset=c}),define("text!htmlContent/project-settings-dialog.html",[],function(){return'<div class="project-settings-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title"></h1>\n    </div>\n    <div class="modal-body">\n        <div class="settings-list">\n            <label>{{PROJECT_SETTING_BASE_URL}}: <input type="text" placeholder="{{PROJECT_SETTING_BASE_URL_HINT}}" class="base-url" /></label>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <a href="#" class="dialog-button btn left" data-button-id="cancel">{{CANCEL}}</a>\n        <a href="#" class="dialog-button btn primary" data-button-id="ok">{{OK}}</a>\n    </div>\n</div>\n'}),define("preferences/PreferencesDialogs",["require","exports","module","thirdparty/path-utils/path-utils.min","widgets/Dialogs","preferences/PreferencesManager","project/ProjectManager","utils/StringUtils","strings","text!htmlContent/project-settings-dialog.html"],function(e,t,n){function f(e){var t="";if(e==="")return t;var n=PathUtils.parseUrl(e);if(!n)t=u.BASEURL_ERROR_UNKOWN_ERROR;else if(n.search!=="")t=o.format(u.BASEURL_ERROR_SEARCH_DISALLOWED,n.search);else if(n.hash!=="")t=o.format(u.BASEURL_ERROR_HASH_DISALLOWED,n.hash);else{var r=e.search(/[ \^\[\]\{\}<>\\"\?]+/);r!==-1&&(t=o.format(u.BASEURL_ERROR_INVALID_CHAR,e[r]))}return t}function l(e,t){var n,i,c,h;h=r.showModalDialogUsingTemplate(Mustache.render(a,u)).done(function(e){if(e===r.DIALOG_BTN_OK){var t=c.val(),n=f(t);n===""?s.setBaseUrl(t):l(t,n)}}),n=$(".project-settings-dialog.instance"),i=n.find(".dialog-title");var p="",d=s.getProjectRoot(),v;return d&&(p=d.name),v=o.format(u.PROJECT_SETTINGS_TITLE,p),i.text(v),c=n.find(".base-url"),e&&c.val(e),t&&n.find(".settings-list").append("<div class='alert-message' style='margin-bottom: 0'>"+t+"</div>"),c.focus(),h}e("thirdparty/path-utils/path-utils.min");var r=e("widgets/Dialogs"),i=e("preferences/PreferencesManager"),s=e("project/ProjectManager"),o=e("utils/StringUtils"),u=e("strings"),a=e("text!htmlContent/project-settings-dialog.html");t._validateBaseUrl=f,t.showProjectPreferencesDialog=l}),define("utils/PerfUtils",["require","exports","module","utils/Global"],function(e,t,n){function f(e,t){this.id=e,this.name=t}function l(e,n){a[e]&&console.error("Performance measurement "+e+" is already defined");var r=new f(e,n);return t[e]=r,r}function c(e){return e instanceof f?e.id:e}function h(e,t){o[e]&&console.error("Recursive tests with the same name are not supported. Timer name: "+e),o[e]={startTime:t}}function p(e){if(!i)return;var t=brackets.app.getElapsedMilliseconds();e=c(e);if(Array.isArray(e)){var n;for(n=0;n<e.length;n++)h(e[n],t)}else h(e,t);return e}function d(e){if(!i)return;var t=brackets.app.getElapsedMilliseconds();e=c(e),o[e]&&(t-=o[e].startTime,delete o[e]),s[e]?Array.isArray(s[e])?s[e].push(t):s[e]=[s[e],t]:s[e]=t}function v(e){var t=brackets.app.getElapsedMilliseconds();e=c(e),u[e]?(t-=u[e].startTime,s[e]&&Array.isArray(s[e])?s[e][s[e].length-1]=t:s[e]=t):(o[e]&&(u[e]={startTime:o[e].startTime}),d(e))}function m(e){e=c(e),o[e]&&delete o[e],u[e]&&delete u[e]}function g(e){return o[e]?!0:!1}function y(){var e=function(e){if(Array.isArray(e)){var t,n="";for(t=0;t<e.length;t++)n+=e[t],t<e.length-1&&(n+=", ");return n}return e},t,n,r="";return $.each(s,function(t,n){r+=e(n)+"	"+t+"\n"}),r}function b(e){return e?s[c(e)]:s}function w(e){var t=Object.keys(s).filter(function(t){return e.test(t)}),n=[];return t.forEach(function(e){n.push(s[e])}),n}function E(){s={},o={},u={}}var r=e("utils/Global"),i=brackets&&!!brackets.app.getElapsedMilliseconds,s={},o={},u={},a={};l("INLINE_EDITOR_OPEN","Open inline editor"),l("INLINE_EDITOR_CLOSE","Close inline editor"),t.addMeasurement=d,t.finalizeMeasurement=m,t.isActive=g,t.markStart=p,t.getData=b,t.searchData=w,t.updateMeasurement=v,t.getDelimitedPerfData=y,t.createPerfMeasurement=l,t.clear=E}),define("file/FileUtils",["require","exports","module","utils/Global","file/NativeFileSystem","file/NativeFileError","utils/PerfUtils","widgets/Dialogs","strings","utils/StringUtils"],function(e,t,n){function l(e){var t=new $.Deferred,n,i=s.markStart("readAsText:	"+e.fullPath);return t.always(function(){s.addMeasurement(i)}),n=new r.FileReader,e.file(function(r){n.onload=function(n){var r=n.target.result;e.getMetadata(function(e){t.resolve(r,e.modificationTime)},function(e){t.reject(e)})},n.onerror=function(e){t.reject(e.target.error)},n.readAsText(r,f.UTF8)}),t.promise()}function c(e,t){var n=new $.Deferred;return e.createWriter(function(e){e.onwriteend=function(e){n.resolve()},e.onerror=function(e){n.reject(e)},e.write(t)}),n.promise()}function d(){return brackets.platform==="win"?h:p}function v(e){var t=e.substr(0,1e3),n=/\r\n/.test(t),r=/[^\r]\n/.test(t);return n&&r||!n&&!r?null:n?h:p}function m(e,t){t!==h&&t!==p&&(t=d());var n=t===h?"\r\n":"\n",r=/\r\n|\r|\n/g;return e.replace(r,n)}function g(e){var t;return e===i.NOT_FOUND_ERR?t=u.NOT_FOUND_ERR:e===i.NOT_READABLE_ERR?t=u.NOT_READABLE_ERR:e===i.NO_MODIFICATION_ALLOWED_ERR?t=u.NO_MODIFICATION_ALLOWED_ERR_FILE:t=a.format(u.GENERIC_ERROR,e),t}function y(e,t){return o.showModalDialog(o.DIALOG_ID_ERROR,u.ERROR_OPENING_FILE_TITLE,a.format(u.ERROR_OPENING_FILE,a.htmlEscape(t),g(e)))}function b(e){return e=unescape(e),e.indexOf(":")!==-1&&e[0]==="/"?e.substr(1):e}function w(e){return e.length>0&&e[e.length-1]==="/"?e.slice(0,-1):e}function E(){var e=decodeURI(window.location.pathname),t=e.substr(0,e.lastIndexOf("/"));return b(t)}function S(e){var t;return e&&e.uri&&(t=decodeURI(e.uri),t[0]==="."&&(t=E()+"/"+t.substr(1)),t=t.substr(0,t.lastIndexOf("/"))),t}function x(e,t,n){if(e.fullPath.indexOf(t)===0){var r=e.fullPath.replace(t,n);e.fullPath=r,e.name=null;if(r){var i=r.split("/");while(!e.name&&i.length)e.name=i.pop()}return!0}return!1}function C(e){if(!e)return!1;var t=e.lastIndexOf("."),n=t===-1||t>=e.length-1?e:e.substr(t+1);return T.indexOf(n.toLowerCase())!==-1}function k(e){if(!e)return!1;var t=e.lastIndexOf("."),n=t===-1||t>=e.length-1?e:e.substr(t+1);return N.indexOf(n.toLowerCase())!==-1}e("utils/Global");var r=e("file/NativeFileSystem").NativeFileSystem,i=e("file/NativeFileError"),s=e("utils/PerfUtils"),o=e("widgets/Dialogs"),u=e("strings"),a=e("utils/StringUtils"),f=r.Encodings,h="CRLF",p="LF",T=["htm","html"],N=["php","php3","php4","php5","phtm","phtml","cfm","cfml","asp","aspx","jsp","jspx","shtm","shtml"];t.LINE_ENDINGS_CRLF=h,t.LINE_ENDINGS_LF=p,t.getPlatformLineEndings=d,t.sniffLineEndings=v,t.translateLineEndings=m,t.showFileOpenError=y,t.getFileErrorString=g,t.readAsText=l,t.writeText=c,t.convertToNativePath=b,t.getNativeBracketsDirectoryPath=E,t.getNativeModuleDirectoryPath=S,t.canonicalizeFolderPath=w,t.updateFileEntryPath=x,t.isStaticHtmlFileExt=C,t.isServerHtmlFileExt=k}),define("command/Commands",["require","exports","module"],function(e,t,n){t.FILE_NEW="file.new",t.FILE_NEW_FOLDER="file.newFolder",t.FILE_OPEN="file.open",t.FILE_OPEN_FOLDER="file.openFolder",t.FILE_SAVE="file.save",t.FILE_SAVE_ALL="file.saveAll",t.FILE_CLOSE="file.close",t.FILE_CLOSE_ALL="file.close_all",t.FILE_CLOSE_WINDOW="file.close_window",t.FILE_ADD_TO_WORKING_SET="file.addToWorkingSet",t.FILE_LIVE_FILE_PREVIEW="file.liveFilePreview",t.FILE_LIVE_HIGHLIGHT="file.previewHighlight",t.FILE_PROJECT_SETTINGS="file.projectSettings",t.FILE_RENAME="file.rename",t.FILE_QUIT="file.quit",t.EDIT_UNDO="edit.undo",t.EDIT_REDO="edit.redo",t.EDIT_CUT="edit.cut",t.EDIT_COPY="edit.copy",t.EDIT_PASTE="edit.paste",t.EDIT_SELECT_ALL="edit.selectAll",t.EDIT_SELECT_LINE="edit.selectLine",t.EDIT_FIND="edit.find",t.EDIT_FIND_IN_FILES="edit.findInFiles",t.EDIT_FIND_IN_SUBTREE="edit.findInSubtree",t.EDIT_FIND_NEXT="edit.findNext",t.EDIT_FIND_PREVIOUS="edit.findPrevious",t.EDIT_REPLACE="edit.replace",t.EDIT_INDENT="edit.indent",t.EDIT_UNINDENT="edit.unindent",t.EDIT_DUPLICATE="edit.duplicate",t.EDIT_DELETE_LINES="edit.deletelines",t.EDIT_LINE_COMMENT="edit.lineComment",t.EDIT_BLOCK_COMMENT="edit.blockComment",t.EDIT_LINE_UP="edit.lineUp",t.EDIT_LINE_DOWN="edit.lineDown",t.VIEW_HIDE_SIDEBAR="view.hideSidebar",t.VIEW_INCREASE_FONT_SIZE="view.increaseFontSize",t.VIEW_DECREASE_FONT_SIZE="view.decreaseFontSize",t.VIEW_RESTORE_FONT_SIZE="view.restoreFontSize",t.TOGGLE_JSLINT="debug.jslint",t.SORT_WORKINGSET_BY_ADDED="view.sortWorkingSetByAdded",t.SORT_WORKINGSET_BY_NAME="view.sortWorkingSetByName",t.SORT_WORKINGSET_BY_TYPE="view.sortWorkingSetByType",t.SORT_WORKINGSET_AUTO="view.sortWorkingSetAuto",t.NAVIGATE_NEXT_DOC="navigate.nextDoc",t.NAVIGATE_PREV_DOC="navigate.prevDoc",t.NAVIGATE_SHOW_IN_FILE_TREE="navigate.showInFileTree",t.NAVIGATE_QUICK_OPEN="navigate.quickOpen",t.NAVIGATE_GOTO_DEFINITION="navigate.gotoDefinition",t.NAVIGATE_GOTO_JSLINT_ERROR="navigate.gotoJSLintError",t.NAVIGATE_GOTO_LINE="navigate.gotoLine",t.TOGGLE_QUICK_EDIT="navigate.toggleQuickEdit",t.QUICK_EDIT_NEXT_MATCH="navigate.nextMatch",t.QUICK_EDIT_PREV_MATCH="navigate.previousMatch",t.DEBUG_REFRESH_WINDOW="debug.refreshWindow",t.DEBUG_SHOW_DEVELOPER_TOOLS="debug.showDeveloperTools",t.DEBUG_RUN_UNIT_TESTS="debug.runUnitTests",t.DEBUG_SHOW_PERF_DATA="debug.showPerfData",t.DEBUG_NEW_BRACKETS_WINDOW="debug.newBracketsWindow",t.DEBUG_SWITCH_LANGUAGE="debug.switchLanguage",t.HELP_CHECK_FOR_UPDATE="help.checkForUpdate",t.HELP_HOW_TO_USE_BRACKETS="help.howToUseBrackets",t.HELP_FORUM="help.forum",t.HELP_RELEASE_NOTES="help.releaseNotes",t.HELP_REPORT_AN_ISSUE="help.reportAnIssue",t.HELP_SHOW_EXT_FOLDER="help.showExtensionsFolder",t.HELP_TWITTER="help.twitter",t.HELP_ABOUT="help.about",t.APP_ABORT_QUIT="app.abort_quit"}),define("widgets/PopUpManager",["require","exports","module","editor/EditorManager","utils/KeyEvent"],function(e,t,n){function o(e,t,n){n=n||!1,s.push(e[0]),e.data("PopUpManager-autoRemove",n),e.data("PopUpManager-removeHandler",t)}function u(e){if(e.find(":visible").length>0){var t=e.data("PopUpManager-removeHandler");t&&t()}var n=s.indexOf(e[0]);if(n>=0){var r=e.data("PopUpManager-autoRemove");r&&(e.remove(),s.splice(n,1))}}function a(e){if(e.keyCode!==i.DOM_VK_ESCAPE)return;var t,n,r=new $.Event("popUpClose");for(n=s.length-1;n>=0;n--){t=$(s[n]);if(t.find(":visible").length>0){t.trigger(r),r.isDefaultPrevented()||(e.stopImmediatePropagation(),u(t));break}}}var r=e("editor/EditorManager"),i=e("utils/KeyEvent"),s=[];window.document.body.addEventListener("keydown",a,!0),t.addPopUp=o,t.removePopUp=u}),define("command/Menus",["require","exports","module","utils/AppInit","utils/Global","command/Commands","command/KeyBindingManager","editor/EditorManager","strings","utils/StringUtils","command/CommandManager","widgets/PopUpManager"],function(e,t,n){function N(e){return S[e]}function C(e){return x[e]}function k(e){return!!C(e)}function L(e){return brackets.inBrowser||k(e)}function A(e){return T[e]}function O(e){return $("#"+f.jQueryIdEscape(e)).get(0)}function M(e){return $("#"+f.jQueryIdEscape(e)).get(0)}function _(e,t,n){var r=e.find(".menu-shortcut");r.length===0&&(r=$("<span class='menu-shortcut' />"),e.append(r)),r.data("key",t),r.text(o.formatKeyDescriptor(n))}function D(e){var t=o.getKeyBindings(e.getCommand().getID()),n=null;return t.length>0&&(n=t[t.length-1],_($(M(e.id)),n.key,n.displayKey)),n}function H(){return"brackets-menuDivider-"+P++}function B(e,t,n,r){var i=!1;n&&(n===b?n=v:n===w&&(n=m),n===g?(e.prepend(t),i=!0):r&&r.length>0&&(n===m?(r.after(t),i=!0):n===v&&(r.before(t),i=!0))),i||e.append(t)}function j(e,t){this.id=e,this.isDivider=t===E,this.isNative=!1,this.isDivider||(this._enabledChanged=this._enabledChanged.bind(this),this._checkedChanged=this._checkedChanged.bind(this),this._nameChanged=this._nameChanged.bind(this),this._keyBindingAdded=this._keyBindingAdded.bind(this),this._keyBindingRemoved=this._keyBindingRemoved.bind(this),this._command=t,$(this._command).on("enabledStateChange",this._enabledChanged).on("checkedStateChange",this._checkedChanged).on("nameChange",this._nameChanged).on("keyBindingAdded",this._keyBindingAdded).on("keyBindingRemoved",this._keyBindingRemoved))}function F(e){this.id=e}function I(){$(".dropdown").removeClass("open")}function q(e,t,n,r){e=f.htmlEscape(e);var i=$("#main-toolbar .nav"),s;if(!e||!t)return console.error("call to addMenu() is missing required parameters"),null;if(S[t])return console.log("Menu added with same name and id of existing Menu: "+t),null;s=new F(t),S[t]=s;if(!L(t))return brackets.app.addMenu(e,t,n,r,function(n){n?console.error("addMenu() -- error: "+n+" when adding menu with ID: "+t):brackets.app.setMenuTitle(t,e,function(e){e&&console.error("setMenuTitle() -- error: "+e)})}),s;var o=$("<a href='#' class='dropdown-toggle'>"+e+"</a>"),u=$("<ul class='dropdown-menu'></ul>"),a=$("<li class='dropdown' id='"+t+"'></li>").append(o).append(u),l=r&&$(O(r));return B(i,a,n,l),c.addPopUp(u,I,!1),s}function R(e){F.apply(this,arguments);var t=$("<li class='dropdown context-menu' id='"+f.jQueryIdEscape(e)+"'></li>"),n=$("<ul class='dropdown-menu'></ul>"),r=$("<a href='#' class='dropdown-toggle'></a>").hide();t.append(r).append(n),$("#context-menu-bar > ul").append(t);var i=this;c.addPopUp(n,function(){i.close()},!1)}function U(e){if(!e)return console.error("call to registerContextMenu() is missing required parameters"),null;if(x[e])return console.log("Context Menu added with same name and id of existing Context Menu: "+e),null;var t=new R(e);return x[e]=t,t}var r=e("utils/AppInit"),i=e("utils/Global"),s=e("command/Commands"),o=e("command/KeyBindingManager"),u=e("editor/EditorManager"),a=e("strings"),f=e("utils/StringUtils"),l=e("command/CommandManager"),c=e("widgets/PopUpManager"),h={FILE_MENU:"file-menu",EDIT_MENU:"edit-menu",VIEW_MENU:"view-menu",NAVIGATE_MENU:"navigate-menu",DEBUG_MENU:"debug-menu",HELP_MENU:"help-menu"},p={EDITOR_MENU:"editor-context-menu",INLINE_EDITOR_MENU:"inline-editor-context-menu",PROJECT_MENU:"project-context-menu",WORKING_SET_MENU:"working-set-context-menu"},d={FILE_OPEN_CLOSE_COMMANDS:{sectionMarker:s.FILE_NEW},FILE_SAVE_COMMANDS:{sectionMarker:s.FILE_SAVE},FILE_LIVE:{sectionMarker:s.FILE_LIVE_FILE_PREVIEW},EDIT_SELECTION_COMMANDS:{sectionMarker:s.EDIT_SELECT_ALL},EDIT_FIND:{sectionMarker:s.EDIT_FIND},EDIT_REPLACE_COMMANDS:{sectionMarker:s.EDIT_REPLACE},EDIT_MODIFY_SELECTION:{sectionMarker:s.EDIT_INDENT},VIEW_HIDESHOW_COMMANDS:{sectionMarker:s.VIEW_HIDE_SIDEBAR},VIEW_FONTSIZE_COMMANDS:{sectionMarker:s.VIEW_INCREASE_FONT_SIZE},NAVIGATE_GOTO_COMMANDS:{sectionMarker:s.NAVIGATE_QUICK_OPEN},NAVIGATE_QUICK_EDIT_COMMANDS:{sectionMarker:s.TOGGLE_QUICK_EDIT}},v="before",m="after",g="first",y="last",b="firstInSection",w="lastInSection",E="---",S={},x={},T={},P=1;F.prototype._getMenuItemId=function(e){return this.id+"-"+e},F.prototype._getMenuItemForCommand=function(e){if(!e)return null;var t=T[this._getMenuItemId(e.getID())];return t?$(M(t.id)).closest("li"):null},F.prototype._getRelativeMenuItem=function(e,t){var n,r,i,s,o;if(e){if(t===b||t===w){if(!e.hasOwnProperty("sectionMarker"))return console.error("Bad Parameter in _getRelativeMenuItem(): relativeID must be a MenuSection when position refers to a menu section"),null;var u=this._getMenuItemForCommand(l.get(e.sectionMarker));if(!u)return console.error("_getRelativeMenuItem(): MenuSection "+e.sectionMarker+" not found in Menu "+this.id),null;var a=u;n=a;for(;;){a=t===b?a.prev():a.next();if(a.length===0)break;if(a.find(".divider").length>0)break;n=a}}else{if(e.hasOwnProperty("sectionMarker"))return console.error("Bad Parameter in _getRelativeMenuItem(): if relativeID is a MenuSection, position must be FIRST_IN_SECTION or LAST_IN_SECTION"),null;var f=l.get(e);f&&(n=this._getMenuItemForCommand(f));if(!n)return console.error("_getRelativeMenuItem(): MenuItem with Command id "+e+" not found in Menu "+this.id),null}return n}return t&&t!==g&&t!==y?(console.error("Bad Parameter in _getRelativeMenuItem(): relative position specified with no relativeID"),null):n},F.prototype.removeMenuItem=function(e){var t,n;if(!e){console.error("removeMenuItem(): missing required parameters: command");return}if(typeof e=="string"){var r=l.get(e);if(!r){console.error("removeMenuItem(): command not found: "+e);return}n=e}else n=e.getID();t=this._getMenuItemId(n),L(this.id)?$(M(t)).parent().remove():brackets.app.removeMenuItem(n,function(e){e&&console.error("removeMenuItem() -- command not found: "+n+" (error: "+e+")")}),delete T[t]},F.prototype.addMenuItem=function(e,t,n,r){var i,s,u,a,c,h;if(!e)return console.error("addMenuItem(): missing required parameters: command"),null;if(typeof e=="string")if(e===E)c=E,h=H();else{h=e,e=l.get(h);if(!e)return console.error("addMenuItem(): commandID not found: "+h),null;c=e.getName()}else h=e.getID(),c=e.getName();i=this._getMenuItemId(h);if(T[i])return console.log("MenuItem added with same id of existing MenuItem: "+i),null;a=new j(i,e),T[i]=a;if(L(this.id)){c===E?s=$("<li><hr class='divider' /></li>"):(s=$("<li><a href='#' id='"+i+"'> <span class='menu-name'></span></a></li>"),s.on("click",function(){a._command.execute()}));var p=this._getRelativeMenuItem(r,n);B($("li#"+f.jQueryIdEscape(this.id)+" > ul.dropdown-menu"),s,n,p)}else{var d=o.getKeyBindings(h),v,m="",g="";d&&d.length>0&&(v=d[d.length-1],m=v.displayKey||v.key),m.length>0&&(g=o.formatKeyDescriptor(m));if(n===b||n===w){if(!r.hasOwnProperty("sectionMarker"))return console.error("Bad Parameter in _getRelativeMenuItem(): relativeID must be a MenuSection when position refers to a menu section"),null;r=r.sectionMarker}brackets.app.addMenuItem(this.id,c,h,m,g,n,r,function(e){e&&console.error("addMenuItem() -- error: "+e+" when adding command: "+h)}),a.isNative=!0}return a.isDivider||(t&&(Array.isArray(t)||(t=[t])),o.addBinding(h,t),D(a,h),a._checkedChanged(),a._enabledChanged(),a._nameChanged()),a},F.prototype.addMenuDivider=function(e,t){return this.addMenuItem(E,"",e,t)},j.prototype.getCommand=function(){return this._command},j.prototype.getParentMenu=function(){var e=$(M(this.id)).parents(".dropdown").get(0);return e?N(e.id):null},j.prototype._checkedChanged=function(){var e=!!this._command.getChecked();if(this.isNative){var t=!!this._command.getEnabled();brackets.app.setMenuItemState(this._command.getID(),t,e,function(e){e&&console.log("Error setting menu item state: "+e)})}else e?$(M(this.id)).addClass("checked"):$(M(this.id)).removeClass("checked")},j.prototype._enabledChanged=function(){if(this.isNative){var e=!!this._command.getEnabled(),t=!!this._command.getChecked();brackets.app.setMenuItemState(this._command.getID(),e,t,function(e){e&&console.log("Error setting menu item state: "+e)})}else $(M(this.id)).toggleClass("disabled",!this._command.getEnabled())},j.prototype._nameChanged=function(){this.isNative?brackets.app.setMenuTitle(this._command.getID(),this._command.getName(),function(e){e&&console.log("Error setting menu title: "+e)}):$(M(this.id)).find(".menu-name").text(this._command.getName())},j.prototype._keyBindingAdded=function(e,t){if(this.isNative){var n=t.displayKey||t.key;brackets.app.setMenuItemShortcut(this._command.getID(),n,o.formatKeyDescriptor(n),function(e){e&&console.error("Error setting menu item shortcut: "+e)})}else _($(M(this.id)),t.key,t.displayKey)},j.prototype._keyBindingRemoved=function(e,t){if(this.isNative)brackets.app.setMenuItemShortcut(this._command.getID(),"","",function(e){e&&console.error("Error setting menu item shortcut: "+e)});else{var n=$(M(this.id)).find(".menu-shortcut");n.length>0&&n.data("key")===t.key&&D(this)===null&&n.empty()}},R.prototype=Object.create(F.prototype),R.prototype.constructor=R,R.prototype.parentClass=F.prototype,R.prototype.open=function(e){if(!e||!e.hasOwnProperty("pageX")||!e.hasOwnProperty("pageY")){console.error("ContextMenu open(): missing required parameter");return}var t=$(window),n=f.jQueryIdEscape(this.id),r=$("#"+n),i=$("#"+n+" > ul"),s=e.pageY,o=e.pageX;if(i.children().length<=0)return;$(this).triggerHandler("beforeContextMenuOpen"),I();var u=s+25+i.height()-t.height();u>0&&(s=Math.max(0,s-u)),s-=30,o+=5;var a=o+i.width()-t.width();a>0&&(o=Math.max(0,o-a)),r.addClass("open").css({left:o,top:s})},R.prototype.close=function(){$("#"+f.jQueryIdEscape(this.id)).removeClass("open")},r.htmlReady(function(){var e;e=q(a.FILE_MENU,h.FILE_MENU),e.addMenuItem(s.FILE_NEW),e.addMenuItem(s.FILE_NEW_FOLDER),e.addMenuItem(s.FILE_OPEN),e.addMenuItem(s.FILE_OPEN_FOLDER),e.addMenuItem(s.FILE_CLOSE),e.addMenuItem(s.FILE_CLOSE_ALL),e.addMenuDivider(),e.addMenuItem(s.FILE_SAVE),e.addMenuItem(s.FILE_SAVE_ALL),e.addMenuDivider(),e.addMenuItem(s.FILE_LIVE_FILE_PREVIEW),e.addMenuItem(s.FILE_LIVE_HIGHLIGHT),e.addMenuItem(s.FILE_PROJECT_SETTINGS),brackets.platform!=="mac"&&!brackets.inBrowser&&(e.addMenuDivider(),e.addMenuItem(s.FILE_QUIT)),e=q(a.EDIT_MENU,h.EDIT_MENU),e.addMenuItem(s.EDIT_UNDO),e.addMenuItem(s.EDIT_REDO),e.addMenuDivider(),e.addMenuItem(s.EDIT_CUT),e.addMenuItem(s.EDIT_COPY),e.addMenuItem(s.EDIT_PASTE),e.addMenuDivider(),e.addMenuItem(s.EDIT_SELECT_ALL),e.addMenuItem(s.EDIT_SELECT_LINE),e.addMenuDivider(),e.addMenuItem(s.EDIT_FIND),e.addMenuItem(s.EDIT_FIND_IN_FILES),e.addMenuItem(s.EDIT_FIND_NEXT),e.addMenuItem(s.EDIT_FIND_PREVIOUS),e.addMenuDivider(),e.addMenuItem(s.EDIT_REPLACE),e.addMenuDivider(),e.addMenuItem(s.EDIT_INDENT),e.addMenuItem(s.EDIT_UNINDENT),e.addMenuItem(s.EDIT_DUPLICATE),e.addMenuItem(s.EDIT_DELETE_LINES),e.addMenuItem(s.EDIT_LINE_UP),e.addMenuItem(s.EDIT_LINE_DOWN),e.addMenuDivider(),e.addMenuItem(s.EDIT_LINE_COMMENT),e.addMenuItem(s.EDIT_BLOCK_COMMENT),e=q(a.VIEW_MENU,h.VIEW_MENU),e.addMenuItem(s.VIEW_HIDE_SIDEBAR),e.addMenuDivider(),e.addMenuItem(s.VIEW_INCREASE_FONT_SIZE),e.addMenuItem(s.VIEW_DECREASE_FONT_SIZE),e.addMenuItem(s.VIEW_RESTORE_FONT_SIZE),e.addMenuDivider(),e.addMenuItem(s.TOGGLE_JSLINT),e=q(a.NAVIGATE_MENU,h.NAVIGATE_MENU),e.addMenuItem(s.NAVIGATE_QUICK_OPEN),e.addMenuItem(s.NAVIGATE_GOTO_LINE),e.addMenuItem(s.NAVIGATE_GOTO_DEFINITION),e.addMenuItem(s.NAVIGATE_GOTO_JSLINT_ERROR),e.addMenuDivider(),e.addMenuItem(s.NAVIGATE_NEXT_DOC),e.addMenuItem(s.NAVIGATE_PREV_DOC),e.addMenuDivider(),e.addMenuItem(s.NAVIGATE_SHOW_IN_FILE_TREE),e.addMenuDivider(),e.addMenuItem(s.TOGGLE_QUICK_EDIT),e.addMenuItem(s.QUICK_EDIT_PREV_MATCH),e.addMenuItem(s.QUICK_EDIT_NEXT_MATCH),brackets.config.show_debug_menu&&(e=q(a.DEBUG_MENU,h.DEBUG_MENU),e.addMenuItem(s.DEBUG_SHOW_DEVELOPER_TOOLS),e.addMenuItem(s.DEBUG_REFRESH_WINDOW),e.addMenuItem(s.DEBUG_NEW_BRACKETS_WINDOW),e.addMenuDivider(),e.addMenuItem(s.DEBUG_SWITCH_LANGUAGE),e.addMenuDivider(),e.addMenuItem(s.DEBUG_RUN_UNIT_TESTS),e.addMenuItem(s.DEBUG_SHOW_PERF_DATA)),e=q(a.HELP_MENU,h.HELP_MENU),e.addMenuItem(s.HELP_CHECK_FOR_UPDATE),e.addMenuDivider(),brackets.config.how_to_use_url&&e.addMenuItem(s.HELP_HOW_TO_USE_BRACKETS),brackets.config.forum_url&&e.addMenuItem(s.HELP_FORUM),brackets.config.release_notes_url&&e.addMenuItem(s.HELP_RELEASE_NOTES),brackets.config.report_issue_url&&e.addMenuItem(s.HELP_REPORT_AN_ISSUE),e.addMenuDivider(),e.addMenuItem(s.HELP_SHOW_EXT_FOLDER);var t=brackets.platform!=="mac"||brackets.inBrowser;(t||brackets.config.twitter_url)&&e.addMenuDivider(),brackets.config.twitter_url&&e.addMenuItem(s.HELP_TWITTER),t&&e.addMenuItem(s.HELP_ABOUT);var n=U(p.PROJECT_MENU);n.addMenuItem(s.FILE_NEW),n.addMenuItem(s.FILE_NEW_FOLDER),n.addMenuItem(s.FILE_RENAME),n.addMenuDivider(),n.addMenuItem(s.EDIT_FIND_IN_SUBTREE);var r=U(p.WORKING_SET_MENU);r.addMenuItem(s.FILE_CLOSE),r.addMenuItem(s.FILE_SAVE),r.addMenuItem(s.FILE_RENAME),r.addMenuItem(s.NAVIGATE_SHOW_IN_FILE_TREE),r.addMenuDivider(),r.addMenuItem(s.EDIT_FIND_IN_SUBTREE),r.addMenuDivider(),r.addMenuItem(s.SORT_WORKINGSET_BY_ADDED),r.addMenuItem(s.SORT_WORKINGSET_BY_NAME),r.addMenuItem(s.SORT_WORKINGSET_BY_TYPE),r.addMenuDivider(),r.addMenuItem(s.SORT_WORKINGSET_AUTO);var i=U(p.EDITOR_MENU);i.addMenuItem(s.TOGGLE_QUICK_EDIT),i.addMenuItem(s.EDIT_SELECT_ALL);var o=U(p.INLINE_EDITOR_MENU);o.addMenuItem(s.TOGGLE_QUICK_EDIT),o.addMenuItem(s.EDIT_SELECT_ALL),o.addMenuDivider(),o.addMenuItem(s.QUICK_EDIT_PREV_MATCH),o.addMenuItem(s.QUICK_EDIT_NEXT_MATCH),$("#editor-holder").on("contextmenu",function(e){if($(e.target).parents(".CodeMirror-gutter").length!==0)return;var t=u.getFocusedEditor(),n=u.getFocusedInlineWidget();t&&(t.hasSelection()||t.selectWordAt(t.getCursorPos()),n?o.open(e):i.open(e))}),$("#project-files-container").on("contextmenu",function(e){n.open(e)}),$("#open-files-container").on("contextmenu",function(e){r.open(e)}),$(window).contextmenu(function(e){e.preventDefault()}),$(window.document).on("mousedown",".dropdown",function(e){e.preventDefault()}),$(window.document).on("mouseenter","#main-toolbar .dropdown",function(e){var t=$(this).siblings(".open");t.length>0&&(t.removeClass("open"),$(this).addClass("open"))})}),t.AppMenuBar=h,t.ContextMenuIds=p,t.MenuSection=d,t.BEFORE=v,t.AFTER=m,t.LAST=y,t.FIRST=g,t.FIRST_IN_SECTION=b,t.LAST_IN_SECTION=w,t.DIVIDER=E,t.getMenu=N,t.getMenuItem=A,t.getContextMenu=C,t.addMenu=q,t.registerContextMenu=U,t.closeAll=I,t.Menu=F,t.MenuItem=j,t.ContextMenu=R}),define("utils/ViewUtils",["require","exports","module"],function(e,t,n){function s(e,t,n,i,s){var o=0,u=t.get(0),a=u.scrollTop,f=Math.min(a-r,0),l=e.width();n&&(n.css("background-position","0px "+f+"px"),s&&(o=e.offset().top,n.css("top",o)),s&&n.css("width",l));if(i){var c=u.clientHeight,h=e.outerHeight(),p=u.scrollHeight,d=h-c,v=r;p>c&&(v-=Math.min(r,p-(a+c))),i.css("background-position","0px "+v+"px"),i.css("top",o+h-r),i.css("width",l)}}function o(e,t,n){var r=e.find(".scroller-shadow."+t);return r.length===0&&(r=$(window.document.createElement("div")).addClass("scroller-shadow "+t),e.append(r)),n||(r.css("position","absolute"),r.css(t,"0")),r}function u(e,t,n){var r=!1;t||(t=e,r=!0);var i=$(e),u=$(t),a=o(i,"top",r),f=n?o(i,"bottom",r):null,l=function(){s(i,u,a,f,r)};u.on("scroll.scroller-shadow",l),i.on("contentChanged.scroller-shadow",l),l()}function a(e,t){t||(t=e);var n=$(e),r=$(t);n.find(".scroller-shadow.top").remove(),n.find(".scroller-shadow.bottom").remove(),r.off("scroll.scroller-shadow"),n.off("contentChanged.scroller-shadow")}function f(e,t,n){var r=e.find("ul"),s,o,u=$("#sidebar"),a=!0;s=$(window.document.createElement("div")).addClass("sidebar-selection"),e.prepend(s),e.css("overflow","auto"),e.css("position","relative"),o=$(window.document.createElement("div")).addClass("sidebar-selection-triangle"),e.append(o),t="."+(t||"selected");var f=function(){var t=s.height(),n=s.offset(),r=e.offset(),i=o.outerHeight(),f=r.top,l=f+e.outerHeight(),c=r.left,h=n.top;o.css("top",h),o.css("left",u.width()-o.outerWidth()),o.toggleClass("triangle-visible",a);var p=Math.floor((t-i)/2),d=h+i+p;h<f||d>l?o.css("clip","rect("+Math.max(f-h-p,0)+"px, auto, "+(i-Math.max(d-l,0))+"px, auto)"):o.css("clip","")},l=function(i,u){var l=r.find(t).closest("li");n&&(a=l.hasClass(n)),o.hide(),s.hide();if(l.length===1){var c=l.offset().top-e.offset().top+e.get(0).scrollTop;s.width(e.get(0).scrollWidth),s.css("top",c),s.show(),f(),o.show();var h=e.get(0),p=h.clientHeight,d=s.height(),v=c+d,m=h.scrollTop+p;u&&(c>=m?l.get(0).scrollIntoView(!1):v<=h.scrollTop&&l.get(0).scrollIntoView(!0))}};r.on("selectionChanged",l),e.on("scroll",f),l(),i.push(f)}function l(){i.forEach(function(e){e.apply()})}function c(e,t,n){var r=e.offset(),i=e.get(0),s=t.get(0),o=t.offset(),u=o.top+t.height()-(r.top+e.height());u>0?e.scrollTop(e.scrollTop()+u):(u=r.top-o.top,u>0&&e.scrollTop(e.scrollTop()-u)),n&&(o.left<0?e.scrollLeft(e.scrollLeft()+o.left):o.left+t.width()>=r.left+e.width()&&e.scrollLeft(o.left-r.left))}var r=5,i=[];$(window).resize(l),t.SCROLL_SHADOW_HEIGHT=r,t.addScrollerShadow=u,t.removeScrollerShadow=a,t.sidebarList=f,t.scrollElementIntoView=c}),define("editor/CodeHintList",["require","exports","module","command/Menus","utils/StringUtils","widgets/PopUpManager","utils/ViewUtils","utils/KeyEvent"],function(e,t,n){function a(e){this.hints=[],this.selectedIndex=-1,this.maxResults=999,this.opened=!1,this.editor=e,this.handleSelect=null,this.handleClose=null,this.$hintMenu=$("<li class='dropdown codehint-menu'></li>").append($("<a href='#' class='dropdown-toggle'></a>").hide()).append("<ul class='dropdown-menu'></ul>")}var r=e("command/Menus"),i=e("utils/StringUtils"),s=e("widgets/PopUpManager"),o=e("utils/ViewUtils"),u=e("utils/KeyEvent");a.prototype._setSelectedIndex=function(e){var t=this.$hintMenu.find("li");e=Math.max(-1,Math.min(e,t.length-1)),this.selectedIndex!==-1&&$(t[this.selectedIndex]).find("a").removeClass("highlight"),this.selectedIndex=e;if(this.selectedIndex!==-1){var n=$(t[this.selectedIndex]),r=this.$hintMenu.find("ul.dropdown-menu");o.scrollElementIntoView(r,n,!1),n.find("a").addClass("highlight")}},a.prototype._buildListView=function(e){function o(e,n){var r=$("<span class='codehint-item'>").append(n),i=$("<a href='#'>").append(r),s=$("<li>").append(i).on("click",function(n){n.stopPropagation(),t.handleSelect&&t.handleSelect(e)});t.$hintMenu.find("ul.dropdown-menu").append(s)}var t=this,n=e.match,r=e.selectInitial,s;this.hints=e.hints,n?s=function(e){var t=$("<span>").append(e.replace(new RegExp(i.regexEscape(n),"i"),"<strong>$&</strong>"));o(e,t)}:s=function(e){o(e,e)},this.$hintMenu.find("li").remove(),this.hints.length===0?this.handleClose&&this.handleClose():($.each(this.hints,function(e,n){if(e>t.maxResults)return!1;s(n)}),this._setSelectedIndex(r?0:-1))},a.prototype._calcHintListLocation=function(){var e=this.editor._codeMirror.cursorCoords(),t=e.top,n=e.left,r=$(window),i=this.$hintMenu.children("ul"),s=t+25+i.height()-r.height();s>0&&(t-=27+i.height()),t-=15;var o=n+i.width()-r.width();return o>0&&(n=Math.max(0,n-o)),{left:n,top:t}},a.prototype.handleKeyEvent=function(e){function r(e){var t=Math.min(n.hints.length,n.maxResults),r;n.selectedIndex<0?r=e>0?e-1:t-1:(r=n.selectedIndex,e>0?r===t-1?r=0:r=Math.min(r+e,t-1):r===0?r=t-1:r=Math.max(r+e,0)),n._setSelectedIndex(r)}function i(){var e=1,t=n.$hintMenu.find("li"),r=n.$hintMenu.find("ul.dropdown-menu"),i;return t.length!==0&&(i=$(t[0]).height(),i&&(e=Math.floor(r.height()/i),e=Math.max(1,Math.min(e,t.length)))),e}var t,n=this;if(e.type==="keydown"){t=e.keyCode;if(t===u.DOM_VK_UP)r.call(this,-1);else if(t===u.DOM_VK_DOWN)r.call(this,1);else if(t===u.DOM_VK_PAGE_UP)r.call(this,-i());else if(t===u.DOM_VK_PAGE_DOWN)r.call(this,i());else{if(this.selectedIndex===-1||t!==u.DOM_VK_RETURN&&t!==u.DOM_VK_TAB)return;$(this.$hintMenu.find("li")[this.selectedIndex]).triggerHandler("click")}e.preventDefault()}},a.prototype.isOpen=function(){return this.opened&&!this.$hintMenu.hasClass("open")&&(this.opened=!1),this.opened},a.prototype.open=function(e){r.closeAll(),this._buildListView(e);if(this.hints.length){$("#codehint-menu-bar > ul").append(this.$hintMenu);var t=this._calcHintListLocation();this.$hintMenu.addClass("open").css({left:t.left,top:t.top}),this.opened=!0,s.addPopUp(this.$hintMenu,this.handleClose,!0)}},a.prototype.update=function(e){this._buildListView(e);if(this.hints.length){var t=this._calcHintListLocation();this.$hintMenu.css({left:t.left,top:t.top})}},a.prototype.close=function(){this.$hintMenu.removeClass("open"),this.opened=!1,s.removePopUp(this.$hintMenu),this.$hintMenu.remove()},a.prototype.onSelect=function(e){this.handleSelect=e},a.prototype.onClose=function(e){this.handleClose=e},t.CodeHintList=a}),define("editor/CodeHintManager",["require","exports","module","utils/KeyEvent","editor/CodeHintList"],function(e,t,n){function h(e,t){return t.priority-e.priority}function p(e,t,n){var r={provider:e,priority:n||0};if(t){var i=[],o=!1,u,a;for(u=0;u<t.length;u++){a=typeof t[u]=="string"?t[u]:t[u].name;if(a){if(a==="all"){o=!0;break}i.push(a)}}if(o){var f;for(f in s)s.hasOwnProperty(f)&&(s[f].push(r),s[f].sort(h))}else i.forEach(function(e){e&&(s[e]||(s[e]=Array.prototype.concat(s.all)),s[e].push(r),s[e].sort(h))})}}function d(e){var t=typeof e=="string"?e:e.name;return s[t]||s.all}function v(){f.close(),f=null,c=null,u=null,a=null,l&&(l.reject(),l=null)}function m(e){if(a){if(a===e&&(f.isOpen()||l&&!l.isResolved()&&!l.isRejected()))return!0;v()}return!1}function g(){l&&(l.reject(),l=null);var e=u.getHints(o);o=null,e?e.hasOwnProperty("hints")?f.isOpen()?f.update(e):f.open(e):(l=e,e.done(function(e){f.isOpen()?f.update(e):f.open(e)})):v()}function y(e){var t=e.getModeForSelection(),n=d(t);$.each(n,function(t,n){return n.provider.hasHints(e,o)?(u=n.provider,!1):!0}),u?(a=e,f=new i(a),f.onSelect(function(e){var t=u.insertHint(e),n=a;v(),t&&y(n)}),f.onClose(v),g()):o=null}function b(e,t){c=e,t.type==="keydown"?(t.keyCode===32&&t.ctrlKey?(t.preventDefault(),o=null,m(e)&&v(),y(e)):m(e)&&f.isOpen()&&f.handleKeyEvent(t),!(t.ctrlKey||t.altKey||t.metaKey)&&(t.keyCode===r.DOM_VK_ENTER||t.keyCode===r.DOM_VK_RETURN||t.keyCode===r.DOM_VK_TAB)&&(o=String.fromCharCode(t.keyCode))):t.type==="keypress"?o=String.fromCharCode(t.charCode):t.type==="keyup"&&m(e)&&(t.keyCode!==32&&t.ctrlKey||t.altKey||t.metaKey?v():(t.keyCode===r.DOM_VK_LEFT||t.keyCode===r.DOM_VK_RIGHT||t.keyCode===r.DOM_VK_BACK_SPACE)&&g())}function w(e){if(o&&e===c){c=null;if(m(e)){var t=o;g(),m(e)||(o=t,y(e))}else y(e)}}function E(){return f}var r=e("utils/KeyEvent"),i=e("editor/CodeHintList").CodeHintList,s={all:[]},o=null,u=null,a=null,f=null,l=null,c=null;t._getCodeHintList=E,t.handleKeyEvent=b,t.handleChange=w,t.registerHintProvider=p}),define("document/TextRange",["require","exports","module"],function(e,t,n){function r(e,t,n){this.startLine=t,this.endLine=n,this.document=e,e.addRef(),this._handleDocumentChange=this._handleDocumentChange.bind(this),this._handleDocumentDeleted=this._handleDocumentDeleted.bind(this),$(e).on("change",this._handleDocumentChange),$(e).on("deleted",this._handleDocumentDeleted)}r.prototype.dispose=function(e,t){this.document.releaseRef(),$(this.document).off("change",this._handleDocumentChange),$(this.document).off("deleted",this._handleDocumentDeleted)},r.prototype.document=null,r.prototype.startLine=null,r.prototype.endLine=null,r.prototype._applySingleChangeToRange=function(e){if(!e.from||!e.to)return this.startLine=null,this.endLine=null,!0;if(e.from.line<this.startLine&&e.to.line>=this.startLine||e.from.line<=this.endLine&&e.to.line>this.endLine)return this.startLine=null,this.endLine=null,!0;var t=e.text.length-(e.to.line-e.from.line+1),n=!1;return e.to.line<this.startLine&&(this.startLine+=t,n=!0),e.to.line<=this.endLine&&(this.endLine+=t,n=!0),n},r.prototype._applyChangesToRange=function(e){var t=!1,n;for(n=e;n;n=n.next){var r=this._applySingleChangeToRange(n);t=t||r;if(this.startLine===null||this.endLine===null){$(this).triggerHandler("lostSync");break}}t&&$(this).triggerHandler("change")},r.prototype._handleDocumentChange=function(e,t,n){this._applyChangesToRange(n)},r.prototype._handleDocumentDeleted=function(e){$(this).triggerHandler("lostSync")},r.prototype.toString=function(){return"[TextRange "+this.startLine+"-"+this.endLine+" in "+this.document+"]"},t.TextRange=r}),define("utils/TokenUtils",["require","exports","module"],function(e,t,n){function r(e,t){return{editor:e,pos:t,token:e.getTokenAt(t)}}function i(e){if(e.pos.ch<=0||e.token.start<=0){if(e.pos.line<=0)return!1;e.pos.line--,e.pos.ch=e.editor.getLine(e.pos.line).length}else e.pos.ch=e.token.start;return e.token=e.editor.getTokenAt(e.pos),!0}function s(e){var t=e.editor.getLine(e.pos.line).length;if(e.pos.ch>=t||e.token.end>=t){if(e.pos.line>=e.editor.lineCount()-1)return!1;e.pos.line++,e.pos.ch=0}else e.pos.ch=e.token.end+1;return e.token=e.editor.getTokenAt(e.pos),!0}function o(e,t){if(!e(t))return!1;while(!t.token.className&&t.token.string.trim().length===0)if(!e(t))return!1;return!0}function u(e){var t=e.pos.ch-e.token.start;return t<0&&console.log("CodeHintUtils: _offsetInToken - Invalid context: pos not in the current token!"),t}function a(e,t){var n=e.getMode(),r=CodeMirror.innerMode(n,e.getTokenAt(t).state),i;return i=r.mode.name==="xml"?r.mode.configuration:r.mode.name,{mode:r.mode,name:i}}t.movePrevToken=i,t.moveNextToken=s,t.moveSkippingWhitespace=o,t.getInitialContext=r,t.offsetInToken=u,t.getModeAt=a}),define("editor/Editor",["require","exports","module","editor/EditorManager","editor/CodeHintManager","command/Commands","command/CommandManager","command/Menus","utils/PerfUtils","preferences/PreferencesManager","strings","document/TextRange","utils/TokenUtils","utils/ViewUtils"],function(e,t,n){function S(e){var t=e.getCursor(!0),n=e.getCursor(!1),r=e.getLine(t.line),i=!1,s=!1;t.line===n.line&&(r.search(/\S/)>n.ch||n.ch===0)&&(i=!0);if(i){var o=r.length;CodeMirror.commands.indentAuto(e),e.getLine(t.line).length===o&&(s=!0,n.ch=0)}else e.somethingSelected()?CodeMirror.commands.indentMore(e):s=!0;if(s)if(e.getOption("indentWithTabs"))CodeMirror.commands.insertTab(e);else{var u,a="",f=b;f-=n.ch%f;for(u=0;u<f;u++)a+=" ";e.replaceSelection(a,"end")}}function x(e,t,n){var r=!1;if(!e.getOption("indentWithTabs")){var i=e.getCursor(),s=i.ch%b,o=e.getLine(i.line);if(t===1){s=b-s;if(i.ch+s>o.length)return!1;o.substr(i.ch,s).search(/\S/)===-1&&(e[n](s,"char"),r=!0)}else{if(i.ch===0)return!1;s===0&&(s=b);var u=o.substr(i.ch-s,s).search(/\s*$/g);u!==-1&&(s-=u),s>0&&(e[n](-s,"char"),r=!0)}}return r}function T(e,t,n){var r=t._codeMirror;if(n.type==="keypress"){var i=String.fromCharCode(n.which||n.keyCode);if(/[\]\{\}\)]/.test(i)){var s=r.getCursor(),o=r.getLine(s.line),u=o.search(/\S/);(u===-1||u>=s.ch)&&window.setTimeout(function(){r.indentLine(s.line)},75)}}}function N(e,t,n){T(e,t,n),i.handleKeyEvent(t,n)}function C(){var e=new $.Deferred,t=r.getFocusedEditor();return t?(t.selectAllNoScroll(),e.resolve()):e.reject(),e.promise()}function k(e){return e!==E}function L(e){return!0}function O(e,t,n,r,i){var s=this;A.push(this),this.document=e,e.addRef(),i&&(this._visibleRange=new c(e,i.startLine,i.endLine)),this._handleDocumentChange=this._handleDocumentChange.bind(this),this._handleDocumentDeleted=this._handleDocumentDeleted.bind(this),$(e).on("change",this._handleDocumentChange),$(e).on("deleted",this._handleDocumentDeleted),this._inlineWidgets=[];var o={Tab:S,"Shift-Tab":"indentLess",Left:function(e){x(e,-1,"moveH")||CodeMirror.commands.goCharLeft(e)},Right:function(e){x(e,1,"moveH")||CodeMirror.commands.goCharRight(e)},Backspace:function(e){x(e,-1,"deleteH")||CodeMirror.commands.delCharBefore(e)},Delete:function(e){x(e,1,"deleteH")||CodeMirror.commands.delCharAfter(e)},Esc:function(e){s.removeAllInlineWidgets()},"Cmd-Left":"goLineStartSmart"};n||(n="text/plain"),this._codeMirror=new CodeMirror(r,{electricChars:!1,indentWithTabs:g,tabSize:y,indentUnit:b,lineNumbers:!0,matchBrackets:!0,dragDrop:!1,extraKeys:o,autoCloseTags:{whenOpening:!0,whenClosing:!0,indentTags:[]}}),this._focused=!1,this._installEditorListeners(),$(this).on("keyEvent",N).on("change",this._handleEditorChange.bind(this)),this._codeMirror.setOption("mode",n),this._duringSync=!0,this._resetText(e.getText()),this._duringSync=!1,i&&(this._codeMirror.operation(function(){i.startLine>0&&s._hideLines(0,i.startLine);var e=i.endLine+1;e<s.lineCount()&&s._hideLines(e,s.lineCount())}),this.setCursorPos(i.startLine,0)),t&&e._makeEditable(this),Object.defineProperty(this,"scrollTop",{get:function(){return this._codeMirror.getScrollInfo().top}})}var r=e("editor/EditorManager"),i=e("editor/CodeHintManager"),s=e("command/Commands"),o=e("command/CommandManager"),u=e("command/Menus"),a=e("utils/PerfUtils"),f=e("preferences/PreferencesManager"),l=e("strings"),c=e("document/TextRange").TextRange,h=e("utils/TokenUtils"),p=e("utils/ViewUtils"),d="com.adobe.brackets.Editor",v={useTabChar:!1,tabSize:4,indentUnit:4},m=f.getPreferenceStorage(d,v),g=m.getValue("useTabChar"),y=m.getValue("tabSize"),b=m.getValue("indentUnit"),w=0,E=1,A=[];O.prototype.destroy=function(){$(this.getRootElement()).remove(),A.splice(A.indexOf(this),1),this.document.releaseRef(),$(this.document).off("change",this._handleDocumentChange),$(this.document).off("deleted",this._handleDocumentDeleted),this._visibleRange&&this._visibleRange.dispose(),this.document._masterEditor===this&&this.document._makeNonEditable(),this._inlineWidgets.forEach(function(e){e.onClosed()})},O.prototype.selectAllNoScroll=function(){var e=this._codeMirror,t=this._codeMirror.getScrollInfo();e.operation(function(){e.scrollTo(t.left,t.top),e.execCommand("selectAll")})},O.prototype._updateHiddenLines=function(){if(this._visibleRange){var e=this._codeMirror,t=this;e.operation(function(){t._hideLines(0,t._visibleRange.startLine),t._hideLines(t._visibleRange.endLine+1,t.lineCount())})}},O.prototype._applyChanges=function(e){if(this._visibleRange)if(this._visibleRange.startLine===null||this._visibleRange.endLine===null){$(this).triggerHandler("lostContent");return}var t=this._codeMirror;t.operation(function(){var n,r;for(n=e;n;n=n.next)r=n.text.join("\n"),!n.from||!n.to?((n.from||n.to)&&console.error("Change record received with only one end undefined--replacing entire text"),t.setValue(r)):t.replaceRange(r,n.from,n.to,n.origin)}),this._updateHiddenLines()},O.prototype._handleEditorChange=function(e,t,n){if(this._duringSync)return;this.document._ensureMasterEditor(),this.document._masterEditor!==this&&(this._duringSync=!0,this.document._masterEditor._applyChanges(n),this._duringSync=!1,this._updateHiddenLines()),i.handleChange(this)},O.prototype._handleDocumentChange=function(e,t,n){var r;if(this._duringSync)return;this.document._masterEditor!==this&&(this._duringSync=!0,this._applyChanges(n),this._duringSync=!1)},O.prototype._handleDocumentDeleted=function(e){$(this).triggerHandler("lostContent",[e])},O.prototype._installEditorListeners=function(){var e=this;this._codeMirror.setOption("onKeyEvent",function(t,n){return $(e).triggerHandler("keyEvent",[e,n]),n.defaultPrevented}),this._codeMirror.on("change",function(t,n){$(e).triggerHandler("change",[e,n])}),this._codeMirror.on("cursorActivity",function(t){$(e).triggerHandler("cursorActivity",[e])}),this._codeMirror.on("scroll",function(t){e.isFullyVisible()&&u.closeAll(),$(e).triggerHandler("scroll",[e])}),this._codeMirror.on("focus",function(){e._focused=!0,r._notifyActiveEditorChanged(e)}),this._codeMirror.on("blur",function(){e._focused=!1}),this._codeMirror.on("update",function(t){$(e).triggerHandler("update",[e])})},O.prototype._resetText=function(e){var t=a.markStart("Edtitor._resetText()	"+(!this.document||this.document.file.fullPath)),n=this.getCursorPos(),r=this.getScrollPos();this._codeMirror.setValue(e),this._codeMirror.clearHistory(),this.setCursorPos(n),this.setScrollPos(r.x,r.y),a.addMeasurement(t)},O.prototype.getCursorPos=function(e){var t=this._codeMirror.getCursor();if(e){var n=this._codeMirror.getRange({line:t.line,ch:0},t),r=O.getTabSize(),i=0,s;for(s=0;s<n.length;s++)n[s]==="	"?i+=r-i%r:i++;t.ch=i}return t},O.prototype.setCursorPos=function(e,t,n){this._codeMirror.setCursor(e,t),n&&this.centerOnCursor()};var M=.15;O.prototype.centerOnCursor=function(e){var t=$(this.getScrollerElement()),n=t.height(),r=t.outerHeight()-n,i=t.offset().top,s=this._codeMirror.cursorCoords(null,"local").bottom,o=this._codeMirror.cursorCoords(null,"page").bottom-i;if(k(e)&&o<n*M||L(e)&&o>n*(1-M)){var u=s-n/2+r,a=this._codeMirror.getScrollInfo();u=Math.min(Math.max(u,0),a.height-a.clientHeight),this.setScrollPos(null,u)}},O.prototype.indexFromPos=function(e){return this._codeMirror.indexFromPos(e)},O.prototype.posWithinRange=function(e,t,n){var r=this.indexFromPos(t),i=this.indexFromPos(n),s=this.indexFromPos(e);return s>=r&&s<=i},O.prototype.hasSelection=function(){return this._codeMirror.somethingSelected()},O.prototype.getSelection=function(){var e=this._codeMirror.getCursor(!0),t=this._codeMirror.getCursor(!1);return{start:e,end:t}},O.prototype.getSelectedText=function(){return this._codeMirror.getSelection()},O.prototype.setSelection=function(e,t,n,r){this._codeMirror.setSelection(e,t),n&&this.centerOnCursor(r)},O.prototype.selectWordAt=function(e){function i(e){return/\w/.test(e)||e.toUpperCase()!==e.toLowerCase()}var t=this.document.getLine(e.line),n=e.ch,r=e.ch;while(n>0&&i(t.charAt(n-1)))--n;while(r<t.length&&i(t.charAt(r)))++r;this.setSelection({line:e.line,ch:n},{line:e.line,ch:r})},O.prototype.lineCount=function(){return this._codeMirror.lineCount()},O.prototype.getFirstVisibleLine=function(){return this._visibleRange?this._visibleRange.startLine:0},O.prototype.getLastVisibleLine=function(){return this._visibleRange?this._visibleRange.endLine:this.lineCount()-1},O.prototype._hideLines=function(e,t){if(t<=e)return;var n=this._codeMirror.markText({line:e,ch:0},{line:t-1,ch:this._codeMirror.getLine(t-1).length},{collapsed:!0,inclusiveLeft:!0,inclusiveRight:!0});return n},O.prototype.totalHeight=function(){return this.getScrollerElement().scrollHeight},O.prototype.getScrollerElement=function(){return this._codeMirror.getScrollerElement()},O.prototype.getRootElement=function(){return this._codeMirror.getWrapperElement()},O.prototype._getLineSpaceElement=function(){return $(".CodeMirror-lines",this.getScrollerElement()).children().get(0)},O.prototype.getScrollPos=function(){var e=this._codeMirror.getScrollInfo();return{x:e.left,y:e.top}},O.prototype.setScrollPos=function(e,t){this._codeMirror.scrollTo(e,t)},O.prototype.addInlineWidget=function(e,t,n){var r=this;this.removeAllInlineWidgetsForLine(e.line),n===undefined&&(n=!0),n&&this._codeMirror.scrollIntoView(e),t.info=this._codeMirror.addLineWidget(e.line,t.htmlContent,{coverGutter:!0,noHScroll:!0}),CodeMirror.on(t.info.line,"delete",function(){r._removeInlineWidgetInternal(t),t.onClosed()}),this._inlineWidgets.push(t),t.onAdded()},O.prototype.removeAllInlineWidgets=function(){var e=[].concat(this.getInlineWidgets());e.forEach(function(e){this.removeInlineWidget(e)},this)},O.prototype.removeInlineWidget=function(e){var t=this._getInlineWidgetLineNumber(e);this._codeMirror.removeLineWidget(e.info),this._removeInlineWidgetInternal(e),e.onClosed()},O.prototype.removeAllInlineWidgetsForLine=function(e){var t=this._codeMirror.lineInfo(e),n=t&&t.widgets?[].concat(t.widgets):null,r=this;if(n&&n.length){var i,s=this._inlineWidgets.map(function(e){return e.info});n.forEach(function(e){i=r._inlineWidgets[s.indexOf(e)],r.removeInlineWidget(i)})}},O.prototype._removeInlineWidgetInternal=function(e){var t,n=this._inlineWidgets.length;for(t=0;t<n;t++)if(this._inlineWidgets[t]===e){this._inlineWidgets.splice(t,1);break}},O.prototype.getInlineWidgets=function(){return this._inlineWidgets},O.prototype.getVirtualScrollAreaTop=function(){var e=this._getLineSpaceElement().offsetTop,t=this.getScrollerElement();return $(t).offset().top-t.scrollTop+e},O.prototype.setInlineWidgetHeight=function(e,t,n){var r=this,i=e.htmlContent,s=i&&$(i).height()||0,o=s!==t,u=e.info!==undefined;if(o||!i.style.height)$(i).height(t),u&&e.info.changed();if(n&&u){var a=$(i).offset(),f=$(i).position(),l=r.getVirtualScrollAreaTop();r._codeMirror.scrollIntoView({left:f.left,top:a.top-l,right:f.left,bottom:a.top+t-l})}},O.prototype._getInlineWidgetLineNumber=function(e){return this._codeMirror.getLineNumber(e.info.line)},O.prototype.focus=function(){this._codeMirror.focus()},O.prototype.hasFocus=function(){return this._focused},O.prototype.refresh=function(e){var t=window.document.activeElement,n=$.contains(this._codeMirror.getScrollerElement(),t);this._codeMirror.refresh(),n&&t.focus()},O.prototype.refreshAll=function(e){this.refresh(e),this.getInlineWidgets().forEach(function(e){e.refresh()})},O.prototype.undo=function(){this._codeMirror.undo()},O.prototype.redo=function(){this._codeMirror.redo()},O.prototype.setVisible=function(e,t){$(this.getRootElement()).css("display",e?"":"none"),e&&(t||t===undefined)&&this.refresh(),e&&this._inlineWidgets.forEach(function(e){e.onParentShown()})},O.prototype.isFullyVisible=function(){return $(this.getRootElement()).is(":visible")},O.prototype.getModeForSelection=function(){var e=this.getSelection(),t=this._codeMirror.getMode(),n=h.getModeAt(this._codeMirror,e.start),r=t.name!==n.name;if(r){if(e.start.line!==e.end.line||e.start.ch!==e.end.ch){var i=h.getModeAt(this._codeMirror,e.end);if(n.name!==i.name)return null}return n.name}return this._codeMirror.getOption("mode")},O.prototype.getModeForDocument=function(){return this._codeMirror.getOption("mode")},O.prototype.setModeForDocument=function(e){this._codeMirror.setOption("mode",e)},O.prototype.document=null,O.prototype._duringSync=!1,O.prototype._codeMirror=null,O.prototype._inlineWidgets=null,O.prototype._visibleRange=null,O.setUseTabChar=function(e){g=e,A.forEach(function(e){e._codeMirror.setOption("indentWithTabs",g)}),m.setValue("useTabChar",Boolean(g))},O.getUseTabChar=function(e){return g},O.setTabSize=function(e){y=e,A.forEach(function(e){e._codeMirror.setOption("tabSize",y)}),m.setValue("tabSize",y)},O.getTabSize=function(e){return y},O.setIndentUnit=function(e){b=e,A.forEach(function(e){e._codeMirror.setOption("indentUnit",b)}),m.setValue("indentUnit",b)},O.getIndentUnit=function(e){return b},o.register(l.CMD_SELECT_ALL,s.EDIT_SELECT_ALL,C),t.Editor=O,t.BOUNDARY_CHECK_NORMAL=w,t.BOUNDARY_IGNORE_TOP=E}),define("editor/InlineWidget",["require","exports","module","editor/EditorManager","utils/KeyEvent"],function(e,t,n){function s(){var e=this;this.htmlContent=window.document.createElement("div"),this.$htmlContent=$(this.htmlContent).addClass("inline-widget"),this.$htmlContent.append("<div class='shadow top' />").append("<div class='shadow bottom' />"),this.$htmlContent.on("keydown",function(t){t.keyCode===i.DOM_VK_ESCAPE&&(e.close(),t.stopImmediatePropagation())})}var r=e("editor/EditorManager"),i=e("utils/KeyEvent");s.prototype.htmlContent=null,s.prototype.$htmlContent=null,s.prototype.id=null,s.prototype.hostEditor=null,s.prototype.height=0,s.prototype.close=function(){r.closeInlineWidget(this.hostEditor,this)},s.prototype.hasFocus=function(){var e=window.document.activeElement,t=this.$htmlContent[0];return $.contains(t,e)||t===e},s.prototype.onClosed=function(){},s.prototype.onAdded=function(){},s.prototype.load=function(e){this.hostEditor=e},s.prototype.onParentShown=function(){},s.prototype.refresh=function(){},t.InlineWidget=s}),define("utils/CollectionUtils",["require","exports","module"],function(e,t,n){function r(e,t){var n;for(n=0;n<e.length;n++)if(t(e[n],n))return n;return-1}function i(e,t){var n=Object.keys(e),r=n.length,i;for(i=0;i<r;i++)t(e[n[i]],n[i])}t.indexOf=r,t.forEach=i}),define("editor/InlineTextEditor",["require","exports","module","document/DocumentManager","editor/EditorManager","command/CommandManager","command/Commands","editor/InlineWidget","utils/CollectionUtils"],function(e,t,n){function f(){return $("#editor-holder").width()}function l(e,t){e.css("width",t?16:0)}function c(e,t){var n=$(".inlineEditorHolder .dirty-indicator"),r;$.each(n,function(e,n){r=$(n),r.data("fullPath")===t.file.fullPath&&l(r,t.isDirty)})}function h(){u.call(this),this.editors=[]}function p(e){var t=i.getInlineEditors(e);t.push(e);var n=0;t.forEach(function(e){var t=$(e._codeMirror.getGutterElement());t.css("min-width","");var r=t.width();r>n&&(n=r)});if(t.length===1){t[0]._codeMirror.setOption("gutter",!0);return}n+="px",t.forEach(function(e){$(e._codeMirror.getGutterElement()).css("min-width",n),e._codeMirror.setOption("gutter",!0)})}var r=e("document/DocumentManager"),i=e("editor/EditorManager"),s=e("command/CommandManager"),o=e("command/Commands"),u=e("editor/InlineWidget").InlineWidget,a=e("utils/CollectionUtils");h.prototype=Object.create(u.prototype),h.prototype.constructor=h,h.prototype.parentClass=u.prototype,h.prototype.editors=null,h.prototype.onClosed=function(){h.prototype.parentClass.onClosed.apply(this,arguments),p(this.hostEditor),this.editors.forEach(function(e){$(e).off(".InlineTextEditor"),e.destroy()})},h.prototype.sizeInlineWidgetToContents=function(e){},h.prototype.onAdded=function(){var e=this;h.prototype.parentClass.onAdded.apply(this,arguments),this.editors.forEach(function(e){e.refresh()}),CodeMirror.on(this.info,"redraw",function(){window.setTimeout(function(){e.editors[0].refresh()},0)}),p(this.hostEditor),this.editors[0].focus()},h.prototype.getFocusedEditor=function(){var e=a.indexOf(this.editors,function(e){return e.hasFocus()});return this.editors[e]},h.prototype.createInlineEditorFromText=function(e,t,n,r){var u=this,a={startLine:t,endLine:n},f=$("<div/>"),c=f[0],h=$("<div/>").addClass("inline-editor-header"),p=$("<a/>").addClass("filename"),d=$("<div/>").addClass("dirty-indicator").width(0);d.data("fullPath",e.file.fullPath),this.$lineNumber=$("<span class='line-number'/>"),p.append(d).append(e.file.name+" : ").append(this.$lineNumber).attr("title",e.file.fullPath),p.click(function(){s.execute(o.FILE_OPEN,{fullPath:e.file.fullPath}).done(function(){i.getCurrentFullEditor().setCursorPos(t,0,!0)})}),h.append(p),f.append(h);var v=i.createInlineEditorForDocument(e,a,c);this.editors.push(v.editor),r.appendChild(c),this._updateLineRange=this._updateLineRange.bind(this),this._updateLineRange(v.editor),$(v.editor).on("update.InlineTextEditor",function(e,t){u.sizeInlineWidgetToContents(!0)}),$(v.editor).on("change.InlineTextEditor",function(e,t){u.hostEditor.isFullyVisible()&&u.sizeInlineWidgetToContents(!0)}),$(v.editor).on("lostContent.InlineTextEditor",function(){u._onLostContent.apply(u,arguments)}),l(d,e.isDirty)},h.prototype._updateLineRange=function(e){var t=this._startLine,n=this._endLine,r=this._lineCount;return this._startLine=e.getFirstVisibleLine(),this._endLine=e.getLastVisibleLine(),this._lineCount=this._endLine-this._startLine,t!==this._startLine&&this.$lineNumber.text(this._startLine+1),this._lineCount!==r},h.prototype.load=function(e){h.prototype.parentClass.load.apply(this,arguments)},h.prototype.onParentShown=function(){var e=this;h.prototype.parentClass.onParentShown.apply(this,arguments),this.editors.forEach(function(t){e._updateLineRange(t),t.refresh()}),this.sizeInlineWidgetToContents(!0)},h.prototype._onLostContent=function(){this.close()},$(r).on("dirtyFlagChange",c),t.InlineTextEditor=h}),CodeMirror.defineMode("xml",function(e,t){function u(e,t){function n(n){return t.tokenize=n,n(e,t)}var r=e.next();if(r=="<"){if(e.eat("!"))return e.eat("[")?e.match("CDATA[")?n(l("atom","]]>")):null:e.match("--")?n(l("comment","-->")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),n(c(1))):null;if(e.eat("?"))return e.eatWhile(/[\w\._\-]/),t.tokenize=l("meta","?>"),"meta";var i=e.eat("/");s="";var u;while(u=e.eat(/[^\s\u00a0=<>\"\'\/?]/))s+=u;return s?(o=i?"closeTag":"openTag",t.tokenize=a,"tag"):"error"}if(r=="&"){var f;return e.eat("#")?e.eat("x")?f=e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):f=e.eatWhile(/[\d]/)&&e.eat(";"):f=e.eatWhile(/[\w\.\-:]/)&&e.eat(";"),f?"atom":"error"}return e.eatWhile(/[^&<]/),null}function a(e,t){var n=e.next();return n==">"||n=="/"&&e.eat(">")?(t.tokenize=u,o=n==">"?"endTag":"selfcloseTag","tag"):n=="="?(o="equals",null):/[\'\"]/.test(n)?(t.tokenize=f(n),t.tokenize(e,t)):(e.eatWhile(/[^\s\u00a0=<>\"\']/),"word")}function f(e){return function(t,n){while(!t.eol())if(t.next()==e){n.tokenize=a;break}return"string"}}function l(e,t){return function(n,r){while(!n.eol()){if(n.match(t)){r.tokenize=u;break}n.next()}return e}}function c(e){return function(t,n){var r;while((r=t.next())!=null){if(r=="<")return n.tokenize=c(e+1),n.tokenize(t,n);if(r==">"){if(e==1){n.tokenize=u;break}return n.tokenize=c(e-1),n.tokenize(t,n)}}return"meta"}}function d(){for(var e=arguments.length-1;e>=0;e--)h.cc.push(arguments[e])}function v(){return d.apply(null,arguments),!0}function m(e,t){var n=r.doNotIndent.hasOwnProperty(e)||h.context&&h.context.noIndent;h.context={prev:h.context,tagName:e,indent:h.indented,startOfLine:t,noIndent:n}}function g(){h.context&&(h.context=h.context.prev)}function y(e){if(e=="openTag")return h.tagName=s,v(S,b(h.startOfLine));if(e=="closeTag"){var t=!1;return h.context?h.context.tagName!=s&&(r.implicitlyClosed.hasOwnProperty(h.context.tagName.toLowerCase())&&g(),t=!h.context||h.context.tagName!=s):t=!0,t&&(p="error"),v(w(t))}return v()}function b(e){return function(t){var n=h.tagName;return h.tagName=null,t=="selfcloseTag"||t=="endTag"&&r.autoSelfClosers.hasOwnProperty(n.toLowerCase())?(E(n.toLowerCase()),v()):t=="endTag"?(E(n.toLowerCase()),m(n,e),v()):v()}}function w(e){return function(t){return e&&(p="error"),t=="endTag"?(g(),v()):(p="error",v(arguments.callee))}}function E(e){var t;for(;;){if(!h.context)return;t=h.context.tagName.toLowerCase();if(!r.contextGrabbers.hasOwnProperty(t)||!r.contextGrabbers[t].hasOwnProperty(e))return;g()}}function S(e){return e=="word"?(p="attribute",v(x,S)):e=="endTag"||e=="selfcloseTag"?d():(p="error",v(S))}function x(e){return e=="equals"?v(T,S):(r.allowMissing?e=="word"&&(p="attribute"):p="error",e=="endTag"||e=="selfcloseTag"?d():v())}function T(e){return e=="string"?v(N):e=="word"&&r.allowUnquoted?(p="string",v()):(p="error",e=="endTag"||e=="selfCloseTag"?d():v())}function N(e){return e=="string"?v(N):d()}var n=e.indentUnit,r=t.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1},i=t.alignCDATA,s,o,h,p;return{startState:function(){return{tokenize:u,cc:[],indented:0,startOfLine:!0,tagName:null,context:null}},token:function(e,t){e.sol()&&(t.startOfLine=!0,t.indented=e.indentation());if(e.eatSpace())return null;p=o=s=null;var n=t.tokenize(e,t);t.type=o;if((n||o)&&n!="comment"){h=t;for(;;){var r=t.cc.pop()||y;if(r(o||n))break}}return t.startOfLine=!1,p||n},indent:function(e,t,r){var s=e.context;if(e.tokenize!=a&&e.tokenize!=u||s&&s.noIndent)return r?r.match(/^(\s*)/)[0].length:0;if(i&&/<!\[CDATA\[/.test(t))return 0;s&&/^<\//.test(t)&&(s=s.prev);while(s&&!s.startOfLine)s=s.prev;return s?s.indent+n:0},electricChars:"/",configuration:t.htmlMode?"html":"xml"}}),CodeMirror.defineMIME("text/xml","xml"),CodeMirror.defineMIME("application/xml","xml"),CodeMirror.mimeModes.hasOwnProperty("text/html")||CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:!0}),define("thirdparty/CodeMirror2/mode/xml/xml",function(){}),CodeMirror.defineMode("javascript",function(e,t){function u(e,t,n){return t.tokenize=n,n(e,t)}function a(e,t){var n=!1,r;while((r=e.next())!=null){if(r==t&&!n)return!1;n=!n&&r=="\\"}return n}function c(e,t,n){return f=e,l=n,t}function h(e,t){var n=e.next();if(n=='"'||n=="'")return u(e,t,p(n));if(/[\[\]{}\(\),;\:\.]/.test(n))return c(n);if(n=="0"&&e.eat(/x/i))return e.eatWhile(/[\da-f]/i),c("number","number");if(/\d/.test(n)||n=="-"&&e.eat(/\d/))return e.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),c("number","number");if(n=="/")return e.eat("*")?u(e,t,d):e.eat("/")?(e.skipToEnd(),c("comment","comment")):t.lastType=="operator"||t.lastType=="keyword c"||/^[\[{}\(,;:]$/.test(t.lastType)?(a(e,"/"),e.eatWhile(/[gimy]/),c("regexp","string-2")):(e.eatWhile(o),c("operator",null,e.current()));if(n=="#")return e.skipToEnd(),c("error","error");if(o.test(n))return e.eatWhile(o),c("operator",null,e.current());e.eatWhile(/[\w\$_]/);var r=e.current(),i=s.propertyIsEnumerable(r)&&s[r];return i&&t.lastType!="."?c(i.type,i.style,r):c("variable","variable",r)}function p(e){return function(t,n){return a(t,e)||(n.tokenize=h),c("string","string")}}function d(e,t){var n=!1,r;while(r=e.next()){if(r=="/"&&n){t.tokenize=h;break}n=r=="*"}return c("comment","comment")}function m(e,t,n,r,i,s){this.indented=e,this.column=t,this.type=n,this.prev=i,this.info=s,r!=null&&(this.align=r)}function g(e,t){for(var n=e.localVars;n;n=n.next)if(n.name==t)return!0}function y(e,t,n,i,s){var o=e.cc;b.state=e,b.stream=s,b.marked=null,b.cc=o,e.lexical.hasOwnProperty("align")||(e.lexical.align=!0);for(;;){var u=o.length?o.pop():r?O:A;if(u(n,i)){while(o.length&&o[o.length-1].lex)o.pop()();return b.marked?b.marked:n=="variable"&&g(e,i)?"variable-2":t}}}function w(){for(var e=arguments.length-1;e>=0;e--)b.cc.push(arguments[e])}function E(){return w.apply(null,arguments),!0}function S(e){function t(t){for(var n=t;n;n=n.next)if(n.name==e)return!0;return!1}var n=b.state;if(n.context){b.marked="def";if(t(n.localVars))return;n.localVars={name:e,next:n.localVars}}else{if(t(n.globalVars))return;n.globalVars={name:e,next:n.globalVars}}}function T(){b.state.context={prev:b.state.context,vars:b.state.localVars},b.state.localVars=x}function N(){b.state.localVars=b.state.context.vars,b.state.context=b.state.context.prev}function C(e,t){var n=function(){var n=b.state;n.lexical=new m(n.indented,b.stream.column(),e,null,n.lexical,t)};return n.lex=!0,n}function k(){var e=b.state;e.lexical.prev&&(e.lexical.type==")"&&(e.indented=e.lexical.indented),e.lexical=e.lexical.prev)}function L(e){return function(t){return t==e?E():e==";"?w():E(arguments.callee)}}function A(e){return e=="var"?E(C("vardef"),q,L(";"),k):e=="keyword a"?E(C("form"),O,A,k):e=="keyword b"?E(C("form"),A,k):e=="{"?E(C("}"),j,k):e==";"?E():e=="function"?E(V):e=="for"?E(C("form"),L("("),C(")"),U,L(")"),k,A,k):e=="variable"?E(C("stat"),D):e=="switch"?E(C("form"),O,C("}","switch"),L("{"),j,k,k):e=="case"?E(O,L(":")):e=="default"?E(L(":")):e=="catch"?E(C("form"),T,L("("),$,L(")"),A,k,N):w(C("stat"),O,L(";"),k)}function O(e){return v.hasOwnProperty(e)?E(_):e=="function"?E(V):e=="keyword c"?E(M):e=="("?E(C(")"),M,L(")"),k,_):e=="operator"?E(O):e=="["?E(C("]"),B(O,"]"),k,_):e=="{"?E(C("}"),B(H,"}"),k,_):E()}function M(e){return e.match(/[;\}\)\],]/)?w():w(O)}function _(e,t){if(e=="operator")return/\+\+|--/.test(t)?E(_):t=="?"?E(O,L(":"),O):E(O);if(e==";")return;if(e=="(")return E(C(")"),B(O,")"),k,_);if(e==".")return E(P,_);if(e=="[")return E(C("]"),O,L("]"),k,_)}function D(e){return e==":"?E(k,A):w(_,L(";"),k)}function P(e){if(e=="variable")return b.marked="property",E()}function H(e){e=="variable"&&(b.marked="property");if(v.hasOwnProperty(e))return E(L(":"),O)}function B(e,t){function n(r){return r==","?E(e,n):r==t?E():E(L(t))}return function(r){return r==t?E():w(e,n)}}function j(e){return e=="}"?E():w(A,j)}function F(e){return e==":"?E(I):w()}function I(e){return e=="variable"?(b.marked="variable-3",E()):w()}function q(e,t){return e=="variable"?(S(t),i?E(F,R):E(R)):w()}function R(e,t){if(t=="=")return E(O,R);if(e==",")return E(q)}function U(e){return e=="var"?E(q,L(";"),W):e==";"?E(W):e=="variable"?E(z):E(W)}function z(e,t){return t=="in"?E(O):E(_,W)}function W(e,t){return e==";"?E(X):t=="in"?E(O):E(O,L(";"),X)}function X(e){e!=")"&&E(O)}function V(e,t){if(e=="variable")return S(t),E(V);if(e=="(")return E(C(")"),T,B($,")"),k,A,N)}function $(e,t){if(e=="variable")return S(t),i?E(F):E()}var n=e.indentUnit,r=t.json,i=t.typescript,s=function(){function e(e){return{type:e,style:"keyword"}}var t=e("keyword a"),n=e("keyword b"),r=e("keyword c"),s=e("operator"),o={type:"atom",style:"atom"},u={"if":t,"while":t,"with":t,"else":n,"do":n,"try":n,"finally":n,"return":r,"break":r,"continue":r,"new":r,"delete":r,"throw":r,"var":e("var"),"const":e("var"),let:e("var"),"function":e("function"),"catch":e("catch"),"for":e("for"),"switch":e("switch"),"case":e("case"),"default":e("default"),"in":s,"typeof":s,"instanceof":s,"true":o,"false":o,"null":o,"undefined":o,NaN:o,Infinity:o};if(i){var a={type:"variable",style:"variable-3"},f={"interface":e("interface"),"class":e("class"),"extends":e("extends"),constructor:e("constructor"),"public":e("public"),"private":e("private"),"protected":e("protected"),"static":e("static"),"super":e("super"),string:a,number:a,bool:a,any:a};for(var l in f)u[l]=f[l]}return u}(),o=/[+\-*&%=<>!?|]/,f,l,v={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},b={state:null,column:null,marked:null,cc:null},x={name:"this",next:{name:"arguments"}};return k.lex=!0,{startState:function(e){return{tokenize:h,lastType:null,cc:[],lexical:new m((e||0)-n,0,"block",!1),localVars:t.localVars,globalVars:t.globalVars,context:t.localVars&&{vars:t.localVars},indented:0}},token:function(e,t){e.sol()&&(t.lexical.hasOwnProperty("align")||(t.lexical.align=!1),t.indented=e.indentation());if(e.eatSpace())return null;var n=t.tokenize(e,t);return f=="comment"?n:(t.lastType=f,y(t,n,f,l,e))},indent:function(e,t){if(e.tokenize==d)return CodeMirror.Pass;if(e.tokenize!=h)return 0;var r=t&&t.charAt(0),i=e.lexical;i.type=="stat"&&r=="}"&&(i=i.prev);var s=i.type,o=r==s;return s=="vardef"?i.indented+(e.lastType=="operator"||e.lastType==","?4:0):s=="form"&&r=="{"?i.indented:s=="form"?i.indented+n:s=="stat"?i.indented+(e.lastType=="operator"||e.lastType==","?n:0):i.info=="switch"&&!o?i.indented+(/^(?:case|default)\b/.test(t)?n:2*n):i.align?i.column+(o?0:1):i.indented+(o?0:n)},electricChars:":{}",jsonMode:r}}),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("text/ecmascript","javascript"),CodeMirror.defineMIME("application/javascript","javascript"),CodeMirror.defineMIME("application/ecmascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0}),CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:!0}),define("thirdparty/CodeMirror2/mode/javascript/javascript",function(){}),CodeMirror.defineMode("css",function(e){function a(e){var t={};for(var n=0;n<e.length;++n)t[e[n]]=!0;return t}function f(e,t){return n=t,e}function l(e,t){var n=e.next();if(n=="@")return e.eatWhile(/[\w\\\-]/),f("def",e.current());if(n=="/"&&e.eat("*"))return t.tokenize=c,c(e,t);if(n=="<"&&e.eat("!"))return t.tokenize=h,h(e,t);if(n=="=")f(null,"compare");else{if(!(n!="~"&&n!="|"||!e.eat("=")))return f(null,"compare");if(n=='"'||n=="'")return t.tokenize=p(n),t.tokenize(e,t);if(n=="#")return e.eatWhile(/[\w\\\-]/),f("atom","hash");if(n=="!")return e.match(/^\s*\w*/),f("keyword","important");if(/\d/.test(n))return e.eatWhile(/[\w.%]/),f("number","unit");if(n!=="-")return/[,+>*\/]/.test(n)?f(null,"select-op"):n=="."&&e.match(/^-?[_a-z][_a-z0-9-]*/i)?f("qualifier","qualifier"):n==":"?f("operator",n):/[;{}\[\]\(\)]/.test(n)?f(null,n):n=="u"&&e.match("rl(")?(e.backUp(1),t.tokenize=d,f("property","variable")):(e.eatWhile(/[\w\\\-]/),f("property","variable"));if(/\d/.test(e.peek()))return e.eatWhile(/[\w.%]/),f("number","unit");if(e.match(/^[^-]+-/))return f("meta","meta")}}function c(e,t){var n=!1,r;while((r=e.next())!=null){if(n&&r=="/"){t.tokenize=l;break}n=r=="*"}return f("comment","comment")}function h(e,t){var n=0,r;while((r=e.next())!=null){if(n>=2&&r==">"){t.tokenize=l;break}n=r=="-"?n+1:0}return f("comment","comment")}function p(e,t){return function(n,r){var i=!1,s;while((s=n.next())!=null){if(s==e&&!i)break;i=!i&&s=="\\"}return i||(t&&n.backUp(1),r.tokenize=l),f("string","string")}}function d(e,t){return e.next(),e.match(/\s*[\"\']/,!1)?t.tokenize=l:t.tokenize=p(")",!0),f(null,"(")}var t=e.indentUnit,n,r=a(["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"]),i=a(["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid"]),s=a(["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid-cell","grid-column","grid-column-align","grid-column-sizing","grid-column-span","grid-columns","grid-flow","grid-row","grid-row-align","grid-row-sizing","grid-row-span","grid-rows","grid-template","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-shadow","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index"]),o=a(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua"]),u=a(["above","absolute","activeborder","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","auto","avoid","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break-all","break-word","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","compact","condensed","contain","content","content-box","context-menu","continuous","copy","cover","crop","cross","crosshair","currentcolor","cursive","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","disc","discard","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ew-resize","expanded","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-table","inset","inside","intrinsic","invert","italic","justify","kannada","katakana","katakana-iroha","khmer","landscape","lao","large","larger","left","level","lighter","line-through","linear","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","malayalam","match","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","myanmar","n-resize","narrower","navy","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","overlay","overline","padding","padding-box","painted","paused","persian","plus-darker","plus-lighter","pointer","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radio","read-only","read-write","read-write-plaintext-only","relative","repeat","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","round","row-resize","rtl","run-in","running","s-resize","sans-serif","scroll","scrollbar","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","single","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","solid","somali","source-atop","source-in","source-out","source-over","space","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","white","wider","window","windowframe","windowtext","x-large","x-small","xor","xx-large","xx-small","yellow"]);return{startState:function(e){return{tokenize:l,baseIndent:e||0,stack:[]}},token:function(e,t){if(t.tokenize==l&&e.eatSpace())return null;var a=t.tokenize(e,t),f=t.stack[t.stack.length-1];return a=="property"?f=="propertyValue"?u[e.current()]?a="string-2":o[e.current()]?a="keyword":a="variable-2":f=="rule"?s[e.current()]||(a+=" error"):!f||f=="@media{"?a="tag":f=="@media"?r[e.current()]?a="attribute":/^(only|not)$/i.test(e.current())?a="keyword":e.current().toLowerCase()=="and"?a="error":i[e.current()]?a="error":a="attribute error":f=="@mediaType"?r[e.current()]?a="attribute":e.current().toLowerCase()=="and"?a="operator":/^(only|not)$/i.test(e.current())?a="error":i[e.current()]?a="error":a="error":f=="@mediaType("?s[e.current()]||(r[e.current()]?a="error":e.current().toLowerCase()=="and"?a="operator":/^(only|not)$/i.test(e.current())?a="error":a+=" error"):a="error":a=="atom"?!f||f=="@media{"?a="builtin":f=="propertyValue"?/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e.current())||(a+=" error"):a="error":f=="@media"&&n=="{"&&(a="error"),n=="{"?f=="@media"||f=="@mediaType"?(t.stack.pop(),t.stack[t.stack.length-1]="@media{"):t.stack.push("rule"):n=="}"?(t.stack.pop(),f=="propertyValue"&&t.stack.pop()):n=="@media"?t.stack.push("@media"):f=="@media"&&/\b(keyword|attribute)\b/.test(a)?t.stack.push("@mediaType"):f=="@mediaType"&&e.current()==","?t.stack.pop():f=="@mediaType"&&n=="("?t.stack.push("@mediaType("):f=="@mediaType("&&n==")"?t.stack.pop():f=="rule"&&n==":"?t.stack.push("propertyValue"):f=="propertyValue"&&n==";"&&t.stack.pop(),a},indent:function(e,n){var r=e.stack.length;return/^\}/.test(n)&&(r-=e.stack[e.stack.length-1]=="propertyValue"?2:1),e.baseIndent+r*t},electricChars:"}"}}),CodeMirror.defineMIME("text/css","css"),define("thirdparty/CodeMirror2/mode/css/css",function(){}),CodeMirror.defineMode("less",function(e){function r(e,t){return n=t,e}function s(e){for(var t=0;t<i.length;t++)if(e===i[t])return!0}function u(e,t){var i=e.next();if(i=="@")return e.eatWhile(/[\w\-]/),r("meta",e.current());if(i=="/"&&e.eat("*"))return t.tokenize=f,f(e,t);if(i=="<"&&e.eat("!"))return t.tokenize=l,l(e,t);if(i=="=")r(null,"compare");else{if(i=="|"&&e.eat("="))return r(null,"compare");if(i=='"'||i=="'")return t.tokenize=c(i),t.tokenize(e,t);if(i=="/"){if(e.eat("/"))return t.tokenize=a,a(e,t);if(n=="string"||n=="(")return r("string","string");if(t.stack[t.stack.length-1]!=undefined)return r(null,i);e.eatWhile(/[\a-zA-Z0-9\-_.\s]/);if(/\/|\)|#/.test(e.peek()||e.eatSpace()&&e.peek()==")")||e.eol())return r("string","string")}else{if(i=="!")return e.match(/^\s*\w*/),r("keyword","important");if(/\d/.test(i))return e.eatWhile(/[\w.%]/),r("number","unit");if(/[,+<>*\/]/.test(i))return e.peek()=="="||n=="a"?r("string","string"):r(null,"select-op");if(!/[;{}:\[\]()~\|]/.test(i)){if(i==".")return n=="("||n=="string"?r("string","string"):(e.eatWhile(/[\a-zA-Z0-9\-_]/),e.peek()==" "&&e.eatSpace(),e.peek()==")"?r("number","unit"):r("tag","tag"));if(i=="#")return e.eatWhile(/[A-Za-z0-9]/),e.current().length==4||e.current().length==7?e.current().match(/[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3}/,false)!=null?e.current().substring(1)!=e.current().match(/[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3}/,false)?r("atom","tag"):(e.eatSpace(),/[\/<>.(){!$%^&*_\-\\?=+\|#'~`]/.test(e.peek())?r("atom","tag"):e.peek()=="}"?r("number","unit"):/[a-zA-Z\\]/.test(e.peek())?r("atom","tag"):e.eol()?r("atom","tag"):r("number","unit")):(e.eatWhile(/[\w\\\-]/),r("atom","tag")):(e.eatWhile(/[\w\\\-]/),r("atom","tag"));if(i=="&")return e.eatWhile(/[\w\-]/),r(null,i);e.eatWhile(/[\w\\\-_%.{]/);if(n=="string")return r("string","string");if(e.current().match(/(^http$|^https$)/)!=null)return e.eatWhile(/[\w\\\-_%.{:\/]/),r("string","string");if(e.peek()=="<"||e.peek()==">")return r("tag","tag");if(/\(/.test(e.peek()))return r(null,i);if(e.peek()=="/"&&t.stack[t.stack.length-1]!=undefined)return r("string","string");if(e.current().match(/\-\d|\-.\d/))return r("number","unit");if(s(e.current().toLowerCase()))return r("tag","tag");if(/\/|[\s\)]/.test(e.peek()||e.eol()||e.eatSpace()&&e.peek()=="/")&&e.current().indexOf(".")!==-1)return e.current().substring(e.current().length-1,e.current().length)=="{"?(e.backUp(1),r("tag","tag")):(e.eatSpace(),/[{<>.a-zA-Z\/]/.test(e.peek())||e.eol()?r("tag","tag"):r("string","string"));if(e.eol()||e.peek()=="["||e.peek()=="#"||n=="tag")return e.current().substring(e.current().length-1,e.current().length)=="{"&&e.backUp(1),r("tag","tag");if(n=="compare"||n=="a"||n=="(")return r("string","string");if(n=="|"||e.current()=="-"||n=="[")return r(null,i);if(e.peek()==":"){e.next();var u=e.peek()==":"?!0:!1;if(!u){var h=e.pos,p=e.current().length;e.eatWhile(/[a-z\\\-]/);var d=e.pos;if(e.current().substring(p-1).match(o)!=null)return e.backUp(d-(h-1)),r("tag","tag");e.backUp(d-(h-1))}else e.backUp(1);return u?r("tag","tag"):r("variable","variable")}return r("variable","variable")}if(i==":")return e.eatWhile(/[a-z\\\-]/),o.test(e.current())?r("tag","tag"):e.peek()==":"?(e.next(),e.eatWhile(/[a-z\\\-]/),e.current().match(/\:\:\-(o|ms|moz|webkit)\-/)?r("string","string"):o.test(e.current().substring(1))?r("tag","tag"):r(null,i)):r(null,i);if(i!="~")return r(null,i);if(n=="r")return r("string","string")}}}function a(e,t){return e.skipToEnd(),t.tokenize=u,r("comment","comment")}function f(e,t){var n=!1,i;while((i=e.next())!=null){if(n&&i=="/"){t.tokenize=u;break}n=i=="*"}return r("comment","comment")}function l(e,t){var n=0,i;while((i=e.next())!=null){if(n>=2&&i==">"){t.tokenize=u;break}n=i=="-"?n+1:0}return r("comment","comment")}function c(e){return function(t,n){var i=!1,s;while((s=t.next())!=null){if(s==e&&!i)break;i=!i&&s=="\\"}return i||(n.tokenize=u),r("string","string")}}var t=e.indentUnit,n,i="a abbr acronym address applet area article aside audio b base basefont bdi bdo big blockquote body br button canvas caption cite code col colgroup command datalist dd del details dfn dir div dl dt em embed fieldset figcaption figure font footer form frame frameset h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins keygen kbd label legend li link map mark menu meta meter nav noframes noscript object ol optgroup option output p param pre progress q rp rt ruby s samp script section select small source span strike strong style sub summary sup table tbody td textarea tfoot th thead time title tr track tt u ul var video wbr".split(" "),o=/(^\:root$|^\:nth\-child$|^\:nth\-last\-child$|^\:nth\-of\-type$|^\:nth\-last\-of\-type$|^\:first\-child$|^\:last\-child$|^\:first\-of\-type$|^\:last\-of\-type$|^\:only\-child$|^\:only\-of\-type$|^\:empty$|^\:link|^\:visited$|^\:active$|^\:hover$|^\:focus$|^\:target$|^\:lang$|^\:enabled^\:disabled$|^\:checked$|^\:first\-line$|^\:first\-letter$|^\:before$|^\:after$|^\:not$|^\:required$|^\:invalid$)/;return{startState:function(e){return{tokenize:u,baseIndent:e||0,stack:[]}},token:function(e,t){if(e.eatSpace())return null;var r=t.tokenize(e,t),i=t.stack[t.stack.length-1];if(n=="hash"&&i=="rule")r="atom";else if(r=="variable")if(i=="rule")r=null;else if(!i||i=="@media{")r=e.current()=="when"?"variable":/[\s,|\s\)|\s]/.test(e.peek())?"tag":n;return i=="rule"&&/^[\{\};]$/.test(n)&&t.stack.pop(),n=="{"?i=="@media"?t.stack[t.stack.length-1]="@media{":t.stack.push("{"):n=="}"?t.stack.pop():n=="@media"?t.stack.push("@media"):i=="{"&&n!="comment"&&t.stack.push("rule"),r},indent:function(e,n){var r=e.stack.length;return/^\}/.test(n)&&(r-=e.stack[e.stack.length-1]=="rule"?2:1),e.baseIndent+r*t},electricChars:"}"}}),CodeMirror.defineMIME("text/x-less","less"),CodeMirror.mimeModes.hasOwnProperty("text/css")||CodeMirror.defineMIME("text/css","less"),define("thirdparty/CodeMirror2/mode/less/less",function(){}),CodeMirror.defineMode("htmlmixed",function(e){function s(e,s){var o=t.token(e,s.htmlState);if(/(?:^|\s)tag(?:\s|$)/.test(o)&&e.current()==">"&&s.htmlState.context)if(/^script$/i.test(s.htmlState.context.tagName)){var l=e.string.slice(Math.max(0,e.pos-100),e.pos).match(/\btype\s*=\s*("[^"]+"|'[^']+'|\S+)[^<]*$/i);l=l&&l[1],!l||l.match(/(text|application)\/(x-)?(java|ecma)script/i)?(s.token=a,s.localMode=r,s.localState=r.startState(t.indent(s.htmlState,""))):!l.match(/\/x-handlebars-template/i)&&!l.match(/\/x-mustache/i)&&(s.token=u,s.localMode=n,s.localState=null)}else/^style$/i.test(s.htmlState.context.tagName)&&(s.token=f,s.localMode=i,s.localState=i.startState(t.indent(s.htmlState,"")));return o}function o(e,t,n){var r=e.current(),i=r.search(t),s;if(i>-1)e.backUp(r.length-i);else if(s=r.match(/<\/?$/))e.backUp(r.length),e.match(t,!1)||e.match(r[0]);return n}function u(e,t){return e.match(/^<\/\s*script\s*>/i,!1)?(t.token=s,t.localState=t.localMode=null,s(e,t)):o(e,/<\/\s*script\s*>/,n.token(e,t.localState))}function a(e,t){return e.match(/^<\/\s*script\s*>/i,!1)?(t.token=s,t.localState=t.localMode=null,s(e,t)):o(e,/<\/\s*script\s*>/,r.token(e,t.localState))}function f(e,t){return e.match(/^<\/\s*style\s*>/i,!1)?(t.token=s,t.localState=t.localMode=null,s(e,t)):o(e,/<\/\s*style\s*>/,i.token(e,t.localState))}var t=CodeMirror.getMode(e,{name:"xml",htmlMode:!0}),n=CodeMirror.getMode(e,"text/plain"),r=CodeMirror.getMode(e,"javascript"),i=CodeMirror.getMode(e,"css");return{startState:function(){var e=t.startState();return{token:s,localMode:null,localState:null,htmlState:e}},copyState:function(e){if(e.localState)var n=CodeMirror.copyState(e.token==f?i:r,e.localState);return{token:e.token,localMode:e.localMode,localState:n,htmlState:CodeMirror.copyState(t,e.htmlState)}},token:function(e,t){return t.token(e,t)},indent:function(e,n){return!e.localMode||/^\s*<\//.test(n)?t.indent(e.htmlState,n):e.localMode.indent?e.localMode.indent(e.localState,n):CodeMirror.Pass},electricChars:"/{}:",innerMode:function(e){return{state:e.localState||e.htmlState,mode:e.localMode||t}}}},"xml","javascript","css"),CodeMirror.defineMIME("text/html","htmlmixed"),define("thirdparty/CodeMirror2/mode/htmlmixed/htmlmixed",function(){}),CodeMirror.defineMode("clike",function(e,t){function p(e,t){var n=e.next();if(f[n]){var r=f[n](e,t);if(r!==!1)return r}if(n=='"'||n=="'")return t.tokenize=d(n),t.tokenize(e,t);if(/[\[\]{}\(\),;\:\.]/.test(n))return h=n,null;if(/\d/.test(n))return e.eatWhile(/[\w\.]/),"number";if(n=="/"){if(e.eat("*"))return t.tokenize=v,v(e,t);if(e.eat("/"))return e.skipToEnd(),"comment"}if(c.test(n))return e.eatWhile(c),"operator";e.eatWhile(/[\w\$_]/);var i=e.current();return s.propertyIsEnumerable(i)?(u.propertyIsEnumerable(i)&&(h="newstatement"),"keyword"):o.propertyIsEnumerable(i)?(u.propertyIsEnumerable(i)&&(h="newstatement"),"builtin"):a.propertyIsEnumerable(i)?"atom":"variable"}function d(e){return function(t,n){var r=!1,i,s=!1;while((i=t.next())!=null){if(i==e&&!r){s=!0;break}r=!r&&i=="\\"}if(s||!r&&!l)n.tokenize=null;return"string"}}function v(e,t){var n=!1,r;while(r=e.next()){if(r=="/"&&n){t.tokenize=null;break}n=r=="*"}return"comment"}function m(e,t,n,r,i){this.indented=e,this.column=t,this.type=n,this.align=r,this.prev=i}function g(e,t,n){var r=e.indented;return e.context&&e.context.type=="statement"&&(r=e.context.indented),e.context=new m(r,t,n,null,e.context)}function y(e){var t=e.context.type;if(t==")"||t=="]"||t=="}")e.indented=e.context.indented;return e.context=e.context.prev}var n=e.indentUnit,r=t.statementIndentUnit||n,i=t.dontAlignCalls,s=t.keywords||{},o=t.builtin||{},u=t.blockKeywords||{},a=t.atoms||{},f=t.hooks||{},l=t.multiLineStrings,c=/[+\-*&%=<>!?|\/]/,h;return{startState:function(e){return{tokenize:null,context:new m((e||0)-n,0,"top",!1),indented:0,startOfLine:!0}},token:function(e,t){var n=t.context;e.sol()&&(n.align==null&&(n.align=!1),t.indented=e.indentation(),t.startOfLine=!0);if(e.eatSpace())return null;h=null;var r=(t.tokenize||p)(e,t);if(r=="comment"||r=="meta")return r;n.align==null&&(n.align=!0);if(h!=";"&&h!=":"&&h!=","||n.type!="statement")if(h=="{")g(t,e.column(),"}");else if(h=="[")g(t,e.column(),"]");else if(h=="(")g(t,e.column(),")");else if(h=="}"){while(n.type=="statement")n=y(t);n.type=="}"&&(n=y(t));while(n.type=="statement")n=y(t)}else h==n.type?y(t):((n.type=="}"||n.type=="top")&&h!=";"||n.type=="statement"&&h=="newstatement")&&g(t,e.column(),"statement");else y(t);return t.startOfLine=!1,r},indent:function(e,t){if(e.tokenize!=p&&e.tokenize!=null)return CodeMirror.Pass;var s=e.context,o=t&&t.charAt(0);s.type=="statement"&&o=="}"&&(s=s.prev);var u=o==s.type;return s.type=="statement"?s.indented+(o=="{"?0:r):i&&s.type==")"&&!u?s.indented+r:s.align?s.column+(u?0:1):s.indented+(u?0:n)},electricChars:"{}"}}),function(){function e(e){var t={},n=e.split(" ");for(var r=0;r<n.length;++r)t[n[r]]=!0;return t}function n(e,t){if(!t.startOfLine)return!1;for(;;){if(!e.skipTo("\\")){e.skipToEnd(),t.tokenize=null;break}e.next();if(e.eol()){t.tokenize=n;break}}return"meta"}function r(e,t){var n;while((n=e.next())!=null)if(n=='"'&&!e.eat('"')){t.tokenize=null;break}return"string"}function i(e,t){for(var n=0;n<e.length;++n)CodeMirror.defineMIME(e[n],t)}var t="auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile";i(["text/x-csrc","text/x-c","text/x-chdr"],{name:"clike",keywords:e(t),blockKeywords:e("case do else for if switch while struct"),atoms:e("null"),hooks:{"#":n}}),i(["text/x-c++src","text/x-c++hdr"],{name:"clike",keywords:e(t+" asm dynamic_cast namespace reinterpret_cast try bool explicit new "+"static_cast typeid catch operator template typename class friend private "+"this using const_cast inline public throw virtual delete mutable protected "+"wchar_t"),blockKeywords:e("catch class do else finally for if struct switch try while"),atoms:e("true false null"),hooks:{"#":n}}),CodeMirror.defineMIME("text/x-java",{name:"clike",keywords:e("abstract assert boolean break byte case catch char class const continue default do double else enum extends final finally float for goto if implements import instanceof int interface long native new package private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),blockKeywords:e("catch class do else finally for if switch try while"),atoms:e("true false null"),hooks:{"@":function(e){return e.eatWhile(/[\w\$_]/),"meta"}}}),CodeMirror.defineMIME("text/x-csharp",{name:"clike",keywords:e("abstract as base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in interface internal is lock namespace new operator out override params private protected public readonly ref return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),blockKeywords:e("catch class do else finally for foreach if struct switch try while"),builtin:e("Boolean Byte Char DateTime DateTimeOffset Decimal Double Guid Int16 Int32 Int64 Object SByte Single String TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),atoms:e("true false null"),hooks:{"@":function(e,t){return e.eat('"')?(t.tokenize=r,r(e,t)):(e.eatWhile(/[\w\$_]/),"meta")}}}),CodeMirror.defineMIME("text/x-scala",{name:"clike",keywords:e("abstract case catch class def do else extends false final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try trye type val var while with yield _ : = => <- <: <% >: # @ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector :: #:: Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),blockKeywords:e("catch class do else finally for forSome if match switch try while"),atoms:e("true false null"),hooks:{"@":function(e){return e.eatWhile(/[\w\$_]/),"meta"}}})}(),define("thirdparty/CodeMirror2/mode/clike/clike",function(){}),function(){function e(e){var t={},n=e.split(" ");for(var r=0;r<n.length;++r)t[n[r]]=!0;return t}function t(e){return function(t,n){return t.match(e)?n.tokenize=null:t.skipToEnd(),"string"}}var n={name:"clike",keywords:e("abstract and array as break case catch class clone const continue declare default do else elseif enddeclare endfor endforeach endif endswitch endwhile extends final for foreach function global goto if implements interface instanceof namespace new or private protected public static switch throw trait try use var while xor die echo empty exit eval include include_once isset list require require_once return print unset __halt_compiler self static parent"),blockKeywords:e("catch do else elseif for foreach if switch try while"),atoms:e("true false null TRUE FALSE NULL __CLASS__ __DIR__ __FILE__ __LINE__ __METHOD__ __FUNCTION__ __NAMESPACE__"),builtin:e("func_num_args func_get_arg func_get_args strlen strcmp strncmp strcasecmp strncasecmp each error_reporting define defined trigger_error user_error set_error_handler restore_error_handler get_declared_classes get_loaded_extensions extension_loaded get_extension_funcs debug_backtrace constant bin2hex sleep usleep time mktime gmmktime strftime gmstrftime strtotime date gmdate getdate localtime checkdate flush wordwrap htmlspecialchars htmlentities html_entity_decode md5 md5_file crc32 getimagesize image_type_to_mime_type phpinfo phpversion phpcredits strnatcmp strnatcasecmp substr_count strspn strcspn strtok strtoupper strtolower strpos strrpos strrev hebrev hebrevc nl2br basename dirname pathinfo stripslashes stripcslashes strstr stristr strrchr str_shuffle str_word_count strcoll substr substr_replace quotemeta ucfirst ucwords strtr addslashes addcslashes rtrim str_replace str_repeat count_chars chunk_split trim ltrim strip_tags similar_text explode implode setlocale localeconv parse_str str_pad chop strchr sprintf printf vprintf vsprintf sscanf fscanf parse_url urlencode urldecode rawurlencode rawurldecode readlink linkinfo link unlink exec system escapeshellcmd escapeshellarg passthru shell_exec proc_open proc_close rand srand getrandmax mt_rand mt_srand mt_getrandmax base64_decode base64_encode abs ceil floor round is_finite is_nan is_infinite bindec hexdec octdec decbin decoct dechex base_convert number_format fmod ip2long long2ip getenv putenv getopt microtime gettimeofday getrusage uniqid quoted_printable_decode set_time_limit get_cfg_var magic_quotes_runtime set_magic_quotes_runtime get_magic_quotes_gpc get_magic_quotes_runtime import_request_variables error_log serialize unserialize memory_get_usage var_dump var_export debug_zval_dump print_r highlight_file show_source highlight_string ini_get ini_get_all ini_set ini_alter ini_restore get_include_path set_include_path restore_include_path setcookie header headers_sent connection_aborted connection_status ignore_user_abort parse_ini_file is_uploaded_file move_uploaded_file intval floatval doubleval strval gettype settype is_null is_resource is_bool is_long is_float is_int is_integer is_double is_real is_numeric is_string is_array is_object is_scalar ereg ereg_replace eregi eregi_replace split spliti join sql_regcase dl pclose popen readfile rewind rmdir umask fclose feof fgetc fgets fgetss fread fopen fpassthru ftruncate fstat fseek ftell fflush fwrite fputs mkdir rename copy tempnam tmpfile file file_get_contents stream_select stream_context_create stream_context_set_params stream_context_set_option stream_context_get_options stream_filter_prepend stream_filter_append fgetcsv flock get_meta_tags stream_set_write_buffer set_file_buffer set_socket_blocking stream_set_blocking socket_set_blocking stream_get_meta_data stream_register_wrapper stream_wrapper_register stream_set_timeout socket_set_timeout socket_get_status realpath fnmatch fsockopen pfsockopen pack unpack get_browser crypt opendir closedir chdir getcwd rewinddir readdir dir glob fileatime filectime filegroup fileinode filemtime fileowner fileperms filesize filetype file_exists is_writable is_writeable is_readable is_executable is_file is_dir is_link stat lstat chown touch clearstatcache mail ob_start ob_flush ob_clean ob_end_flush ob_end_clean ob_get_flush ob_get_clean ob_get_length ob_get_level ob_get_status ob_get_contents ob_implicit_flush ob_list_handlers ksort krsort natsort natcasesort asort arsort sort rsort usort uasort uksort shuffle array_walk count end prev next reset current key min max in_array array_search extract compact array_fill range array_multisort array_push array_pop array_shift array_unshift array_splice array_slice array_merge array_merge_recursive array_keys array_values array_count_values array_reverse array_reduce array_pad array_flip array_change_key_case array_rand array_unique array_intersect array_intersect_assoc array_diff array_diff_assoc array_sum array_filter array_map array_chunk array_key_exists pos sizeof key_exists assert assert_options version_compare ftok str_rot13 aggregate session_name session_module_name session_save_path session_id session_regenerate_id session_decode session_register session_unregister session_is_registered session_encode session_start session_destroy session_unset session_set_save_handler session_cache_limiter session_cache_expire session_set_cookie_params session_get_cookie_params session_write_close preg_match preg_match_all preg_replace preg_replace_callback preg_split preg_quote preg_grep overload ctype_alnum ctype_alpha ctype_cntrl ctype_digit ctype_lower ctype_graph ctype_print ctype_punct ctype_space ctype_upper ctype_xdigit virtual apache_request_headers apache_note apache_lookup_uri apache_child_terminate apache_setenv apache_response_headers apache_get_version getallheaders mysql_connect mysql_pconnect mysql_close mysql_select_db mysql_create_db mysql_drop_db mysql_query mysql_unbuffered_query mysql_db_query mysql_list_dbs mysql_list_tables mysql_list_fields mysql_list_processes mysql_error mysql_errno mysql_affected_rows mysql_insert_id mysql_result mysql_num_rows mysql_num_fields mysql_fetch_row mysql_fetch_array mysql_fetch_assoc mysql_fetch_object mysql_data_seek mysql_fetch_lengths mysql_fetch_field mysql_field_seek mysql_free_result mysql_field_name mysql_field_table mysql_field_len mysql_field_type mysql_field_flags mysql_escape_string mysql_real_escape_string mysql_stat mysql_thread_id mysql_client_encoding mysql_get_client_info mysql_get_host_info mysql_get_proto_info mysql_get_server_info mysql_info mysql mysql_fieldname mysql_fieldtable mysql_fieldlen mysql_fieldtype mysql_fieldflags mysql_selectdb mysql_createdb mysql_dropdb mysql_freeresult mysql_numfields mysql_numrows mysql_listdbs mysql_listtables mysql_listfields mysql_db_name mysql_dbname mysql_tablename mysql_table_name pg_connect pg_pconnect pg_close pg_connection_status pg_connection_busy pg_connection_reset pg_host pg_dbname pg_port pg_tty pg_options pg_ping pg_query pg_send_query pg_cancel_query pg_fetch_result pg_fetch_row pg_fetch_assoc pg_fetch_array pg_fetch_object pg_fetch_all pg_affected_rows pg_get_result pg_result_seek pg_result_status pg_free_result pg_last_oid pg_num_rows pg_num_fields pg_field_name pg_field_num pg_field_size pg_field_type pg_field_prtlen pg_field_is_null pg_get_notify pg_get_pid pg_result_error pg_last_error pg_last_notice pg_put_line pg_end_copy pg_copy_to pg_copy_from pg_trace pg_untrace pg_lo_create pg_lo_unlink pg_lo_open pg_lo_close pg_lo_read pg_lo_write pg_lo_read_all pg_lo_import pg_lo_export pg_lo_seek pg_lo_tell pg_escape_string pg_escape_bytea pg_unescape_bytea pg_client_encoding pg_set_client_encoding pg_meta_data pg_convert pg_insert pg_update pg_delete pg_select pg_exec pg_getlastoid pg_cmdtuples pg_errormessage pg_numrows pg_numfields pg_fieldname pg_fieldsize pg_fieldtype pg_fieldnum pg_fieldprtlen pg_fieldisnull pg_freeresult pg_result pg_loreadall pg_locreate pg_lounlink pg_loopen pg_loclose pg_loread pg_lowrite pg_loimport pg_loexport echo print global static exit array empty eval isset unset die include require include_once require_once"),multiLineStrings:!0,hooks:{$:function(e){return e.eatWhile(/[\w\$_]/),"variable-2"},"<":function(e,n){return e.match(/<</)?(e.eatWhile(/[\w\.]/),n.tokenize=t(e.current().slice(3)),n.tokenize(e,n)):!1},"#":function(e){while(!e.eol()&&!e.match("?>",!1))e.next();return"comment"},"/":function(e){if(e.eat("/")){while(!e.eol()&&!e.match("?>",!1))e.next();return"comment"}return!1}}};CodeMirror.defineMode("php",function(e,t){function s(e,t){var n=t.curMode==i;e.sol()&&t.pending!='"'&&(t.pending=null);if(!n){if(e.match(/^<\?\w*/))return t.curMode=i,t.curState=t.php,"meta";if(t.pending=='"'){while(!e.eol()&&e.next()!='"');var s="string"}else if(t.pending&&e.pos<t.pending.end){e.pos=t.pending.end;var s=t.pending.style}else var s=r.token(e,t.curState);t.pending=null;var o=e.current(),u=o.search(/<\?/);return u!=-1&&(s=="string"&&/\"$/.test(o)&&!/\?>/.test(o)?t.pending='"':t.pending={end:e.pos,style:s},e.backUp(o.length-u)),s}return n&&t.php.tokenize==null&&e.match("?>")?(t.curMode=r,t.curState=t.html,"meta"):i.token(e,t.curState)}var r=CodeMirror.getMode(e,"text/html"),i=CodeMirror.getMode(e,n);return{startState:function(){var e=CodeMirror.startState(r),n=CodeMirror.startState(i);return{html:e,php:n,curMode:t.startOpen?i:r,curState:t.startOpen?n:e,pending:null}},copyState:function(e){var t=e.html,n=CodeMirror.copyState(r,t),s=e.php,o=CodeMirror.copyState(i,s),u;return e.curMode==r?u=n:u=o,{html:n,php:o,curMode:e.curMode,curState:u,pending:e.pending}},token:s,indent:function(e,t){return e.curMode!=i&&/^\s*<\//.test(t)||e.curMode==i&&/^\?>/.test(t)?r.indent(e.html,t):e.curMode.indent(e.curState,t)},electricChars:"/{}:",innerMode:function(e){return{state:e.curState,mode:e.curMode}}}},"htmlmixed"),CodeMirror.defineMIME("application/x-httpd-php","php"),CodeMirror.defineMIME("application/x-httpd-php-open",{name:"php",startOpen:!0}),CodeMirror.defineMIME("text/x-php",n)}(),define("thirdparty/CodeMirror2/mode/php/php",function(){}),CodeMirror.defineMode("coffeescript",function(e){function n(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}function y(e,n){if(e.sol()){var c=n.scopes[0].offset;if(e.eatSpace()){var h=e.indentation();return h>c?"indent":h<c?"dedent":null}c>0&&S(e,n)}if(e.eatSpace())return null;var m=e.peek();if(e.match("####"))return e.skipToEnd(),"comment";if(e.match("###"))return n.tokenize=w,n.tokenize(e,n);if(m==="#")return e.skipToEnd(),"comment";if(e.match(/^-?[0-9\.]/,!1)){var y=!1;e.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)&&(y=!0),e.match(/^-?\d+\.\d*/)&&(y=!0),e.match(/^-?\.\d+/)&&(y=!0);if(y)return e.peek()=="."&&e.backUp(1),"number";var E=!1;e.match(/^-?0x[0-9a-f]+/i)&&(E=!0),e.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)&&(E=!0),e.match(/^-?0(?![\dx])/i)&&(E=!0);if(E)return"number"}if(e.match(d))return n.tokenize=b(e.current(),"string"),n.tokenize(e,n);if(e.match(v)){if(e.current()!="/"||e.match(/^.*\//,!1))return n.tokenize=b(e.current(),"string-2"),n.tokenize(e,n);e.backUp(1)}return e.match(u)||e.match(o)?"punctuation":e.match(s)||e.match(r)||e.match(l)?"operator":e.match(i)?"punctuation":e.match(g)?"atom":e.match(p)?"keyword":e.match(a)?"variable":e.match(f)?"property":(e.next(),t)}function b(n,r){var i=n.length==1;return function(s,o){while(!s.eol()){s.eatWhile(/[^'"\/\\]/);if(s.eat("\\")){s.next();if(i&&s.eol())return r}else{if(s.match(n))return o.tokenize=y,r;s.eat(/['"\/]/)}}return i&&(e.mode.singleLineStringErrors?r=t:o.tokenize=y),r}}function w(e,t){while(!e.eol()){e.eatWhile(/[^#]/);if(e.match("###")){t.tokenize=y;break}e.eatWhile("#")}return"comment"}function E(t,n,r){r=r||"coffee";var i=0;if(r==="coffee"){for(var s=0;s<n.scopes.length;s++)if(n.scopes[s].type==="coffee"){i=n.scopes[s].offset+e.indentUnit;break}}else i=t.column()+t.current().length;n.scopes.unshift({offset:i,type:r})}function S(e,t){if(t.scopes.length==1)return;if(t.scopes[0].type==="coffee"){var n=e.indentation(),r=-1;for(var i=0;i<t.scopes.length;++i)if(n===t.scopes[i].offset){r=i;break}if(r===-1)return!0;while(t.scopes[0].offset!==n)t.scopes.shift();return!1}return t.scopes.shift(),!1}function x(e,n){var r=n.tokenize(e,n),i=e.current();if(i===".")return r=n.tokenize(e,n),i=e.current(),r==="variable"?"variable":t;i==="return"&&(n.dedent+=1),((i==="->"||i==="=>")&&!n.lambda&&n.scopes[0].type=="coffee"&&e.peek()===""||r==="indent")&&E(e,n);var s="[({".indexOf(i);return s!==-1&&E(e,n,"])}".slice(s,s+1)),c.exec(i)&&E(e,n),i=="then"&&S(e,n),r==="dedent"&&S(e,n)?t:(s="])}".indexOf(i),s!==-1&&S(e,n)?t:(n.dedent>0&&e.eol()&&n.scopes[0].type=="coffee"&&(n.scopes.length>1&&n.scopes.shift(),n.dedent-=1),r))}var t="error",r=new RegExp("^[\\+\\-\\*/%&|\\^~<>!?]"),i=new RegExp("^[\\(\\)\\[\\]\\{\\},:`=;\\.]"),s=new RegExp("^((->)|(=>)|(\\+\\+)|(\\+\\=)|(\\-\\-)|(\\-\\=)|(\\*\\*)|(\\*\\=)|(\\/\\/)|(\\/\\=)|(==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//))"),o=new RegExp("^((\\.\\.)|(\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),u=new RegExp("^((\\.\\.\\.)|(//=)|(>>=)|(<<=)|(\\*\\*=))"),a=new RegExp("^[_A-Za-z$][_A-Za-z$0-9]*"),f=new RegExp("^(@|this.)[_A-Za-z$][_A-Za-z$0-9]*"),l=n(["and","or","not","is","isnt","in","instanceof","typeof"]),c=["for","while","loop","if","unless","else","switch","try","catch","finally","class"],h=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","throw","when","until"],p=n(c.concat(h));c=n(c);var d=new RegExp("^('{3}|\"{3}|['\"])"),v=new RegExp("^(/{3}|/)"),m=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"],g=n(m),T={startState:function(e){return{tokenize:y,scopes:[{offset:e||0,type:"coffee"}],lastToken:null,lambda:!1,dedent:0}},token:function(e,t){var n=x(e,t);return t.lastToken={style:n,content:e.current()},e.eol()&&e.lambda&&(t.lambda=!1),n},indent:function(e){return e.tokenize!=y?0:e.scopes[0].offset}};return T}),CodeMirror.defineMIME("text/x-coffeescript","coffeescript"),define("thirdparty/CodeMirror2/mode/coffeescript/coffeescript",function(){}),CodeMirror.defineMode("clojure",function(){function a(e){var t={},n=e.split(" ");for(var r=0;r<n.length;++r)t[n[r]]=!0;return t}function d(e,t,n){this.indent=e,this.type=t,this.prev=n}function v(e,t,n){e.indentStack=new d(t,n,e.indentStack)}function m(e){e.indentStack=e.indentStack.prev}function g(e,t){return e==="0"&&t.eat(/x/i)?(t.eatWhile(p.hex),!0):((e=="+"||e=="-")&&p.digit.test(t.peek())&&(t.eat(p.sign),e=t.next()),p.digit.test(e)?(t.eat(e),t.eatWhile(p.digit),"."==t.peek()&&(t.eat("."),t.eatWhile(p.digit)),t.eat(p.exponent)&&(t.eat(p.sign),t.eatWhile(p.digit)),!0):!1)}var e="builtin",t="comment",n="string",r="atom",i="number",s="bracket",o="keyword",u=2,f=a("true false nil"),l=a("defn defn- def def- defonce defmulti defmethod defmacro defstruct deftype defprotocol defrecord defproject deftest slice defalias defhinted defmacro- defn-memo defnk defnk defonce- defunbound defunbound- defvar defvar- let letfn do case cond condp for loop recur when when-not when-let when-first if if-let if-not . .. -> ->> doto and or dosync doseq dotimes dorun doall load import unimport ns in-ns refer try catch finally throw with-open with-local-vars binding gen-class gen-and-load-class gen-and-save-class handler-case handle"),c=a("* *1 *2 *3 *agent* *allow-unresolved-vars* *assert *clojure-version* *command-line-args* *compile-files* *compile-path* *e *err* *file* *flush-on-newline* *in* *macro-meta* *math-context* *ns* *out* *print-dup* *print-length* *print-level* *print-meta* *print-readably* *read-eval* *source-path* *use-context-classloader* *warn-on-reflection* + - / < <= = == > >= accessor aclone agent agent-errors aget alength alias all-ns alter alter-meta! alter-var-root amap ancestors and apply areduce array-map aset aset-boolean aset-byte aset-char aset-double aset-float aset-int aset-long aset-short assert assoc assoc! assoc-in associative? atom await await-for await1 bases bean bigdec bigint binding bit-and bit-and-not bit-clear bit-flip bit-not bit-or bit-set bit-shift-left bit-shift-right bit-test bit-xor boolean boolean-array booleans bound-fn bound-fn* butlast byte byte-array bytes case cast char char-array char-escape-string char-name-string char? chars chunk chunk-append chunk-buffer chunk-cons chunk-first chunk-next chunk-rest chunked-seq? class class? clear-agent-errors clojure-version coll? comment commute comp comparator compare compare-and-set! compile complement concat cond condp conj conj! cons constantly construct-proxy contains? count counted? create-ns create-struct cycle dec decimal? declare definline defmacro defmethod defmulti defn defn- defonce defstruct delay delay? deliver deref derive descendants destructure disj disj! dissoc dissoc! distinct distinct? doall doc dorun doseq dosync dotimes doto double double-array doubles drop drop-last drop-while empty empty? ensure enumeration-seq eval even? every? extend extend-protocol extend-type extends? extenders false? ffirst file-seq filter find find-doc find-ns find-var first float float-array float? floats flush fn fn? fnext for force format future future-call future-cancel future-cancelled? future-done? future? gen-class gen-interface gensym get get-in get-method get-proxy-class get-thread-bindings get-validator hash hash-map hash-set identical? identity if-let if-not ifn? import in-ns inc init-proxy instance? int int-array integer? interleave intern interpose into into-array ints io! isa? iterate iterator-seq juxt key keys keyword keyword? last lazy-cat lazy-seq let letfn line-seq list list* list? load load-file load-reader load-string loaded-libs locking long long-array longs loop macroexpand macroexpand-1 make-array make-hierarchy map map? mapcat max max-key memfn memoize merge merge-with meta method-sig methods min min-key mod name namespace neg? newline next nfirst nil? nnext not not-any? not-empty not-every? not= ns ns-aliases ns-imports ns-interns ns-map ns-name ns-publics ns-refers ns-resolve ns-unalias ns-unmap nth nthnext num number? odd? or parents partial partition pcalls peek persistent! pmap pop pop! pop-thread-bindings pos? pr pr-str prefer-method prefers primitives-classnames print print-ctor print-doc print-dup print-method print-namespace-doc print-simple print-special-doc print-str printf println println-str prn prn-str promise proxy proxy-call-with-super proxy-mappings proxy-name proxy-super push-thread-bindings pvalues quot rand rand-int range ratio? rational? rationalize re-find re-groups re-matcher re-matches re-pattern re-seq read read-line read-string reify reduce ref ref-history-count ref-max-history ref-min-history ref-set refer refer-clojure release-pending-sends rem remove remove-method remove-ns repeat repeatedly replace replicate require reset! reset-meta! resolve rest resultset-seq reverse reversible? rseq rsubseq satisfies? second select-keys send send-off seq seq? seque sequence sequential? set set-validator! set? short short-array shorts shutdown-agents slurp some sort sort-by sorted-map sorted-map-by sorted-set sorted-set-by sorted? special-form-anchor special-symbol? split-at split-with str stream? string? struct struct-map subs subseq subvec supers swap! symbol symbol? sync syntax-symbol-anchor take take-last take-nth take-while test the-ns time to-array to-array-2d trampoline transient tree-seq true? type unchecked-add unchecked-dec unchecked-divide unchecked-inc unchecked-multiply unchecked-negate unchecked-remainder unchecked-subtract underive unquote unquote-splicing update-in update-proxy use val vals var-get var-set var? vary-meta vec vector vector? when when-first when-let when-not while with-bindings with-bindings* with-in-str with-loading-context with-local-vars with-meta with-open with-out-str with-precision xml-seq"),h=a("ns fn def defn defmethod bound-fn if if-not case condp when while when-not when-first do future comment doto locking proxy with-open with-precision reify deftype defrecord defprotocol extend extend-protocol extend-type try catch let letfn binding loop for doseq dotimes when-let if-let defstruct struct-map assoc testing deftest handler-case handle dotrace deftrace"),p={digit:/\d/,digit_or_colon:/[\d:]/,hex:/[0-9a-f]/i,sign:/[+-]/,exponent:/e/i,keyword_char:/[^\s\(\[\;\)\]]/,basic:/[\w\$_\-]/,lang_keyword:/[\w*+!\-_?:\/]/};return{startState:function(){return{indentStack:null,indentation:0,mode:!1}},token:function(a,d){d.indentStack==null&&a.sol()&&(d.indentation=a.indentation());if(a.eatSpace())return null;var y=null;switch(d.mode){case"string":var b,w=!1;while((b=a.next())!=null){if(b=='"'&&!w){d.mode=!1;break}w=!w&&b=="\\"}y=n;break;default:var E=a.next();if(E=='"')d.mode="string",y=n;else if(E=="'"&&!p.digit_or_colon.test(a.peek()))y=r;else if(E==";")a.skipToEnd(),y=t;else if(g(E,a))y=i;else if(E=="("||E=="["||E=="{"){var S="",x=a.column(),T;if(E=="(")while((T=a.eat(p.keyword_char))!=null)S+=T;S.length>0&&(h.propertyIsEnumerable(S)||/^(?:def|with)/.test(S))?v(d,x+u,E):(a.eatSpace(),a.eol()||a.peek()==";"?v(d,x+1,E):v(d,x+a.current().length,E)),a.backUp(a.current().length-1),y=s}else if(E==")"||E=="]"||E=="}")y=s,d.indentStack!=null&&d.indentStack.type==(E==")"?"(":E=="]"?"[":"{")&&m(d);else{if(E==":")return a.eatWhile(p.lang_keyword),r;a.eatWhile(p.basic),l&&l.propertyIsEnumerable(a.current())?y=o:c&&c.propertyIsEnumerable(a.current())?y=e:f&&f.propertyIsEnumerable(a.current())?y=r:y=null}}return y},indent:function(e){return e.indentStack==null?e.indentation:e.indentStack.indent}}}),CodeMirror.defineMIME("text/x-clojure","clojure"),define("thirdparty/CodeMirror2/mode/clojure/clojure",function(){}),CodeMirror.defineMode("perl",function(){function r(e,t,n,r,i){return t.chain=null,t.style=null,t.tail=null,t.tokenize=function(e,t){var o=!1,u,a=0;while(u=e.next()){if(u===n[a]&&!o)return n[++a]!==undefined?(t.chain=n[a],t.style=r,t.tail=i):i&&e.eatWhile(i),t.tokenize=s,r;o=!o&&u=="\\"}return r},t.tokenize(e,t)}function i(e,t,n){return t.tokenize=function(e,t){return e.string==n&&(t.tokenize=s),e.skipToEnd(),"string"},t.tokenize(e,t)}function s(s,o){if(s.eatSpace())return null;if(o.chain)return r(s,o,o.chain,o.style,o.tail);if(s.match(/^\-?[\d\.]/,!1)&&s.match(/^(\-?(\d*\.\d+(e[+-]?\d+)?|\d+\.\d*)|0x[\da-fA-F]+|0b[01]+|\d+(e[+-]?\d+)?)/))return"number";if(s.match(/^<<(?=\w)/))return s.eatWhile(/\w/),i(s,o,s.current().substr(2));if(s.sol()&&s.match(/^\=item(?!\w)/))return i(s,o,"=cut");var u=s.next();if(u=='"'||u=="'"){if(s.prefix(3)=="<<"+u){var a=s.pos;s.eatWhile(/\w/);var f=s.current().substr(1);if(f&&s.eat(u))return i(s,o,f);s.pos=a}return r(s,o,[u],"string")}if(u=="q"){var l=s.look(-2);if(!l||!/\w/.test(l)){l=s.look(0);if(l=="x"){l=s.look(1);if(l=="(")return s.eatSuffix(2),r(s,o,[")"],t,n);if(l=="[")return s.eatSuffix(2),r(s,o,["]"],t,n);if(l=="{")return s.eatSuffix(2),r(s,o,["}"],t,n);if(l=="<")return s.eatSuffix(2),r(s,o,[">"],t,n);if(/[\^'"!~\/]/.test(l))return s.eatSuffix(1),r(s,o,[s.eat(l)],t,n)}else if(l=="q"){l=s.look(1);if(l=="(")return s.eatSuffix(2),r(s,o,[")"],"string");if(l=="[")return s.eatSuffix(2),r(s,o,["]"],"string");if(l=="{")return s.eatSuffix(2),r(s,o,["}"],"string");if(l=="<")return s.eatSuffix(2),r(s,o,[">"],"string");if(/[\^'"!~\/]/.test(l))return s.eatSuffix(1),r(s,o,[s.eat(l)],"string")}else if(l=="w"){l=s.look(1);if(l=="(")return s.eatSuffix(2),r(s,o,[")"],"bracket");if(l=="[")return s.eatSuffix(2),r(s,o,["]"],"bracket");if(l=="{")return s.eatSuffix(2),r(s,o,["}"],"bracket");if(l=="<")return s.eatSuffix(2),r(s,o,[">"],"bracket");if(/[\^'"!~\/]/.test(l))return s.eatSuffix(1),r(s,o,[s.eat(l)],"bracket")}else if(l=="r"){l=s.look(1);if(l=="(")return s.eatSuffix(2),r(s,o,[")"],t,n);if(l=="[")return s.eatSuffix(2),r(s,o,["]"],t,n);if(l=="{")return s.eatSuffix(2),r(s,o,["}"],t,n);if(l=="<")return s.eatSuffix(2),r(s,o,[">"],t,n);if(/[\^'"!~\/]/.test(l))return s.eatSuffix(1),r(s,o,[s.eat(l)],t,n)}else if(/[\^'"!~\/(\[{<]/.test(l)){if(l=="(")return s.eatSuffix(1),r(s,o,[")"],"string");if(l=="[")return s.eatSuffix(1),r(s,o,["]"],"string");if(l=="{")return s.eatSuffix(1),r(s,o,["}"],"string");if(l=="<")return s.eatSuffix(1),r(s,o,[">"],"string");if(/[\^'"!~\/]/.test(l))return r(s,o,[s.eat(l)],"string")}}}if(u=="m"){var l=s.look(-2);if(!l||!/\w/.test(l)){l=s.eat(/[(\[{<\^'"!~\/]/);if(l){if(/[\^'"!~\/]/.test(l))return r(s,o,[l],t,n);if(l=="(")return r(s,o,[")"],t,n);if(l=="[")return r(s,o,["]"],t,n);if(l=="{")return r(s,o,["}"],t,n);if(l=="<")return r(s,o,[">"],t,n)}}}if(u=="s"){var l=/[\/>\]})\w]/.test(s.look(-2));if(!l){l=s.eat(/[(\[{<\^'"!~\/]/);if(l)return l=="["?r(s,o,["]","]"],t,n):l=="{"?r(s,o,["}","}"],t,n):l=="<"?r(s,o,[">",">"],t,n):l=="("?r(s,o,[")",")"],t,n):r(s,o,[l,l],t,n)}}if(u=="y"){var l=/[\/>\]})\w]/.test(s.look(-2));if(!l){l=s.eat(/[(\[{<\^'"!~\/]/);if(l)return l=="["?r(s,o,["]","]"],t,n):l=="{"?r(s,o,["}","}"],t,n):l=="<"?r(s,o,[">",">"],t,n):l=="("?r(s,o,[")",")"],t,n):r(s,o,[l,l],t,n)}}if(u=="t"){var l=/[\/>\]})\w]/.test(s.look(-2));if(!l){l=s.eat("r");if(l){l=s.eat(/[(\[{<\^'"!~\/]/);if(l)return l=="["?r(s,o,["]","]"],t,n):l=="{"?r(s,o,["}","}"],t,n):l=="<"?r(s,o,[">",">"],t,n):l=="("?r(s,o,[")",")"],t,n):r(s,o,[l,l],t,n)}}}if(u=="`")return r(s,o,[u],"variable-2");if(u=="/")return/~\s*$/.test(s.prefix())?r(s,o,[u],t,n):"operator";if(u=="$"){var a=s.pos;if(s.eatWhile(/\d/)||s.eat("{")&&s.eatWhile(/\d/)&&s.eat("}"))return"variable-2";s.pos=a}if(/[$@%]/.test(u)){var a=s.pos;if(s.eat("^")&&s.eat(/[A-Z]/)||!/[@$%&]/.test(s.look(-2))&&s.eat(/[=|\\\-#?@;:&`~\^!\[\]*'"$+.,\/<>()]/)){var l=s.current();if(e[l])return"variable-2"}s.pos=a}if(/[$@%&]/.test(u))if(s.eatWhile(/[\w$\[\]]/)||s.eat("{")&&s.eatWhile(/[\w$\[\]]/)&&s.eat("}")){var l=s.current();return e[l]?"variable-2":"variable"}if(u=="#"&&s.look(-2)!="$")return s.skipToEnd(),"comment";if(/[:+\-\^*$&%@=<>!?|\/~\.]/.test(u)){var a=s.pos;s.eatWhile(/[:+\-\^*$&%@=<>!?|\/~\.]/);if(e[s.current()])return"operator";s.pos=a}if(u=="_"&&s.pos==1){if(s.suffix(6)=="_END__")return r(s,o,["\0"],"comment");if(s.suffix(7)=="_DATA__")return r(s,o,["\0"],"variable-2");if(s.suffix(7)=="_C__")return r(s,o,["\0"],"string")}if(/\w/.test(u)){var a=s.pos;if(s.look(-2)=="{"&&(s.look(0)=="}"||s.eatWhile(/\w/)&&s.look(0)=="}"))return"string";s.pos=a}if(/[A-Z]/.test(u)){var c=s.look(-2),a=s.pos;s.eatWhile(/[A-Z_]/);if(!/[\da-z]/.test(s.look(0))){var l=e[s.current()];return l?(l[1]&&(l=l[0]),c!=":"?l==1?"keyword":l==2?"def":l==3?"atom":l==4?"operator":l==5?"variable-2":"meta":"meta"):"meta"}s.pos=a}if(/[a-zA-Z_]/.test(u)){var c=s.look(-2);s.eatWhile(/\w/);var l=e[s.current()];return l?(l[1]&&(l=l[0]),c!=":"?l==1?"keyword":l==2?"def":l==3?"atom":l==4?"operator":l==5?"variable-2":"meta":"meta"):"meta"}return null}var e={"->":4,"++":4,"--":4,"**":4,"=~":4,"!~":4,"*":4,"/":4,"%":4,x:4,"+":4,"-":4,".":4,"<<":4,">>":4,"<":4,">":4,"<=":4,">=":4,lt:4,gt:4,le:4,ge:4,"==":4,"!=":4,"<=>":4,eq:4,ne:4,cmp:4,"~~":4,"&":4,"|":4,"^":4,"&&":4,"||":4,"//":4,"..":4,"...":4,"?":4,":":4,"=":4,"+=":4,"-=":4,"*=":4,",":4,"=>":4,"::":4,not:4,and:4,or:4,xor:4,BEGIN:[5,1],END:[5,1],PRINT:[5,1],PRINTF:[5,1],GETC:[5,1],READ:[5,1],READLINE:[5,1],DESTROY:[5,1],TIE:[5,1],TIEHANDLE:[5,1],UNTIE:[5,1],STDIN:5,STDIN_TOP:5,STDOUT:5,STDOUT_TOP:5,STDERR:5,STDERR_TOP:5,$ARG:5,$_:5,"@ARG":5,"@_":5,$LIST_SEPARATOR:5,'$"':5,$PROCESS_ID:5,$PID:5,$$:5,$REAL_GROUP_ID:5,$GID:5,"$(":5,$EFFECTIVE_GROUP_ID:5,$EGID:5,"$)":5,$PROGRAM_NAME:5,$0:5,$SUBSCRIPT_SEPARATOR:5,$SUBSEP:5,"$;":5,$REAL_USER_ID:5,$UID:5,"$<":5,$EFFECTIVE_USER_ID:5,$EUID:5,"$>":5,$a:5,$b:5,$COMPILING:5,"$^C":5,$DEBUGGING:5,"$^D":5,"${^ENCODING}":5,$ENV:5,"%ENV":5,$SYSTEM_FD_MAX:5,"$^F":5,"@F":5,"${^GLOBAL_PHASE}":5,"$^H":5,"%^H":5,"@INC":5,"%INC":5,$INPLACE_EDIT:5,"$^I":5,"$^M":5,$OSNAME:5,"$^O":5,"${^OPEN}":5,$PERLDB:5,"$^P":5,$SIG:5,"%SIG":5,$BASETIME:5,"$^T":5,"${^TAINT}":5,"${^UNICODE}":5,"${^UTF8CACHE}":5,"${^UTF8LOCALE}":5,$PERL_VERSION:5,"$^V":5,"${^WIN32_SLOPPY_STAT}":5,$EXECUTABLE_NAME:5,"$^X":5,$1:5,$MATCH:5,"$&":5,"${^MATCH}":5,$PREMATCH:5,"$`":5,"${^PREMATCH}":5,$POSTMATCH:5,"$'":5,"${^POSTMATCH}":5,$LAST_PAREN_MATCH:5,"$+":5,$LAST_SUBMATCH_RESULT:5,"$^N":5,"@LAST_MATCH_END":5,"@+":5,"%LAST_PAREN_MATCH":5,"%+":5,"@LAST_MATCH_START":5,"@-":5,"%LAST_MATCH_START":5,"%-":5,$LAST_REGEXP_CODE_RESULT:5,"$^R":5,"${^RE_DEBUG_FLAGS}":5,"${^RE_TRIE_MAXBUF}":5,$ARGV:5,"@ARGV":5,ARGV:5,ARGVOUT:5,$OUTPUT_FIELD_SEPARATOR:5,$OFS:5,"$,":5,$INPUT_LINE_NUMBER:5,$NR:5,"$.":5,$INPUT_RECORD_SEPARATOR:5,$RS:5,"$/":5,$OUTPUT_RECORD_SEPARATOR:5,$ORS:5,"$\\":5,$OUTPUT_AUTOFLUSH:5,"$|":5,$ACCUMULATOR:5,"$^A":5,$FORMAT_FORMFEED:5,"$^L":5,$FORMAT_PAGE_NUMBER:5,"$%":5,$FORMAT_LINES_LEFT:5,"$-":5,$FORMAT_LINE_BREAK_CHARACTERS:5,"$:":5,$FORMAT_LINES_PER_PAGE:5,"$=":5,$FORMAT_TOP_NAME:5,"$^":5,$FORMAT_NAME:5,"$~":5,"${^CHILD_ERROR_NATIVE}":5,$EXTENDED_OS_ERROR:5,"$^E":5,$EXCEPTIONS_BEING_CAUGHT:5,"$^S":5,$WARNING:5,"$^W":5,"${^WARNING_BITS}":5,$OS_ERROR:5,$ERRNO:5,"$!":5,"%OS_ERROR":5,"%ERRNO":5,"%!":5,$CHILD_ERROR:5,"$?":5,$EVAL_ERROR:5,"$@":5,$OFMT:5,"$#":5,"$*":5,$ARRAY_BASE:5,"$[":5,$OLD_PERL_VERSION:5,"$]":5,"if":[1,1],elsif:[1,1],"else":[1,1],"while":[1,1],unless:[1,1],"for":[1,1],foreach:[1,1],abs:1,accept:1,alarm:1,atan2:1,bind:1,binmode:1,bless:1,bootstrap:1,"break":1,caller:1,chdir:1,chmod:1,chomp:1,chop:1,chown:1,chr:1,chroot:1,close:1,closedir:1,connect:1,"continue":[1,1],cos:1,crypt:1,dbmclose:1,dbmopen:1,"default":1,defined:1,"delete":1,die:1,"do":1,dump:1,each:1,endgrent:1,endhostent:1,endnetent:1,endprotoent:1,endpwent:1,endservent:1,eof:1,eval:1,exec:1,exists:1,exit:1,exp:1,fcntl:1,fileno:1,flock:1,fork:1,format:1,formline:1,getc:1,getgrent:1,getgrgid:1,getgrnam:1,gethostbyaddr:1,gethostbyname:1,gethostent:1,getlogin:1,getnetbyaddr:1,getnetbyname:1,getnetent:1,getpeername:1,getpgrp:1,getppid:1,getpriority:1,getprotobyname:1,getprotobynumber:1,getprotoent:1,getpwent:1,getpwnam:1,getpwuid:1,getservbyname:1,getservbyport:1,getservent:1,getsockname:1,getsockopt:1,given:1,glob:1,gmtime:1,"goto":1,grep:1,hex:1,"import":1,index:1,"int":1,ioctl:1,join:1,keys:1,kill:1,last:1,lc:1,lcfirst:1,length:1,link:1,listen:1,local:2,localtime:1,lock:1,log:1,lstat:1,m:null,map:1,mkdir:1,msgctl:1,msgget:1,msgrcv:1,msgsnd:1,my:2,"new":1,next:1,no:1,oct:1,open:1,opendir:1,ord:1,our:2,pack:1,"package":1,pipe:1,pop:1,pos:1,print:1,printf:1,prototype:1,push:1,q:null,qq:null,qr:null,quotemeta:null,qw:null,qx:null,rand:1,read:1,readdir:1,readline:1,readlink:1,readpipe:1,recv:1,redo:1,ref:1,rename:1,require:1,reset:1,"return":1,reverse:1,rewinddir:1,rindex:1,rmdir:1,s:null,say:1,scalar:1,seek:1,seekdir:1,select:1,semctl:1,semget:1,semop:1,send:1,setgrent:1,sethostent:1,setnetent:1,setpgrp:1,setpriority:1,setprotoent:1,setpwent:1,setservent:1,setsockopt:1,shift:1,shmctl:1,shmget:1,shmread:1,shmwrite:1,shutdown:1,sin:1,sleep:1,socket:1,socketpair:1,sort:1,splice:1,split:1,sprintf:1,sqrt:1,srand:1,stat:1,state:1,study:1,sub:1,substr:1,symlink:1,syscall:1,sysopen:1,sysread:1,sysseek:1,system:1,syswrite:1,tell:1,telldir:1,tie:1,tied:1,time:1,times:1,tr:null,truncate:1,uc:1,ucfirst:1,umask:1,undef:1,unlink:1,unpack:1,unshift:1,untie:1,use:1,utime:1,values:1,vec:1,wait:1,waitpid:1,wantarray:1,warn:1,when:1,write:1,y:null},t="string-2",n=/[goseximacplud]/;return{startState:function(){return{tokenize:s,chain:null,style:null,tail:null}},token:function(e,t){return(t.tokenize||s)(e,t)},electricChars:"{}"}}),CodeMirror.defineMIME("text/x-perl","perl"),CodeMirror.StringStream.prototype.look=function(e){return this.string.charAt(this.pos+(e||0))},CodeMirror.StringStream.prototype.prefix=function(e){if(e){var t=this.pos-e;return this.string.substr(t>=0?t:0,e)}return this.string.substr(0,this.pos-1)},CodeMirror.StringStream.prototype.suffix=function(e){var t=this.string.length,n=t-this.pos+1;return this.string.substr(this.pos,e&&e<t?e:n)},CodeMirror.StringStream.prototype.nsuffix=function(e){var t=this.pos,n=e||this.string.length-this.pos+1;return this.pos+=n,this.string.substr(t,n)},CodeMirror.StringStream.prototype.eatSuffix=function(e){var t=this.pos+e,n;t<=0?this.pos=0:t>=(n=this.string.length-1)?this.pos=n:this.pos=t},define("thirdparty/CodeMirror2/mode/perl/perl",function(){}),CodeMirror.defineMode("python",function(e,t){function r(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}function b(e,t){if(e.sol()){var r=t.scopes[0].offset;if(e.eatSpace()){var c=e.indentation();return c>r?y="indent":c<r&&(y="dedent"),null}r>0&&S(e,t)}if(e.eatSpace())return null;var h=e.peek();if(h==="#")return e.skipToEnd(),"comment";if(e.match(/^[0-9\.]/,!1)){var p=!1;e.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)&&(p=!0),e.match(/^\d+\.\d*/)&&(p=!0),e.match(/^\.\d+/)&&(p=!0);if(p)return e.eat(/J/i),"number";var d=!1;e.match(/^0x[0-9a-f]+/i)&&(d=!0),e.match(/^0b[01]+/i)&&(d=!0),e.match(/^0o[0-7]+/i)&&(d=!0),e.match(/^[1-9]\d*(e[\+\-]?\d+)?/)&&(e.eat(/J/i),d=!0),e.match(/^0(?![\dx])/i)&&(d=!0);if(d)return e.eat(/L/i),"number"}return e.match(v)?(t.tokenize=w(e.current()),t.tokenize(e,t)):e.match(a)||e.match(u)?null:e.match(o)||e.match(i)||e.match(l)?"operator":e.match(s)?null:e.match(m)?"keyword":e.match(g)?"builtin":e.match(f)?"variable":(e.next(),n)}function w(e){function s(s,o){while(!s.eol()){s.eatWhile(/[^'"\\]/);if(s.eat("\\")){s.next();if(r&&s.eol())return i}else{if(s.match(e))return o.tokenize=b,i;s.eat(/['"]/)}}if(r){if(t.singleLineStringErrors)return n;o.tokenize=b}return i}while("rub".indexOf(e.charAt(0).toLowerCase())>=0)e=e.substr(1);var r=e.length==1,i="string";return s.isString=!0,s}function E(t,n,r){r=r||"py";var i=0;if(r==="py"){if(n.scopes[0].type!=="py"){n.scopes[0].offset=t.indentation();return}for(var s=0;s<n.scopes.length;++s)if(n.scopes[s].type==="py"){i=n.scopes[s].offset+e.indentUnit;break}}else i=t.column()+t.current().length;n.scopes.unshift({offset:i,type:r})}function S(e,t,n){n=n||"py";if(t.scopes.length==1)return;if(t.scopes[0].type==="py"){var r=e.indentation(),i=-1;for(var s=0;s<t.scopes.length;++s)if(r===t.scopes[s].offset){i=s;break}if(i===-1)return!0;while(t.scopes[0].offset!==r)t.scopes.shift();return!1}return n==="py"?(t.scopes[0].offset=e.indentation(),!1):t.scopes[0].type!=n?!0:(t.scopes.shift(),!1)}function x(e,t){y=null;var r=t.tokenize(e,t),i=e.current();if(i===".")return r=e.match(f,!1)?null:n,r===null&&t.lastToken==="meta"&&(r="meta"),r;if(i==="@")return e.match(f,!1)?"meta":n;(r==="variable"||r==="builtin")&&t.lastToken==="meta"&&(r="meta");if(i==="pass"||i==="return")t.dedent+=1;i==="lambda"&&(t.lambda=!0),(i===":"&&!t.lambda&&t.scopes[0].type=="py"||y==="indent")&&E(e,t);var s="[({".indexOf(i);return s!==-1&&E(e,t,"])}".slice(s,s+1)),y==="dedent"&&S(e,t)?n:(s="])}".indexOf(i),s!==-1&&S(e,t,i)?n:(t.dedent>0&&e.eol()&&t.scopes[0].type=="py"&&(t.scopes.length>1&&t.scopes.shift(),t.dedent-=1),r))}var n="error",i=new RegExp("^[\\+\\-\\*/%&|\\^~<>!]"),s=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),o=new RegExp("^((==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))"),u=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),a=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))"),f=new RegExp("^[_A-Za-z][_A-Za-z0-9]*"),l=r(["and","or","not","is","in"]),c=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield"],h=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"],p={builtins:["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"],keywords:["exec","print"]},d={builtins:["ascii","bytes","exec","print"],keywords:["nonlocal","False","True","None"]};if(!t.version||parseInt(t.version,10)!==3){c=c.concat(p.keywords),h=h.concat(p.builtins);var v=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}else{c=c.concat(d.keywords),h=h.concat(d.builtins);var v=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i")}var m=r(c),g=r(h),y=null,T={startState:function(e){return{tokenize:b,scopes:[{offset:e||0,type:"py"}],lastToken:null,lambda:!1,dedent:0}},token:function(e,t){var n=x(e,t);return t.lastToken=n,e.eol()&&e.lambda&&(t.lambda=!1),n},indent:function(e){return e.tokenize!=b?e.tokenize.isString?CodeMirror.Pass:0:e.scopes[0].offset}};return T}),CodeMirror.defineMIME("text/x-python","python"),define("thirdparty/CodeMirror2/mode/python/python",function(){}),CodeMirror.defineMode("ruby",function(e){function t(e){var t={};for(var n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}function u(e,t,n){return n.tokenize.push(e),e(t,n)}function a(e,t){o=null;if(e.sol()&&e.match("=begin")&&e.eol())return t.tokenize.push(h),"comment";if(e.eatSpace())return null;var n=e.next(),r;if(n=="`"||n=="'"||n=='"'||n=="/"&&!e.eol()&&e.peek()!=" ")return u(l(n,"string",n=='"'||n=="`"),e,t);if(n=="%"){var i,a=!1;e.eat("s")?i="atom":e.eat(/[WQ]/)?(i="string",a=!0):e.eat(/[wxqr]/)&&(i="string");var f=e.eat(/[^\w\s]/);return f?(s.propertyIsEnumerable(f)&&(f=s[f]),u(l(f,i,a,!0),e,t)):"operator"}if(n=="#")return e.skipToEnd(),"comment";if(n=="<"&&(r=e.match(/^<-?[\`\"\']?([a-zA-Z_?]\w*)[\`\"\']?(?:;|$)/)))return u(c(r[1]),e,t);if(n=="0")return e.eat("x")?e.eatWhile(/[\da-fA-F]/):e.eat("b")?e.eatWhile(/[01]/):e.eatWhile(/[0-7]/),"number";if(/\d/.test(n))return e.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+\-]?[\d_]+)?/),"number";if(n=="?"){while(e.match(/^\\[CM]-/));return e.eat("\\")?e.eatWhile(/\w/):e.next(),"string"}return n==":"?e.eat("'")?u(l("'","atom",!1),e,t):e.eat('"')?u(l('"',"atom",!0),e,t):(e.eatWhile(/[\w\?]/),"atom"):n=="@"?(e.eat("@"),e.eatWhile(/[\w\?]/),"variable-2"):n=="$"?(e.next(),e.eatWhile(/[\w\?]/),"variable-3"):/\w/.test(n)?(e.eatWhile(/[\w\?]/),e.eat(":")?"atom":"ident"):n!="|"||!t.varList&&t.lastTok!="{"&&t.lastTok!="do"?/[\(\)\[\]{}\\;]/.test(n)?(o=n,null):n=="-"&&e.eat(">")?"arrow":/[=+\-\/*:\.^%<>~|]/.test(n)?(e.eatWhile(/[=+\-\/*:\.^%<>~|]/),"operator"):null:(o="|",null)}function f(){var e=1;return function(t,n){if(t.peek()=="}"){e--;if(e==0)return n.tokenize.pop(),n.tokenize[n.tokenize.length-1](t,n)}else t.peek()=="{"&&e++;return a(t,n)}}function l(e,t,n,r){return function(i,s){var o=!1,u;while((u=i.next())!=null){if(u==e&&(r||!o)){s.tokenize.pop();break}if(n&&u=="#"&&!o&&i.eat("{")){s.tokenize.push(f(arguments.callee));break}o=!o&&u=="\\"}return t}}function c(e){return function(t,n){return t.match(e)?n.tokenize.pop():t.skipToEnd(),"string"}}function h(e,t){return e.sol()&&e.match("=end")&&e.eol()&&t.tokenize.pop(),e.skipToEnd(),"comment"}var n=t(["alias","and","BEGIN","begin","break","case","class","def","defined?","do","else","elsif","END","end","ensure","false","for","if","in","module","next","not","or","redo","rescue","retry","return","self","super","then","true","undef","unless","until","when","while","yield","nil","raise","throw","catch","fail","loop","callcc","caller","lambda","proc","public","protected","private","require","load","require_relative","extend","autoload"]),r=t(["def","class","case","for","while","do","module","then","catch","loop","proc","begin"]),i=t(["end","until"]),s={"[":"]","{":"}","(":")"},o;return{startState:function(){return{tokenize:[a],indented:0,context:{type:"top",indented:-e.indentUnit},continuedLine:!1,lastTok:null,varList:!1}},token:function(e,t){e.sol()&&(t.indented=e.indentation());var s=t.tokenize[t.tokenize.length-1](e,t),u;if(s=="ident"){var a=e.current();s=n.propertyIsEnumerable(e.current())?"keyword":/^[A-Z]/.test(a)?"tag":t.lastTok=="def"||t.lastTok=="class"||t.varList?"def":"variable",r.propertyIsEnumerable(a)?u="indent":i.propertyIsEnumerable(a)?u="dedent":(a=="if"||a=="unless")&&e.column()==e.indentation()&&(u="indent")}if(o||s&&s!="comment")t.lastTok=a||o||s;return o=="|"&&(t.varList=!t.varList),u=="indent"||/[\(\[\{]/.test(o)?t.context={prev:t.context,type:o||s,indented:t.indented}:(u=="dedent"||/[\)\]\}]/.test(o))&&t.context.prev&&(t.context=t.context.prev),e.eol()&&(t.continuedLine=o=="\\"||s=="operator"),s},indent:function(t,n){if(t.tokenize[t.tokenize.length-1]!=a)return 0;var r=n&&n.charAt(0),i=t.context,o=i.type==s[r]||i.type=="keyword"&&/^(?:end|until|else|elsif|when|rescue)\b/.test(n);return i.indented+(o?0:e.indentUnit)+(t.continuedLine?e.indentUnit:0)},electricChars:"}de"}}),CodeMirror.defineMIME("text/x-ruby","ruby"),define("thirdparty/CodeMirror2/mode/ruby/ruby",function(){}),CodeMirror.defineMode("sass",function(e){function u(e){for(var t=0;t<n.length;t++)if(e===n[t])return!0}var t=function(e){return new RegExp("^"+e.join("|"))},n=["&","a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","keygen","kbd","label","legend","li","link","map","mark","menu","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],r=["true","false","null","auto"],i=new RegExp("^"+r.join("|")),s=["\\(","\\)","=",">","<","==",">=","<=","\\+","-","\\!=","/","\\*","%","and","or","not"],o=t(s),a=[":first-line",":hover",":first-letter",":active",":visited",":before",":after",":link",":focus",":first-child",":lang"],f=new RegExp("^("+a.join("\\b|")+")"),l=function(e,t){var n=e.peek();return n===")"?(e.next(),t.tokenizer=m,"operator"):n==="("?(e.next(),e.eatSpace(),"operator"):n==="'"||n==='"'?(t.tokenizer=h(e.next()),"string"):(t.tokenizer=h(")",!1),"string")},c=function(e,t){return e.skipTo("*/")?(e.next(),e.next(),t.tokenizer=m):e.next(),"comment"},h=function(e,t){function n(r,i){var s=r.next(),o=r.peek(),u=r.string.charAt(r.pos-2),a=s!=="\\"&&o===e||s===e&&u!=="\\";return a?(s!==e&&t&&r.next(),i.tokenizer=m,"string"):s==="#"&&o==="{"?(i.tokenizer=p(n),r.next(),"operator"):"string"}return t==null&&(t=!0),n},p=function(e){return function(t,n){return t.peek()==="}"?(t.next(),n.tokenizer=e,"operator"):m(t,n)}},d=function(t){if(t.indentCount==0){t.indentCount++;var n=t.scopes[0].offset,r=n+e.indentUnit;t.scopes.unshift({offset:r})}},v=function(e){if(e.scopes.length==1)return;e.scopes.shift()},m=function(e,t){var n=e.peek();if(e.match("//"))return e.skipToEnd(),"comment";if(e.match("/*"))return t.tokenizer=c,t.tokenizer(e,t);if(e.match("#{"))return t.tokenizer=p(m),"operator";if(n===".")return e.next(),e.match(/^[\w-]+/)?(d(t),"atom"):e.peek()==="#"?(d(t),"atom"):"operator";if(n==="#"){e.next();if(e.match(/[0-9a-fA-F]{6}|[0-9a-fA-F]{3}/))return"number";if(e.match(/^[\w-]+/))return d(t),"atom";if(e.peek()==="#")return d(t),"atom"}if(e.match(/^-?[0-9\.]+/))return"number";if(e.match(/^(px|em|in)\b/))return"unit";if(e.match(i))return"keyword";if(e.match(/^url/)&&e.peek()==="(")return t.tokenizer=l,"atom";if(n==="$")return e.next(),e.eatWhile(/[\w-]/),e.peek()===":"?(e.next(),"variable-2"):"variable-3";if(n==="!")return e.next(),e.match(/^[\w]+/)?"keyword":"operator";if(n==="=")return e.next(),e.match(/^[\w-]+/)?(d(t),"meta"):"operator";if(n==="+")return e.next(),e.match(/^[\w-]+/)?"variable-3":"operator";if(e.match(/^@(else if|if|media|else|for|each|while|mixin|function)/))return d(t),"meta";if(n==="@")return e.next(),e.eatWhile(/[\w-]/),"meta";if(n==='"'||n==="'")return e.next(),t.tokenizer=h(n),"string";if(e.match(f))return"keyword";if(e.eatWhile(/[\w-&]/)){var r=e.current();return e.peek()===":"?u(r)&&e.match(f,!1)?"atom":(e.next(),"property"):"atom"}return e.match(o)?"operator":(e.next(),"error")},g=function(t,n){t.sol()&&(n.indentCount=0);var r=n.tokenizer(t,n),i=t.current();i==="@return"&&v(n),r==="atom"&&u(i)&&d(n);if(r!=="error"){var s=t.pos-i.length,o=s+e.indentUnit*n.indentCount,a=[];for(var f=0;f<n.scopes.length;f++){var l=n.scopes[f];l.offset<=o&&a.push(l)}n.scopes=a}return r};return{startState:function(){return{tokenizer:m,scopes:[{offset:0,type:"sass"}],definedVars:[],definedMixins:[]}},token:function(e,t){var n=g(e,t);return t.lastToken={style:n,content:e.current()},n},indent:function(e){return e.scopes[0].offset}}}),CodeMirror.defineMIME("text/x-sass","sass"),define("thirdparty/CodeMirror2/mode/sass/sass",function(){}),CodeMirror.defineMode("lua",function(e,t){function r(e){return new RegExp("^(?:"+e.join("|")+")","i")}function i(e){return new RegExp("^(?:"+e.join("|")+")$","i")}function c(e){var t=0;while(e.eat("="))++t;return e.eat("["),t}function h(e,t){var n=e.next();return n=="-"&&e.eat("-")?e.eat("[")&&e.eat("[")?(t.cur=p(c(e),"comment"))(e,t):(e.skipToEnd(),"comment"):n=='"'||n=="'"?(t.cur=d(n))(e,t):n=="["&&/[\[=]/.test(e.peek())?(t.cur=p(c(e),"string"))(e,t):/\d/.test(n)?(e.eatWhile(/[\w.%]/),"number"):/[\w_]/.test(n)?(e.eatWhile(/[\w\\\-_.]/),"variable"):null}function p(e,t){return function(n,r){var i=null,s;while((s=n.next())!=null)if(i==null)s=="]"&&(i=0);else if(s=="=")++i;else{if(s=="]"&&i==e){r.cur=h;break}i=null}return t}}function d(e){return function(t,n){var r=!1,i;while((i=t.next())!=null){if(i==e&&!r)break;r=!r&&i=="\\"}return r||(n.cur=h),"string"}}var n=e.indentUnit,s=i(t.specials||[]),o=i(["_G","_VERSION","assert","collectgarbage","dofile","error","getfenv","getmetatable","ipairs","load","loadfile","loadstring","module","next","pairs","pcall","print","rawequal","rawget","rawset","require","select","setfenv","setmetatable","tonumber","tostring","type","unpack","xpcall","coroutine.create","coroutine.resume","coroutine.running","coroutine.status","coroutine.wrap","coroutine.yield","debug.debug","debug.getfenv","debug.gethook","debug.getinfo","debug.getlocal","debug.getmetatable","debug.getregistry","debug.getupvalue","debug.setfenv","debug.sethook","debug.setlocal","debug.setmetatable","debug.setupvalue","debug.traceback","close","flush","lines","read","seek","setvbuf","write","io.close","io.flush","io.input","io.lines","io.open","io.output","io.popen","io.read","io.stderr","io.stdin","io.stdout","io.tmpfile","io.type","io.write","math.abs","math.acos","math.asin","math.atan","math.atan2","math.ceil","math.cos","math.cosh","math.deg","math.exp","math.floor","math.fmod","math.frexp","math.huge","math.ldexp","math.log","math.log10","math.max","math.min","math.modf","math.pi","math.pow","math.rad","math.random","math.randomseed","math.sin","math.sinh","math.sqrt","math.tan","math.tanh","os.clock","os.date","os.difftime","os.execute","os.exit","os.getenv","os.remove","os.rename","os.setlocale","os.time","os.tmpname","package.cpath","package.loaded","package.loaders","package.loadlib","package.path","package.preload","package.seeall","string.byte","string.char","string.dump","string.find","string.format","string.gmatch","string.gsub","string.len","string.lower","string.match","string.rep","string.reverse","string.sub","string.upper","table.concat","table.insert","table.maxn","table.remove","table.sort"]),u=i(["and","break","elseif","false","nil","not","or","return","true","function","end","if","then","else","do","while","repeat","until","for","in","local"]),a=i(["function","if","repeat","do","\\(","{"]),f=i(["end","until","\\)","}"]),l=r(["end","until","\\)","}","else","elseif"]);return{startState:function(e){return{basecol:e||0,indentDepth:0,cur:h}},token:function(e,t){if(e.eatSpace())return null;var n=t.cur(e,t),r=e.current();return n=="variable"&&(u.test(r)?n="keyword":o.test(r)?n="builtin":s.test(r)&&(n="variable-2")),n!="comment"&&n!="string"&&(a.test(r)?++t.indentDepth:f.test(r)&&--t.indentDepth),n},indent:function(e,t){var r=l.test(t);return e.basecol+n*(e.indentDepth-(r?1:0))}}}),CodeMirror.defineMIME("text/x-lua","lua"),define("thirdparty/CodeMirror2/mode/lua/lua",function(){}),CodeMirror.defineMode("mysql",function(e){function r(e){return new RegExp("^(?:"+e.join("|")+")$","i")}function u(e,t){var r=e.next();n=null;if(r=="$"||r=="?")return e.match(/^[\w\d]*/),"variable-2";if(r=="<"&&!e.match(/^[\s\u00a0=]/,!1))return e.match(/^[^\s\u00a0>]*>?/),"atom";if(r=='"'||r=="'")return t.tokenize=a(r),t.tokenize(e,t);if(r=="`")return t.tokenize=f(r),t.tokenize(e,t);if(/[{}\(\),\.;\[\]]/.test(r))return n=r,null;if(r=="-"&&e.eat("-"))return e.skipToEnd(),"comment";if(r=="/"&&e.eat("*"))return t.tokenize=l,t.tokenize(e,t);if(o.test(r))return e.eatWhile(o),null;if(r==":")return e.eatWhile(/[\w\d\._\-]/),"atom";e.eatWhile(/[_\w\d]/);if(e.eat(":"))return e.eatWhile(/[\w\d_\-]/),"atom";var u=e.current();return i.test(u)?null:s.test(u)?"keyword":"variable"}function a(e){return function(t,n){var r=!1,i;while((i=t.next())!=null){if(i==e&&!r){n.tokenize=u;break}r=!r&&i=="\\"}return"string"}}function f(e){return function(t,n){var r=!1,i;while((i=t.next())!=null){if(i==e&&!r){n.tokenize=u;break}r=!r&&i=="\\"}return"variable-2"}}function l(e,t){for(;;){if(!e.skipTo("*")){e.skipToEnd();break}e.next();if(e.eat("/")){t.tokenize=u;break}}return"comment"}function c(e,t,n){e.context={prev:e.context,indent:e.indent,col:n,type:t}}function h(e){e.indent=e.context.indent,e.context=e.context.prev}var t=e.indentUnit,n,i=r(["str","lang","langmatches","datatype","bound","sameterm","isiri","isuri","isblank","isliteral","union","a"]),s=r(["ACCESSIBLE","ALTER","AS","BEFORE","BINARY","BY","CASE","CHARACTER","COLUMN","CONTINUE","CROSS","CURRENT_TIMESTAMP","DATABASE","DAY_MICROSECOND","DEC","DEFAULT","DESC","DISTINCT","DOUBLE","EACH","ENCLOSED","EXIT","FETCH","FLOAT8","FOREIGN","GRANT","HIGH_PRIORITY","HOUR_SECOND","IN","INNER","INSERT","INT2","INT8","INTO","JOIN","KILL","LEFT","LINEAR","LOCALTIME","LONG","LOOP","MATCH","MEDIUMTEXT","MINUTE_SECOND","NATURAL","NULL","OPTIMIZE","OR","OUTER","PRIMARY","RANGE","READ_WRITE","REGEXP","REPEAT","RESTRICT","RIGHT","SCHEMAS","SENSITIVE","SHOW","SPECIFIC","SQLSTATE","SQL_CALC_FOUND_ROWS","STARTING","TERMINATED","TINYINT","TRAILING","UNDO","UNLOCK","USAGE","UTC_DATE","VALUES","VARCHARACTER","WHERE","WRITE","ZEROFILL","ALL","AND","ASENSITIVE","BIGINT","BOTH","CASCADE","CHAR","COLLATE","CONSTRAINT","CREATE","CURRENT_TIME","CURSOR","DAY_HOUR","DAY_SECOND","DECLARE","DELETE","DETERMINISTIC","DIV","DUAL","ELSEIF","EXISTS","FALSE","FLOAT4","FORCE","FULLTEXT","HAVING","HOUR_MINUTE","IGNORE","INFILE","INSENSITIVE","INT1","INT4","INTERVAL","ITERATE","KEYS","LEAVE","LIMIT","LOAD","LOCK","LONGTEXT","MASTER_SSL_VERIFY_SERVER_CERT","MEDIUMINT","MINUTE_MICROSECOND","MODIFIES","NO_WRITE_TO_BINLOG","ON","OPTIONALLY","OUT","PRECISION","PURGE","READS","REFERENCES","RENAME","REQUIRE","REVOKE","SCHEMA","SELECT","SET","SPATIAL","SQLEXCEPTION","SQL_BIG_RESULT","SSL","TABLE","TINYBLOB","TO","TRUE","UNIQUE","UPDATE","USING","UTC_TIMESTAMP","VARCHAR","WHEN","WITH","YEAR_MONTH","ADD","ANALYZE","ASC","BETWEEN","BLOB","CALL","CHANGE","CHECK","CONDITION","CONVERT","CURRENT_DATE","CURRENT_USER","DATABASES","DAY_MINUTE","DECIMAL","DELAYED","DESCRIBE","DISTINCTROW","DROP","ELSE","ESCAPED","EXPLAIN","FLOAT","FOR","FROM","GROUP","HOUR_MICROSECOND","IF","INDEX","INOUT","INT","INT3","INTEGER","IS","KEY","LEADING","LIKE","LINES","LOCALTIMESTAMP","LONGBLOB","LOW_PRIORITY","MEDIUMBLOB","MIDDLEINT","MOD","NOT","NUMERIC","OPTION","ORDER","OUTFILE","PROCEDURE","READ","REAL","RELEASE","REPLACE","RETURN","RLIKE","SECOND_MICROSECOND","SEPARATOR","SMALLINT","SQL","SQLWARNING","SQL_SMALL_RESULT","STRAIGHT_JOIN","THEN","TINYTEXT","TRIGGER","UNION","UNSIGNED","USE","UTC_TIME","VARBINARY","VARYING","WHILE","XOR","FULL","COLUMNS","MIN","MAX","STDEV","COUNT"]),o=/[*+\-<>=&|]/;return{startState:function(){return{tokenize:u,context:null,indent:0,col:0}},token:function(e,t){e.sol()&&(t.context&&t.context.align==null&&(t.context.align=!1),t.indent=e.indentation());if(e.eatSpace())return null;var r=t.tokenize(e,t);r!="comment"&&t.context&&t.context.align==null&&t.context.type!="pattern"&&(t.context.align=!0);if(n=="(")c(t,")",e.column());else if(n=="[")c(t,"]",e.column());else if(n=="{")c(t,"}",e.column());else if(/[\]\}\)]/.test(n)){while(t.context&&t.context.type=="pattern")h(t);t.context&&n==t.context.type&&h(t)}else n=="."&&t.context&&t.context.type=="pattern"?h(t):/atom|string|variable/.test(r)&&t.context&&(/[\}\]]/.test(t.context.type)?c(t,"pattern",e.column()):t.context.type=="pattern"&&!t.context.align&&(t.context.align=!0,t.context.col=e.column()));return r},indent:function(e,n){var r=n&&n.charAt(0),i=e.context;if(/[\]\}]/.test(r))while(i&&i.type=="pattern")i=i.prev;var s=i&&r==i.type;return i?i.type=="pattern"?i.col:i.align?i.col+(s?0:1):i.indent+(s?0:t):0}}}),CodeMirror.defineMIME("text/x-mysql","mysql"),define("thirdparty/CodeMirror2/mode/mysql/mysql",function(){}),CodeMirror.defineMode("diff",function(){var e={"+":"positive","-":"negative","@":"meta"};return{token:function(t){var n=t.string.search(/[\t ]+?$/);if(!t.sol()||n===0)return t.skipToEnd(),("error "+(e[t.string.charAt(0)]||"")).replace(/ $/,"");var r=e[t.peek()]||t.skipToEnd();return n===-1?t.skipToEnd():t.pos=n,r}}}),CodeMirror.defineMIME("text/x-diff","diff"),define("thirdparty/CodeMirror2/mode/diff/diff",function(){}),CodeMirror.defineMode("markdown",function(e,t){function k(e,t,n){return t.f=t.inline=n,n(e,t)}function L(e,t,n){return t.f=t.block=n,n(e,t)}function A(e){return e.linkTitle=!1,e.em=!1,e.strong=!1,e.quote=!1,!n&&e.f==M&&(e.f=H,e.block=O),null}function O(e,n){n.list!==!1&&n.indentationDiff>=0?(n.indentationDiff<4&&(n.indentation-=n.indentationDiff),n.list=null):n.list=!1;if(n.indentationDiff>=4)return n.indentation-=4,e.skipToEnd(),l;if(e.eatSpace())return null;if(e.peek()==="#"||u&&e.match(N))n.header=!0;else if(e.eat(">"))n.indentation++,n.quote=!0;else{if(e.peek()==="[")return k(e,n,j);if(e.match(S,!0))return p;if(e.match(x,!0)||e.match(T,!0))n.indentation+=4,n.list=!0;else if(t.fencedCodeBlocks&&e.match(/^```([\w+#]*)/,!0))return n.localMode=s(RegExp.$1),n.localMode&&(n.localState=n.localMode.startState()),L(e,n,_),l}return k(e,n,n.inline)}function M(e,t){var i=r.token(e,t.htmlState);return n&&i==="tag"&&t.htmlState.type!=="openTag"&&!t.htmlState.context&&(t.f=H,t.block=O),t.md_inside&&e.current().indexOf(">")!=-1&&(t.f=H,t.block=O,t.htmlState.context=undefined),i}function _(e,t){return e.sol()&&e.match(/^```/,!0)?(t.localMode=t.localState=null,t.f=H,t.block=O,l):t.localMode?t.localMode.token(e,t.localState):(e.skipToEnd(),l)}function D(e){var t=[];return e.strong?t.push(e.em?E:w):e.em&&t.push(b),e.linkText&&t.push(g),e.code&&t.push(l),e.header&&t.push(f),e.quote&&t.push(c),e.list!==!1&&t.push(h),t.length?t.join(" "):null}function P(e,t){return e.match(C,!0)?D(t):undefined}function H(e,n){var r=n.text(e,n);if(typeof r!="undefined")return r;if(n.list)return n.list=null,h;var i=e.next();if(i==="\\")return e.next(),D(n);if(n.linkTitle){n.linkTitle=!1;var s=i;i==="("&&(s=")"),s=(s+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var u="^\\s*(?:[^"+s+"\\\\]+|\\\\\\\\|\\\\.)"+s;if(e.match(new RegExp(u),!0))return y}if(i==="`"){var a=D(n),f=e.pos;e.eatWhile("`");var l=1+e.pos-f;return n.code?l===o?(n.code=!1,a):D(n):(o=l,n.code=!0,D(n))}if(n.code)return D(n);if(i==="!"&&e.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return e.match(/\[[^\]]*\]/),n.inline=n.f=B,d;if(i==="["&&e.match(/.*\](\(| ?\[)/,!1))return n.linkText=!0,D(n);if(i==="]"&&n.linkText){var c=D(n);return n.linkText=!1,n.inline=n.f=B,c}if(i==="<"&&e.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!0))return k(e,n,R(v,">"));if(i==="<"&&e.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!0))return k(e,n,R(m,">"));if(i==="<"&&e.match(/^\w/,!1)){if(e.string.indexOf(">")!=-1){var p=e.string.substring(1,e.string.indexOf(">"));/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(p)&&(n.md_inside=!0)}return e.backUp(1),L(e,n,M)}if(i==="<"&&e.match(/^\/\w*?>/))return n.md_inside=!1,"tag";var g=!1;if(!t.underscoresBreakWords&&i==="_"&&e.peek()!=="_"&&e.match(/(\w)/,!1)){var b=e.pos-2;if(b>=0){var w=e.string.charAt(b);w!=="_"&&w.match(/(\w)/,!1)&&(g=!0)}}var a=D(n);if(i==="*"||i==="_"&&!g){if(n.strong===i&&e.eat(i))return n.strong=!1,a;if(!n.strong&&e.eat(i))return n.strong=i,D(n);if(n.em===i)return n.em=!1,a;if(!n.em)return n.em=i,D(n)}else if(i===" ")if(e.eat("*")||e.eat("_")){if(e.peek()===" ")return D(n);e.backUp(1)}return D(n)}function B(e,t){if(e.eatSpace())return null;var n=e.next();return n==="("||n==="["?k(e,t,R(y,n==="("?")":"]")):"error"}function j(e,t){return e.match(/^[^\]]*\]:/,!0)?(t.f=F,g):k(e,t,H)}function F(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),e.peek()===undefined?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),t.f=t.inline=H,y)}function q(e){return I[e]||(e=(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),I[e]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+e+")")),I[e]}function R(e,t,n){return n=n||H,function(r,i){return r.match(q(t)),i.inline=i.f=n,e}}var n=CodeMirror.mimeModes.hasOwnProperty("text/html"),r=CodeMirror.getMode(e,n?"text/html":"text/plain"),i={html:"htmlmixed",js:"javascript",json:"application/json",c:"text/x-csrc","c++":"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp","c#":"text/x-csharp",scala:"text/x-scala"},s=function(){var t,n={},r={},s,o=[];for(var u in CodeMirror.modes)CodeMirror.modes.propertyIsEnumerable(u)&&o.push(u);for(t=0;t<o.length;t++)n[o[t]]=o[t];var a=[];for(var u in CodeMirror.mimeModes)CodeMirror.mimeModes.propertyIsEnumerable(u)&&a.push({mime:u,mode:CodeMirror.mimeModes[u]});for(t=0;t<a.length;t++)s=a[t].mime,r[s]=a[t].mime;for(var f in i)if(i[f]in n||i[f]in r)n[f]=i[f];return function(t){return n[t]?CodeMirror.getMode(e,n[t]):null}}();t.underscoresBreakWords===undefined&&(t.underscoresBreakWords=!0),t.fencedCodeBlocks===undefined&&(t.fencedCodeBlocks=!1);var o=0,u=!1,a=!1,f="header",l="comment",c="quote",h="string",p="hr",d="tag",v="link",m="link",g="link",y="string",b="em",w="strong",E="emstrong",S=/^([*\-=_])(?:\s*\1){2,}\s*$/,x=/^[*\-+]\s+/,T=/^[0-9]+\.\s+/,N=/^(?:\={1,}|-{1,})$/,C=/^[^!\[\]*_\\<>` "'(]+/,I=[];return{startState:function(){return u=!1,a=!1,{f:O,block:O,htmlState:CodeMirror.startState(r),indentation:0,inline:H,text:P,linkText:!1,linkTitle:!1,em:!1,strong:!1,header:!1,list:!1,quote:!1}},copyState:function(e){return{f:e.f,block:e.block,htmlState:CodeMirror.copyState(r,e.htmlState),indentation:e.indentation,localMode:e.localMode,localState:e.localMode?CodeMirror.copyState(e.localMode,e.localState):null,inline:e.inline,text:e.text,linkTitle:e.linkTitle,em:e.em,strong:e.strong,header:e.header,list:e.list,quote:e.quote,md_inside:e.md_inside}},token:function(e,t){if(e.sol()){if(e.match(/^\s*$/,!0))return u=!1,A(t);a&&(u=!0,a=!1),a=!0,t.header=!1,t.code=!1,t.f=t.block;var n=e.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,r=Math.floor((n-t.indentation)/4)*4;r>4&&(r=4);var i=t.indentation+r;t.indentationDiff=i-t.indentation,t.indentation=i;if(n>0)return null}return t.f(e,t)},blankLine:A,getType:D}},"xml"),CodeMirror.defineMIME("text/x-markdown","markdown"),define("thirdparty/CodeMirror2/mode/markdown/markdown",function(){}),CodeMirror.defineMode("yaml",function(){var e=["true","false","on","off","yes","no"],t=new RegExp("\\b(("+e.join(")|(")+"))$","i");return{token:function(e,n){var r=e.peek(),i=n.escaped;n.escaped=!1;if(r=="#")return e.skipToEnd(),"comment";if(n.literal&&e.indentation()>n.keyCol)return e.skipToEnd(),"string";n.literal&&(n.literal=!1);if(e.sol()){n.keyCol=0,n.pair=!1,n.pairStart=!1;if(e.match(/---/))return"def";if(e.match(/\.\.\./))return"def";if(e.match(/\s*-\s+/))return"meta"}if(!n.pair&&e.match(/^\s*([a-z0-9\._-])+(?=\s*:)/i))return n.pair=!0,n.keyCol=e.indentation(),"atom";if(n.pair&&e.match(/^:\s*/))return n.pairStart=!0,"meta";if(e.match(/^(\{|\}|\[|\])/))return r=="{"?n.inlinePairs++:r=="}"?n.inlinePairs--:r=="["?n.inlineList++:n.inlineList--,"meta";if(n.inlineList>0&&!i&&r==",")return e.next(),"meta";if(n.inlinePairs>0&&!i&&r==",")return n.keyCol=0,n.pair=!1,n.pairStart=!1,e.next(),"meta";if(n.pairStart){if(e.match(/^\s*(\||\>)\s*/))return n.literal=!0,"meta";if(e.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable-2";if(n.inlinePairs==0&&e.match(/^\s*-?[0-9\.\,]+\s?$/))return"number";if(n.inlinePairs>0&&e.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(e.match(t))return"keyword"}return n.pairStart=!1,n.escaped=r=="\\",e.next(),null},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}}}}),CodeMirror.defineMIME("text/x-yaml","yaml"),define("thirdparty/CodeMirror2/mode/yaml/yaml",function(){}),CodeMirror.defineMode("haxe",function(e,t){function s(e,t,n){return t.tokenize=n,n(e,t)}function o(e,t){var n=!1,r;while((r=e.next())!=null){if(r==t&&!n)return!1;n=!n&&r=="\\"}return n}function f(e,t,n){return u=e,a=n,t}function l(e,t){var n=e.next();if(n=='"'||n=="'")return s(e,t,c(n));if(/[\[\]{}\(\),;\:\.]/.test(n))return f(n);if(n=="0"&&e.eat(/x/i))return e.eatWhile(/[\da-f]/i),f("number","number");if(/\d/.test(n)||n=="-"&&e.eat(/\d/))return e.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),f("number","number");if(t.reAllowed&&n=="~"&&e.eat(/\//))return o(e,"/"),e.eatWhile(/[gimsu]/),f("regexp","string-2");if(n=="/")return e.eat("*")?s(e,t,h):e.eat("/")?(e.skipToEnd(),f("comment","comment")):(e.eatWhile(i),f("operator",null,e.current()));if(n=="#")return e.skipToEnd(),f("conditional","meta");if(n=="@")return e.eat(/:/),e.eatWhile(/[\w_]/),f("metadata","meta");if(i.test(n))return e.eatWhile(i),f("operator",null,e.current());var u;if(/[A-Z]/.test(n))return e.eatWhile(/[\w_<>]/),u=e.current(),f("type","variable-3",u);e.eatWhile(/[\w_]/);var u=e.current(),a=r.propertyIsEnumerable(u)&&r[u];return a&&t.kwAllowed?f(a.type,a.style,u):f("variable","variable",u)}function c(e){return function(t,n){return o(t,e)||(n.tokenize=l),f("string","string")}}function h(e,t){var n=!1,r;while(r=e.next()){if(r=="/"&&n){t.tokenize=l;break}n=r=="*"}return f("comment","comment")}function d(e,t,n,r,i,s){this.indented=e,this.column=t,this.type=n,this.prev=i,this.info=s,r!=null&&(this.align=r)}function v(e,t){for(var n=e.localVars;n;n=n.next)if(n.name==t)return!0}function m(e,t,n,r,i){var s=e.cc;b.state=e,b.stream=i,b.marked=null,b.cc=s,e.lexical.hasOwnProperty("align")||(e.lexical.align=!0);for(;;){var o=s.length?s.pop():A;if(o(n,r)){while(s.length&&s[s.length-1].lex)s.pop()();return b.marked?b.marked:n=="variable"&&v(e,r)?"variable-2":n=="variable"&&g(e,r)?"variable-3":t}}}function g(e,t){if(/[a-z]/.test(t.charAt(0)))return!1;var n=e.importedtypes.length;for(var r=0;r<n;r++)if(e.importedtypes[r]==t)return!0}function y(e){var t=b.state;for(var n=t.importedtypes;n;n=n.next)if(n.name==e)return;t.importedtypes={name:e,next:t.importedtypes}}function w(){for(var e=arguments.length-1;e>=0;e--)b.cc.push(arguments[e])}function E(){return w.apply(null,arguments),!0}function S(e){var t=b.state;if(t.context){b.marked="def";for(var n=t.localVars;n;n=n.next)if(n.name==e)return;t.localVars={name:e,next:t.localVars}}}function T(){b.state.context||(b.state.localVars=x),b.state.context={prev:b.state.context,vars:b.state.localVars}}function N(){b.state.localVars=b.state.context.vars,b.state.context=b.state.context.prev}function C(e,t){var n=function(){var n=b.state;n.lexical=new d(n.indented,b.stream.column(),e,null,n.lexical,t)};return n.lex=!0,n}function k(){var e=b.state;e.lexical.prev&&(e.lexical.type==")"&&(e.indented=e.lexical.indented),e.lexical=e.lexical.prev)}function L(e){return function(t){return t==e?E():e==";"?w():E(arguments.callee)}}function A(e){return e=="@"?E(P):e=="var"?E(C("vardef"),z,L(";"),k):e=="keyword a"?E(C("form"),O,A,k):e=="keyword b"?E(C("form"),A,k):e=="{"?E(C("}"),T,U,k,N):e==";"?E():e=="attribute"?E(D):e=="function"?E($):e=="for"?E(C("form"),L("("),C(")"),X,L(")"),k,A,k):e=="variable"?E(C("stat"),F):e=="switch"?E(C("form"),O,C("}","switch"),L("{"),U,k,k):e=="case"?E(O,L(":")):e=="default"?E(L(":")):e=="catch"?E(C("form"),T,L("("),G,L(")"),A,k,N):e=="import"?E(B,L(";")):e=="typedef"?E(j):w(C("stat"),O,L(";"),k)}function O(e){return p.hasOwnProperty(e)?E(_):e=="function"?E($):e=="keyword c"?E(M):e=="("?E(C(")"),M,L(")"),k,_):e=="operator"?E(O):e=="["?E(C("]"),R(O,"]"),k,_):e=="{"?E(C("}"),R(q,"}"),k,_):E()}function M(e){return e.match(/[;\}\)\],]/)?w():w(O)}function _(e,t){if(e=="operator"&&/\+\+|--/.test(t))return E(_);if(e=="operator"||e==":")return E(O);if(e==";")return;if(e=="(")return E(C(")"),R(O,")"),k,_);if(e==".")return E(I,_);if(e=="[")return E(C("]"),O,L("]"),k,_)}function D(e){if(e=="attribute")return E(D);if(e=="function")return E($);if(e=="var")return E(z)}function P(e){if(e==":")return E(P);if(e=="variable")return E(P);if(e=="(")return E(C(")"),comasep(H,")"),k,A)}function H(e){if(e=="variable")return E()}function B(e,t){if(e=="variable"&&/[A-Z]/.test(t.charAt(0)))return y(t),E();if(e=="variable"||e=="property"||e==".")return E(B)}function j(e,t){if(e=="variable"&&/[A-Z]/.test(t.charAt(0)))return y(t),E()}function F(e){return e==":"?E(k,A):w(_,L(";"),k)}function I(e){if(e=="variable")return b.marked="property",E()}function q(e){e=="variable"&&(b.marked="property");if(p.hasOwnProperty(e))return E(L(":"),O)}function R(e,t){function n(r){return r==","?E(e,n):r==t?E():E(L(t))}return function(r){return r==t?E():w(e,n)}}function U(e){return e=="}"?E():w(A,U)}function z(e,t){return e=="variable"?(S(t),E(J,W)):E()}function W(e,t){if(t=="=")return E(O,W);if(e==",")return E(z)}function X(e,t){return e=="variable"&&S(t),E(C(")"),T,V,O,k,A,N)}function V(e,t){if(t=="in")return E()}function $(e,t){if(e=="variable")return S(t),E($);if(t=="new")return E($);if(e=="(")return E(C(")"),T,R(G,")"),k,J,A,N)}function J(e){if(e==":")return E(K)}function K(e){if(e=="type")return E();if(e=="variable")return E();if(e=="{")return E(C("}"),R(Q,"}"),k)}function Q(e){if(e=="variable")return E(J)}function G(e,t){if(e=="variable")return S(t),E(J)}var n=e.indentUnit,r=function(){function e(e){return{type:e,style:"keyword"}}var t=e("keyword a"),n=e("keyword b"),r=e("keyword c"),i=e("operator"),s={type:"atom",style:"atom"},o={type:"attribute",style:"attribute"},u=e("typedef");return{"if":t,"while":t,"else":n,"do":n,"try":n,"return":r,"break":r,"continue":r,"new":r,"throw":r,"var":e("var"),inline:o,"static":o,using:e("import"),"public":o,"private":o,cast:e("cast"),"import":e("import"),macro:e("macro"),"function":e("function"),"catch":e("catch"),untyped:e("untyped"),callback:e("cb"),"for":e("for"),"switch":e("switch"),"case":e("case"),"default":e("default"),"in":i,never:e("property_access"),trace:e("trace"),"class":u,"enum":u,"interface":u,typedef:u,"extends":u,"implements":u,dynamic:u,"true":s,"false":s,"null":s}}(),i=/[+\-*&%=<>!?|]/,u,a,p={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},b={state:null,column:null,marked:null,cc:null},x={name:"this",next:null};return k.lex=!0,{startState:function(e){var r=["Int","Float","String","Void","Std","Bool","Dynamic","Array"];return{tokenize:l,reAllowed:!0,kwAllowed:!0,cc:[],lexical:new d((e||0)-n,0,"block",!1),localVars:t.localVars,importedtypes:r,context:t.localVars&&{vars:t.localVars},indented:0}},token:function(e,t){e.sol()&&(t.lexical.hasOwnProperty("align")||(t.lexical.align=!1),t.indented=e.indentation());if(e.eatSpace())return null;var n=t.tokenize(e,t);return u=="comment"?n:(t.reAllowed=u=="operator"||u=="keyword c"||!!u.match(/^[\[{}\(,;:]$/),t.kwAllowed=u!=".",m(t,n,u,a,e))},indent:function(e,t){if(e.tokenize!=l)return 0;var r=t&&t.charAt(0),i=e.lexical;i.type=="stat"&&r=="}"&&(i=i.prev);var s=i.type,o=r==s;return s=="vardef"?i.indented+4:s=="form"&&r=="{"?i.indented:s=="stat"||s=="form"?i.indented+n:i.info=="switch"&&!o?i.indented+(/^(?:case|default)\b/.test(t)?n:2*n):i.align?i.column+(o?0:1):i.indented+(o?0:n)},electricChars:"{}"}}),CodeMirror.defineMIME("text/x-haxe","haxe"),define("thirdparty/CodeMirror2/mode/haxe/haxe",function(){}),define("editor/EditorUtils",["require","exports","module","thirdparty/path-utils/path-utils.min","thirdparty/CodeMirror2/mode/xml/xml","thirdparty/CodeMirror2/mode/javascript/javascript","thirdparty/CodeMirror2/mode/css/css","thirdparty/CodeMirror2/mode/less/less","thirdparty/CodeMirror2/mode/htmlmixed/htmlmixed","thirdparty/CodeMirror2/mode/clike/clike","thirdparty/CodeMirror2/mode/php/php","thirdparty/CodeMirror2/mode/coffeescript/coffeescript","thirdparty/CodeMirror2/mode/clojure/clojure","thirdparty/CodeMirror2/mode/perl/perl","thirdparty/CodeMirror2/mode/python/python","thirdparty/CodeMirror2/mode/ruby/ruby","thirdparty/CodeMirror2/mode/sass/sass","thirdparty/CodeMirror2/mode/lua/lua","thirdparty/CodeMirror2/mode/mysql/mysql","thirdparty/CodeMirror2/mode/diff/diff","thirdparty/CodeMirror2/mode/markdown/markdown","thirdparty/CodeMirror2/mode/yaml/yaml","thirdparty/CodeMirror2/mode/haxe/haxe"],function(e,t,n){function r(e){var t=PathUtils.filenameExtension(e);t||(t=e),t.charAt(0)==="."&&(t=t.substr(1)),t=t.toLowerCase();switch(t){case"js":return"javascript";case"json":return{name:"javascript",json:!0};case"css":return"css";case"less":return"less";case"html":case"htm":case"shtm":case"shtml":case"xhtml":case"cfm":case"cfml":case"cfc":case"dhtml":case"xht":return"htmlmixed";case"svg":case"xml":case"wxs":case"wxl":return"xml";case"php":case"php3":case"php4":case"php5":case"phtm":case"phtml":case"ctp":return"php";case"cc":case"cp":case"cpp":case"c++":case"cxx":case"hh":case"hpp":case"hxx":case"h++":case"ii":return"text/x-c++src";case"c":case"h":case"i":return"text/x-csrc";case"cs":return"text/x-csharp";case"java":return"text/x-java";case"coffee":return"coffeescript";case"clj":return"clojure";case"pl":return"perl";case"rb":return"ruby";case"py":case"pyw":return"python";case"sass":case"scss":return"sass";case"lua":return"lua";case"sql":return"mysql";case"diff":case"patch":return"diff";case"md":case"markdown":return"markdown";case"yaml":case"yml":return"yaml";case"hx":return"haxe";default:return console.log("Called EditorUtils.js _getModeFromFileExtensions with an unhandled file extension: "+t),""}}e("thirdparty/path-utils/path-utils.min"),e("thirdparty/CodeMirror2/mode/xml/xml"),e("thirdparty/CodeMirror2/mode/javascript/javascript"),e("thirdparty/CodeMirror2/mode/css/css"),e("thirdparty/CodeMirror2/mode/less/less"),e("thirdparty/CodeMirror2/mode/htmlmixed/htmlmixed"),e("thirdparty/CodeMirror2/mode/clike/clike"),e("thirdparty/CodeMirror2/mode/php/php"),e("thirdparty/CodeMirror2/mode/coffeescript/coffeescript"),e("thirdparty/CodeMirror2/mode/clojure/clojure"),e("thirdparty/CodeMirror2/mode/perl/perl"),e("thirdparty/CodeMirror2/mode/python/python"),e("thirdparty/CodeMirror2/mode/ruby/ruby"),e("thirdparty/CodeMirror2/mode/sass/sass"),e("thirdparty/CodeMirror2/mode/lua/lua"),e("thirdparty/CodeMirror2/mode/mysql/mysql"),e("thirdparty/CodeMirror2/mode/diff/diff"),e("thirdparty/CodeMirror2/mode/markdown/markdown"),e("thirdparty/CodeMirror2/mode/yaml/yaml"),e("thirdparty/CodeMirror2/mode/haxe/haxe"),t.getModeFromFileExtension=r}),define("text!widgets/StatusBar.html",[],function(){return'<div id="status-bar" class="statusbar no-focus">\n    <div id="status-info" class="info" >\n        <div id="status-cursor"></div>\n    </div>\n    <div id="status-indicators" class="indicators">\n        <div id="gold-star" title="{{JSLINT_NO_ERRORS}}">&#9733;</div>\n        <div id="status-file"></div>\n        <div id="status-mode"></div>\n        <div id="status-indent">\n            <div id="indent-type"></div>\n            <div id="indent-width-label"></div>\n            <input id="indent-width-input" type="number" min="1" max="10" maxlength="2" size="2" class="hidden">\n        </div>\n        <div id="busy-indicator"></div>\n    </div>\n</div>'}),define("widgets/StatusBar",["require","exports","module","utils/AppInit","text!widgets/StatusBar.html","editor/EditorManager","strings"],function(e,t,n){function d(e){if(!u)return;e&&(a=!0,$("*").addClass("busyCursor")),p.addClass("spin")}function v(){if(!u)return;a&&(a=!1,$("*").removeClass("busyCursor")),p.removeClass("spin")}function m(e,t,n,r,i,s){if(!u)return;t=t||document.createElement("div"),i=i||"",r=r||"",e=e.replace(f,"-")||"";var o=$(t);o.attr("id",e),o.attr("title",i),o.addClass("indicator"),o.addClass("style"),n||o.hide(),h.prepend(o)}function g(e,t,n,r,i){if(!u)return;var s=$("#"+e.replace(f,"-"));s&&(t?s.show():s.hide(),n?(s.removeClass(),s.addClass(n)):(s.removeClass(),s.addClass("indicator")),r&&s.attr("title",r))}function y(){if(!u)return;c.is(":visible")&&(c.hide(),s.resizeEditor())}function b(){if(!u)return;c.is(":visible")||(c.show(),s.resizeEditor())}function w(e){if(u)return;e=e||$("body"),e.append(Mustache.render(i,o)),c=$("#status-bar"),h=$("#status-indicators"),p=$("#busy-indicator"),u=!0,y()}function E(e){var t=typeof e=="string"?e:e.name,n,r;return t=t.toLowerCase(),t==="javascript"?"JavaScript":t==="html"||t==="htmlmixed"?"HTML":t==="css"?"CSS":t==="less"?"LESS":t==="text/plain"?"Text":t==="php"?"PHP":t==="xml"?"XML":t==="yaml"?"YAML":t==="coffeescript"?"CoffeeScript":t==="mysql"?"SQL":(t=t.replace(/^(text\/|application\/)/,""),t=t.replace(/^x-/,""),n=t.indexOf("/"),n!==-1&&(t=t.substr(0,n)),r=t[0].toUpperCase(),r+=t.substr(1),r)}var r=e("utils/AppInit"),i=e("text!widgets/StatusBar.html"),s=e("editor/EditorManager"),o=e("strings"),u=!1,a=!1,f=new RegExp("[^a-zA-Z 0-9]+","g"),l,c,h,p;t.init=w,t.showBusyIndicator=d,t.hideBusyIndicator=v,t.addIndicator=m,t.updateIndicator=g,t.getModeDisplayString=E,t.hide=y,t.show=b}),define("editor/EditorManager",["require","exports","module","utils/AppInit","file/FileUtils","command/Commands","command/CommandManager","document/DocumentManager","utils/PerfUtils","editor/Editor","editor/InlineTextEditor","utils/KeyEvent","editor/EditorUtils","utils/ViewUtils","widgets/StatusBar","strings","utils/StringUtils"],function(e,t,n){function A(e,t,n,r){var i=h.getModeFromFileExtension(e.file.fullPath);return new f(e,t,i,n,r)}function O(e){a.markStart(a.INLINE_EDITOR_OPEN);var t=e.getCursorPos(),n,r,i=new $.Deferred;for(r=0;r<S.length&&!n;r++){var s=S[r];n=s(e,t)}return n?n.done(function(n){e.addInlineWidget(t,n),a.addMeasurement(a.INLINE_EDITOR_OPEN),i.resolve()}).fail(function(){a.finalizeMeasurement(a.INLINE_EDITOR_OPEN),i.reject()}):(a.finalizeMeasurement(a.INLINE_EDITOR_OPEN),i.reject()),i.promise()}function M(e,t){if(t.hasFocus()){var n=e._codeMirror.getLineNumber(t.info.line),r=e.getCursorPos().line;r!==n&&e.setCursorPos({line:n,pos:0}),e.focus()}e.removeInlineWidget(t)}function _(e){S.push(e)}function D(e){var t=[];return e&&e.getInlineWidgets().forEach(function(e){e instanceof l&&(t=t.concat(e.editors))}),t}function P(e){var t=g.get(0),n=A(e,!0,t);n.setVisible(!1)}function H(){return y}function B(e,t,n){var r=A(e,!1,n,t);return{content:n,editor:r}}function j(e){var t=e._masterEditor;if(!t)return;var n=u.getCurrentDocument()===e,r=u.findInWorkingSet(e.file.fullPath)!==-1;!n&&!r&&(t.destroy(),y===t&&(b=null,y=null))}function F(){w&&w.focus()}function I(){var e=$(".content").height();return g.siblings().each(function(t,n){var r=$(n);r.css("display")!=="none"&&(e-=r.outerHeight())}),Math.max(e,0)}function U(e){if(!g)return;var t=I();g.height(t);if(y){var n=y.getRootElement(),r=$(n).width();!n.style.height||$(n).height()!==t?($(n).height(t),e===undefined&&(e=q)):r!==E&&e===undefined&&(e=q),E=r,e===q&&y.refreshAll(!0)}}function z(){U(R)}function W(e){if(w===e)return;var n=w;w=e,$(t).triggerHandler("activeEditorChange",[e,n])}function X(e){b=e,y=e._masterEditor,y.setVisible(!0,!1),y.focus(),U(q)}function V(e){y?(y.setVisible(!1),j(b)):$("#not-editor").css("display","none"),e._masterEditor||P(e),X(e)}function J(){y&&(y.setVisible(!1),j(b),b=null,y=null,$("#not-editor").css("display",""),W(null))}function K(){var e=u.getCurrentDocument(),t=g.get(0),n=a.markStart("EditorManager._onCurrentDocumentChange():	"+(!e||e.file.fullPath));y&&p.removeScrollerShadow(t,y),e?(V(e),p.addScrollerShadow(t,y)):J(),a.addMeasurement(n)}function Q(e,t){var n=u.getOpenDocumentForPath(t.fullPath);n&&j(n)}function G(e,t){t.forEach(function(t){Q(e,t)})}function Y(e){if(y){console.error("Cannot change editor area after an editor has already been created!");return}g=e,U()}function Z(){var e=null;return y&&y.getInlineWidgets().forEach(function(t){t.hasFocus()&&(e=t)}),e}function et(){var e=Z();return e instanceof l?e.getFocusedEditor():null}function tt(){if(y){var e=et();if(e)return e;if(y.hasFocus())return y}return null}function nt(){return w}function rt(){var e=new $.Deferred;if(y){var t=Z();t?(a.markStart(a.INLINE_EDITOR_CLOSE),t.close(),a.addMeasurement(a.INLINE_EDITOR_CLOSE),e.resolve(!1)):O(y).done(function(){e.resolve(!0)}).fail(function(){e.reject()})}else e.reject();return e.promise()}function it(e){x.text(d.getModeDisplayString(e.getModeForDocument()))}function st(e){N.text(m.format(v.STATUSBAR_LINE_COUNT,e.lineCount()))}function ot(){var e=f.getUseTabChar();C.text(e?v.STATUSBAR_TAB_SIZE:v.STATUSBAR_SPACES),C.attr("title",e?v.STATUSBAR_INDENT_TOOLTIP_SPACES:v.STATUSBAR_INDENT_TOOLTIP_TABS),k.attr("title",e?v.STATUSBAR_INDENT_SIZE_TOOLTIP_TABS:v.STATUSBAR_INDENT_SIZE_TOOLTIP_SPACES)}function ut(){return f.getUseTabChar()?f.getTabSize():f.getIndentUnit()}function at(){var e=ut();k.text(e),L.val(e)}function ft(){f.setUseTabChar(!f.getUseTabChar()),ot(),at()}function lt(e,t){t=t||tt();var n=t.getCursorPos(!0);T.text(m.format(v.STATUSBAR_CURSOR_POSITION,n.line+1,n.ch+1))}function ct(e){k.removeClass("hidden"),L.addClass("hidden"),L.off("blur keyup"),F();if(!e||isNaN(e))return;f.getUseTabChar()?f.setTabSize(Math.max(Math.min(e,10),1)):f.setIndentUnit(Math.max(Math.min(e,10),1)),at(),lt()}function ht(e,t,n){n&&($(n).off("cursorActivity.statusbar"),$(n).off("change.statusbar")),t?(d.show(),$(t).on("cursorActivity.statusbar",lt),$(t).on("change.statusbar",function(){window.setTimeout(function(){st(t)},0)}),lt(null,t),it(t),st(t),ot(),at()):d.hide()}function pt(e,t,n){var r=H();r&&r.document.file.fullPath===n&&r.setModeForDocument(h.getModeFromFileExtension(r.document.file.fullPath))}function dt(){d.init($(".main-view .content")),x=$("#status-mode"),T=$("#status-cursor"),N=$("#status-file"),C=$("#indent-type"),k=$("#indent-width-label"),L=$("#indent-width-input"),C.on("click",ft),k.on("click",function(){L.val(ut()),k.addClass("hidden"),L.removeClass("hidden"),L.focus(),L.on("blur",function(){ct(L.val())}).on("keyup",function(e){e.keyCode===c.DOM_VK_RETURN?L.blur():e.keyCode===c.DOM_VK_ESCAPE&&ct(!1)})}),L.focus(function(){L.select()}),ht(null,tt(),null)}var r=e("utils/AppInit"),i=e("file/FileUtils"),s=e("command/Commands"),o=e("command/CommandManager"),u=e("document/DocumentManager"),a=e("utils/PerfUtils"),f=e("editor/Editor").Editor,l=e("editor/InlineTextEditor").InlineTextEditor,c=e("utils/KeyEvent"),h=e("editor/EditorUtils"),p=e("utils/ViewUtils"),d=e("widgets/StatusBar"),v=e("strings"),m=e("utils/StringUtils"),g=null,y=null,b=null,w=null,E=null,S=[],x,T,N,C,k,L,q="force",R="skip";o.register(v.CMD_TOGGLE_QUICK_EDIT,s.TOGGLE_QUICK_EDIT,rt),$(u).on("currentDocumentChange",K),$(u).on("workingSetRemove",Q),$(u).on("workingSetRemoveList",G),$(u).on("fileNameChange",pt),window.addEventListener("resize",z,!0),$(t).on("activeEditorChange",ht),r.htmlReady(dt),t._init=dt,t._openInlineWidget=O,t._notifyActiveEditorChanged=W,t._createFullEditorForDocument=P,t._destroyEditorIfUnneeded=j,t._doShow=X,t.REFRESH_FORCE=q,t.REFRESH_SKIP=R,t.setEditorHolder=Y,t.getCurrentFullEditor=H,t.createInlineEditorForDocument=B,t.focusEditor=F,t.getFocusedEditor=tt,t.getActiveEditor=nt,t.getFocusedInlineWidget=Z,t.resizeEditor=U,t.registerInlineEditProvider=_,t.getInlineEditors=D,t.closeInlineWidget=M}),define("document/DocumentManager",["require","exports","module","file/NativeFileSystem","project/ProjectManager","editor/EditorManager","preferences/PreferencesManager","file/FileUtils","command/CommandManager","utils/Async","utils/CollectionUtils","utils/PerfUtils","command/Commands"],function(e,t,n){function m(){return d}function x(){return g}function T(e,t){return t=t||g,l.indexOf(t,function(t,n){return t.fullPath===e})}function N(e){return T(e,b)}function C(){var e=[],t;for(t in S)S.hasOwnProperty(t)&&e.push(S[t]);return e}function k(e){if(T(e.fullPath)!==-1)return;e=new r.FileEntry(e.fullPath),g.push(e),d&&d.file.fullPath===e.fullPath?y.unshift(e):y.push(e),b.unshift(e),$(t).triggerHandler("workingSetAdd",e)}function L(e){var n=[];e.forEach(function(e,t){T(e.fullPath)===-1&&(n.push(e),g.push(e),d&&d.file.fullPath===e.fullPath?y.unshift(e):y.push(e),b.splice(t,1,e))}),$(t).triggerHandler("workingSetAddList",[n])}function A(e){var n=T(e.fullPath);if(n===-1)return;g.splice(n,1),y.splice(T(e.fullPath,y),1),b.splice(T(e.fullPath,b),1),$(t).triggerHandler("workingSetRemove",e)}function O(){var e=g;g=[],y=[],b=[],$(t).triggerHandler("workingSetRemoveList",[e])}function M(e){var t=T(e.file.fullPath,y);t!==-1&&(y.splice(t,1),y.unshift(e.file))}function _(e,n){var r=g.length-1,i;e>=0&&n<=r&&e>=0&&n<=r&&(i=g[e],g[e]=g[n],g[n]=i,$(t).triggerHandler("workingSetReorder"))}function D(e){g.sort(e),$(t).triggerHandler("workingSetSort")}function P(){w=!0}function H(){w&&(w=!1,M(d))}function B(e){if(e!==-1&&e!==1)return console.error("Illegal argument: inc = "+e),null;if(d){var t=T(d.file.fullPath,y);if(t!==-1){var n=t+e;return n>=y.length?n=0:n<0&&(n=y.length-1),y[n]}if(y.length>0)return y[0]}return null}function j(e){if(d===e)return;var n=c.markStart("setCurrentDocument:	"+e.file.fullPath);i.isWithinProject(e.file.fullPath)||k(e.file),w||M(e),d=e,$(t).triggerHandler("currentDocumentChange"),c.addMeasurement(n)}function F(){if(!d)return;d=null,$(t).triggerHandler("currentDocumentChange")}function I(e){if(d&&d.file.fullPath===e.fullPath){var t=B(1);t&&t.fullPath===d.file.fullPath&&(t=null),t?a.execute(h.FILE_OPEN,{fullPath:t.fullPath}).done(function(){console.assert(!d||d.file.fullPath!==e.fullPath)}).fail(function(){I(e)}):F()}A(e)}function q(){F(),O()}function R(){C().forEach(function(e){e._refCount===1&&e._masterEditor&&s._destroyEditorIfUnneeded(e)})}function U(e,t,n){if(!(this instanceof U))throw new Error("Document constructor must be called with 'new'");if(S[e.fullPath])throw new Error("Creating a document when one already exists, for: "+e);this.file=e,this.refreshText(n,t),R()}function z(e){var t=S[e],n=z._pendingDocumentPromises[e];if(t)return(new $.Deferred).resolve(t).promise();if(n)return n;var i=new $.Deferred,s=i.promise();z._pendingDocumentPromises[e]=s;var o=new r.FileEntry(e),a=c.markStart("getDocumentForPath:	"+e);return i.done(function(){c.addMeasurement(a)}).fail(function(){c.finalizeMeasurement(a)}),u.readAsText(o).always(function(){delete z._pendingDocumentPromises[e]}).done(function(e,n){t=new U(o,n,e),i.resolve(t)}).fail(function(e){i.reject(e)}),s}function W(e){return S[e]}function X(e){I(e);var t=W(e.fullPath);t&&$(t).triggerHandler("deleted"),t&&t._refCount>0&&console.log("WARNING: deleted Document still has "+t._refCount+" references. Did someone addRef() without listening for 'deleted'?")}function V(){if(E)return;var e=[],t=!1,n=x(),r=m(),s=i.getProjectRoot();if(!s)return;n.forEach(function(n,i){t=r&&n.fullPath===r.file.fullPath,e.push({file:n.fullPath,active:t})}),v.setValue("files_"+s.fullPath,e)}function J(){V(),E=!0}function K(e){E=!1;var t=i.getProjectRoot(),n=v.getValue("files_"+t.fullPath);if(!n)return;var s=[],o;n.forEach(function(e,t){s.push(new r.FileEntry(e.file)),e.active&&(o=e.file)}),L(s),!o&&g.length>0&&(o=g[0].fullPath);if(o){var u=a.execute(h.FILE_OPEN,{fullPath:o});e.promises.push(u)}}function Q(e,n,r){var i,s,o=[];for(s in S)if(S.hasOwnProperty(s)&&s.indexOf(e)===0){var a=s.replace(e,n);S[a]=S[s],o.push(s),u.updateFileEntryPath(S[a].file,e,n);if(!r)break}for(i=0;i<o.length;i++)delete S[o[i]];for(i=0;i<g.length;i++)u.updateFileEntryPath(g[i],e,n);$(t).triggerHandler("fileNameChange",[e,n])}var r=e("file/NativeFileSystem").NativeFileSystem,i=e("project/ProjectManager"),s=e("editor/EditorManager"),o=e("preferences/PreferencesManager"),u=e("file/FileUtils"),a=e("command/CommandManager"),f=e("utils/Async"),l=e("utils/CollectionUtils"),c=e("utils/PerfUtils"),h=e("command/Commands"),p="com.adobe.brackets.DocumentManager",d=null,v={},g=[],y=[],b=[],w=!1,E=!1,S={};U.prototype._refCount=0,U.prototype.file=null,U.prototype.isDirty=!1,U.prototype.diskTimestamp=null,U.prototype._text=null,U.prototype._masterEditor=null,U.prototype._lineEndings=null,U.prototype.addRef=function(){if(this._refCount===0){if(S[this.file.fullPath]){console.error("Document for this path already in _openDocuments!");return}S[this.file.fullPath]=this,$(t).triggerHandler("afterDocumentCreate",this)}this._refCount++},U.prototype.releaseRef=function(){this._refCount--;if(this._refCount<0){console.error("Document ref count has fallen below zero!");return}if(this._refCount===0){if(!S[this.file.fullPath]){console.error("Document with references was not in _openDocuments!");return}$(t).triggerHandler("beforeDocumentDelete",this),delete S[this.file.fullPath]}},U.prototype._makeEditable=function(e){this._masterEditor?console.error("Document is already editable"):(this._text=null,this._masterEditor=e,$(e).on("change",this._handleEditorChange.bind(this)))},U.prototype._makeNonEditable=function(){this._masterEditor?(this._text=this.getText(!0),this._masterEditor=null):console.error("Document is already non-editable")},U.prototype._ensureMasterEditor=function(){this._masterEditor||s._createFullEditorForDocument(this)},U.prototype.getText=function(e){if(this._masterEditor){var t=this._masterEditor._codeMirror.getValue();return e&&this._lineEndings===u.LINE_ENDINGS_CRLF?t.replace(/\n/g,"\r\n"):t}return e?this._text:this._text.replace(/\r\n/g,"\n")},U.prototype.setText=function(e){this._ensureMasterEditor(),this._masterEditor._codeMirror.setValue(e)},U.prototype.refreshText=function(e,n){var r=c.markStart("refreshText:	"+(!this.file||this.file.fullPath));this._masterEditor?this._masterEditor._resetText(e):(this._text=e,$(this).triggerHandler("change",[this,{text:e.split(/\r?\n/)}])),this._markClean(),this.diskTimestamp=n,this._lineEndings=u.sniffLineEndings(e),this._lineEndings||(this._lineEndings=u.getPlatformLineEndings()),$(t).triggerHandler("documentRefreshed",this),c.addMeasurement(r)},U.prototype.replaceRange=function(e,t,n,r){this._ensureMasterEditor(),this._masterEditor._codeMirror.replaceRange(e,t,n,r)},U.prototype.getRange=function(e,t){return this._ensureMasterEditor(),this._masterEditor._codeMirror.getRange(e,t)},U.prototype.getLine=function(e){return this._ensureMasterEditor(),this._masterEditor._codeMirror.getLine(e)},U.prototype.batchOperation=function(e){this._ensureMasterEditor();var t=this;t._masterEditor._codeMirror.operation(e)},U.prototype._handleEditorChange=function(e,n,r){var i=this.isDirty;this.isDirty=!n._codeMirror.isClean(),i!==this.isDirty&&($(t).triggerHandler("dirtyFlagChange",[this]),k(this.file)),$(this).triggerHandler("change",[this,r])},U.prototype._markClean=function(){this.isDirty=!1,this._masterEditor&&this._masterEditor._codeMirror.markClean(),$(t).triggerHandler("dirtyFlagChange",this)},U.prototype.notifySaved=function(){this._masterEditor||console.log("### Warning: saving a Document that is not modifiable!"),this._markClean(),$(t).triggerHandler("documentSaved",this);var e=this;this.file.getMetadata(function(t){e.diskTimestamp=t.modificationTime},function(t){console.log("Error updating timestamp after saving file: "+e.file.fullPath)})},U.prototype.toString=function(){var e=this.isDirty?" (dirty!)":" (clean)",t=this._masterEditor?" (Editable)":" (Non-editable)",n=" refs:"+this._refCount;return"[Document "+this.file.fullPath+e+t+n+"]"},z._pendingDocumentPromises={},t.Document=U,t.getCurrentDocument=m,t.getDocumentForPath=z,t.getOpenDocumentForPath=W,t.getWorkingSet=x,t.findInWorkingSet=T,t.findInWorkingSetAddedOrder=N,t.getAllOpenDocuments=C,t.setCurrentDocument=j,t.addToWorkingSet=k,t.addListToWorkingSet=L,t.removeFromWorkingSet=A,t.getNextPrevFile=B,t.swapWorkingSetIndexes=_,t.sortWorkingSet=D,t.beginDocumentNavigation=P,t.finalizeDocumentNavigation=H,t.closeFullEditor=I,t.closeAll=q,t.notifyFileDeleted=X,t.notifyPathNameChanged=Q,v=o.getPreferenceStorage(p),$(t).bind("currentDocumentChange workingSetAdd workingSetAddList workingSetRemove workingSetRemoveList fileNameChange workingSetReorder workingSetSort",V),c.createPerfMeasurement("DOCUMENT_MANAGER_GET_DOCUMENT_FOR_PATH","DocumentManager.getDocumentForPath()"),$(i).on("projectOpen",K),$(i).on("beforeProjectClose",J)}),define("project/FileViewController",["require","exports","module","document/DocumentManager","command/CommandManager","editor/EditorManager","utils/PerfUtils","command/Commands"],function(e,t,n){function h(){$(t).triggerHandler("documentSelectionFocusChange"),s.focusEditor()}function p(e){if(e!==l&&e!==f){console.error("Bad parameter passed to FileViewController.setFileViewFocus");return}c=e,$(t).triggerHandler("fileViewFocusChange")}function d(e,t){var n;if(t!==l&&t!==f){console.error("Bad parameter passed to FileViewController.openAndSelectDocument");return}a=!0,c=t;var s=r.getCurrentDocument();return s&&s.file.fullPath===e?(h(),n=(new $.Deferred).resolve().promise()):n=i.execute(u.FILE_OPEN,{fullPath:e}),n.always(function(){a=!1}),n}function v(e,t){var n=new $.Deferred,r=i.execute(u.FILE_ADD_TO_WORKING_SET,{fullPath:e});return r.done(function(e){c=t||f,h(),n.resolve(e)}).fail(function(e){n.reject(e)}),n.promise()}function m(){return c}var r=e("document/DocumentManager"),i=e("command/CommandManager"),s=e("editor/EditorManager"),o=e("utils/PerfUtils"),u=e("command/Commands"),a=!1,f="WorkingSetView",l="ProjectManager",c=l;$(r).on("workingSetAdd",function(e,n){c=f,$(t).triggerHandler("documentSelectionFocusChange")}),$(r).on("currentDocumentChange",function(e){var n;if(!a){var i=r.getCurrentDocument();n=o.markStart("FileViewController._onCurrentDocumentChange():	"+(!i||i.file.fullPath)),i&&r.findInWorkingSet(i.file.fullPath)!==-1?c=f:c=l}$(t).triggerHandler("documentSelectionFocusChange"),a||o.addMeasurement(n)}),t.getFileSelectionFocus=m,t.openAndSelectDocument=d,t.addToWorkingSetAndSelect=v,t.setFileViewFocus=p,t.WORKING_SET_VIEW=f,t.PROJECT_MANAGER=l}),define("nls/urls",["require","exports","module"],function(e,t,n){n.exports={root:!0,de:!0,fr:!0,es:!0,ru:!0}}),define("project/ProjectManager",["require","exports","module","utils/Global","thirdparty/jstree_pre1.0_fix_1/jquery.jstree","utils/AppInit","file/NativeFileSystem","preferences/PreferencesDialogs","preferences/PreferencesManager","document/DocumentManager","command/CommandManager","command/Commands","widgets/Dialogs","command/Menus","utils/StringUtils","strings","project/FileViewController","utils/PerfUtils","utils/ViewUtils","utils/CollectionUtils","file/FileUtils","file/NativeFileError","i18n!nls/urls","utils/KeyEvent"],function(e,t,n){function T(e){return e.length>0&&e[e.length-1]==="/"?e.slice(0,-1):e}function H(){return d.getFileSelectionFocus()===d.PROJECT_MANAGER}function B(e,t){t=t===undefined?!0:t,k&&(e&&!C&&k.triggerHandler("selectionChanged",t),S.triggerHandler("scroll"),x.triggerHandler("contentChanged"))}function j(){var e=x.jstree("get_selected");return e?e.data("entry"):null}function F(){B(!0)}function I(){var e=u.getCurrentDocument();e&&H()?$("#project-files-container li").is(function(t){var n=$(this).data("entry");return n&&n.fullPath===e.file.fullPath&&!x.jstree("is_selected",$(this))?(x.jstree("deselect_all"),x.jstree("select_node",$(this),!1),!0):!1}):x!==null&&(x.jstree("deselect_all"),N=null),B(!0)}function q(){return L}function R(){return"projectBaseUrl_"+L}function U(){return A}function z(){return O}function W(e){return O=e}function X(e){A=e,A.length>0&&A[A.length-1]!=="/"&&(A+="/"),_.setValue(R(),A)}function V(e){return L&&e.indexOf(L.fullPath)===0}function J(e){return V(e)?e.slice(L.fullPath.length):e}function K(e){var t="projectTreeState_"+e;return t[t.length-1]!=="/"&&(t+="/"),t}function Q(){_.setValue("projectPath",L.fullPath);var e=[],t=L.fullPath.length,n,r,i,s;$(".jstree-open:visible").each(function(o){n=$(this).data("entry"),n.fullPath&&(r=n.fullPath,i=r.slice(t,-1),s=i.split("/").length-1,e[s]===undefined&&(e[s]=[]),e[s].push(r))}),_.setValue(K(L.fullPath),e)}function G(e,t){var n=S.get(0).scrollTop;C=!0,x.jstree("deselect_node",e),x.jstree("select_node",t,!1),C=!1,S.get(0).scrollTop=n,B(!0,!1)}function Y(e){return $(e).closest("li").find("input").length>0}function Z(e){var t=new $.Deferred;return S.scrollTop(0),S.hide(),x=S.jstree({plugins:["ui","themes","json_data","crrm","sort"],ui:{select_limit:1,select_multiple_modifier:"",select_range_modifier:""},json_data:{data:e,correct_state:!1},core:{animation:0},themes:{theme:"brackets",url:"styles/jsTreeTheme.css",dots:!1,icons:!1},strings:{loading:"Loading ...",new_node:"New node"},sort:function(e,t){if(brackets.platform==="win"){var n=($(e).hasClass("jstree-leaf")?"1":"0")+this.get_text(e).toLowerCase(),r=($(t).hasClass("jstree-leaf")?"1":"0")+this.get_text(t).toLowerCase();return n>r?1:-1}return this.get_text(e).toLowerCase()>this.get_text(t).toLowerCase()?1:-1}}).bind("before.jstree",function(e,t){t.func==="toggle_node"&&(P=x.jstree("is_open",t.args[0]))}).bind("select_node.jstree",function(e,t){var n=t.rslt.obj.data("entry");if(n.isFile){var r=d.openAndSelectDocument(n.fullPath,d.PROJECT_MANAGER);r.done(function(){B(!0),N=t.rslt.obj}).fail(function(){N?G(t.rslt.obj,N):(x.jstree("deselect_all"),N=null)})}else d.setFileViewFocus(d.PROJECT_MANAGER),B(!0),P||x.jstree("toggle_node",t.rslt.obj);P=!1}).bind("reopen.jstree",function(e,n){if(D.previous.length>0){var r=D.previous.shift(),i=[],s=null;$.each(r,function(e,t){s=D.fullPathToIdMap[t],s&&i.push(s)}),n.inst.data.core.to_open=i,x.jstree("reload_nodes",!1)}D.previous.length===0&&t.resolve()}).bind("scroll.jstree",function(e){c.closeAll()}).bind("loaded.jstree open_node.jstree close_node.jstree",function(e,t){if(e.type==="open_node"){var n=u.getCurrentDocument();if(H()&&n&&t){var r=t.rslt.obj.data("entry");n.file.fullPath.indexOf(r.fullPath)===0?G(t.rslt.obj,N):B(!0,!1)}}else e.type==="close_node"?B(!0,!1):B(!1);Q()}).bind("mousedown.jstree",function(e){if(e.which===3){var t=$(e.target).closest("li");if(t){var n=P;P=!0,x.jstree("deselect_all"),x.jstree("select_node",t,!1),P=n}}}),x.bind("init.jstree",function(){m.addScrollerShadow(x.get(0)),x.unbind("dblclick.jstree").bind("dblclick.jstree",function(e){var t=$(e.target).closest("li").data("entry");t&&t.isFile&&!Y(e.target)&&d.addToWorkingSetAndSelect(t.fullPath)}),k=S.find("ul"),m.sidebarList(S,"jstree-clicked","jstree-leaf"),S.show()}),t.promise()}function et(e){if([".git",".gitignore",".gitmodules",".svn",".DS_Store","Thumbs.db"].indexOf(e.name)>-1)return!1;var t=e.name.split(".").pop();return["pyc"].indexOf(t)>-1?!1:!0}function tt(e){var t=[],n,r;for(r=0;r<e.length;r++){n=e[r];if(et(n)){var i={data:n.name,attr:{id:"node"+D.id++},metadata:{entry:n}};n.isDirectory&&(i.children=[],i.state="closed"),t.push(i),D.fullPathToIdMap[n.fullPath]=i.attr.id}}return t}function nt(e,t){var n,r=!1;e===-1?(n=L,r=!0):n=e.data("entry"),n.createReader().readEntries(function(n){var i=tt(n),s=!1,o=i.length===0;o&&(r?i.push({}):s=e.hasClass("jstree-open")),t(i);if(!r&&o){var u=s?"jstree-closed":"jstree-open";e.removeClass("jstree-leaf jstree-closed jstree-open").addClass(u),s||e.trigger("open_node.jstree")}},function(e){l.showModalDialog(l.DIALOG_ID_ERROR,p.ERROR_LOADING_PROJECT,h.format(p.READ_DIRECTORY_ENTRIES_ERROR,h.htmlEscape(n.fullPath),e.name))})}function rt(){var e=y.getNativeBracketsDirectoryPath(),t=w.GETTING_STARTED;return t&&(e=e.substr(0,e.lastIndexOf("/"))+"/samples/"+t),e}function it(e){var t=y.canonicalizeFolderPath(e);if(t===rt())return!0;var n=_.getValue("welcomeProjects")||[];return n.indexOf(t)!==-1}function st(e){return it(e)?rt():e}function ot(){return st(_.getValue("projectPath"))}function ut(e){L&&$(t).triggerHandler("beforeProjectClose",L),u.closeAll(),D.id=0;var n=new $.Deferred,r;return D.previous=_.getValue(K(e))||[],brackets.fs&&i.requestNativeFileSystem(e,function(i){var s=i.root,o=!L||!s||L.fullPath!==s.fullPath,a,f=v.markStart("Load Project: "+e),l=y.canonicalizeFolderPath(e);L=s,A=_.getValue(R())||"",u.getDocumentForPath(L.fullPath+"config.xml").done(function(e){O=$(e.getText()).find("tizen\\:application").attr("id")});if(l===rt()){var c=_.getValue("welcomeProjects")||[];c.indexOf(l)===-1&&(c.push(l),_.setValue("welcomeProjects",c))}r=Z(nt),r.done(function(){if(o){var e=[];$(t).triggerHandler({type:"projectOpen",promises:e},[L]),$.when.apply($,e).pipe(n.resolve,n.reject)}else n.resolve()}),r.fail(function(){v.terminateMeasurement(f),n.reject()}),r.always(function(){v.addMeasurement(f)})},function(t){l.showModalDialog(l.DIALOG_ID_ERROR,p.ERROR_LOADING_PROJECT,h.format(p.REQUEST_NATIVE_FILE_SYSTEM_ERROR,h.htmlEscape(e),t.name)).done(function(){ut(rt()).always(function(){n.reject()})})}),n.promise()}function at(e){function s(e,n){var o=i[n],u=g.indexOf(e,function(e,t){var n=$(e).data("entry").name;return n===o});if(u===-1)t.reject();else{var a=e.eq(u);if(n===i.length-1)t.resolve(a);else{var f=r._get_children(a);f.length>0?s(f,n+1):r.load_node(a,function(e){f=r._get_children(a),s(f,n+1)},function(e){t.reject()})}}}var t=new $.Deferred,n=J(e.fullPath);if(n===e.fullPath)return t.reject().promise();var r=$.jstree._reference(x),i=n.split("/");e.isDirectory&&i.pop();var o=r._get_children(-1);return s(o,0),t.promise()}function ft(e){return at(e).done(function(e){x.jstree("select_node",e,!1)})}function lt(e){var t=new $.Deferred;return a.execute(f.FILE_CLOSE_ALL,{promptOnly:!0}).done(function(){e?ut(e).pipe(t.resolve,t.reject):i.showOpenDialog(!1,!0,p.CHOOSE_FOLDER,L.fullPath,null,function(e){e.length>0?ut(e[0]).pipe(t.resolve,t.reject):t.reject()},function(e){l.showModalDialog(l.DIALOG_ID_ERROR,p.ERROR_LOADING_PROJECT,h.format(p.OPEN_DIALOG_ERROR,e.name)),t.reject()})}).fail(function(){t.reject()}),t.promise()}function ct(){return s.showProjectPreferencesDialog(U())}function ht(e){return e.search(/[\/?*:;\{\}<>\\|]+/)!==-1?(l.showModalDialog(l.DIALOG_ID_ERROR,p.INVALID_FILENAME_TITLE,p.INVALID_FILENAME_MESSAGE),!1):!0}function pt(e,n,r,i){function g(){x.jstree("create",s,a,{data:n},null,r);if(!r){var e=x.find(".jstree-rename-input");e.on("keydown",function(e){e.keyCode===E.DOM_VK_ESCAPE&&(f=!0)}),m.scrollElementIntoView(x,e,!0)}}var s=null,o=x.jstree("get_selected"),u=null,a="inside",f=!1,c=new $.Deferred,d=!0;o&&(u=o.data("entry"));if(u)if(u.isFile){a="after";var v=$.jstree._reference(x)._get_parent(o);typeof v.data=="function"?u=v.data("entry"):u=null}else u.isDirectory&&(d=o.hasClass("jstree-open"));return u||(u=q()),x.on("create.jstree",function(e,n){function r(){var e=n.inst._get_parent(n.rslt.obj);x.jstree("remove",n.rslt.obj);if(e&&e!==-1){var t=d?"open_node":"close_node",r=d?"jstree-open":"jstree-closed";x.jstree(t,e),e.removeClass("jstree-leaf jstree-closed jstree-open").addClass(r)}c.reject()}$(e.target).off("create.jstree");if(!f){if(!ht(n.rslt.name)){r();return}var s=function(e){n.rslt.obj.data("entry",e),i&&n.rslt.obj.removeClass("jstree-leaf jstree-closed jstree-open").addClass("jstree-closed"),i&&x.jstree("sort",n.rslt.obj.parent()),x.jstree("select_node",n.rslt.obj,!0),$(t).triggerHandler("projectFilesChange"),c.resolve(e)},o=function(e){if(e.name===b.PATH_EXISTS_ERR||e.name===b.TYPE_MISMATCH_ERR)l.showModalDialog(l.DIALOG_ID_ERROR,p.INVALID_FILENAME_TITLE,h.format(p.FILE_ALREADY_EXISTS,h.htmlEscape(n.rslt.name)));else{var t=e.name===b.NO_MODIFICATION_ALLOWED_ERR?p.NO_MODIFICATION_ALLOWED_ERR:h.format(p.GENERIC_ERROR,e.name),i=h.format(p.ERROR_CREATING_FILE,h.htmlEscape(n.rslt.name),t);l.showModalDialog(l.DIALOG_ID_ERROR,p.ERROR_CREATING_FILE_TITLE,i)}r()};i?u.getDirectory(n.rslt.name,{create:!0,exclusive:!0},s,o):u.getFile(n.rslt.name,{create:!0,exclusive:!0},s,o)}else r()}),s=o,d?g():(x.one("open_node.jstree",g),x.jstree("open_node",s)),c.promise()}function dt(e,n,r){var i=new $.Deferred;return e===n?(i.resolve(),i):(brackets.fs.rename(e,n,function(s){if(!s){var o=x.find(".jstree-leaf, .jstree-open, .jstree-closed"),a;for(a=0;a<o.length;a++){var f=$(o[a]);y.updateFileEntryPath(f.data("entry"),e,n)}$(t).triggerHandler("projectFilesChange"),u.notifyPathNameChanged(e,n,r),u.getCurrentDocument()&&d.openAndSelectDocument(u.getCurrentDocument().file.fullPath,d.getFileSelectionFocus()),B(!0),i.resolve()}else l.showModalDialog(l.DIALOG_ID_ERROR,p.ERROR_RENAMING_FILE_TITLE,h.format(p.ERROR_RENAMING_FILE,h.htmlEscape(n),s===brackets.fs.ERR_FILE_EXISTS?p.FILE_EXISTS_ERR:y.getFileErrorString(s))),i.reject(s)}),i)}function vt(e){ft(e).done(function(e){var t=e.hasClass("jstree-open")||e.hasClass("jstree-closed");x.one("rename.jstree",function(n,r){if(r.rslt.old_name===r.rslt.new_name)return;var i=function(){x.jstree("set_text",e,r.rslt.old_name),x.jstree("sort",e.parent())};if(!ht(r.rslt.new_name)){i();return}var s=e.data("entry").fullPath,o=new RegExp(h.regexEscape(r.rslt.old_name)+"$"),u=s.replace(o,r.rslt.new_name);dt(s,u,t).done(function(){if(t){var n=P;P=!0,x.jstree("select_node",e,!0),P=n}}).fail(function(e){i()})}),x.jstree("rename")})}function mt(){$(".jstree-rename-input").blur()}e("utils/Global"),e("thirdparty/jstree_pre1.0_fix_1/jquery.jstree");var r=e("utils/AppInit"),i=e("file/NativeFileSystem").NativeFileSystem,s=e("preferences/PreferencesDialogs"),o=e("preferences/PreferencesManager"),u=e("document/DocumentManager"),a=e("command/CommandManager"),f=e("command/Commands"),l=e("widgets/Dialogs"),c=e("command/Menus"),h=e("utils/StringUtils"),p=e("strings"),d=e("project/FileViewController"),v=e("utils/PerfUtils"),m=e("utils/ViewUtils"),g=e("utils/CollectionUtils"),y=e("file/FileUtils"),b=e("file/NativeFileError"),w=e("i18n!nls/urls"),E=e("utils/KeyEvent"),S,x=null,N=null,C=!1,k,L=null,A="",O="",M="com.adobe.brackets.ProjectManager",_=null,D={previous:[],id:0,fullPathToIdMap:{}},P=!1;r.htmlReady(function(){S=$("#project-files-container"),$("#open-files-container").on("contentChanged",function(){B(!1)})});var gt={projectPath:rt()};_=o.getPreferenceStorage(M,gt);if(!_.getValue("welcomeProjectsFixed")){var yt=_.getValue("welcomeProjects");if(yt){var bt=[],wt;for(wt=0;wt<yt.length;wt++)bt.indexOf(yt[wt])===-1&&bt.push(yt[wt]);_.setValue("welcomeProjects",bt),_.setValue("welcomeProjectsFixed",!0)}}$(d).on("documentSelectionFocusChange",I),$(d).on("fileViewFocusChange",F),a.register(p.CMD_OPEN_FOLDER,f.FILE_OPEN_FOLDER,lt),a.register(p.CMD_PROJECT_SETTINGS,f.FILE_PROJECT_SETTINGS,ct),t.getProjectRoot=q,t.getBaseUrl=U,t.setBaseUrl=X,t.getProjectId=z,t.setProjectId=W,t.isWithinProject=V,t.makeProjectRelativeIfPossible=J,t.shouldShow=et,t.openProject=lt,t.getSelectedItem=j,t.getInitialProjectPath=ot,t.isWelcomeProjectPath=it,t.updateWelcomeProjectPath=st,t.createNewItem=pt,t.renameItemInline=vt,t.forceFinishRename=mt,t.showInTree=ft}),define("language/HTMLUtils",["require","exports","module","utils/TokenUtils"],function(e,t,n){function u(e){var t=e.token.string,n=t.charAt(0),i=t.charAt(t.length-1),s=r.offsetInToken(e),o=!1;if(t.length>1&&(n==="'"||n==='"')&&i===n){o=t.match(/\=\s*['"]$/)!==null;if(!o)return t=t.substring(1,t.length-1),s=s-1>t.length?t.length:s-1,{val:t,offset:s,quoteChar:n,hasEndQuote:!0}}if(o){var u=t.indexOf(" ");t=t.substring(0,u>s?u:s)}else s>0&&(n==="'"||n==='"')&&(t=t.substring(0,s));return n=t.charAt(0),n==="'"||n==='"'?(t=t.substring(1),s--):n="",{val:t,offset:s,quoteChar:n,hasEndQuote:!1}}function a(e){var t=e.editor.getMode(),n=CodeMirror.innerMode(t,e.token.state);return n.state.tagName}function f(e,t){var n=[],i=r.getInitialContext(e._codeMirror,t),s=$.extend({},i);if(e.getModeForSelection()==="html"&&i.token&&i.token.className!=="tag"){while(r.movePrevToken(i)&&i.token.className!=="tag"){if(i.token.className==="error"&&i.token.string.indexOf("<")===0)break;i.token.className==="attribute"&&n.push(i.token.string)}while(r.moveNextToken(s)&&s.token.className!=="tag")if(s.token.className==="attribute"){if(s.token.string.indexOf("<")===0)break;n.push(s.token.string)}else if(s.token.className==="error"){if(s.token.string.indexOf("<")===0||s.token.string.indexOf(">")===0)break;s.token.string.trim()!==""&&s.token.string.indexOf('"')===-1&&s.token.string.indexOf("'")===-1&&s.token.string.indexOf("=")===-1&&n.push(s.token.string)}}return n}function l(e,t,n,r,i,s,o,u){return{tagName:n||"",attr:{name:r||"",value:i||"",valueAssigned:s||!1,quoteChar:o||"",hasEndQuote:u||!1},position:{tokenType:e||"",offset:t||0}}}function c(e){var t=u(e),n=t.val,i=t.offset,s=t.quoteChar,f=t.hasEndQuote,c=e.token.string.length;if((e.token.className==="string"||e.token.className==="error")&&e.pos.ch===e.token.end&&c>1){var h=e.token.string[0],p=e.token.string[c-1];if(h===p&&(h==="'"||h==='"'))return l()}if(!r.moveSkippingWhitespace(r.movePrevToken,e)||e.token.string!=="=")return l();if(!r.moveSkippingWhitespace(r.movePrevToken,e)||e.token.className!=="attribute")return l();var d=e.token.string,v=a(e);return l(o,i,v,d,n,!0,s,f)}function h(e,t){if(t===!1&&e.token.className!=="attribute")return l();var n=a(e),i=e.token.string,o=r.offsetInToken(e);if(!r.moveSkippingWhitespace(r.moveNextToken,e)||e.token.string!=="=")return t&&(!e.token.className||e.token.className!=="attribute"&&e.token.string.indexOf("<")!==-1)?l():l(s,o,n,i);if(!r.moveSkippingWhitespace(r.moveNextToken,e))return l(s,o,n,i);var f=u(e),c=f.val,h=f.quoteChar,p=f.hasEndQuote;return l(s,o,n,i,c,!0,h,p)}function p(e,t){var n=$.extend({},t),u=r.getInitialContext(e._codeMirror,n),f=null,p=r.offsetInToken(u),d,v;if(e.getModeForSelection()!=="html")return l();if(u.token.string.length>0&&u.token.string.trim().length===0){var m={ch:u.pos.ch+1,line:u.pos.line},g=e._codeMirror.getTokenAt(m);if(g.string.length>0&&g.string.trim().length>0&&g.string.charAt(0)!==">"){u.token=g;if(u.token.className==="tag"||u.token.className==="error"){if(u.token.string.charAt(0)==="<")return l()}else{if(u.token.className==="attribute")return h(u,!1);if(u.token.string==="=")return l()}}else{if(!r.movePrevToken(u))return l();if(u.token.className==="comment")return l();if(u.token.className!=="tag"&&u.token.string!=="=")return d=c(u),u.token.className==="comment"||u.token.className==="tag"&&(u.token.string===">"||u.token.string==="/>"||u.token.string.charAt(0)==="<"&&u.token.string.charAt(1)==="/")?l():(d.tagName||(d=h(u,!0)),d.tagName?l(s,0,d.tagName):l());v=s,p=0}}if(u.token.className==="tag"||u.token.className==="error"){if(u.token.string.match(/^<\s+/)&&p!==1)return l();if(u.token.string===">"||u.token.string==="/>"||u.token.string.charAt(0)==="<"&&u.token.string.charAt(1)==="/")return l();if(u.token.string!=="="&&u.token.string.match(/^["']/)===null)return v||(v=i,p--),l(v,p,a(u))}if(u.token.string==="="){if(!r.moveSkippingWhitespace(r.movePrevToken,u)||u.token.className!=="attribute")return l();v=o,p=0}return u.token.className==="attribute"?(d=h(u,!1),d.attr.quoteChar?p=t.ch-u.pos.ch:v===o&&t.ch+1<u.pos.ch&&(d.attr.value="")):d=c(u),v&&d.tagName&&(d.position.tokenType=v,d.position.offset=p),d}function d(e){var t=r.getInitialContext(e._codeMirror,{line:0,ch:0}),n=[],i=null,s=!1;while(r.moveNextToken(t))s?t.token.state.mode!=="css"?(i.text=e.document.getRange(i.start,i.end),s=!1):i.end={line:t.pos.line,ch:t.pos.ch}:t.token.state.mode==="css"&&(i={start:{line:t.pos.line,ch:t.pos.ch}},n.push(i),s=!0);return n}var r=e("utils/TokenUtils"),i="tagName",s="attr.name",o="attr.value";t.TAG_NAME=i,t.ATTR_NAME=s,t.ATTR_VALUE=o,t.getTagInfo=p,t.getTagAttributes=f,t.createTagInfo=l,t.findStyleBlocks=d}),define("project/FileIndexManager",["require","exports","module","utils/PerfUtils","project/ProjectManager","widgets/Dialogs","strings"],function(e,t,n){function f(e,t){this.name=e,this.fileInfos=[],this.filterFunction=t}function l(e){this.name=e.name,this.fullPath=e.fullPath}function c(e,t){if(u.hasOwnProperty(e)){console.error("Duplicate index name");return}if(typeof t!="function"){console.error("Invalid arguments");return}u[e]=new f(e,t),a=!0}function h(e){if(!i.shouldShow(e))return;var t=new l(e);$.each(u,function(n,r){r.filterFunction(e)&&r.fileInfos.push(t)})}function p(){return s.showModalDialog(s.DIALOG_ID_ERROR,o.ERROR_MAX_FILES_TITLE,o.ERROR_MAX_FILES)}function d(e){function r(){var e;for(e in t.dirInProgress)if(t.dirInProgress.hasOwnProperty(e))return!1;return!0}function s(e){delete t.dirInProgress[e.fullPath],r()&&n.resolve()}function o(e){if(!i.shouldShow(e))return;t.dirInProgress[e.fullPath]=!0,e.createReader().readEntries(function(n){n.forEach(function(e){if(t.fileCount>1e4){t.maxFilesHit||(t.maxFilesHit=!0,p());return}e.isFile?(h(e),t.fileCount++):e.isDirectory&&o(e)}),s(e)},function(n){t.dirError[e.fullPath]=n,s(e)})}if(!e){console.error("Bad dirEntry passed to _scanDirectorySubTree");return}var t={fileCount:0,dirInProgress:{},dirError:{},maxFilesHit:!1},n=new $.Deferred;return o(e),n.promise()}function v(e){e.forEach(function(e){console.log(e.name)}),console.log("length: "+e.length)}function m(){$.each(u,function(e,t){t.fileInfos=[]})}function g(){a=!0}function b(){if(y){console.error("syncFileIndex cannot be called Recursively");return}y=!0;var e=i.getProjectRoot();return a?(r.markStart(r.FILE_INDEX_MANAGER_SYNC),m(),d(e).done(function(){r.addMeasurement(r.FILE_INDEX_MANAGER_SYNC),a=!1,y=!1})):(y=!1,$.Deferred().resolve().promise())}function w(e){var t=new $.Deferred;if(!u.hasOwnProperty(e)){console.error("indexName not found");return}return b().done(function(){t.resolve(u[e].fileInfos)}),t.promise()}function E(e,t){var n=new $.Deferred;if(!u.hasOwnProperty(e)){console.error("indexName not found");return}return b().done(function(){var r=[];w(e).done(function(e){r=e.filter(function(e){return t(e.name)}),n.resolve(r)})}),n.promise()}function S(e,t){return E(e,function(e){return e===t})}var r=e("utils/PerfUtils"),i=e("project/ProjectManager"),s=e("widgets/Dialogs"),o=e("strings"),u={},a=!0,y=!1;c("all",function(e){return!0}),c("css",function(e){var t=e.name;return PathUtils.filenameExtension(t)===".css"}),$(i).on("projectOpen projectFilesChange",function(e,t){g()}),r.createPerfMeasurement("FILE_INDEX_MANAGER_SYNC","syncFileIndex"),t.markDirty=g,t.getFileInfoList=w,t.getFilenameMatches=S}),define("language/CSSUtils",["require","exports","module","utils/Async","document/DocumentManager","editor/EditorManager","language/HTMLUtils","project/FileIndexManager","file/NativeFileSystem","utils/TokenUtils"],function(e,t,n){function p(e){var t,n;return!e||!e.token||!e.token.state||e.token.className==="comment"?!1:(t=e.token.state.localState||e.token.state,!t.stack||t.stack.length<1?!1:(n=t.stack[t.stack.length-1],n==="{"||n==="rule"))}function d(e){var t;return!e||!e.token||!e.token.state||e.token.className==="comment"||e.token.className==="property"||e.token.className==="property error"||e.token.className==="tag"?!1:(t=e.token.state.localState||e.token.state,!t.stack||t.stack.length<2?!1:t.stack[t.stack.length-1]==="propertyValue"&&t.stack[t.stack.length-2]==="rule")}function v(e,t,n,r,i,s){var o={context:e||"",offset:t||0,name:n||"",index:-1,values:[],isNewItem:s?!0:!1};if(e===h||e===l)o.index=r,o.values=i;return o}function m(e){var t=$.extend({},e);do if(t.token.className==="property"||t.token.className==="property error"||t.token.string==="{"||t.token.string===";")return"";while(t.token.string!==":"&&f.moveSkippingWhitespace(f.movePrevToken,t));return t.token.string!==":"||!f.moveSkippingWhitespace(f.movePrevToken,t)||t.token.className!=="property"&&t.token.className!=="property error"?"":t.token.string}function g(e){var t="",n,r=[];while(e.token.string!==":"&&f.movePrevToken(e)){if(e.token.className==="property"||e.token.className==="property error"||e.token.className==="tag"||e.token.string===":"||e.token.string==="{"||e.token.string===";")break;n=e.token.string,t!==""&&(n+=t),e.token.string.length>0&&!e.token.string.match(/\S/)||e.token.string===","?t=n:(t="",r.length===0||n.match(/,\s*$/)?r.push(n):r[r.length-1]=n+r[r.length-1])}return r.length>0&&r.reverse(),r}function y(e,t){var n=t,r,i=[];while(e.token.string!==";"&&f.moveNextToken(e)){if(e.token.string===";"||e.token.string==="}")break;if(e.token.className==="property"||e.token.className==="property error"||e.token.className==="tag"||e.token.string===":"){n="";break}n===""?n=e.token.string.trim():n.length>0&&(e.token.string.length>0&&!e.token.string.match(/\S/)?(n+=e.token.string,i.push(n),n=""):e.token.string===","?n+=e.token.string:n&&n.match(/,$/)?(i.push(n),n=""):n+=e.token.string)}return n.length>0&&i.push(n),i}function b(e,t){var n=$.extend({},e.pos),r=$.extend({},e.pos),i=$.extend({},e.pos),s=f.getInitialContext(t._codeMirror,n),o,u,a="",l=[],c=-1,p=f.offsetInToken(e),d=!1,b={ch:e.pos.ch+1,line:e.pos.line},w=t._codeMirror.getTokenAt(b),E;return E=m(s),E?(o=f.getInitialContext(t._codeMirror,r),l=g(o),a="",e.token.string===":"?(c=0,d=!0):(c=l.length-1,e.token.string===","?(l[c]+=e.token.string,c++,d=!0):(c=c<0?0:c+1,a=e.token.string.trim(),a.length===0&&(d=!0,c>0&&(l[c-1]+=e.token.string.substr(0,p))))),d&&(p=0,t.document.getLine(e.pos.line).length>e.pos.ch&&(w.string.length===0||w.string.match(/\S/))&&(d=!1)),u=f.getInitialContext(t._codeMirror,i),l=l.concat(y(u,a)),c===l.length&&(d=!0),v(h,p,E,c,l,d)):v()}function w(e,t){var n=$.extend({},t),r=f.getInitialContext(e._codeMirror,n),i=f.offsetInToken(r),s="",o=e.getModeForSelection();if(o!=="css"&&o!=="less")return v();if(p(r)){if(r.token.string.length>0&&!r.token.string.match(/\S/)){var u={ch:r.pos.ch+1,line:r.pos.line},a=e._codeMirror.getTokenAt(u);if(a.className==="property"||a.className==="property error"||a.className==="tag")s=a.string,i=0}else if(r.token.className==="property"||r.token.className==="property error"||r.token.className==="tag")s=r.token.string;return s===""&&(i=0),v(c,i,s)}return d(r)?b(r,e):v()}function E(e){function E(){while(a.eol()){f++;if(f>=s)return!1;l.match(/\S/)&&(l+=" "),a=new CodeMirror.StringStream(i[f])}return!0}function S(){return r=CodeMirror.startState(n),i=CodeMirror.splitLines(e),s=i.length,s===0?!1:(f=0,a=new CodeMirror.StringStream(i[f]),E()?(u=n.token(a,r),o=a.current(),!0):!1)}function x(){return a.start=a.pos,E()?(u=n.token(a,r),o=a.current(),!0):!1}function T(){if(!S())return!1;while(!o.match(/\S/))if(!x())return!1;return!0}function N(){if(!x())return!1;while(!o.match(/\S/))if(!x())return!1;return!0}function C(){return o.match(/^\/\*/)}function k(){while(!o.match(/\*\/$/))if(!x())break}function L(){if(!x())return!1;while(C()){k();if(!x())return!1}return!0}function A(){l="",p=a.start,d=f;while(o!==","&&o!=="{"){l+=o;if(!L())break}/\\/.test(l)&&(l=l.replace(b,function(e){return e.replace(w,function(e){return e=e.substr(1),e.length===1?e:parseInt(e,16)<1114111?String.fromCharCode(parseInt(e,16)):String.fromCharCode(65533)})})),l=l.trim(),l!==""&&(t.push({selector:l,ruleStartLine:h,ruleStartChar:c,selectorStartLine:d,selectorStartChar:p,declListEndLine:-1,selectorEndLine:f,selectorEndChar:a.start-1,selectorGroupStartLine:v,selectorGroupStartChar:m}),l=""),p=-1}function O(){v=f,m=a.start,A();while(o===","){if(!L())break;A()}}function M(){var e;g=f,y=a.start,v=-1,m=-1,h=-1,c=-1;while(o!=="}")if(!L())break;for(e=t.length-1;e>=0;e--){if(t[e].declListEndLine!==-1)break;t[e].declListStartLine=g,t[e].declListStartChar=y,t[e].declListEndLine=f,t[e].declListEndChar=a.pos-1}}function _(){return c!==-1?!1:a.start>0&&i[f].substr(0,a.start).indexOf("}")!==-1?!1:!0}function D(){return o.match(/^@/)}function P(){h=-1,c=-1,d=-1,p=-1,v=-1,m=-1;if(o.match(/@media/i)){while(o!=="{")if(!L())break;N(),B("}")}else if(o.match(/@(charset|import|namespace)/i)){while(o!==";")if(!L())break}else while(o!=="}")if(!L())break}function H(){O(),M()}function B(e){while(!e||o!==e){D()?P():C()?(_()&&(c=a.start,h=f),k()):(c===-1&&(c=a.start,h=f),H());if(!N())break}}var t=[],n=CodeMirror.getMode({indentUnit:2},"css"),r,i,s,o,u,a,f,l="",c=-1,h=-1,p=-1,d=-1,v=-1,m=-1,g=-1,y=-1,b=new RegExp("\\\\[^\\\\]+","g"),w=new RegExp("\\\\([a-f0-9]{6}|[a-f0-9]{4}(\\s|\\\\|$)|[a-f0-9]{2}(\\s|\\\\|$)|.)","i");return T()&&B(),t}function S(e,t){var n=E(e),r=[],i,s=t[0]==="."||t[0]==="#",o="";t[0]==="."&&(t="\\"+t),s||(t="(^|[\\s>+~])"+t);var u=new RegExp(t+"(\\[[^\\]]*\\]|:{1,2}[\\w-()]+|\\.[\\w-]+|#[\\w-]+)*\\s*$",s?"":"i");return n.forEach(function(e){e.selector.search(u)!==-1?r.push(e):s||e.selector.trim().search(/\*$/)!==-1&&r.push(e)}),r}function x(e,t,n,r){t.forEach(function(t){e.push({name:t.selector,document:n,lineStart:t.ruleStartLine+r,lineEnd:t.declListEndLine+r})})}function T(e,t){function o(e,n){var r=new $.Deferred;return i.getDocumentForPath(e).done(function(e){var i=S(e.getText(),n);x(t,i,e,0),r.resolve()}).fail(function(e){r.reject(e)}),r.promise()}var n=new $.Deferred,s=u.getFileInfoList("css");return s.done(function(t){r.doInParallel(t,function(t,n){return o(t.fullPath,e)}).pipe(n.resolve,n.reject)}),n.promise()}function N(e,t,n){var r=s.getCurrentFullEditor();if(r.document!==e){console.error("Cannot search for <style> blocks in HTML file other than current editor");return}var i=o.findStyleBlocks(r);i.forEach(function(r){var i=S(r.text,t);x(n,i,e,r.start.line)})}function C(e,t){var n=new $.Deferred,r=[];return t&&N(t,e,r),T(e,r).done(function(){n.resolve(r)}).fail(function(e){n.reject(e)}),n.promise()}function k(e,t){function u(e){return e=e.trim(),e.indexOf("@")===0?"":e}function a(e){var t="";f.movePrevToken(e);for(;;){if(e.token.className!=="comment"){if(/[\{\}\;]/.test(e.token.string))break;t=e.token.string+t}if(!f.movePrevToken(e))break}return t}var n=e._codeMirror,r=f.getInitialContext(n,$.extend({},t)),i="",s=!1,o=!1;for(;;){if(r.token.className!=="comment"){if(r.token.string==="}")break;if(r.token.string==="{"){i=a(r);break}r.token.string.trim()!==""&&(o=!0)}if(!f.movePrevToken(r))break}i=u(i),r=f.getInitialContext(n,$.extend({},t)),!i&&!o&&f.moveNextToken(r)&&r.token.className!=="comment"&&r.token.string.trim()!==""&&(o=!0,r=f.getInitialContext(n,$.extend({},t)));if(!i&&o)for(;;){if(r.token.className!=="comment"){if(r.token.string==="{"){i=a(r);break}if(r.token.string==="}"||r.token.string===";")break}if(!f.moveNextToken(r))break}return u(i)}var r=e("utils/Async"),i=e("document/DocumentManager"),s=e("editor/EditorManager"),o=e("language/HTMLUtils"),u=e("project/FileIndexManager"),a=e("file/NativeFileSystem").NativeFileSystem,f=e("utils/TokenUtils"),l="selector",c="prop.name",h="prop.value";t._findAllMatchingSelectorsInText=S,t.findMatchingRules=C,t.extractAllSelectors=E,t.findSelectorAtDocumentPos=k,t.SELECTOR=l,t.PROP_NAME=c,t.PROP_VALUE=h,t.getInfoAtPos=w,t.createInfo=v}),define("editor/MultiRangeInlineEditor",["require","exports","module","document/TextRange","editor/InlineTextEditor","editor/EditorManager","command/Commands","strings","command/CommandManager","utils/PerfUtils"],function(e,t,n){function l(e,t){return parseInt(e.css(t),10)}function c(e){this.name=e.name,this.textRange=new r(e.document,e.lineStart,e.lineEnd)}function h(e,t){var n=t.name+" "+t.textRange.document.file.name+" : "+(t.textRange.startLine+1);e.text(n),e.attr("title",n)}function p(e){i.call(this),this._ranges=e.map(function(e){return new c(e)}),this._selectedRangeIndex=-1}function d(){var e=s.getFocusedInlineWidget();return e instanceof p?e:null}function v(){var e=d();e&&e._selectPreviousRange()}function m(){var e=d();e&&e._selectNextRange()}var r=e("document/TextRange").TextRange,i=e("editor/InlineTextEditor").InlineTextEditor,s=e("editor/EditorManager"),o=e("command/Commands"),u=e("strings"),a=e("command/CommandManager"),f=e("utils/PerfUtils");c.prototype.name=null,c.prototype.textRange=null,c.prototype.$listItem=null,p.prototype=Object.create(i.prototype),p.prototype.constructor=p,p.prototype.parentClass=i.prototype,p.prototype.$editorsDiv=null,p.prototype.$relatedContainer=null,p.prototype.$related=null,p.prototype.$selectedMarker=null,p.prototype._ranges=null,p.prototype._selectedRangeIndex=null,p.prototype.load=function(e){p.prototype.parentClass.load.apply(this,arguments);var t=this;this.$editorsDiv=$(window.document.createElement("div")).addClass("inlineEditorHolder"),this.$editorsDiv.on("mousewheel.MultiRangeInlineEditor",function(e){e.stopPropagation()}),this.$relatedContainer=$(window.document.createElement("div")).addClass("related-container"),this.$selectedMarker=$(window.document.createElement("div")).appendTo(this.$relatedContainer).addClass("selection"),this.$related=$(window.document.createElement("div")).appendTo(this.$relatedContainer).addClass("related");var n=$(window.document.createElement("ul")).appendTo(this.$related),r;this._ranges.forEach(function(e){var r=$(window.document.createElement("li")).appendTo(n);h(r,e),r.mousedown(function(){t.setSelectedIndex(t._ranges.indexOf(e))}),e.$listItem=r,$(e.textRange).on("change",function(){h(r,e)}),$(e.textRange).on("lostSync",function(){t._removeRange(e)})}),t.setSelectedIndex(0),this.$htmlContent.append(this.$relatedContainer).append(this.$editorsDiv);var i=this._onClick.bind(this);this.$htmlContent.on("click.MultiRangeInlineEditor",i),this.$htmlContent.on("mouseup.MultiRangeInlineEditor",i)},p.prototype.onAdded=function(){this.$relatedContainer.height(this.$related.height()),p.prototype.parentClass.onAdded.apply(this,arguments),this._updateEditorMinHeight()},p.prototype.setSelectedIndex=function(e){var t=Math.min(Math.max(0,e),this._ranges.length-1),n=this;if(t===this._selectedRangeIndex)return;var r=this._selectedRangeIndex>=0?this._ranges[this._selectedRangeIndex].$listItem:null;r&&r.toggleClass("selected",!1),this._selectedRangeIndex=t;var i=this._ranges[this._selectedRangeIndex].$listItem;this._ranges[this._selectedRangeIndex].$listItem.toggleClass("selected",!0),this.editors.forEach(function(e){$(n.editors[0]).off(".MultiRangeInlineEditor"),e.destroy()}),this.editors=[],this.$editorsDiv.children().remove();var s=this._getSelectedRange();this.createInlineEditorFromText(s.textRange.document,s.textRange.startLine,s.textRange.endLine,this.$editorsDiv.get(0)),this.editors[0].focus(),this._updateEditorMinHeight(),this.editors[0].refresh(),$(this.editors[0]).on("cursorActivity.MultiRangeInlineEditor",this._ensureCursorVisible.bind(this)),this.sizeInlineWidgetToContents(!0,!1),this._updateSelectedMarker()},p.prototype._updateEditorMinHeight=function(){var e=this.$related.outerHeight(),t=$(".inline-editor-header",this.$htmlContent).outerHeight();if(!e||!t)return;$(this.editors[0].getScrollerElement()).css("min-height",e-t+"px")},p.prototype._removeRange=function(e){if(this._ranges.length<=1){this.close();return}var t=this._ranges.indexOf(e);t===this._selectedRangeIndex&&(t+1<this._ranges.length?this.setSelectedIndex(t+1):this.setSelectedIndex(t-1)),e.$listItem.remove(),e.textRange.dispose(),this._ranges.splice(t,1),t<this._selectedRangeIndex&&(this._selectedRangeIndex--,this._updateSelectedMarker())},p.prototype._updateSelectedMarker=function(){var e=this._ranges[this._selectedRangeIndex].$listItem,t=this;window.setTimeout(function(){var n=t.$relatedContainer.height(),r=e.position().top,i=t.$relatedContainer.scrollTop();t.$selectedMarker.css("top",r),t.$selectedMarker.height(e.outerHeight());if(n<=0)return;var s=l(e.parent(),"paddingTop");if(r-s<i)t.$relatedContainer.scrollTop(r-s);else{var o=r+e.height()+l(e.parent(),"paddingBottom");o>i+n&&t.$relatedContainer.scrollTop(o-n)}},0)},p.prototype.onClosed=function(){p.prototype.parentClass.onClosed.apply(this,arguments),this._ranges.forEach(function(e){e.textRange.dispose()}),this.$htmlContent.off(".MultiRangeInlineEditor"),this.$editorsDiv.off(".MultiRangeInlineEditor")},p.prototype._onClick=function(e){function i(t){return t.find(e.target)>0||t[0]===e.target}var t=this.editors[0],n=t.getRootElement(),r=$(n).offset();if(!i($(n))&&!i($(".filename",this.$editorsDiv))){t.focus();if(!i(this.$relatedContainer))if(e.pageY<r.top)t.setCursorPos(0,0);else if(e.pageY>r.top+$(n).height()){var s=t.getLastVisibleLine();t.setCursorPos(s,t.document.getLine(s).length)}}},p.prototype._ensureCursorVisible=function(){if($.contains(this.editors[0].getRootElement(),window.document.activeElement)){var e=this.hostEditor.getScrollPos(),t=this.editors[0]._codeMirror.cursorCoords(),n=this.hostEditor.getVirtualScrollAreaTop();this.hostEditor._codeMirror.scrollIntoView({left:e.x,top:t.top-n,right:e.x,bottom:t.bottom-n})}},p.prototype._onLostContent=function(e,t){if(t&&t.type==="deleted")return;return p.prototype.parentClass._onLostContent.apply(this,arguments)},p.prototype._getRanges=function(){return this._ranges},p.prototype._getSelectedRange=function(){return this._ranges[this._selectedRangeIndex]},p.prototype._selectNextRange=function(){this.setSelectedIndex(this._selectedRangeIndex+1)},p.prototype._selectPreviousRange=function(){this.setSelectedIndex(this._selectedRangeIndex-1)},p.prototype.sizeInlineWidgetToContents=function(e,t){p.prototype.parentClass.sizeInlineWidgetToContents.call(this,e);var n=Math.max(this.$related.height(),this.$editorsDiv.height());n&&this.hostEditor.setInlineWidgetHeight(this,n,t)},p.prototype.refresh=function(){p.prototype.parentClass.refresh.apply(this,arguments),this.sizeInlineWidgetToContents(!0),this.editors.forEach(function(e,t,n){e.refresh()})},a.register(u.CMD_QUICK_EDIT_PREV_MATCH,o.QUICK_EDIT_PREV_MATCH,v),a.register(u.CMD_QUICK_EDIT_NEXT_MATCH,o.QUICK_EDIT_NEXT_MATCH,m),t.MultiRangeInlineEditor=p}),define("editor/CSSInlineEditor",["require","exports","module","language/CSSUtils","editor/EditorManager","language/HTMLUtils","editor/MultiRangeInlineEditor"],function(e,t,n){function u(e,t){var n=s.getTagInfo(e,t),r="";if(n.position.tokenType===s.TAG_NAME)r=n.tagName;else if(n.position.tokenType===s.ATTR_NAME||n.position.tokenType===s.ATTR_VALUE)if(n.attr.name==="class"){var i=n.attr.value,o=i.substr(0,n.position.offset).lastIndexOf(" "),u=i.indexOf(" ",n.position.offset);r="."+i.substring(o===-1?0:o+1,u===-1?i.length:u),r==="."&&(r="")}else n.attr.name==="id"&&(r="#"+n.attr.value);return r}function a(e,t){if(e.getModeForSelection()!=="html")return null;var n=e.getSelection(!1);if(n.start.line!==n.end.line)return null;var i=u(e,e.getSelection(!1).start);if(i==="")return null;var s=new $.Deferred;return r.findMatchingRules(i,e.document).done(function(t){if(t&&t.length>0){var n=new o(t);n.load(e),s.resolve(n)}else s.reject()}).fail(function(){console.log("Error in findMatchingRules()"),s.reject()}),s.promise()}var r=e("language/CSSUtils"),i=e("editor/EditorManager"),s=e("language/HTMLUtils"),o=e("editor/MultiRangeInlineEditor").MultiRangeInlineEditor;i.registerInlineEditProvider(a)}),define("document/ChangedDocumentTracker",["require","exports","module","document/DocumentManager","project/ProjectManager"],function(e,t,n){function s(){var e=this;this._changedPaths={},this._windowFocus=!0,this._addListener=this._addListener.bind(this),this._removeListener=this._removeListener.bind(this),this._onChange=this._onChange.bind(this),this._onWindowFocus=this._onWindowFocus.bind(this),$(r).on("afterDocumentCreate",function(t,n){i.isWithinProject(n.file.fullPath)&&e._addListener(n)}),$(r).on("beforeDocumentDelete",function(t,n){e._removeListener(n)}),$(window).focus(this._onWindowFocus)}var r=e("document/DocumentManager"),i=e("project/ProjectManager");s.prototype._addListener=function(e){$(e).on("change",this._onChange)},s.prototype._removeListener=function(e){$(e).off("change",this._onChange)},s.prototype._onWindowFocus=function(e,t){this._windowFocus=!0},s.prototype._onChange=function(e,t){this._changedPaths[t.file.fullPath]=!0},s.prototype.reset=function(){this._changedPaths={},this._windowFocus=!1},s.prototype.isPathChanged=function(e){return this._windowFocus||this._changedPaths[e]},s.prototype.getChangedPaths=function(){return $.makeArray(this._changedPaths)},n.exports=s}),define("language/JSUtils",["require","exports","module","utils/Async","document/DocumentManager","document/ChangedDocumentTracker","file/NativeFileSystem","utils/CollectionUtils","utils/PerfUtils","utils/StringUtils"],function(e,t,n){function h(e){var t={},n,r;a.markStart(a.JSUTILS_REGEXP);while((r=c.exec(e))!==null)n=(r[2]||r[5]).trim(),Array.isArray(t[n])||(t[n]=[]),t[n].push({offsetStart:r.index});return a.addMeasurement(a.JSUTILS_REGEXP),t}function p(e,t){function h(){if(i){u++;if(u>=a)return!1}l=u;var t=e.indexOf("\n",l);return t===-1&&(t=a),i=new CodeMirror.StringStream(e.slice(u,t)),!0}function p(){if(u>=a)return!1;i&&(i.start=i.pos);while(!i||i.eol())if(!h())return!1;return s=n.token(i,r),o=i.current(),u=l+i.pos,!0}var n=CodeMirror.getMode({},"javascript"),r=CodeMirror.startState(n),i,s,o,u=t,a=e.length,f=0,l,c=!1;while(p()){s!=="comment"&&s!=="regexp"&&s!=="string"&&(o==="{"?(c=!0,f++):o==="}"&&f--);if(c&&f<=0)return u}return a}function d(e,t,n,r){var i=e.getText(),s=f.getLines(i);n.forEach(function(n){n.offsetEnd||(a.markStart(a.JSUTILS_END_OFFSET),n.offsetEnd=p(i,n.offsetStart),n.lineStart=f.offsetToLineNum(s,n.offsetStart),n.lineEnd=f.offsetToLineNum(s,n.offsetEnd),a.addMeasurement(a.JSUTILS_END_OFFSET)),r.push({document:e,name:t,lineStart:n.lineStart,lineEnd:n.lineEnd})})}function v(e,t){i.getDocumentForPath(e.fullPath).done(function(n){var r=h(n.getText());e.JSUtils={},e.JSUtils.functions=r,e.JSUtils.timestamp=n.diskTimestamp,t.resolve({doc:n,functions:r})}).fail(function(e){t.reject(e)})}function m(e){var t=new $.Deferred,n=l.isPathChanged(e.fullPath);if(n&&e.JSUtils){var r=i.getOpenDocumentForPath(e.fullPath);if(r&&r.isDirty)t.resolve(!1);else{var s=new o.FileEntry(e.fullPath);s.getMetadata(function(n){t.resolve(e.JSUtils.timestamp===n.diskTimestamp)},function(e){t.reject(e)})}}else t.resolve(!n&&e.JSUtils);return t.promise()}function g(e,t){var n=new $.Deferred,s=[],o=[];return e.forEach(function(e){if(e.functions.hasOwnProperty(t)){var n=e.functions[t];s.push({doc:e.doc,fileInfo:e.fileInfo,functions:n})}}),r.doInParallel(s,function(e){var n=e.doc,r=new $.Deferred;return n?(d(n,t,e.functions,o),r.resolve()):i.getDocumentForPath(e.fileInfo.fullPath).done(function(n){d(n,t,e.functions,o)}).always(function(){r.resolve()}),r.promise()}).done(function(){n.resolve(o)}),n.promise()}function y(e){var t=new $.Deferred;return m(e).done(function(n){n?t.resolve({fileInfo:e,functions:e.JSUtils.functions}):v(e,t)}).fail(function(e){t.reject(e)}),t.promise()}function b(e){var t=new $.Deferred,n=[];return a.markStart(a.JSUTILS_GET_ALL_FUNCTIONS),r.doInParallel(e,function(e){var t=new $.Deferred;return y(e).done(function(e){n.push(e)}).always(function(e){t.resolve()}),t.promise()}).always(function(){l.reset(),a.addMeasurement(a.JSUTILS_GET_ALL_FUNCTIONS),t.resolve(n)}),t.promise()}function w(e,t){var n=new $.Deferred,r=[],i=[];return r=t.filter(function(e){return/^\.js/i.test(PathUtils.filenameExtension(e.fullPath))}),b(r).done(function(t){g(t,e).done(function(e){n.resolve(e)})}),n.promise()}function E(e,t){var n=h(e),r=[],i=e.split("\n");return u.forEach(n,function(n,s){(s===t||t==="*")&&n.forEach(function(t){var n=p(e,t.offsetStart);r.push({name:s,lineStart:f.offsetToLineNum(i,t.offsetStart),lineEnd:f.offsetToLineNum(i,n)})})}),r}var r=e("utils/Async"),i=e("document/DocumentManager"),s=e("document/ChangedDocumentTracker"),o=e("file/NativeFileSystem").NativeFileSystem,u=e("utils/CollectionUtils"),a=e("utils/PerfUtils"),f=e("utils/StringUtils"),l=new s,c=/(function\s+([$_A-Za-z\u007F-\uFFFF][$_A-Za-z0-9\u007F-\uFFFF]*)\s*(\([^)]*\)))|(([$_A-Za-z\u007F-\uFFFF][$_A-Za-z0-9\u007F-\uFFFF]*)\s*[:=]\s*function\s*(\([^)]*\)))/g;a.createPerfMeasurement("JSUTILS_GET_ALL_FUNCTIONS","Parallel file search across project"),a.createPerfMeasurement("JSUTILS_REGEXP","RegExp search for all functions"),a.createPerfMeasurement("JSUTILS_END_OFFSET","Find end offset for a single matched function"),t.findAllMatchingFunctionsInText=E,t._getFunctionEndOffset=p,t.findMatchingFunctions=w}),define("project/WorkingSetView",["require","exports","module","document/DocumentManager","command/CommandManager","command/Commands","command/Menus","project/FileViewController","utils/ViewUtils"],function(e,t,n){function h(){c.trigger("selectionChanged"),l.triggerHandler("contentChanged")}function p(){l[0].scrollHeight>l[0].clientHeight?l.hasClass("vertical-scroll")||l.addClass("vertical-scroll"):l.removeClass("vertical-scroll")}function d(){r.getWorkingSet().length===0?l.hide():l.show(),p(),h()}function v(e,t,n){function M(e){var n=e.pageY-b;c.length&&n<0||p.length&&n>0?Math.abs(n)>y/2&&(n<0?(c.insertAfter(t),b-=y,n+=y,r.swapWorkingSetIndexes(g,--g)):(p.insertBefore(t),b+=y,n-=y,r.swapWorkingSetIndexes(g,++g)),!d&&(n>0&&v||n<0&&m)&&h(),c=t.prev(),p=t.next(),v=c.hasClass("selected"),m=p.hasClass("selected"),!L&&!k&&!p.length&&v&&(a.removeScrollerShadow(l[0],null),a.addScrollerShadow(l[0],null,!1),L=!0)):n=0,t.css("top",n+"px"),d&&h(),!O&&Math.abs(n)>3&&(o.closeAll(),O=!0)}function _(){window.clearInterval(A),A=!1}function D(e){var t=0;e.pageY-w<S+7?t=-1:e.pageY+E>S+T-7&&(t=1),t&&!A?A=window.setInterval(function(){var n=l.scrollTop();t===-1&&n<=0||t===1&&n>=N?_():(l.scrollTop(n+7*t),b-=7*t,M(e))},100):!t&&A&&_()}function P(){window.onmousewheel=window.document.onmousewheel=null,t.removeAttr("style"),A&&window.clearInterval(A),O?O&&(d&&(h(),a.scrollElementIntoView(l,t,!1)),L&&a.addScrollerShadow(l[0],null,!0)):n?i.execute(s.FILE_CLOSE,{file:t.data(f)}):u.openAndSelectDocument(t.data(f).fullPath,u.WORKING_SET_VIEW)}var c=t.prev(),p=t.next(),d=t.hasClass("selected"),v=c.hasClass("selected"),m=p.hasClass("selected"),g=r.findInWorkingSet(t.data(f).fullPath),y=t.height(),b=e.pageY,w=b-t.offset().top,E=t.offset().top+y-b,S=l.offset().top,x=l.get(0),T=x.clientHeight,N=x.scrollHeight-T,C=x.scrollHeight>T,k=x.scrollHeight>x.scrollTop+T,L=!1,A=!1,O=!1;if(e.which!==1){P();return}window.onmousewheel=window.document.onmousewheel=function(e){e.preventDefault()},t.css("position","relative").css("z-index",1),l.on("mousemove.workingSet",function(e){C&&D(e),M(e)}),l.on("mouseup.workingSet mouseleave.workingSet",function(e){l.off("mousemove.workingSet mouseup.workingSet mouseleave.workingSet"),P()})}function m(e,t,n){var r=e.find(".file-status-icon"),i=t||n;!i&&r.length!==0?(r.remove(),r=null):i&&r.length===0&&(r=$("<div class='file-status-icon'></div>").prependTo(e).mousedown(function(e){v(e,$(this).parent(),!0),e.stopPropagation()})),r&&(r.toggleClass("dirty",Boolean(t)),r.toggleClass("can-close",Boolean(n)))}function g(e,t){var n=t&&$(e).data(f).fullPath===t.file.fullPath;$(e).toggleClass("selected",Boolean(n))}function y(e){var t=r.getOpenDocumentForPath(e.fullPath);return t&&t.isDirty}function b(e){var t=r.getCurrentDocument(),n=$("<a href='#'></a>").text(e.name),i=$("<li></li>").append(n).data(f,e);l.find("ul").append(i),m(i,y(e),!1),g(i,t),i.mousedown(function(e){v(e,$(this)),e.preventDefault()}),i.hover(function(){m($(this),y(e),!0)},function(){m($(this),y(e),!1)})}function w(){l.find("ul").empty(),r.getWorkingSet().forEach(function(e){b(e)}),d()}function E(e){var t=null;if(e){var n=l.find("ul").children();n.each(function(){var n=$(this);if(n.data(f).fullPath===e.fullPath)return t=n,!1})}return t}function S(){if(u.getFileSelectionFocus()!==u.WORKING_SET_VIEW)return;var e=r.getCurrentDocument();if(!e)return;var t=E(e.file);if(!t)return;a.scrollElementIntoView(l,t,!1)}function x(){var e;u.getFileSelectionFocus()===u.WORKING_SET_VIEW?e=r.getCurrentDocument():e=null;var t=l.find("ul").children().each(function(){g(this,e)});S(),h()}function T(e){b(e),d()}function N(e){e.forEach(function(e){b(e)}),d()}function C(){x(),h()}function k(e){var t=E(e);if(t){var n=t.next();if(n&&n.length>0){var r=t.find(".can-close").length===1,i=y(n.data(f));m(n,i,r)}t.remove()}d()}function L(e){e.forEach(function(e){var t=E(e);t&&t.remove()}),d()}function A(){w(),S()}function O(e){var t=E(e.file);if(t){var n=$(t).find(".can-close").length===1;m(t,e.isDirty,n)}}function M(e,t){w()}function _(e){l=e,c=l.find("ul"),$(r).on("workingSetAdd",function(e,t){T(t)}),$(r).on("workingSetAddList",function(e,t){N(t)}),$(r).on("workingSetRemove",function(e,t){k(t)}),$(r).on("workingSetRemoveList",function(e,t){L(t)}),$(r).on("workingSetSort",function(e){A()}),$(r).on("dirtyFlagChange",function(e,t){O(t)}),$(r).on("fileNameChange",function(e,t,n){M(t,n)}),$(u).on("documentSelectionFocusChange fileViewFocusChange",C),a.addScrollerShadow(l[0],null,!0),a.sidebarList(l),l.css("overflow-x","hidden"),d()}var r=e("document/DocumentManager"),i=e("command/CommandManager"),s=e("command/Commands"),o=e("command/Menus"),u=e("project/FileViewController"),a=e("utils/ViewUtils"),f="file",l,c;t.create=_}),define("project/WorkingSetSort",["require","exports","module","command/Commands","command/CommandManager","document/DocumentManager","preferences/PreferencesManager","utils/AppInit","strings"],function(e,t,n){function m(e){return h[e]}function g(){return d}function y(e){d=e,c.setValue("automaticSort",d),i.get(r.SORT_WORKINGSET_AUTO).setChecked(d)}function b(){p&&p.getEvents()&&$(s).off(".sort")}function w(){y(!1),b()}function E(){d&&p&&p.getEvents()&&$(s).on(p.getEvents(),function(e){p.callAutomaticFn(e)}).on("workingSetReorder.sort",function(){w()})}function S(){y(!0),E()}function x(e){e?S():w()}function T(e){var t;p!==e&&(p!==null&&(t=i.get(p.getCommandID()),t&&t.setChecked(!1)),t=i.get(e.getCommandID()),t&&t.setChecked(!0),i.get(r.SORT_WORKINGSET_AUTO).setEnabled(!!e.getEvents()),p=e,c.setValue("currentSort",p.getCommandID()))}function N(e,t,n,r){this._commandID=e,this._compareFn=t,this._events=n,this._automaticFn=r}function C(e,t,n,r){if(h[e]){console.log("Attempting to register an already-registered sort: "+e);return}if(!e||!t){console.log("Attempting to register a sort with a missing id, or compare function: "+e);return}n&&(n=n.split(" "),n.forEach(function(e,t){n[t]=n[t].trim()+".sort"}),n=n.join(" ")),r=r||function(e){p.sort()};var i=new N(e,t,n,r);return h[e]=i,i}function k(){m(r.SORT_WORKINGSET_BY_ADDED).execute()}function L(){m(r.SORT_WORKINGSET_BY_NAME).execute()}function A(){m(r.SORT_WORKINGSET_BY_TYPE).execute()}function O(){x(!g())}var r=e("command/Commands"),i=e("command/CommandManager"),s=e("document/DocumentManager"),o=e("preferences/PreferencesManager"),u=e("utils/AppInit"),a=e("strings"),f="com.adobe.brackets.WorkingSetSort",l={currentSort:r.SORT_WORKINGSET_BY_ADDED,automaticSort:!1},c={},h=[],p=null,d=!1,v=!1;N.prototype.getCommandID=function(){return this._commandID},N.prototype.getCompareFn=function(){return this._compareFn},N.prototype.getEvents=function(){return this._events},N.prototype.callAutomaticFn=function(e){return this._automaticFn(e)},N.prototype.execute=function(){b(),T(this),E(),this.sort()},N.prototype.sort=function(){p===this&&s.sortWorkingSet(this._compareFn)},C(r.SORT_WORKINGSET_BY_ADDED,function(e,t){var n=s.findInWorkingSetAddedOrder(e.fullPath),r=s.findInWorkingSetAddedOrder(t.fullPath);return n-r},"workingSetAdd workingSetAddList"),C(r.SORT_WORKINGSET_BY_NAME,function(e,t){return e.name.toLocaleLowerCase().localeCompare(t.name.toLocaleLowerCase())},"workingSetAdd workingSetAddList"),C(r.SORT_WORKINGSET_BY_TYPE,function(e,t){var n=e.name.split(".").pop(),r=t.name.split(".").pop(),i=n.localeCompare(r);return i===0?e.name.toLocaleLowerCase().localeCompare(t.name.toLocaleLowerCase()):i},"workingSetAdd workingSetAddList"),i.register(a.CMD_SORT_WORKINGSET_BY_ADDED,r.SORT_WORKINGSET_BY_ADDED,k),i.register(a.CMD_SORT_WORKINGSET_BY_NAME,r.SORT_WORKINGSET_BY_NAME,L),i.register(a.CMD_SORT_WORKINGSET_BY_TYPE,r.SORT_WORKINGSET_BY_TYPE,A),i.register(a.CMD_SORT_WORKINGSET_AUTO,r.SORT_WORKINGSET_AUTO,O),c=o.getPreferenceStorage(f,l),u.appReady(function(){var e=m(c.getValue("currentSort")),t=c.getValue("automaticSort");e&&T(e),t&&S(),e&&t&&e.sort()}),t.register=C,t.get=m,t.getAutomatic=g,t.setAutomatic=x}),define("document/DocumentCommandHandlers",["require","exports","module","thirdparty/path-utils/path-utils.min","utils/AppInit","command/CommandManager","command/Commands","command/KeyBindingManager","file/NativeFileSystem","project/ProjectManager","document/DocumentManager","editor/EditorManager","project/FileViewController","file/FileUtils","utils/StringUtils","utils/Async","widgets/Dialogs","strings","preferences/PreferencesManager","utils/PerfUtils","utils/KeyEvent"],function(e,t,n){function C(){var e=f.getCurrentDocument();e?(w.text(x),w.attr("title",e.file.fullPath),E.css("visibility",e.isDirty?"visible":"hidden")):(w.text(""),w.attr("title",""),E.css("visibility","hidden")),S.css("width","");var t=w.width();S.css("width",t);var n=T.height();N!==n&&(N=n,l.resizeEditor())}function k(){var e=f.getCurrentDocument();if(e){var t=e.file.fullPath;x=a.makeProjectRelativeIfPossible(t)}else x=null;C()}function L(e,t){var n=f.getCurrentDocument();n&&t.file.fullPath===n.file.fullPath&&C()}function A(e){var t=new $.Deferred;if(!e)console.log("doOpen() called without fullPath"),t.reject();else{var n=y.markStart("Open File:	"+e);t.always(function(){y.addMeasurement(n)}),f.getDocumentForPath(e).done(function(e){f.setCurrentDocument(e),t.resolve(e)}).fail(function(n){h.showFileOpenError(n.name,e).done(function(){f.removeFromWorkingSet(new u.FileEntry(e)),l.focusEditor(),t.reject()})})}return t.promise()}function M(e){var t;return e?t=A(e):(t=new $.Deferred,O||(O=a.getProjectRoot().fullPath),u.showOpenDialog(!0,!1,m.OPEN_FILE,O,null,function(e){var n;if(e.length>0){var r=[];e.forEach(function(e){r.push(new u.FileEntry(e))}),f.addListToWorkingSet(r),A(e[e.length-1]).done(function(e){var t=PathUtils.parseUrl(e.file.fullPath);O=t.protocol+t.doubleSlash+t.authority+t.directory,f.addToWorkingSet(e.file)}).pipe(t.resolve,t.reject)}else t.reject()})),t.promise()}function _(e){var t=null;return e&&(t=e.fullPath),M(t).always(l.focusEditor)}function D(e){return _(e).done(function(e){f.addToWorkingSet(e.file)})}function P(e,t,n,r){var i=new $.Deferred,s=t+n,o=new u.DirectoryEntry(e);return i.progress(function(s,u){if(u>99){i.reject();return}var a=function(e){i.notify(t+"-"+u+n,u+1)},f=function(e){i.resolve(s)};r?o.getDirectory(s,{},a,f):o.getFile(s,{},a,f)}),i.notify(t+n,1),i.promise()}function B(e){if(H){a.forceFinishRename();return}H=!0;var t,n=a.getSelectedItem()||a.getProjectRoot();t=n.fullPath,n.isFile&&(t=t.substr(0,t.lastIndexOf("/")));var r=P(t,m.UNTITLED,e?"":".js",e),i=function(n){a.createNewItem(t,n,!1,e).pipe(r.resolve,r.reject,r.notify).always(function(){H=!1})};return r.done(i),r.fail(function(){i(e?"Untitled":"Untitled.js")}),r}function j(){B(!1)}function F(){B(!0)}function I(e,t){return v.showModalDialog(v.DIALOG_ID_ERROR,m.ERROR_SAVING_FILE_TITLE,p.format(m.ERROR_SAVING_FILE,p.htmlEscape(t),h.getFileErrorString(e)))}function q(e){function n(e,n){I(e.name,n.fullPath).always(function(){t.reject(e)})}var t=new $.Deferred;if(e&&e.isDirty){var r=e.file,i=!1;r.createWriter(function(s){s.onwriteend=function(){i||(e.notifySaved(),t.resolve())},s.onerror=function(e){i=!0,n(e,r)},s.write(e.getText(!0))},function(e){n(e,r)})}else t.resolve();return t.always(function(){l.focusEditor()}),t.promise()}function R(e){var t=null;e&&(t=e.doc);if(!t){var n=l.getActiveEditor();n&&(t=n.document)}return q(t)}function U(){return d.doSequentially(f.getWorkingSet(),function(e){var t=f.getOpenDocumentForPath(e.fullPath);return t?q(t):(new $.Deferred).resolve().promise()},!1)}function z(){return U()}function W(e){var t=new $.Deferred;return h.readAsText(e.file).done(function(n,r){e.refreshText(n,r),t.resolve()}).fail(function(n){h.showFileOpenError(n.name,e.file.fullPath).always(function(){t.reject(n)})}),t.promise()}function X(e){function r(e){n||(f.closeFullEditor(e),l.focusEditor())}var t=e&&e.file,n=e&&e.promptOnly,i=new $.Deferred,s=i.promise();t||f.getCurrentDocument()&&(t=f.getCurrentDocument().file);if(!t)return i.resolve(),s;var o=f.getOpenDocumentForPath(t.fullPath);if(o&&o.isDirty){var u=PathUtils.parseUrl(o.file.fullPath).filename;v.showModalDialog(v.DIALOG_ID_SAVE_CLOSE,m.SAVE_CLOSE_TITLE,p.format(m.SAVE_CLOSE_MESSAGE,p.htmlEscape(u))).done(function(e){e===v.DIALOG_BTN_CANCEL?i.reject():e===v.DIALOG_BTN_OK?q(o).done(function(){r(t),i.resolve()}).fail(function(){i.reject()}):(r(t),!n&&f.getOpenDocumentForPath(t.fullPath)?W(o).pipe(i.resolve,i.reject):i.resolve())}),i.always(function(){l.focusEditor()})}else r(t),l.focusEditor(),i.resolve();return s}function V(e){var t=new $.Deferred,n=e&&e.promptOnly,r=[];f.getWorkingSet().forEach(function(e){var t=f.getOpenDocumentForPath(e.fullPath);t&&t.isDirty&&r.push(t)});if(r.length===0)t.resolve();else if(r.length===1){var i={file:r[0].file,promptOnly:n};X(i).done(function(){t.resolve()}).fail(function(){t.reject()})}else{var s=m.SAVE_CLOSE_MULTI_MESSAGE;s+="<ul>",r.forEach(function(e){s+="<li><span class='dialog-filename'>"+p.htmlEscape(a.makeProjectRelativeIfPossible(e.file.fullPath))+"</span></li>"}),s+="</ul>",v.showModalDialog(v.DIALOG_ID_SAVE_CLOSE,m.SAVE_CLOSE_TITLE,s).done(function(e){e===v.DIALOG_BTN_CANCEL?t.reject():e===v.DIALOG_BTN_OK?U().done(function(){t.resolve()}).fail(function(){t.reject()}):t.resolve()})}return t.done(function(){n||f.closeAll()}),t.promise()}function K(e,t,n){return J?(new $.Deferred).reject().promise():i.execute(s.FILE_CLOSE_ALL,{promptOnly:!0}).done(function(){J=!0,g.savePreferences(),t()}).fail(function(){J=!1,n&&n()})}function Q(){J=!1}function G(e){return K(e,function(){window.close()},function(){brackets.app.abortQuit&&brackets.app.abortQuit()})}function Y(){var e=a.getSelectedItem();if(!e){var t=f.getCurrentDocument();e=t&&t.file}a.renameItemInline(e)}function Z(e){return K(e,function(){brackets.app.quit()},function(){brackets.app.abortQuit&&brackets.app.abortQuit()})}function et(e){return K(e,function(){window.location.reload(!0)})}function nt(e){e.keyCode===b.DOM_VK_CONTROL&&(f.finalizeDocumentNavigation(),tt=!1,$(window.document.body).off("keyup",nt))}function rt(e){var t=f.getNextPrevFile(e);t&&(f.beginDocumentNavigation(),i.execute(s.FILE_OPEN,{fullPath:t.fullPath}),tt||(tt=!0,$(window.document.body).keyup(nt)))}function it(){rt(1)}function st(){rt(-1)}function ot(){a.showInTree(f.getCurrentDocument().file)}e("thirdparty/path-utils/path-utils.min");var r=e("utils/AppInit"),i=e("command/CommandManager"),s=e("command/Commands"),o=e("command/KeyBindingManager"),u=e("file/NativeFileSystem").NativeFileSystem,a=e("project/ProjectManager"),f=e("document/DocumentManager"),l=e("editor/EditorManager"),c=e("project/FileViewController"),h=e("file/FileUtils"),p=e("utils/StringUtils"),d=e("utils/Async"),v=e("widgets/Dialogs"),m=e("strings"),g=e("preferences/PreferencesManager"),y=e("utils/PerfUtils"),b=e("utils/KeyEvent"),w=null,E=null,S=null,x=null,T=null,N=null,O=null,H=!1,J=!1,tt=!1;r.htmlReady(function(){var e=$("#main-toolbar");T=e,S=$(".title-wrapper",T),w=$(".title",S),E=$(".dirty-dot",S)}),i.register(m.CMD_FILE_OPEN,s.FILE_OPEN,_),i.register(m.CMD_ADD_TO_WORKING_SET,s.FILE_ADD_TO_WORKING_SET,D),i.register(m.CMD_FILE_NEW,s.FILE_NEW,j),i.register(m.CMD_FILE_NEW_FOLDER,s.FILE_NEW_FOLDER,F),i.register(m.CMD_FILE_SAVE,s.FILE_SAVE,R),i.register(m.CMD_FILE_SAVE_ALL,s.FILE_SAVE_ALL,z),i.register(m.CMD_FILE_RENAME,s.FILE_RENAME,Y),i.register(m.CMD_FILE_CLOSE,s.FILE_CLOSE,X),i.register(m.CMD_FILE_CLOSE_ALL,s.FILE_CLOSE_ALL,V),i.register(m.CMD_CLOSE_WINDOW,s.FILE_CLOSE_WINDOW,G),brackets.platform==="win"?i.register(m.CMD_EXIT,s.FILE_QUIT,Z):i.register(m.CMD_QUIT,s.FILE_QUIT,Z),i.register(m.CMD_REFRESH_WINDOW,s.DEBUG_REFRESH_WINDOW,et),i.register(m.CMD_ABORT_QUIT,s.APP_ABORT_QUIT,Q),i.register(m.CMD_NEXT_DOC,s.NAVIGATE_NEXT_DOC,it),i.register(m.CMD_PREV_DOC,s.NAVIGATE_PREV_DOC,st),i.register(m.CMD_SHOW_IN_TREE,s.NAVIGATE_SHOW_IN_FILE_TREE,ot),$(f).on("dirtyFlagChange",L),$(f).on("currentDocumentChange fileNameChange",k)}),define("project/FileSyncManager",["require","exports","module","project/ProjectManager","document/DocumentManager","editor/EditorManager","command/Commands","command/CommandManager","utils/Async","widgets/Dialogs","strings","utils/StringUtils","file/FileUtils","file/NativeFileError"],function(e,t,n){function w(e){function t(e){var t=new $.Deferred;return e.file.getMetadata(function(n){n.modificationTime.getTime()!==e.diskTimestamp.getTime()&&(e.isDirty?y.push(e):m.push(e)),t.resolve()},function(n){n.name===p.NOT_FOUND_ERR?(e.isDirty?b.push(e):g.push(e),t.resolve()):(console.log("Error checking modification status of "+e.file.fullPath,n.name),t.reject())}),t.promise()}return m=[],g=[],y=[],b=[],a.doInParallel(e,t,!0)}function E(){function t(e){var t=new $.Deferred;return e.getMetadata(function(e){t.resolve()},function(n){n.name===p.NOT_FOUND_ERR?(i.notifyFileDeleted(e),t.resolve()):(console.log("Error checking for deletion of "+e.fullPath,n.name),t.reject())}),t.promise()}var e=i.getWorkingSet().filter(function(e){return!i.getOpenDocumentForPath(e.fullPath)});return a.doInParallel(e,t,!1)}function S(e){var t=h.readAsText(e.file);return t.done(function(t,n){e.refreshText(t,n)}),t.fail(function(t){console.log("Error reloading contents of "+e.file.fullPath,t.name)}),t}function x(){return a.doInParallel(m,S,!1)}function T(e,t){return f.showModalDialog(f.DIALOG_ID_ERROR,l.ERROR_RELOADING_FILE_TITLE,c.format(l.ERROR_RELOADING_FILE,c.htmlEscape(t.file.fullPath),h.getFileErrorString(e.name)))}function N(){g.forEach(function(e){i.notifyFileDeleted(e.file)})}function C(){function t(e,t){var n=new $.Deferred,s=n.promise();if(v)return n.resolve(),s;var o,u,a;return t<y.length?(a=!1,u=f.DIALOG_ID_EXT_CHANGED,o=c.format(l.EXT_MODIFIED_MESSAGE,c.htmlEscape(r.makeProjectRelativeIfPossible(e.file.fullPath)))):(a=!0,u=f.DIALOG_ID_EXT_DELETED,o=c.format(l.EXT_DELETED_MESSAGE,c.htmlEscape(r.makeProjectRelativeIfPossible(e.file.fullPath)))),f.showModalDialog(u,l.EXT_MODIFIED_TITLE,o).done(function(t){t===f.DIALOG_BTN_DONTSAVE?a?(i.notifyFileDeleted(e.file),n.resolve()):S(e).done(function(){n.resolve()}).fail(function(t){T(t,e).always(function(){n.reject()})}):n.resolve()}),s}var e=y.concat(b);return a.doSequentially(e,t,!1)}function k(){if(d){v=!0,f.cancelModalDialogIfOpen(f.DIALOG_ID_EXT_CHANGED),f.cancelModalDialogIfOpen(f.DIALOG_ID_EXT_DELETED);return}d=!0;var e=i.getAllOpenDocuments();w(e).done(function(){E().always(function(){x().always(function(){N(),C().always(function(){v?(v=!1,d=!1,k()):(d=!1,(y.length>0||b.length>0)&&s.focusEditor())})})})}).fail(function(){d=!1})}var r=e("project/ProjectManager"),i=e("document/DocumentManager"),s=e("editor/EditorManager"),o=e("command/Commands"),u=e("command/CommandManager"),a=e("utils/Async"),f=e("widgets/Dialogs"),l=e("strings"),c=e("utils/StringUtils"),h=e("file/FileUtils"),p=e("file/NativeFileError"),d=!1,v=!1,m,g,y,b;t.syncOpenDocuments=k});var JSLINT=function(){function e(e,t){var n,r=e.length,i={};for(n=0;n<r;n+=1)i[e[n]]=t;return i}function Pt(){}function Ht(e){return N[e]||"\\u"+("0000"+e.charCodeAt().toString(16)).slice(-4)}function Bt(e){Object.keys(e).forEach(function(t){$[t]=e[t]})}function jt(){V.safe||(V.rhino&&(Bt(Z),V.rhino=!1),V.devel&&(Bt(x),V.devel=!1),V.browser&&(Bt(c),V.browser=!1),V.windows&&(Bt(dt),V.windows=!1),V.node&&(Bt(U),V.node=!1,z=!0),V.widget&&(Bt(pt),V.widget=!1)),V.type&&(V.confusion=!0)}function Ft(e){return e||(e=X),e.number||e.string}function It(e,t,n){throw{name:"JSLintError",line:t,character:n,message:h.scanned_a_b.supplant({a:e,b:Math.floor(t/I.length*100)})}}function qt(e,t,n,r,i,s){var o,u,a;return t=t||X,u=t.line||0,o=t.from||0,a={id:"(error)",raw:h[e]||e,evidence:I[u-1]||"",line:u,character:o,a:n||(t.id==="(number)"?String(t.number):t.string),b:r,c:i,d:s},a.reason=a.raw.supplant(a),JSLINT.errors.push(a),V.passfail&&It(h.stopping,u,o),ht+=1,ht>=V.maxerr&&It(h.too_many,u,o),a}function Rt(e,t,n,r,i,s,o){return qt(e,{line:t,from:n},r,i,s,o)}function Ut(e,t,n,r,i,s){var o=qt(e,t,n,r,i,s);It(h.stopping,o.line,o.character)}function zt(e,t,n,r,i,s,o){return Ut(e,{line:t,from:n},r,i,s,o)}function Wt(e){!V.white&&X.from!==e&&qt("expected_a_at_b_c",X,"",e,X.from)}function Xt(e,t,n){return e[t]!==n?(qt("expected_a_b",e,n,e[t]),!0):!1}function Vt(e,t,n){n=n||e.string,C===A?(V.safe&&qt("adsafe_a",e,n),typeof A[n]!="string"&&(e.writeable=typeof $[n]=="boolean"?$[n]:!0,e.funct=C,O[n]=e),t==="becoming"&&(t="var")):typeof C[n]=="string"?C[n]==="undef"?(V.undef||qt("used_before_a",e,n),t="var"):qt("already_defined",e,n):(e.funct=C,e.writeable=!0,et[n]=e),C[n]=t}function $t(e){var t,n=0;e=e||0;while(n<=e)t=q[n],t||(t=q[n]=F.token()),n+=1;return t}function Jt(e,t){if(P){if(ct&&X.line!==ft.line){if((ct!==P||!X.edge)&&X.from===P.at-(X.edge?V.indent:0)){var n=P;for(;;){n.at-=V.indent;if(n===ct)break;n=n.was}n.open=!1}ct=null}X.id==="?"&&P.mode===":"&&ft.line!==X.line&&(P.at-=V.indent),P.open?X.edge?X.edge==="label"?Wt(1):X.edge==="case"||P.mode==="statement"?Wt(P.at-V.indent):(P.mode!=="array"||X.line!==ft.line)&&Wt(P.at):X.line!==ft.line&&(X.from<P.at+(P.mode==="expression"?0:V.indent)&&Wt(P.at+V.indent),P.wrap=!0):X.line!==ft.line&&(X.edge?Wt(P.at):(P.wrap=!0,P.mode==="statement"||P.mode==="var"?Wt(P.at+V.indent):X.from<P.at+(P.mode==="expression"?0:V.indent)&&Wt(P.at+V.indent)))}switch(ft.id){case"(number)":X.id==="."&&qt("trailing_decimal_a");break;case"-":(X.id==="-"||X.id==="--")&&qt("confusing_a");break;case"+":(X.id==="+"||X.id==="++")&&qt("confusing_a")}if(ft.id==="(string)"||ft.identifier)o=ft.string;e&&X.id!==e&&(t?qt("expected_a_b_from_c_d",X,e,t.id,t.line,Ft()):(!X.identifier||X.string!==e)&&qt("expected_a_b",X,e,Ft())),K=ft,ft=X,X=q.shift()||F.token()}function Kt(e){X.identifier&&X.string===e?Jt():qt("expected_a_b",X,e,Ft())}function Qt(){V.adsafe&&(V.safe=!0),V.safe&&(V.browser=V["continue"]=V.css=V.debug=V.devel=V.evil=V.forin=V.newcap=V.nomen=V.on=V.rhino=V.sloppy=V.sub=V.undef=V.widget=V.windows=!1,delete $.Array,delete $.Date,delete $.Function,delete $.Object,delete $.eval,Bt({ADSAFE:!1,lib:!1}))}function Gt(){var e,t;for(;;){if(X.id!=="(string)"&&!X.identifier)return;e=X.string,Jt(),t=!1;if(X.id===":"){Jt(":");switch(X.id){case"true":t=$[e]!==!1,Jt("true");break;case"false":Jt("false");break;default:Ut("unexpected_a")}}$[e]=t;if(X.id!==",")return;Jt(",")}}function Yt(){var e,t;while(X.id==="(string)"||X.identifier)e=X.string,s[e]||Ut("unexpected_a"),Jt(),X.id!==":"&&Ut("expected_a_b",X,":",Ft()),Jt(":"),typeof s[e]=="number"?(t=X.number,(t>s[e]||t<=0||Math.floor(t)!==t)&&Ut("expected_small_a"),V[e]=t):X.id==="true"?V[e]=!0:X.id==="false"?V[e]=!1:Ut("unexpected_a"),Jt(),X.id===","&&Jt(",");jt()}function Zt(){var e,t;V.properties=!0,C["(old_property_type)"]||(C["(old_property_type)"]=Q,Q=Object.create(Q));for(;;){if(X.id!=="(string)"&&!X.identifier)return;e=X.string,t="",Jt(),X.id===":"&&(Jt(":"),X.id==="function"?(Jt("function"),H[X.string]===!0?(t="function "+X.string,Jt()):t="function"):(t=X.string,H[t]!==!0&&(qt("expected_type_a",X),t=""),Jt())),Q[e]=t;if(X.id!==",")return;Jt(",")}}function en(e){X.edge=P?P.open&&(e||"edge"):""}function tn(e){var t;typeof e=="number"?P={at:+e,open:!0,was:P}:e==="statement"?P={at:P.at,open:!0,was:P}:P?(t=e==="var"||X.line!==ft.line,P={at:(t||e==="control"?P.at+V.indent:P.at)+(P.wrap?V.indent:0),mode:e,open:t,was:P},e==="var"&&t&&(ct=P)):P={at:1,mode:"statement",open:!0}}function nn(e,t){e&&(P&&P.open&&(P.at-=V.indent,en()),Jt(e,t)),P&&(P=P.was)}function rn(e,t){e=e||ft,t=t||X,t.id!=="(end)"&&!V.white&&(ft.line!==t.line||ft.thru+1!==t.from)&&qt("expected_space_a_b",t,Ft(ft),Ft(t))}function sn(e,t){e=e||ft,t=t||X,t.id!=="(end)"&&(e.line!==t.line||!V.white&&e.thru+1!==t.from)&&qt("expected_space_a_b",t,Ft(e),Ft(t))}function on(e,t){e=e||ft,t=t||X,(!V.white||vt==="styleproperty"||vt==="style")&&e.thru!==t.from&&e.line===t.line&&qt("unexpected_space_a_b",t,Ft(e),Ft(t))}function un(e,t){e=e||ft,t=t||X,t.id!=="(end)"&&(e.line!==t.line||!V.white&&e.thru!==t.from)&&qt("unexpected_space_a_b",t,Ft(e),Ft(t))}function an(e,t){V.white||(e=e||ft,t=t||X,e.thru===t.from&&e.line===t.line&&qt("missing_space_a_b",t,Ft(e),Ft(t)))}function fn(){X.id!==","?Rt("expected_a_b",ft.line,ft.thru,",",Ft()):(V.white||un(),Jt(","),an())}function ln(){X.id!==";"?Rt("expected_a_b",ft.line,ft.thru,";",Ft()):(V.white||un(),Jt(";"),tt[X.id]!==!0&&an())}function cn(){return X.string==="use strict"?(ot&&qt("unnecessary_use"),en(),Jt(),ln(),ot=!0,V.newcap=!1,V.undef=!1,!0):!1}function hn(e,t){if(e===t)return!0;if(Array.isArray(e)){if(Array.isArray(t)&&e.length===t.length){var n;for(n=0;n<e.length;n+=1)if(!hn(e[n],t[n]))return!1;return!0}return!1}if(Array.isArray(t))return!1;if(e.id==="(number)"&&t.id==="(number)")return e.number===t.number;if(e.arity===t.arity&&e.string===t.string)switch(e.arity){case"prefix":case"suffix":case undefined:return e.id===t.id&&hn(e.first,t.first);case"infix":return hn(e.first,t.first)&&hn(e.second,t.second);case"ternary":return hn(e.first,t.first)&&hn(e.second,t.second)&&hn(e.third,t.third);case"function":case"regexp":return!1;default:return!0}else{if(e.id==="."&&t.id==="["&&t.arity==="infix")return e.second.string===t.second.string&&t.second.id==="(string)";if(e.id==="["&&e.arity==="infix"&&t.id===".")return e.second.string===t.second.string&&e.second.id==="(string)"}return!1}function pn(e,t){var n;X.id==="(end)"&&Ut("unexpected_a",ft,X.id),Jt(),V.safe&&et[ft.string]&&et[ft.string]===O[ft.string]&&X.id!=="("&&X.id!=="."&&qt("adsafe_a",ft),t&&(o="anonymous",C["(verb)"]=ft.string);if(t===!0&&ft.fud)n=ft.fud();else{if(ft.nud)n=ft.nud();else{if(X.id==="(number)"&&ft.id===".")return qt("leading_decimal_a",ft,Ft()),Jt(),ft;Ut("expected_identifier_a",ft,ft.id)}while(e<X.lbp)Jt(),ft.led?n=ft.led(n):Ut("expected_operator_a",ft,ft.id)}return n}function dn(e,t){var n=ut[e];if(!n||typeof n!="object")ut[e]=n={id:e,lbp:t||0,string:e};return n}function vn(e){return e.postscript=!0,e}function mn(e){var t=dn(e,0);return t.from=1,t.thru=1,t.line=0,t.edge="edge",e.string=e,vn(t)}function gn(e,t){var n=dn(e);return n.identifier=n.reserved=!0,n.fud=t,n}function yn(e,t){var n=gn(e,t);n.labeled=!0}function bn(e,t){var n=gn(e,t);n.disrupt=!0}function wn(e){var t=e.id.charAt(0);if(t>="a"&&t<="z"||t>="A"&&t<="Z")e.identifier=e.reserved=!0;return e}function En(e,t,n){var r=dn(e,150);return wn(r),r.nud=typeof t=="function"?t:function(){e==="typeof"?rn():un(),this.first=pn(150),this.arity="prefix";if(this.id==="++"||this.id==="--")V.plusplus?(!this.first.identifier||this.first.reserved)&&this.first.id!=="."&&this.first.id!=="["&&qt("bad_operand",this):qt("unexpected_a",this);return this.type=n,this},r}function Sn(e,t,n){var r=dn(e);return r.arity=r.type=t,n&&(r.nud=n),r}function xn(e,t){var n=dn(e);return n.identifier=n.reserved=!0,typeof t=="function"&&(n.nud=t),n}function Tn(e,t){var n=xn(e);return n.type=t,n.string=e,n.nud=Y,n}function Nn(e,t){return xn(e,function(){return typeof t=="function"&&t(this),this})}function Cn(e,t,n,r,i){var s=dn(e,t);return wn(s),s.led=function(e){return this.arity="infix",i||(an(K,ft),an()),!V.bitwise&&this.bitwise&&qt("unexpected_a",this),typeof n=="function"?n(e,this):(this.first=e,this.second=pn(t),this)},r&&(s.type=r),s}function kn(e,t){return e.assign&&qt(t||h.conditional_assignment,e),e}function Ln(e,t){switch(e.id){case"[":case"-":e.arity!=="infix"&&qt(t||h.weird_condition,e);break;case"false":case"function":case"Infinity":case"NaN":case"null":case"true":case"undefined":case"void":case"(number)":case"(regexp)":case"(string)":case"{":qt(t||h.weird_condition,e);break;case"(":e.first.id==="."&&W[e.first.second.string]===!0&&qt(t||h.weird_condition,e)}return e}function An(e){switch(e.arity){case"prefix":switch(e.id){case"{":case"[":qt("unexpected_a",e);break;case"!":qt("confusing_a",e)}break;case"function":case"regexp":qt("unexpected_a",e);break;default:e.id==="NaN"&&qt("isnan",e)}return e}function On(e,t){return Cn(e,100,function(e,n){An(e),t&&!V.eqeq&&qt("expected_a_b",n,t,n.id);var r=pn(100);return(hn(e,r)||(e.id==="(string)"||e.id==="(number)")&&(r.id==="(string)"||r.id==="(number)"))&&qt("weird_relation",n),n.first=e,n.second=An(r),n},"boolean")}function Mn(e,t){var n=Cn(e,20,function(e,t){var n;t.first=e;if(e.identifier)et[e.string]?et[e.string].writeable===!1&&qt("read_only",e):Ut("read_only");else if(V.safe){n=e;do typeof $[n.string]=="boolean"&&qt("adsafe_a",n),n=n.first;while(n)}return e===ut["function"]&&qt("identifier_function",ft),e.id==="."||e.id==="["?(!e.first||e.first.string==="arguments")&&qt("bad_assignment",t):e.identifier?!e.reserved&&C[e.string]==="exception"&&qt("assign_exception",e):qt("bad_assignment",t),t.second=pn(19),t.id==="="&&hn(t.first,t.second)&&qt("weird_assignment",t),t});return n.assign=!0,t&&(ut[t].type&&(n.type=ut[t].type),ut[t].bitwise&&(n.bitwise=!0)),n}function _n(e,t){var n=Cn(e,t,"number");return n.bitwise=!0,n}function Dn(e){var t=dn(e,150);return t.led=function(e){return un(K,ft),V.plusplus?(!e.identifier||e.reserved)&&e.id!=="."&&e.id!=="["&&qt("bad_operand",this):qt("unexpected_a",this),this.first=e,this.arity="suffix",this},t}function Pn(){if(X.identifier)return Jt(),V.safe&&f[ft.string]?qt("adsafe_a",ft):ft.reserved&&!V.es5&&qt("expected_identifier_a_reserved",ft),ft.string}function Hn(){var e=Pn();return e||Ut(ft.id==="function"&&X.id==="("?"name_function":"expected_identifier_a"),e}function Bn(){var e,t=et,n;if(X.id===";"){qt("unexpected_a"),ln();return}return X.identifier&&!X.reserved&&$t().id===":"&&(en("label"),e=X,Jt(),Jt(":"),et=Object.create(t),Vt(e,"label"),X.labeled!==!0?qt("label_a_b",X,e.string,Ft()):Tt.test(e.string+":")?qt("url",e):C===A&&Ut("unexpected_a",ft),X.label=e),ft.id!=="else"&&en(),tn("statement"),n=pn(0,!0),n&&(n.arity==="statement"?n.id==="switch"||n.block&&n.id!=="do"?an():ln():(n.id==="("?n.first.id==="new"&&qt("bad_new"):!n.assign&&n.id!=="delete"&&n.id!=="++"&&n.id!=="--"&&qt("assignment_function_expression",ft),ln())),nn(),et=t,n}function jn(){var e=[],t,n;while(X.postscript!==!0)X.id===";"?(qt("unexpected_a",X),ln()):(X.string==="use strict"&&((!z&&vt!=="script"||C!==A||e.length>0)&&qt("function_strict"),cn()),t&&(qt("unreachable_a_b",X,X.string,t.string),t=null),n=Bn(),n&&(e.push(n),n.disrupt&&(t=n,e.disrupt=!0)));return e}function Fn(e){var t,n=X,r=D,i=et,s=ot;return D=e,et=Object.create(et),an(),X.id==="{"?(Jt("{"),tn(),!e&&!cn()&&!s&&!V.sloppy&&C["(context)"]===A&&qt("missing_use_strict"),t=jn(),ot=s,nn("}",n)):e?(qt("expected_a_b",X,"{",Ft()),t=[Bn()],t.disrupt=t[0].disrupt):Ut("expected_a_b",X,"{",Ft()),C["(verb)"]=null,et=i,D=r,e&&t.length===0&&qt("empty_block"),t}function In(e){V.properties&&typeof Q[e]!="string"&&qt("unexpected_property_a",ft,e),typeof R[e]=="number"?R[e]+=1:R[e]=1}function qn(){var e=Pn(!0);return e||(X.id==="(string)"?(e=X.string,V.safe&&(f[e]?qt("adsafe_a"):(e.charAt(0)==="_"||e.charAt(e.length-1)==="_")&&qt("dangling_a")),Jt()):X.id==="(number)"&&(e=X.number.toString(),Jt())),e}function Rn(){var e,t=X,n=[];Jt("("),tn(),on();if(X.id===")"){on(),nn(")",t);return}for(;;){en(),e=Hn(),n.push(ft),Vt(ft,V.unparam?"parameter":"unparam");if(X.id!==",")return on(),nn(")",t),n;fn()}}function Un(e,t){var n=C,r=V,i=et;C={"(name)":t||"'"+(o||"").replace(Ct,Ht)+"'","(line)":X.line,"(context)":n,"(breakage)":0,"(loopage)":0,"(scope)":et,"(token)":e},V=Object.create(r),et=Object.create(i),L.push(C),e.name=t,t&&Vt(e,"function",t),e.writeable=!1,e.first=C["(params)"]=Rn(),rn(),e.block=Fn(!1),C["(old_property_type)"]&&(Q=C["(old_property_type)"],delete C["(old_property_type)"]),V.confusion&&(C["(confusion)"]=!0),C=n,V=r,et=i}function zn(){function e(){var e=X,t={};Jt("{");if(X.id!=="}")while(X.id!=="(end)"){while(X.id===",")qt("unexpected_a",X),Jt(",");X.id!=="(string)"&&qt("expected_string_a"),t[X.string]===!0?qt("duplicate_a"):X.string==="__proto__"?qt("dangling_a"):t[X.string]=!0,Jt(),Jt(":"),zn();if(X.id!==",")break;Jt(",");if(X.id==="}"){qt("unexpected_a",ft);break}}Jt("}",e)}function t(){var e=X;Jt("[");if(X.id!=="]")while(X.id!=="(end)"){while(X.id===",")qt("unexpected_a",X),Jt(",");zn();if(X.id!==",")break;Jt(",");if(X.id==="]"){qt("unexpected_a",ft);break}}Jt("]",e)}switch(X.id){case"{":e();break;case"[":t();break;case"true":case"false":case"null":case"(number)":case"(string)":Jt();break;case"-":Jt("-"),un(),Jt("(number)");break;default:Ut("unexpected_a")}}function Wn(){if(X.identifier)return Jt(),!0}function Xn(){X.id==="-"&&(Jt("-"),un());if(X.id==="(number)")return Jt("(number)"),!0}function Vn(){if(X.id==="(string)")return Jt(),!0}function $n(){var e,t,n,r;if(X.identifier){r=X.string;if(r==="rgb"||r==="rgba"){Jt(),n=X,Jt("(");for(e=0;e<3;e+=1)e&&fn(),t=X.number,X.id!=="(number)"||t<0?(qt("expected_positive_a",X),Jt()):(Jt(),X.id==="%"?(Jt("%"),t>100&&qt("expected_percent_a",ft,t)):t>255&&qt("expected_small_a",ft,t));return r==="rgba"&&(fn(),t=X.number,(X.id!=="(number)"||t<0||t>1)&&qt("expected_fraction_a",X),Jt(),X.id==="%"&&(qt("unexpected_a"),Jt("%"))),Jt(")",n),!0}if(m[X.string]===!0)return Jt(),!0}else if(X.id==="(color)")return Jt(),!0;return!1}function Jn(){return X.id==="-"&&(Jt("-"),un()),X.id==="(number)"?(Jt(),X.id!=="(string)"&&b[X.string]===!0?(un(),Jt()):+ft.number!==0&&qt("expected_linear_a"),!0):!1}function Kn(){return X.id==="-"&&(Jt("-"),un()),X.id==="(number)"?(Jt(),X.id!=="(string)"&&b[X.string]===!0&&(un(),Jt()),!0):!1}function Qn(){if(!X.identifier)return Jn();switch(X.string){case"thin":case"medium":case"thick":return Jt(),!0}}function Gn(){if(!X.identifier)return Jn();if(X.string==="auto")return Jt(),!0}function Yn(){return X.identifier&&X.string==="attr"?(Jt(),Jt("("),X.identifier||qt("expected_name_a"),Jt(),Jt(")"),!0):!1}function Zn(){while(X.id!==";"){!Wn()&&!Vn()&&qt("expected_name_a");if(X.id!==",")return!0;fn()}}function er(){return X.identifier&&X.string==="counter"?(Jt(),Jt("("),Jt(),X.id===","&&(fn(),X.id!=="(string)"&&qt("expected_string_a"),Jt()),Jt(")"),!0):X.identifier&&X.string==="counters"?(Jt(),Jt("("),X.identifier||qt("expected_name_a"),Jt(),X.id===","&&(fn(),X.id!=="(string)"&&qt("expected_string_a"),Jt()),X.id===","&&(fn(),X.id!=="(string)"&&qt("expected_string_a"),Jt()),Jt(")"),!0):!1}function tr(){return Jn()&&(X.id!=="(number)"||Jn())}function nr(){var e;if(X.identifier&&X.string==="rect"){Jt(),Jt("(");for(e=0;e<4;e+=1)if(!Jn()){qt("expected_number_a");break}return Jt(")"),!0}return!1}function rr(){var e,t;if(X.identifier&&X.string==="url"){X=F.range("(",")"),t=X.string,e=t.charAt(0);if(e==='"'||e==="'")t.slice(-1)!==e?qt("bad_url_a"):(t=t.slice(1,-1),t.indexOf(e)>=0&&qt("bad_url_a"));return t||qt("missing_url"),_t.test(t)&&Ut("bad_url_a"),lt.push(t),Jt(),!0}return!1}function ir(){Kt("font-family"),Jt(":"),!Wn()&&!Vn()&&Ut("expected_name_a"),ln(),Kt("src"),Jt(":");for(;;){X.string==="local"?(Kt("local"),Jt("("),_t.test(X.string)&&Ut("bad_url_a"),!Wn()&&!Vn()&&Ut("expected_name_a"),Jt(")")):rr()||Ut("expected_a_b",X,"url",Ft());if(X.id!==",")break;fn()}ln()}function sr(){var e;while(X.id==="*"||X.id==="#"||X.string==="_")V.css||qt("unexpected_a"),Jt();return X.id==="-"?(V.css||qt("unexpected_a"),Jt("-"),X.identifier||qt("expected_nonstandard_style_attribute"),Jt(),v):(X.identifier?Object.prototype.hasOwnProperty.call(d,X.string)?e=d[X.string]:(e=v,V.css||qt("unrecognized_style_attribute_a")):qt("expected_style_attribute"),Jt(),e)}function or(e){var t=0,n,r,i,s,o=0,u;switch(typeof e){case"function":return e();case"string":if(X.identifier&&X.string===e)return Jt(),!0;return!1}for(;;){if(t>=e.length)return!1;u=e[t],t+=1;if(typeof u=="boolean")break;typeof u=="number"?(n=u,u=e[t],t+=1):n=1,i=!1;while(n>0){if(!or(u))break;i=!0,n-=1}if(i)return!0}o=t,r=[];for(;;){s=!1;for(t=o;t<e.length;t+=1)if(!r[t]&&or(d[e[t]])){i=!0,s=!0,r[t]=!0;break}if(!s)return i}}function ur(){if(X.id==="(number)"){Jt(),X.string==="n"&&X.identifier&&(un(),Jt(),X.id==="+"&&(un(),Jt("+"),un(),Jt("(number)")));return}if(!(!X.identifier||X.string!=="odd"&&X.string!=="even")){Jt();return}qt("unexpected_a")}function ar(){var e;for(;;){if(X.id==="}"||X.id==="(end)"||mt&&X.id===mt)return;e=sr(),Jt(":"),X.identifier&&X.string==="inherit"?Jt():or(e)||(qt("unexpected_a"),Jt()),X.id==="!"&&(Jt("!"),un(),X.identifier&&X.string==="important"?Jt():qt("expected_a_b",X,"important",Ft())),X.id==="}"||X.id===mt?qt("expected_a_b",X,";",Ft()):ln()}}function fr(){if(X.identifier)Object.prototype.hasOwnProperty.call(M,V.cap?X.string.toLowerCase():X.string)||qt("expected_tagname_a"),Jt();else switch(X.id){case">":case"+":Jt(),fr();break;case":":Jt(":");switch(X.string){case"active":case"after":case"before":case"checked":case"disabled":case"empty":case"enabled":case"first-child":case"first-letter":case"first-line":case"first-of-type":case"focus":case"hover":case"last-child":case"last-of-type":case"link":case"only-of-type":case"root":case"target":case"visited":Kt(X.string);break;case"lang":Kt("lang"),Jt("("),X.identifier||qt("expected_lang_a"),Jt(")");break;case"nth-child":case"nth-last-child":case"nth-last-of-type":case"nth-of-type":Kt(X.string),Jt("("),ur(),Jt(")");break;case"not":Kt("not"),Jt("("),X.id===":"&&$t(0).string==="not"&&qt("not"),fr(),Jt(")");break;default:qt("expected_pseudo_a")}break;case"#":Jt("#"),X.identifier||qt("expected_id_a"),Jt();break;case"*":Jt("*");break;case".":Jt("."),X.identifier||qt("expected_class_a"),Jt();break;case"[":Jt("["),X.identifier||qt("expected_attribute_a"),Jt();if(X.id==="="||X.string==="~="||X.string==="$="||X.string==="|="||X.id==="*="||X.id==="^=")Jt(),X.id!=="(string)"&&qt("expected_string_a"),Jt();Jt("]");break;default:Ut("expected_selector_a")}}function lr(){X.id==="{"&&qt("expected_style_pattern");for(;;){fr();if(X.id==="</"||X.id==="{"||X.id==="}"||X.id==="(end)")return"";X.id===","&&fn()}}function cr(){while(X.id!=="}"&&X.id!=="</"&&X.id!=="(end)")lr(),vt="styleproperty",X.id===";"?ln():(Jt("{"),ar(),vt="style",Jt("}"))}function hr(){var e;while(X.id==="@"){e=$t(),Jt("@");switch(X.string){case"import":Kt("import"),rr()||(qt("expected_a_b",X,"url",Ft()),Jt()),ln();break;case"media":Kt("media");for(;;){(!X.identifier||w[X.string]!==!0)&&Ut("expected_media_a"),Jt();if(X.id!==",")break;fn()}Jt("{"),cr(),Jt("}");break;case"font-face":Kt("font-face"),Jt("{"),ir(),Jt("}");break;default:Ut("expected_at_a")}}cr()}function pr(e){e!=="html"&&!V.fragment&&(e==="div"&&V.adsafe?Ut("adsafe_fragment"):Ut("expected_a_b",ft,"html",e)),V.adsafe&&(e==="html"&&Ut("adsafe_html",ft),V.fragment?e!=="div"&&Ut("adsafe_div",ft):Ut("adsafe_fragment",ft)),V.browser=!0}function dr(e,n){var r,i;e==="id"?(r=typeof n=="string"?n.toUpperCase():"",_[r]===!0&&qt("duplicate_a",X,n),/^[A-Za-z][A-Za-z0-9._:\-]*$/.test(n)?V.adsafe&&(t?n.slice(0,t.length)!==t?qt("adsafe_prefix_a",X,t):/^[A-Z]+_[A-Z]+$/.test(n)||qt("adsafe_bad_id"):(t=n,/^[A-Z]+_$/.test(n)||qt("adsafe_bad_id"))):qt("bad_id_a",X,n),i=n.search(Et),i>=0&&qt("unexpected_char_a_b",ft,n.charAt(i),e),_[r]=!0):e==="class"||e==="type"||e==="name"?(i=n.search(Lt),i>=0&&qt("unexpected_char_a_b",ft,n.charAt(i),e),_[r]=!0):e==="href"||e==="background"||e==="content"||e==="data"||e.indexOf("src")>=0||e.indexOf("url")>=0?(V.safe&&_t.test(n)&&Ut("bad_url_a",X,n),lt.push(n)):e==="for"?V.adsafe&&(t?n.slice(0,t.length)!==t?qt("adsafe_prefix_a",X,t):/^[A-Z]+_[A-Z]+$/.test(n)||qt("adsafe_bad_id"):qt("adsafe_bad_id")):e==="name"&&V.adsafe&&n.indexOf("_")>=0&&qt("adsafe_name_a",X,n)}function vr(e,s){var o,a=M[e],f,l;nt=!1,a||Ut(h.unrecognized_tag_a,X,e===e.toLowerCase()?e:e+" (capitalization error)");if(rt.length>0){e==="html"&&Ut("unexpected_a",ft,e),l=a.parent;if(l)l.indexOf(" "+rt[rt.length-1].name+" ")<0&&Ut("tag_a_in_b",ft,e,l);else if(!V.adsafe&&!V.fragment){o=rt.length;do o<=0&&Ut("tag_a_in_b",ft,e,"body"),o-=1;while(rt[o].name!=="body")}}switch(e){case"div":V.adsafe&&rt.length===1&&!t&&qt("adsafe_missing_id");break;case"script":vt="script",Jt(">"),s.lang&&qt("lang",ft),V.adsafe&&rt.length!==1&&qt("adsafe_placement",ft);if(s.src)V.adsafe&&(!n||!u[s.src])&&qt("adsafe_source",ft),s.type&&qt("type",ft);else{tn(X.from),en(),cn(),r=!0,f=jn();if(V.adsafe){i&&Ut("adsafe_script",ft),(f.length!==1||Xt(f[0],"id","(")||Xt(f[0].first,"id",".")||Xt(f[0].first.first,"string","ADSAFE")||Xt(f[0].second[0],"string",t))&&Ut("adsafe_id_go");switch(f[0].first.second.string){case"id":(n||i||f[0].second.length!==1)&&Ut("adsafe_id",X),n=!0;break;case"go":i&&Ut("adsafe_go"),(f[0].second.length!==2||Xt(f[0].second[1],"id","function")||!f[0].second[1].first||Xt(f[0].second[1].first[0],"string","dom")||f[0].second[1].first.length>2||f[0].second[1].first.length===2&&Xt(f[0].second[1].first[1],"string","lib"))&&Ut("adsafe_go",X),i=!0;break;default:Ut("adsafe_id_go")}}P=null}vt="html",Jt("</"),Kt("script"),vt="outer";break;case"style":vt="style",Jt(">"),hr(),vt="html",Jt("</"),Kt("style");break;case"input":switch(s.type){case"button":case"checkbox":case"radio":case"reset":case"submit":break;case"file":case"hidden":case"image":case"password":case"text":V.adsafe&&s.autocomplete!=="off"&&qt("adsafe_autocomplete");break;default:qt("bad_type")}break;case"applet":case"body":case"embed":case"frame":case"frameset":case"head":case"iframe":case"noembed":case"noframes":case"object":case"param":V.adsafe&&qt("adsafe_tag",X,e)}}function mr(e){return"</"+e+">"}function gr(){var e,t,n,r,i=V.white,s,o,u,a;vt="html",mt="",rt=null;for(;;){switch(X.string){case"<":vt="html",Jt("<"),t={},o=X,r=o.string,Kt(r),V.cap&&(r=r.toLowerCase()),o.name=r,rt||(rt=[],pr(r)),u=M[r],typeof u!="object"&&Ut("unrecognized_tag_a",o,r),n=u.empty,o.type=r;for(;;){if(X.id==="/"){Jt("/"),X.id!==">"&&qt("expected_a_b",X,">",Ft());break}if(X.id&&X.id.charAt(0)===">")break;X.identifier||((X.id==="(end)"||X.id==="(error)")&&qt("expected_a_b",X,">",Ft()),qt("bad_name_a")),V.white=!1,an(),e=X.string,V.white=i,Jt(),!V.cap&&e!==e.toLowerCase()&&qt("attribute_case_a",ft),e=e.toLowerCase(),mt="",Object.prototype.hasOwnProperty.call(t,e)&&qt("duplicate_a",ft,e),e.slice(0,2)==="on"?(V.on||qt("html_handlers"),vt="scriptstring",Jt("="),s=X.id,s!=='"'&&s!=="'"&&Ut("expected_a_b",X,'"',Ft()),mt=s,a=V.white,V.white=!0,Jt(s),cn(),jn(),V.white=a,X.id!==s&&Ut("expected_a_b",X,s,Ft()),vt="html",mt="",Jt(s),u=!1):e==="style"?(vt="scriptstring",Jt("="),s=X.id,s!=='"'&&s!=="'"&&Ut("expected_a_b",X,'"',Ft()),vt="styleproperty",mt=s,Jt(s),ar(),vt="html",mt="",Jt(s),u=!1):X.id==="="?(Jt("="),u=X.string,!X.identifier&&X.id!=='"'&&X.id!=="'"&&X.id!=="(string)"&&X.id!=="(string)"&&X.id!=="(color)"&&qt("expected_attribute_value_a",ft,e),Jt()):u=!0,t[e]=u,dr(e,u)}vr(r,t),n||rt.push(o),vt="outer",Jt(">");break;case"</":vt="html",Jt("</"),X.identifier||qt("bad_name_a"),r=X.string,V.cap&&(r=r.toLowerCase()),Jt(),rt||Ut("unexpected_a",X,mr(r)),o=rt.pop(),o||Ut("unexpected_a",X,mr(r)),o.name!==r&&Ut("expected_a_b",X,mr(o.name),mr(r)),X.id!==">"&&Ut("expected_a_b",X,">",Ft()),vt="outer",Jt(">");break;case"<!":V.safe&&qt("adsafe_a"),vt="html";for(;;){Jt();if(X.id===">"||X.id==="(end)")break;X.string.indexOf("--")>=0&&Ut("unexpected_a",X,"--"),X.string.indexOf("<")>=0&&Ut("unexpected_a",X,"<"),X.string.indexOf(">")>=0&&Ut("unexpected_a",X,">")}vt="outer",Jt(">");break;case"(end)":return;default:X.id==="(end)"?Ut("missing_a",X,"</"+rt[rt.length-1].string+">"):Jt()}if(rt&&rt.length===0&&(V.adsafe||!V.fragment||X.id==="(end)"))break}X.id!=="(end)"&&Ut("unexpected_a")}var t,n,r,i,s={anon:!0,bitwise:!0,browser:!0,cap:!0,confusion:!0,"continue":!0,css:!0,debug:!0,devel:!0,eqeq:!0,es5:!0,evil:!0,forin:!0,fragment:!0,indent:10,maxerr:1e3,maxlen:256,newcap:!0,node:!0,nomen:!0,on:!0,passfail:!0,plusplus:!0,properties:!0,regexp:!0,rhino:!0,undef:!0,unparam:!0,sloppy:!0,sub:!0,vars:!0,white:!0,widget:!0,windows:!0},o,u,a={"<":!0,"<=":!0,"==":!0,"===":!0,"!==":!0,"!=":!0,">":!0,">=":!0,"+":!0,"-":!0,"*":!0,"/":!0,"%":!0},f=e(["arguments","callee","caller","constructor","eval","prototype","stack","unwatch","valueOf","watch"],!0),l,c=e(["clearInterval","clearTimeout","document","event","frames","history","Image","localStorage","location","name","navigator","Option","parent","screen","sessionStorage","setInterval","setTimeout","Storage","window","XMLHttpRequest"],!1),h={a_label:"'{a}' is a statement label.",a_not_allowed:"'{a}' is not allowed.",a_not_defined:"'{a}' is not defined.",a_scope:"'{a}' used out of scope.",adsafe_a:"ADsafe violation: '{a}'.",adsafe_autocomplete:"ADsafe autocomplete violation.",adsafe_bad_id:"ADSAFE violation: bad id.",adsafe_div:"ADsafe violation: Wrap the widget in a div.",adsafe_fragment:"ADSAFE: Use the fragment option.",adsafe_go:"ADsafe violation: Misformed ADSAFE.go.",adsafe_html:"Currently, ADsafe does not operate on whole HTML documents. It operates on <div> fragments and .js files.",adsafe_id:"ADsafe violation: id does not match.",adsafe_id_go:"ADsafe violation: Missing ADSAFE.id or ADSAFE.go.",adsafe_lib:"ADsafe lib violation.",adsafe_lib_second:"ADsafe: The second argument to lib must be a function.",adsafe_missing_id:"ADSAFE violation: missing ID_.",adsafe_name_a:"ADsafe name violation: '{a}'.",adsafe_placement:"ADsafe script placement violation.",adsafe_prefix_a:"ADsafe violation: An id must have a '{a}' prefix",adsafe_script:"ADsafe script violation.",adsafe_source:"ADsafe unapproved script source.",adsafe_subscript_a:"ADsafe subscript '{a}'.",adsafe_tag:"ADsafe violation: Disallowed tag '{a}'.",already_defined:"'{a}' is already defined.",and:"The '&&' subexpression should be wrapped in parens.",assign_exception:"Do not assign to the exception parameter.",assignment_function_expression:"Expected an assignment or function call and instead saw an expression.",attribute_case_a:"Attribute '{a}' not all lower case.",avoid_a:"Avoid '{a}'.",bad_assignment:"Bad assignment.",bad_color_a:"Bad hex color '{a}'.",bad_constructor:"Bad constructor.",bad_entity:"Bad entity.",bad_html:"Bad HTML string",bad_id_a:"Bad id: '{a}'.",bad_in_a:"Bad for in variable '{a}'.",bad_invocation:"Bad invocation.",bad_name_a:"Bad name: '{a}'.",bad_new:"Do not use 'new' for side effects.",bad_number:"Bad number '{a}'.",bad_operand:"Bad operand.",bad_style:"Bad style.",bad_type:"Bad type.",bad_url_a:"Bad url '{a}'.",bad_wrap:"Do not wrap function literals in parens unless they are to be immediately invoked.",combine_var:"Combine this with the previous 'var' statement.",conditional_assignment:"Expected a conditional expression and instead saw an assignment.",confusing_a:"Confusing use of '{a}'.",confusing_regexp:"Confusing regular expression.",constructor_name_a:"A constructor name '{a}' should start with an uppercase letter.",control_a:"Unexpected control character '{a}'.",css:"A css file should begin with @charset 'UTF-8';",dangling_a:"Unexpected dangling '_' in '{a}'.",dangerous_comment:"Dangerous comment.",deleted:"Only properties should be deleted.",duplicate_a:"Duplicate '{a}'.",empty_block:"Empty block.",empty_case:"Empty case.",empty_class:"Empty class.",es5:"This is an ES5 feature.",evil:"eval is evil.",expected_a:"Expected '{a}'.",expected_a_b:"Expected '{a}' and instead saw '{b}'.",expected_a_b_from_c_d:"Expected '{a}' to match '{b}' from line {c} and instead saw '{d}'.",expected_at_a:"Expected an at-rule, and instead saw @{a}.",expected_a_at_b_c:"Expected '{a}' at column {b}, not column {c}.",expected_attribute_a:"Expected an attribute, and instead saw [{a}].",expected_attribute_value_a:"Expected an attribute value and instead saw '{a}'.",expected_class_a:"Expected a class, and instead saw .{a}.",expected_fraction_a:"Expected a number between 0 and 1 and instead saw '{a}'",expected_id_a:"Expected an id, and instead saw #{a}.",expected_identifier_a:"Expected an identifier and instead saw '{a}'.",expected_identifier_a_reserved:"Expected an identifier and instead saw '{a}' (a reserved word).",expected_linear_a:"Expected a linear unit and instead saw '{a}'.",expected_lang_a:"Expected a lang code, and instead saw :{a}.",expected_media_a:"Expected a CSS media type, and instead saw '{a}'.",expected_name_a:"Expected a name and instead saw '{a}'.",expected_nonstandard_style_attribute:"Expected a non-standard style attribute and instead saw '{a}'.",expected_number_a:"Expected a number and instead saw '{a}'.",expected_operator_a:"Expected an operator and instead saw '{a}'.",expected_percent_a:"Expected a percentage and instead saw '{a}'",expected_positive_a:"Expected a positive number and instead saw '{a}'",expected_pseudo_a:"Expected a pseudo, and instead saw :{a}.",expected_selector_a:"Expected a CSS selector, and instead saw {a}.",expected_small_a:"Expected a small positive integer and instead saw '{a}'",expected_space_a_b:"Expected exactly one space between '{a}' and '{b}'.",expected_string_a:"Expected a string and instead saw {a}.",expected_style_attribute:"Excepted a style attribute, and instead saw '{a}'.",expected_style_pattern:"Expected a style pattern, and instead saw '{a}'.",expected_tagname_a:"Expected a tagName, and instead saw {a}.",expected_type_a:"Expected a type, and instead saw {a}.",for_if:"The body of a for in should be wrapped in an if statement to filter unwanted properties from the prototype.",function_block:"Function statements should not be placed in blocks. Use a function expression or move the statement to the top of the outer function.",function_eval:"The Function constructor is eval.",function_loop:"Don't make functions within a loop.",function_statement:"Function statements are not invocable. Wrap the whole function invocation in parens.",function_strict:"Use the function form of 'use strict'.",html_confusion_a:"HTML confusion in regular expression '<{a}'.",html_handlers:"Avoid HTML event handlers.",identifier_function:"Expected an identifier in an assignment and instead saw a function invocation.",implied_evil:"Implied eval is evil. Pass a function instead of a string.",infix_in:"Unexpected 'in'. Compare with undefined, or use the hasOwnProperty method instead.",insecure_a:"Insecure '{a}'.",isNaN:"Use the isNaN function to compare with NaN.",label_a_b:"Label '{a}' on '{b}' statement.",lang:"lang is deprecated.",leading_decimal_a:"A leading decimal point can be confused with a dot: '.{a}'.",missing_a:"Missing '{a}'.",missing_a_after_b:"Missing '{a}' after '{b}'.",missing_option:"Missing option value.",missing_property:"Missing property name.",missing_space_a_b:"Missing space between '{a}' and '{b}'.",missing_url:"Missing url.",missing_use_strict:"Missing 'use strict' statement.",mixed:"Mixed spaces and tabs.",move_invocation:"Move the invocation into the parens that contain the function.",move_var:"Move 'var' declarations to the top of the function.",name_function:"Missing name in function statement.",nested_comment:"Nested comment.",not:"Nested not.",not_a_constructor:"Do not use {a} as a constructor.",not_a_defined:"'{a}' has not been fully defined yet.",not_a_function:"'{a}' is not a function.",not_a_label:"'{a}' is not a label.",not_a_scope:"'{a}' is out of scope.",not_greater:"'{a}' should not be greater than '{b}'.",parameter_a_get_b:"Unexpected parameter '{a}' in get {b} function.",parameter_set_a:"Expected parameter (value) in set {a} function.",radix:"Missing radix parameter.",read_only:"Read only.",redefinition_a:"Redefinition of '{a}'.",reserved_a:"Reserved name '{a}'.",scanned_a_b:"{a} ({b}% scanned).",slash_equal:"A regular expression literal can be confused with '/='.",statement_block:"Expected to see a statement and instead saw a block.",stopping:"Stopping. ",strange_loop:"Strange loop.",strict:"Strict violation.",subscript:"['{a}'] is better written in dot notation.",tag_a_in_b:"A '<{a}>' must be within '<{b}>'.",too_long:"Line too long.",too_many:"Too many errors.",trailing_decimal_a:"A trailing decimal point can be confused with a dot: '.{a}'.",type:"type is unnecessary.",type_confusion_a_b:"Type confusion: {a} and {b}.",unclosed:"Unclosed string.",unclosed_comment:"Unclosed comment.",unclosed_regexp:"Unclosed regular expression.",unescaped_a:"Unescaped '{a}'.",unexpected_a:"Unexpected '{a}'.",unexpected_char_a_b:"Unexpected character '{a}' in {b}.",unexpected_comment:"Unexpected comment.",unexpected_property_a:"Unexpected /*property*/ '{a}'.",unexpected_space_a_b:"Unexpected space between '{a}' and '{b}'.",unnecessary_initialize:"It is not necessary to initialize '{a}' to 'undefined'.",unnecessary_use:"Unnecessary 'use strict'.",unreachable_a_b:"Unreachable '{a}' after '{b}'.",unrecognized_style_attribute_a:"Unrecognized style attribute '{a}'.",unrecognized_tag_a:"Unrecognized tag '<{a}>'.",unsafe:"Unsafe character.",url:"JavaScript URL.",use_array:"Use the array literal notation [].",use_braces:"Spaces are hard to count. Use {{a}}.",use_charAt:"Use the charAt method.",use_object:"Use the object literal notation {}.",use_or:"Use the || operator.",use_param:"Use a named parameter.",used_before_a:"'{a}' was used before it was defined.",var_a_not:"Variable {a} was not declared correctly.",weird_assignment:"Weird assignment.",weird_condition:"Weird condition.",weird_new:"Weird construction. Delete 'new'.",weird_program:"Weird program.",weird_relation:"Weird relation.",weird_ternary:"Weird ternary.",wrap_immediate:"Wrap an immediate function invocation in parentheses to assist the reader in understanding that the expression is the result of a function, and not the function itself.",wrap_regexp:"Wrap the /regexp/ literal in parens to disambiguate the slash operator.",write_is_wrong:"document.write can be a form of eval."},p,d,v,m=e(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext"],!0),g,y,b={"%":!0,cm:!0,em:!0,ex:!0,"in":!0,mm:!0,pc:!0,pt:!0,px:!0},w,E,S={b:"\b",t:"	",n:"\n",f:"\f",r:"\r",'"':'"',"/":"/","\\":"\\"},x=e(["alert","confirm","console","Debug","opera","prompt","WSH"],!1),T,N={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'",'"':'\\"',"/":"\\/","\\":"\\\\"},C,k=["closure","exception","global","label","outer","undef","unused","var"],L,A,O,M={a:{},abbr:{},acronym:{},address:{},applet:{},area:{empty:!0,parent:" map "},article:{},aside:{},audio:{},b:{},base:{empty:!0,parent:" head "},bdo:{},big:{},blockquote:{},body:{parent:" html noframes "},br:{empty:!0},button:{},canvas:{parent:" body p div th td "},caption:{parent:" table "},center:{},cite:{},code:{},col:{empty:!0,parent:" table colgroup "},colgroup:{parent:" table "},command:{parent:" menu "},datalist:{},dd:{parent:" dl "},del:{},details:{},dialog:{},dfn:{},dir:{},div:{},dl:{},dt:{parent:" dl "},em:{},embed:{},fieldset:{},figure:{},font:{},footer:{},form:{},frame:{empty:!0,parent:" frameset "},frameset:{parent:" html frameset "},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},head:{parent:" html "},header:{},hgroup:{},hr:{empty:!0},"hta:application":{empty:!0,parent:" head "},html:{parent:"*"},i:{},iframe:{},img:{empty:!0},input:{empty:!0},ins:{},kbd:{},keygen:{},label:{},legend:{parent:" details fieldset figure "},li:{parent:" dir menu ol ul "},link:{empty:!0,parent:" head "},map:{},mark:{},menu:{},meta:{empty:!0,parent:" head noframes noscript "},meter:{},nav:{},noframes:{parent:" html body "},noscript:{parent:" body head noframes "},object:{},ol:{},optgroup:{parent:" select "},option:{parent:" optgroup select "},output:{},p:{},param:{empty:!0,parent:" applet object "},pre:{},progress:{},q:{},rp:{},rt:{},ruby:{},samp:{},script:{empty:!0,parent:" body div frame head iframe p pre span "},section:{},select:{},small:{},span:{},source:{},strong:{},style:{parent:" head ",empty:!0},sub:{},sup:{},table:{},tbody:{parent:" table "},td:{parent:" tr "},textarea:{},tfoot:{parent:" table "},th:{parent:" tr "},thead:{parent:" table "},time:{},title:{parent:" head "},tr:{parent:" table tbody thead tfoot "},tt:{},u:{},ul:{},"var":{},video:{}},_,D,P,H=e(["*","array","boolean","function","number","object","regexp","string"],!0),B,j,F,I,q,R,U=e(["Buffer","clearInterval","clearTimeout","console","exports","global","module","process","querystring","require","setInterval","setTimeout","__dirname","__filename"],!1),z,W=e(["indexOf","lastIndexOf","search"],!0),X,V,$,J,K,Q,G=e(["g","i","m"],!0),Y=function(){return this},Z=e(["defineClass","deserialize","gc","help","load","loadClass","print","quit","readFile","readUrl","runCommand","seal","serialize","spawn","sync","toint32","version"],!1),et,tt=e([";",'"',"'",")"],!0),nt,rt,it=e(["Array","Boolean","Date","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","Error","eval","EvalError","Function","isFinite","isNaN","JSON","Math","Number","Object","parseInt","parseFloat","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError"],!1),st={E:"number",LN2:"number",LN10:"number",LOG2E:"number",LOG10E:"number",MAX_VALUE:"number",MIN_VALUE:"number",NEGATIVE_INFINITY:"number",PI:"number",POSITIVE_INFINITY:"number",SQRT1_2:"number",SQRT2:"number",apply:"function",bind:"function function",call:"function",ceil:"function number",charAt:"function string",concat:"function",constructor:"function object",create:"function object",defineProperty:"function object",defineProperties:"function object",every:"function boolean",exec:"function array",filter:"function array",floor:"function number",forEach:"function",freeze:"function object",getDate:"function number",getDay:"function number",getFullYear:"function number",getHours:"function number",getMilliseconds:"function number",getMinutes:"function number",getMonth:"function number",getOwnPropertyDescriptor:"function object",getOwnPropertyNames:"function array",getPrototypeOf:"function object",getSeconds:"function number",getTime:"function number",getTimezoneOffset:"function number",getUTCDate:"function number",getUTCDay:"function number",getUTCFullYear:"function number",getUTCHours:"function number",getUTCMilliseconds:"function number",getUTCMinutes:"function number",getUTCMonth:"function number",getUTCSeconds:"function number",getYear:"function number",hasOwnProperty:"function boolean",indexOf:"function number",isExtensible:"function boolean",isFrozen:"function boolean",isPrototypeOf:"function boolean",isSealed:"function boolean",join:"function string",keys:"function array",lastIndexOf:"function number",lastIndex:"number",length:"number",map:"function array",now:"function number",parse:"function",pop:"function",preventExtensions:"function object",propertyIsEnumerable:"function boolean",prototype:"object",push:"function number",reduce:"function",reduceRight:"function",reverse:"function",seal:"function object",setDate:"function",setDay:"function",setFullYear:"function",setHours:"function",setMilliseconds:"function",setMinutes:"function",setMonth:"function",setSeconds:"function",setTime:"function",setTimezoneOffset:"function",setUTCDate:"function",setUTCDay:"function",setUTCFullYear:"function",setUTCHours:"function",setUTCMilliseconds:"function",setUTCMinutes:"function",setUTCMonth:"function",setUTCSeconds:"function",setYear:"function",shift:"function",slice:"function",some:"function boolean",sort:"function",splice:"function",stringify:"function string",substr:"function string",substring:"function string",test:"function boolean",toDateString:"function string",toExponential:"function string",toFixed:"function string",toJSON:"function",toISOString:"function string",toLocaleDateString:"function string",toLocaleLowerCase:"function string",toLocaleUpperCase:"function string",toLocaleString:"function string",toLocaleTimeString:"function string",toLowerCase:"function string",toPrecision:"function string",toTimeString:"function string",toUpperCase:"function string",toUTCString:"function string",trim:"function string",unshift:"function number",valueOf:"function"},ot,ut={},at,ft,lt,ct,ht,pt=e(["alert","animator","appleScript","beep","bytesToUIString","Canvas","chooseColor","chooseFile","chooseFolder","closeWidget","COM","convertPathToHFS","convertPathToPlatform","CustomAnimation","escape","FadeAnimation","filesystem","Flash","focusWidget","form","FormField","Frame","HotKey","Image","include","isApplicationRunning","iTunes","konfabulatorVersion","log","md5","MenuItem","MoveAnimation","openURL","play","Point","popupMenu","preferenceGroups","preferences","print","prompt","random","Rectangle","reloadWidget","ResizeAnimation","resolvePath","resumeUpdates","RotateAnimation","runCommand","runCommandInBg","saveAs","savePreferences","screen","ScrollBar","showWidgetPreferences","sleep","speak","Style","suppressUpdates","system","tellWidget","Text","TextArea","Timer","unescape","updateNow","URL","Web","widget","Window","XMLDOM","XMLHttpRequest","yahooCheckLogin","yahooLogin","yahooLogout"],!0),dt=e(["ActiveXObject","CScript","Debug","Enumerator","System","VBArray","WScript","WSH"],!1),vt,mt,gt=/@cc|<\/?|script|\]\s*\]|<\s*!|&lt/i,yt=/\r/g,bt=/\r\n/g,wt=/[\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/,Et=/[\[\]\/\\"'*<>.&:(){}+=#]/,St=/^\s*(['"=>\/&#]|<(?:\/|\!(?:--)?)?|[a-zA-Z][a-zA-Z0-9_\-:]*|[0-9]+|--)/,xt=/^([a-zA-Z_$][a-zA-Z0-9_$]*)$/,Tt=/^(?:javascript|jscript|ecmascript|vbscript|mocha|livescript)\s*:/i,Nt=/\*\/|\/\*/,Ct=/[\u0000-\u001f'\\\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,kt=/[>&]|<[\/!]?|--/,Lt=/[^a-zA-Z0-9+\-_\/ ]/,At=/^\s*([{}:#%.=,>+\[\]@()"';]|[*$\^~]=|[a-zA-Z_][a-zA-Z0-9_\-]*|[0-9]+|<\/|\/\*)/,Ot=/^\s*([@#!"'};:\-%.=,+\[\]()*_]|[a-zA-Z][a-zA-Z0-9._\-]*|\/\*?|\d+(?:\.\d+)?|<\/)/,Mt=/^\s*([(){}\[\]\?.,:;'"~#@`]|={1,3}|\/(\*(jslint|properties|property|members?|globals?)?|=|\/)?|\*[\/=]?|\+(?:=|\++)?|-(?:=|-+)?|[\^%]=?|&[&=]?|\|[|=]?|>{1,3}=?|<(?:[\/=!]|\!(\[|--)?|<=?)?|\!={0,2}|[a-zA-Z_$][a-zA-Z0-9_$]*|[0-9]+(?:[xX][0-9a-fA-F]+|\.[0-9]*)?(?:[eE][+\-]?[0-9]+)?)/,_t=/&|\+|\u00AD|\.\.|\/\*|%[^;]|base64|url|expression|data|mailto|script/i,Dt={outer:St,html:St,style:At,styleproperty:Ot};return typeof Array.prototype.filter!="function"&&(Array.prototype.filter=function(e){var t,n=this.length,r=[],i;for(t=0;t<n;t+=1)try{i=this[t],e(i)&&r.push(i)}catch(s){}return r}),typeof Array.prototype.forEach!="function"&&(Array.prototype.forEach=function(e){var t,n=this.length;for(t=0;t<n;t+=1)try{e(this[t])}catch(r){}}),typeof Array.isArray!="function"&&(Array.isArray=function(e){return Object.prototype.toString.apply(e)==="[object Array]"}),Object.prototype.hasOwnProperty.call(Object,"create")||(Object.create=function(e){return Pt.prototype=e,new Pt}),typeof Object.keys!="function"&&(Object.keys=function(e){var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}),typeof String.prototype.entityify!="function"&&(String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),typeof String.prototype.isAlpha!="function"&&(String.prototype.isAlpha=function(){return this>="a"&&this<="z￿"||this>="A"&&this<="Z￿"}),typeof String.prototype.isDigit!="function"&&(String.prototype.isDigit=function(){return this>="0"&&this<="9"}),typeof String.prototype.supplant!="function"&&(String.prototype.supplant=function(e){return this.replace(/\{([^{}]*)\}/g,function(t,n){var r=e[n];return typeof r=="string"||typeof r=="number"?r:t})}),F=function(){function a(){var e;return s>=I.length?!1:(t=1,u=I[s],s+=1,e=u.search(/ \t/),e>=0&&Rt("mixed",s,e+1),u=u.replace(/\t/g,at),e=u.search(wt),e>=0&&Rt("unsafe",s,e),V.maxlen&&V.maxlen<u.length&&Rt("too_long",s,u.length),!0)}function f(e,n){var i,o;return(e==="(string)"||e==="(range)")&&Tt.test(n)&&Rt("url",s,r),o=Object.create(ut[e==="(punctuator)"||e==="(identifier)"&&Object.prototype.hasOwnProperty.call(ut,n)?n:e]||ut["(error)"]),e==="(identifier)"&&(o.identifier=!0,n==="__iterator__"||n==="__proto__"?zt("reserved_a",s,r,n):!V.nomen&&(n.charAt(0)==="_"||n.charAt(n.length-1)==="_")&&Rt("dangling_a",s,r,n)),e==="(number)"?o.number=+n:n!==undefined&&(o.string=String(n)),o.line=s,o.from=r,o.thru=t,i=o.id,J=i&&("(,=:[!&|?{};".indexOf(i.charAt(i.length-1))>=0||i==="return"||i==="case"),o}function l(e){var s=e.exec(u),o;if(s)return i=s[0].length,o=s[1],n=o.charAt(0),u=u.slice(i),r=t+i-o.length,t+=i,o}function c(e){function c(e){var r=parseInt(u.substr(i+1,e),16);i+=e,r>=32&&r<=126&&r!==34&&r!==92&&r!==39&&Rt("unexpected_a",s,t,"\\"),t+=e,n=String.fromCharCode(r)}var n,i=0,o="",l;j&&e!=='"'&&Rt("expected_a",s,t,'"');if(mt===e||vt==="scriptstring"&&!mt)return f("(punctuator)",e);for(;;){while(i>=u.length)i=0,(vt!=="html"||!a())&&zt("unclosed",s,r);n=u.charAt(i);if(n===e)return t+=1,u=u.slice(i+1),l=f("(string)",o),l.quote=e,l;if(n<" "){if(n==="\n"||n==="\r")break;Rt("control_a",s,t+i,u.slice(0,i))}else if(n===mt)Rt("bad_html",s,t+i);else if(n==="<")V.safe&&vt==="html"?Rt("adsafe_a",s,t+i,n):u.charAt(i+1)==="/"&&(vt||V.safe)?Rt("expected_a_b",s,t,"<\\/","</"):u.charAt(i+1)==="!"&&(vt||V.safe)&&Rt("unexpected_a",s,t,"<!");else if(n==="\\")if(vt==="html")V.safe&&Rt("adsafe_a",s,t+i,n);else if(vt==="styleproperty")i+=1,t+=1,n=u.charAt(i),n!==e&&Rt("unexpected_a",s,t,"\\");else{i+=1,t+=1,n=u.charAt(i);switch(n){case"":V.es5||Rt("es5",s,t),a(),i=-1;break;case mt:Rt("bad_html",s,t+i);break;case"'":j&&Rt("unexpected_a",s,t,"\\'");break;case"u":c(4);break;case"v":j&&Rt("unexpected_a",s,t,"\\v"),n="";break;case"x":j&&Rt("unexpected_a",s,t,"\\x"),c(2);break;default:n=S[n],typeof n!="string"&&Rt("unexpected_a",s,t,"\\")}}o+=n,t+=1,i+=1}}function d(e){var r;return vt!=="style"&&vt!=="styleproperty"&&u.charAt(0).isAlpha()&&Rt("expected_space_a_b",s,t,n,u.charAt(0)),n==="0"&&(r=e.charAt(1),r.isDigit()?ft.id!=="."&&vt!=="styleproperty"&&Rt("unexpected_a",s,t,e):j&&(r==="x"||r==="X")&&Rt("unexpected_a",s,t,"0x")),e.slice(e.length-1)==="."&&Rt("trailing_decimal_a",s,t,e),vt!=="style"&&(r=+e,isFinite(r)||Rt("bad_number",s,t,e),e=r),f("(number)",e)}function v(e){p||nt||vt&&vt!=="script"&&vt!=="style"&&vt!=="styleproperty"?Rt("unexpected_comment",s,t):vt==="script"&&/<\//i.test(u)?Rt("unexpected_a",s,t,"</"):V.safe&&gt.test(e)&&Rt("dangerous_comment",s,t)}function m(){var e,i,a=0,l=0,c="",p,d,v=0,m,g,y,b;for(;;){e=!0,n=u.charAt(v),v+=1;switch(n){case"":zt("unclosed_regexp",s,r);return;case"/":l>0&&Rt("unescaped_a",s,r+v,"/"),n=u.slice(0,v-1),g=Object.create(G);for(;;){d=u.charAt(v);if(g[d]!==!0)break;g[d]=!1,v+=1,c+=d}return u.charAt(v).isAlpha()&&zt("unexpected_a",s,r,u.charAt(v)),t+=v,u=u.slice(v),y=u.charAt(0),(y==="/"||y==="*")&&zt("confusing_regexp",s,r),b=f("(regexp)",n),b.flag=c,b;case"\\":n=u.charAt(v),n<" "?Rt("control_a",s,r+v,String(n)):n==="<"&&Rt(h.unexpected_a,s,r+v,"\\"),v+=1;break;case"(":l+=1,e=!1;if(u.charAt(v)==="?"){v+=1;switch(u.charAt(v)){case":":case"=":case"!":v+=1;break;default:Rt(h.expected_a_b,s,r+v,":",u.charAt(v))}}else a+=1;break;case"|":e=!1;break;case")":l===0?Rt("unescaped_a",s,r+v,")"):l-=1;break;case" ":o=1;while(u.charAt(v)===" ")v+=1,o+=1;o>1&&Rt("use_braces",s,r+v,o);break;case"[":n=u.charAt(v),n==="^"&&(v+=1,V.regexp?u.charAt(v)==="]"&&zt("unescaped_a",s,r+v,"^"):Rt("insecure_a",s,r+v,n)),i=!1,n==="]"&&(Rt("empty_class",s,r+v-1),i=!0);e:do{n=u.charAt(v),v+=1;switch(n){case"[":case"^":Rt("unescaped_a",s,r+v,n),i=!0;break;case"-":i?i=!1:(Rt("unescaped_a",s,r+v,"-"),i=!0);break;case"]":i||Rt("unescaped_a",s,r+v-1,"-");break e;case"\\":n=u.charAt(v),n<" "?Rt(h.control_a,s,r+v,String(n)):n==="<"&&Rt(h.unexpected_a,s,r+v,"\\"),v+=1,i=!0;break;case"/":Rt("unescaped_a",s,r+v-1,"/"),i=!0;break;case"<":vt==="script"&&(n=u.charAt(v),(n==="!"||n==="/")&&Rt(h.html_confusion_a,s,r+v,n)),i=!0;break;default:i=!0}}while(n);break;case".":V.regexp||Rt("insecure_a",s,r+v,n);break;case"]":case"?":case"{":case"}":case"+":case"*":Rt("unescaped_a",s,r+v,n);break;case"<":vt==="script"&&(n=u.charAt(v),(n==="!"||n==="/")&&Rt(h.html_confusion_a,s,r+v,n))}if(e)switch(u.charAt(v)){case"?":case"+":case"*":v+=1,u.charAt(v)==="?"&&(v+=1);break;case"{":v+=1,n=u.charAt(v),(n<"0"||n>"9")&&Rt(h.expected_number_a,s,r+v,n),v+=1,m=+n;for(;;){n=u.charAt(v);if(n<"0"||n>"9")break;v+=1,m=+n+m*10}p=m;if(n===","){v+=1,p=Infinity,n=u.charAt(v);if(n>="0"&&n<="9"){v+=1,p=+n;for(;;){n=u.charAt(v);if(n<"0"||n>"9")break;v+=1,p=+n+p*10}}}u.charAt(v)!=="}"?Rt(h.expected_a_b,s,r+v,"}",n):v+=1,u.charAt(v)==="?"&&(v+=1),m>p&&Rt(h.not_greater,s,r+v,m,p)}}return n=u.slice(0,v-1),t+=v,u=u.slice(v),f("(regexp)",n)}var t,n,r,i,s,o,u;return{init:function(e){typeof e=="string"?I=e.replace(bt,"\n").replace(yt,"\n").split("\n"):I=e,s=0,a(),r=1},range:function(e,n){var i,o="";r=t,u.charAt(0)!==e&&zt("expected_a_b",s,t,e,u.charAt(0));for(;;){u=u.slice(1),t+=1,i=u.charAt(0);switch(i){case"":zt("missing_a",s,t,i);break;case n:return u=u.slice(1),t+=1,f("(range)",o);case mt:case"\\":Rt("unexpected_a",s,t,i)}o+=i}},token:function(){var e,n,o;for(;;){while(!u)if(!a())return f("(end)");while(vt==="outer"){n=u.search(kt);if(n===0)break;if(n>0){t+=1,u=u.slice(n);break}if(!a())return f("(end)","")}o=l(Dt[vt]||Mt);if(!o)u&&(u.charAt(0)===" "?(V.white||Rt("unexpected_a",s,t,"(space)"),t+=1,u=""):zt("unexpected_a",s,t,u.charAt(0)));else{e=o.charAt(0);if(e.isAlpha()||e==="_"||e==="$")return f("(identifier)",o);if(e.isDigit())return d(o);switch(o){case'"':case"'":return c(o);case"//":v(u),u="";break;case"/*":for(;;){n=u.search(Nt);if(n>=0)break;v(u),a()||zt("unclosed_comment",s,t)}v(u.slice(0,n)),t+=n+2,u.charAt(n)==="/"&&zt("nested_comment",s,t),u=u.slice(n+2);break;case"":break;case"/":return ft.id==="/="&&zt(h.slash_equal,s,r),J?m():f("(punctuator)",o);case"<!--":i=s;for(;;){n=u.indexOf("--");if(n>=0)break;n=u.indexOf("<!"),n>=0&&zt("nested_comment",s,t+n),a()||zt("unclosed_comment",i,e)}i=u.indexOf("<!"),i>=0&&i<n&&zt("nested_comment",s,t+i),t+=n,u.charAt(n+2)!==">"&&zt("expected_a",s,t,"-->"),t+=3,u=u.slice(n+3);break;case"#":if(vt==="html"||vt==="styleproperty"){for(;;){e=u.charAt(0);if((e<"0"||e>"9")&&(e<"a"||e>"f")&&(e<"A"||e>"F"))break;t+=1,u=u.slice(1),o+=e}return o.length!==4&&o.length!==7&&Rt("bad_color_a",s,r+i,o),f("(color)",o)}return f("(punctuator)",o);default:if(vt==="outer"&&e==="&"){t+=1,u=u.slice(1);for(;;){e=u.charAt(0),t+=1,u=u.slice(1);if(e===";")break;e>="0"&&e<="9"||e>="a"&&e<="z"||e==="#"||zt("bad_entity",s,r+i,t)}break}return f("(punctuator)",o)}}}}}}(),T=function(){var t=this.id,n=p,r=P;p=!0,P=null,X.line===ft.line&&X.from===ft.thru&&qt("missing_space_a_b",X,Ft(ft),Ft()),q.length>0&&qt("unexpected_a",this);switch(t){case"/*properties":case"/*property":case"/*members":case"/*member":Zt();break;case"/*jslint":V.safe&&qt("adsafe_a",this),Yt();break;case"/*globals":case"/*global":V.safe&&qt("adsafe_a",this),Gt();break;default:Ut("unexpected_a",this)}p=n,Jt("*/"),P=r},ut["(identifier)"]={id:"(identifier)",lbp:0,identifier:!0,nud:function(){var e=this.string,t=et[e],n,r;typeof t!="object"&&(r=$[e],typeof r=="boolean"?(O[e]=t={string:e,writeable:r,funct:A},A[e]="var"):(V.undef||qt("used_before_a",ft),et[e]=t={string:e,writeable:!0,funct:C},C[e]="undef")),n=t.funct;if(C===n)switch(C[e]){case"becoming":qt("unexpected_a",ft),C[e]="var";break;case"unused":C[e]="var";break;case"unparam":C[e]="parameter";break;case"unction":C[e]="function";break;case"label":qt("a_label",ft,e)}else switch(C[e]){case"closure":case"function":case"var":case"unused":qt("a_scope",ft,e);break;case"label":qt("a_label",ft,e);break;case"outer":case"global":break;default:switch(n[e]){case"becoming":case"closure":case"function":case"parameter":case"unction":case"unused":case"var":n[e]="closure",C[e]=n===A?"global":"outer";break;case"unparam":n[e]="parameter",C[e]="outer";break;case"undef":C[e]="undef";break;case"label":qt("a_label",ft,e)}}return this},led:function(){Ut("expected_operator_a")}},Sn("(array)","array"),Sn("(color)","color"),Sn("(function)","function"),Sn("(number)","number",Y),Sn("(object)","object"),Sn("(string)","string",Y),Sn("(boolean)","boolean",Y),Sn("(range)","range"),Sn("(regexp)","regexp",Y),mn("(begin)"),mn("(end)"),mn("(error)"),vn(dn("</")),dn("<!"),dn("<!--"),dn("-->"),vn(dn("}")),dn(")"),dn("]"),vn(dn('"')),vn(dn("'")),dn(";"),dn(":"),dn(","),dn("#"),dn("@"),dn("*/"),vn(xn("case")),xn("catch"),vn(xn("default")),xn("else"),xn("finally"),Nn("arguments",function(e){ot&&C===A?qt("strict",e):V.safe&&qt("adsafe_a",e)}),Nn("eval",function(e){V.safe&&qt("adsafe_a",e)}),Tn("false","boolean"),Tn("Infinity","number"),Tn("NaN","number"),Tn("null",""),Nn("this",function(e){V.safe?qt("adsafe_a",e):ot&&C["(token)"].arity==="statement"&&C["(name)"].charAt(0)>"Z"&&qt("strict",e)}),Tn("true","boolean"),Tn("undefined",""),Cn("?",30,function(e,t){tn("?"),t.first=Ln(kn(e)),t.second=pn(0),an(),nn();var n=X;return Jt(":"),tn(":"),an(),t.third=pn(10),t.arity="ternary",hn(t.second,t.third)?qt("weird_ternary",n):hn(t.first,t.second)&&qt("use_or",t),nn(),t}),Cn("||",40,function(e,t){function n(e){return e.id==="&&"&&!e.paren&&qt("and",e),e}return t.first=n(Ln(kn(e))),t.second=n(kn(pn(40))),hn(t.first,t.second)&&qt("weird_condition",t),t}),Cn("&&",50,function(e,t){return t.first=Ln(kn(e)),t.second=kn(pn(50)),hn(t.first,t.second)&&qt("weird_condition",t),t}),En("void",function(){return this.first=pn(0),this.arity="prefix",V.es5?qt("expected_a_b",this,"undefined","void"):this.first.number!==0&&qt("expected_a_b",this.first,"0",Ft(this.first)),this.type="undefined",this}),_n("|",70),_n("^",80),_n("&",90),On("==","==="),On("==="),On("!=","!=="),On("!=="),On("<"),On(">"),On("<="),On(">="),_n("<<",120),_n(">>",120),_n(">>>",120),Cn("in",120,function(e,t){return qt("infix_in",t),t.left=e,t.right=pn(130),t},"boolean"),Cn("instanceof",120,null,"boolean"),Cn("+",130,function(e,t){e.id==="(number)"?e.number===0&&qt("unexpected_a",e,"0"):e.id==="(string)"&&e.string===""&&qt("expected_a_b",e,"String","''");var n=pn(130);n.id==="(number)"?n.number===0&&qt("unexpected_a",n,"0"):n.id==="(string)"&&n.string===""&&qt("expected_a_b",n,"String","''");if(e.id===n.id)if(e.id==="(string)"||e.id==="(number)")return e.id==="(string)"?(e.string+=n.string,Tt.test(e.string)&&qt("url",e)):e.number+=n.number,e.thru=n.thru,e;return t.first=e,t.second=n,t}),En("+","num"),En("+++",function(){return qt("confusing_a",ft),this.first=pn(150),this.arity="prefix",this}),Cn("+++",130,function(e){return qt("confusing_a",ft),this.first=e,this.second=pn(130),this}),Cn("-",130,function(e,t){(e.id==="(number)"&&e.number===0||e.id==="(string)")&&qt("unexpected_a",e);var n=pn(130);return(n.id==="(number)"&&n.number===0||n.id==="(string)")&&qt("unexpected_a",e),e.id===n.id&&e.id==="(number)"?(e.number-=n.number,e.thru=n.thru,e):(t.first=e,t.second=n,t)},"number"),En("-"),En("---",function(){return qt("confusing_a",ft),this.first=pn(150),this.arity="prefix",this}),Cn("---",130,function(e){return qt("confusing_a",ft),this.first=e,this.second=pn(130),this}),Cn("*",140,function(e,t){(e.id==="(number)"&&(e.number===0||e.number===1)||e.id==="(string)")&&qt("unexpected_a",e);var n=pn(140);return(n.id==="(number)"&&(n.number===0||n.number===1)||n.id==="(string)")&&qt("unexpected_a",n),e.id===n.id&&e.id==="(number)"?(e.number*=n.number,e.thru=n.thru,e):(t.first=e,t.second=n,t)},"number"),Cn("/",140,function(e,t){(e.id==="(number)"&&e.number===0||e.id==="(string)")&&qt("unexpected_a",e);var n=pn(140);return(n.id==="(number)"&&(n.number===0||n.number===1)||n.id==="(string)")&&qt("unexpected_a",n),e.id===n.id&&e.id==="(number)"?(e.number/=n.number,e.thru=n.thru,e):(t.first=e,t.second=n,t)},"number"),Cn("%",140,function(e,t){(e.id==="(number)"&&(e.number===0||e.number===1)||e.id==="(string)")&&qt("unexpected_a",e);var n=pn(140);return(n.id==="(number)"&&n.number===0||n.id==="(string)")&&qt("unexpected_a",n),e.id===n.id&&e.id==="(number)"?(e.number%=n.number,e.thru=n.thru,e):(t.first=e,t.second=n,t)},"number"),Dn("++"),En("++"),Dn("--"),En("--"),En("delete",function(){rn();var e=pn(0);return(!e||e.id!=="."&&e.id!=="[")&&qt("deleted"),this.first=e,this}),En("~",function(){return un(),V.bitwise||qt("unexpected_a",this),pn(150),this},"number"),En("!",function(){return un(),this.first=Ln(pn(150)),this.arity="prefix",(a[this.first.id]===!0||this.first.assign)&&qt("confusing_a",this),this},"boolean"),En("typeof",null,"string"),En("new",function(){rn();var e=pn(160),t,n,r;this.first=e;if(e.id!=="function")if(e.identifier)switch(e.string){case"Object":qt("use_object",ft);break;case"Array":if(X.id==="("){n=X,n.first=this,Jt("(");if(X.id!==")"){t=pn(0),n.second=[t],(t.type!=="number"||X.id===",")&&qt("use_array",n);while(X.id===",")Jt(","),n.second.push(pn(0))}else qt("use_array",ft);return Jt(")",n),n}qt("use_array",ft);break;case"Number":case"String":case"Boolean":case"Math":case"JSON":qt("not_a_constructor",e);break;case"Function":V.evil||qt("function_eval");break;case"Date":case"RegExp":case"this":break;default:e.id!=="function"&&(r=e.string.charAt(0),!V.newcap&&(r<"A"||r>"Z")&&qt("constructor_name_a",ft))}else e.id!=="."&&e.id!=="["&&e.id!=="("&&qt("bad_constructor",ft);else qt("weird_new",this);return X.id!=="("&&qt("missing_a",X,"()"),this}),Cn("(",160,function(e,t){var n;P&&P.mode==="expression"?on(K,ft):un(K,ft),!e.immed&&e.id==="function"&&qt("wrap_immediate"),n=[],e.identifier?e.string.match(/^[A-Z]([A-Z0-9_$]*[a-z][A-Za-z0-9_$]*)?$/)&&e.string!=="Number"&&e.string!=="String"&&e.string!=="Boolean"&&e.string!=="Date"&&(e.string==="Math"||e.string==="JSON"?qt("not_a_function",e):e.string==="Object"?qt("use_object",ft):(e.string==="Array"||!V.newcap)&&qt("missing_a",e,"new")):e.id==="."&&(V.safe&&e.first.string==="Math"&&e.second==="random"?qt("adsafe_a",e):e.second.string==="split"&&e.first.id==="(string)"&&qt("use_array",e.second)),tn();if(X.id!==")"){on();for(;;){en(),n.push(pn(10));if(X.id!==",")break;fn()}}return on(),nn(")",t),typeof e=="object"&&(e.string==="parseInt"&&n.length===1&&qt("radix",e),V.evil||(e.string==="eval"||e.string==="Function"||e.string==="execScript"?qt("evil",e):n[0]&&n[0].id==="(string)"&&(e.string==="setTimeout"||e.string==="setInterval")&&qt("implied_evil",e)),!e.identifier&&e.id!=="."&&e.id!=="["&&e.id!=="("&&e.id!=="&&"&&e.id!=="||"&&e.id!=="?"&&qt("bad_invocation",e)),t.first=e,t.second=n,t},"",!0),En("(",function(){tn("expression"),on(),en(),X.id==="function"&&(X.immed=!0);var e=pn(0);return e.paren=!0,on(),nn(")",this),e.id==="function"&&(X.id==="("?qt("move_invocation"):qt("bad_wrap",this)),e}),Cn(".",170,function(e,s){on(K,ft),on();var o=Hn(),u;typeof o=="string"&&In(o),s.first=e,s.second=ft,!e||e.string!=="arguments"||o!=="callee"&&o!=="caller"?!V.evil&&e&&e.string==="document"&&(o==="write"||o==="writeln")?qt("write_is_wrong",e):V.adsafe&&(!r&&e.string==="ADSAFE"&&(o==="id"||o==="lib"?qt("adsafe_a",s):o==="go"&&(vt!=="script"?qt("adsafe_a",s):(i||X.id!=="("||$t(0).id!=="(string)"||$t(0).string!==t||$t(1).id!==",")&&Ut("adsafe_a",s,"go"),i=!0,n=!1)),r=!1):qt("avoid_a",e,"arguments."+o);if(!!V.evil||o!=="eval"&&o!=="execScript"){if(V.safe)for(;;){f[o]===!0&&qt("adsafe_a",ft,o);if(typeof $[e.string]!="boolean"||X.id==="(")break;if(X.id!=="."){qt("adsafe_a",s);break}Jt("."),ft.first=s,ft.second=o,s=ft,o=Hn(),typeof o=="string"&&In(o)}}else qt("evil");return u=Q[o],u&&typeof u=="string"&&u!=="*"&&(s.type=u),s},"",!0),Cn("[",170,function(e,t){var n,r;un(K,ft),on(),tn(),en(),n=pn(0);switch(n.type){case"number":n.id==="(number)"&&e.id==="arguments"&&qt("use_param",e);break;case"string":n.id==="(string)"?(V.safe&&(f[n.string]||n.string.charAt(0)==="_"||n.string.slice(-1)==="_")?qt("adsafe_subscript_a",n):!!V.evil||n.string!=="eval"&&n.string!=="execScript"?!V.sub&&xt.test(n.string)&&(r=ut[n.string],(!r||!r.reserved)&&qt("subscript",n)):qt("evil",n),In(n.string)):V.safe&&n.id!=="typeof"&&qt("adsafe_subscript_a",n);break;case undefined:V.safe&&qt("adsafe_subscript_a",n);break;default:V.safe&&qt("adsafe_subscript_a",n)}return nn("]",t),on(K,ft),t.first=e,t.second=n,t},"",!0),En("[",function(){this.arity="prefix",this.first=[],tn("array");while(X.id!=="(end)"){while(X.id===",")qt("unexpected_a",X),Jt(",");if(X.id==="]")break;P.wrap=!1,en(),this.first.push(pn(10));if(X.id!==",")break;fn();if(X.id==="]"&&!V.es5){qt("unexpected_a",ft);break}}return nn("]",this),this},170),Mn("="),Mn("+=","+"),Mn("-=","-"),Mn("*=","*"),Mn("/=","/").nud=function(){Ut("slash_equal")},Mn("%=","%"),Mn("&=","&"),Mn("|=","|"),Mn("^=","^"),Mn("<<=","<<"),Mn(">>=",">>"),Mn(">>>=",">>>"),En("{",function(){var e,t,n,r,i,s,o={};this.arity="prefix",this.first=[],tn();while(X.id!=="}"){P.wrap=!1,en(),X.string==="get"&&$t().id!==":"?(V.es5||qt("es5"),e=X,Jt("get"),sn(),r=X,t=qn(),t||Ut("missing_property"),e.string="",Un(e),C["(loopage)"]&&qt("function_loop",e),i=e.first,i&&qt("parameter_a_get_b",i[0],i[0].string,t),fn(),s=X,an(),en(),Jt("set"),s.string="",sn(),n=qn(),t!==n&&Ut("expected_a_b",ft,t,n||X.string),Un(s),s.block.length===0&&qt("missing_a",ft,"throw"),i=s.first,!i||i.length!==1?Ut("parameter_set_a",s,"value"):i[0].string!=="value"&&Ut("expected_a_b",i[0],"value",i[0].string),r.first=[e,s]):(r=X,t=qn(),typeof t!="string"&&Ut("missing_property"),Jt(":"),an(),r.first=pn(10)),this.first.push(r),o[t]===!0&&qt("duplicate_a",X,t),o[t]=!0,In(t);if(X.id!==",")break;for(;;){fn();if(X.id!==",")break;qt("unexpected_a",X)}X.id==="}"&&!V.es5&&qt("unexpected_a",ft)}return nn("}",this),this}),gn("{",function(){return qt("statement_block"),this.arity="statement",this.block=jn(),this.disrupt=this.block.disrupt,Jt("}",this),this}),gn("/*global",T),gn("/*globals",T),gn("/*jslint",T),gn("/*member",T),gn("/*members",T),gn("/*property",T),gn("/*properties",T),gn("var",function(){var e,t,n;C["(vars)"]&&!V.vars?qt("combine_var"):C!==A&&(C["(vars)"]=!0),this.arity="statement",this.first=[],tn("var");for(;;){n=X,t=Hn(),Vt(n,"becoming"),X.id==="="?(e=X,e.first=n,an(),Jt("="),an(),X.id==="undefined"&&qt("unnecessary_initialize",ft,t),$t(0).id==="="&&X.identifier&&Ut("var_a_not"),e.second=pn(0),e.arity="infix",this.first.push(e)):this.first.push(n),C[t]==="becoming"&&(C[t]="unused");if(X.id!==",")break;fn(),P.wrap=!1,ct&&X.line===ft.line&&this.first.length===1&&(ct=null,P.open=!1,P.at-=V.indent),an(),en()}return ct=null,nn(),this}),gn("function",function(){rn(),D&&qt("function_block",ft);var e=X,t=Hn();return Vt(e,"unction"),on(),this.arity="statement",Un(this,t),X.id==="("&&X.line===ft.line&&Ut("function_statement"),this}),En("function",function(){V.anon||rn();var e=Pn();return e?on():e="",Un(this,e),C["(loopage)"]&&qt("function_loop"),this.arity="function",this}),gn("if",function(){var e=X;return rn(),Jt("("),tn("control"),on(),en(),this.arity="statement",this.first=Ln(kn(pn(0))),on(),nn(")",e),rn(),this.block=Fn(!0),X.id==="else"&&(rn(),Jt("else"),rn(),this["else"]=X.id==="if"||X.id==="switch"?Bn(!0):Fn(!0),this["else"].disrupt&&this.block.disrupt&&(this.disrupt=!0)),this}),gn("try",function(){var e,t,n;return V.adsafe&&qt("adsafe_a",this),rn(),this.arity="statement",this.block=Fn(!1),X.id==="catch"&&(rn(),Jt("catch"),rn(),n=X,Jt("("),tn("control"),on(),en(),t=et,et=Object.create(t),e=X.string,this.first=e,X.identifier?Vt(X,"exception"):qt("expected_identifier_a",X),Jt(),on(),nn(")",n),rn(),this.second=Fn(!1),et=t),X.id==="finally"?(rn(),Jt("finally"),rn(),this.third=Fn(!1)):this.second||Ut("expected_a_b",X,"catch",Ft()),this}),yn("while",function(){rn();var e=X;return C["(breakage)"]+=1,C["(loopage)"]+=1,Jt("("),tn("control"),on(),en(),this.arity="statement",this.first=kn(pn(0)),this.first.id!=="true"&&Ln(this.first,h.unexpected_a),on(),nn(")",e),rn(),this.block=Fn(!0),this.block.disrupt&&qt("strange_loop",K),C["(breakage)"]-=1,C["(loopage)"]-=1,this}),xn("with"),yn("switch",function(){function s(e){hn(n,e)&&qt("duplicate_a",e)}var e=[],t=D,n,r=X,i=!0;C["(breakage)"]+=1,rn(),Jt("("),on(),tn(),this.arity="statement",this.first=Ln(kn(pn(0))),on(),nn(")",r),rn(),Jt("{"),tn(),D=!0,this.second=[];while(X.id==="case"){r=X,e.forEach(s),r.first=[],r.arity="case",an(),en("case"),Jt("case");for(;;){rn(),n=pn(0),e.forEach(s),e.push(n),r.first.push(n),n.id==="NaN"&&qt("unexpected_a",n),un(),Jt(":");if(X.id!=="case")break;an(),en("case"),Jt("case")}an(),r.second=jn(),r.second&&r.second.length>0?(n=r.second[r.second.length-1],n.disrupt?n.id==="break"&&(i=!1):qt("missing_a_after_b",X,"break","case")):qt("empty_case"),this.second.push(r)}return this.second.length===0&&qt("missing_a",X,"case"),X.id==="default"&&(an(),r=X,r.arity="case",en("case"),Jt("default"),un(),Jt(":"),an(),r.second=jn(),r.second&&r.second.length>0&&(n=r.second[r.second.length-1],i&&n.disrupt&&n.id!=="break"&&(this.disrupt=!0)),this.second.push(r)),C["(breakage)"]-=1,an(),nn("}",this),D=t,this}),gn("debugger",function(){return V.debug||qt("unexpected_a",this),this.arity="statement",this}),yn("do",function(){C["(breakage)"]+=1,C["(loopage)"]+=1,rn(),this.arity="statement",this.block=Fn(!0),this.block.disrupt&&qt("strange_loop",K),rn(),Jt("while");var e=X;return rn(),Jt("("),tn(),on(),en(),this.first=Ln(kn(pn(0)),h.unexpected_a),on(),nn(")",e),C["(breakage)"]-=1,C["(loopage)"]-=1,this}),yn("for",function(){var e,t,n=!1,r=X,i;this.arity="statement",C["(breakage)"]+=1,C["(loopage)"]+=1,Jt("(");if(X.id===";")on(),Jt(";"),on(),Jt(";"),on(),Jt(")"),e=Fn(!0);else{tn("control"),an(this,r),on(),X.id==="var"&&Ut("move_var"),en();if($t(0).id==="in"){this.forin=!0,i=X;switch(C[i.string]){case"unused":C[i.string]="var";break;case"closure":case"var":break;default:qt("bad_in_a",i)}Jt(),Jt("in"),this.first=i,this.second=pn(20),nn(")",r),e=Fn(!0);if(!V.forin){if(e.length===1&&typeof e[0]=="object"&&e[0].string==="if"&&!e[0]["else"]){t=e[0].first;while(t.id==="&&")t=t.first;switch(t.id){case"===":case"!==":n=t.first.id==="["?t.first.first.string===this.second.string&&t.first.second.string===this.first.string:t.first.id==="typeof"&&t.first.first.id==="["&&t.first.first.first.string===this.second.string&&t.first.first.second.string===this.first.string;break;case"(":n=t.first.id==="."&&(t.first.first.string===this.second.string&&t.first.second.string==="hasOwnProperty"&&t.second[0].string===this.first.string||t.first.first.string==="ADSAFE"&&t.first.second.string==="has"&&t.second[0].string===this.second.string&&t.second[1].string===this.first.string||t.first.first.id==="."&&t.first.first.first.id==="."&&t.first.first.first.first.string==="Object"&&t.first.first.first.second.string==="prototype"&&t.first.first.second.string==="hasOwnProperty"&&t.first.second.string==="call"&&t.second[0].string===this.second.string&&t.second[1].string===this.first.string)}}n||qt("for_if",this)}}else{en(),this.first=[];for(;;){this.first.push(pn(0,"for"));if(X.id!==",")break;fn()}ln(),en(),this.second=kn(pn(0)),this.second.id!=="true"&&Ln(this.second,h.unexpected_a),ln(ft),X.id===";"&&Ut("expected_a_b",X,")",";"),this.third=[],en();for(;;){this.third.push(pn(0,"for"));if(X.id!==",")break;fn()}on(),nn(")",r),rn(),e=Fn(!0)}}return e.disrupt&&qt("strange_loop",K),this.block=e,C["(breakage)"]-=1,C["(loopage)"]-=1,this}),bn("break",function(){var e=X.string;return this.arity="statement",C["(breakage)"]===0&&qt("unexpected_a",this),X.identifier&&ft.line===X.line&&(sn(),C[e]!=="label"?qt("not_a_label",X):et[e].funct!==C&&qt("not_a_scope",X),this.first=X,Jt()),this}),bn("continue",function(){V["continue"]||qt("unexpected_a",this);var e=X.string;return this.arity="statement",C["(breakage)"]===0&&qt("unexpected_a",this),X.identifier&&ft.line===X.line&&(sn(),C[e]!=="label"?qt("not_a_label",X):et[e].funct!==C&&qt("not_a_scope",X),this.first=X,Jt()),this}),bn("return",function(){return C===A&&qt("unexpected_a",this),this.arity="statement",X.id!==";"&&X.line===ft.line&&(sn(),(X.id==="/"||X.id==="(regexp)")&&qt("wrap_regexp"),this.first=pn(20)),this}),bn("throw",function(){return this.arity="statement",sn(),this.first=pn(20),this}),xn("class"),xn("const"),xn("enum"),xn("export"),xn("extends"),xn("import"),xn("super"),xn("implements"),xn("interface"),xn("let"),xn("package"),xn("private"),xn("protected"),xn("public"),xn("static"),xn("yield"),v=[rr,function(){for(;;)if(X.identifier)switch(X.string.toLowerCase()){case"url":rr();break;case"expression":qt("unexpected_a"),Jt();break;default:Jt()}else{if(X.id===";"||X.id==="!"||X.id==="(end)"||X.id==="}")return!0;Jt()}}],g=["none","dashed","dotted","double","groove","hidden","inset","outset","ridge","solid"],y=["auto","always","avoid","left","right"],w={all:!0,braille:!0,embossed:!0,handheld:!0,print:!0,projection:!0,screen:!0,speech:!0,tty:!0,tv:!0},E=["auto","hidden","scroll","visible"],d={background:[!0,"background-attachment","background-color","background-image","background-position","background-repeat"],"background-attachment":["scroll","fixed"],"background-color":["transparent",$n],"background-image":["none",rr],"background-position":[2,[Jn,"top","bottom","left","right","center"]],"background-repeat":["repeat","repeat-x","repeat-y","no-repeat"],border:[!0,"border-color","border-style","border-width"],"border-bottom":[!0,"border-bottom-color","border-bottom-style","border-bottom-width"],"border-bottom-color":$n,"border-bottom-left-radius":tr,"border-bottom-right-radius":tr,"border-bottom-style":g,"border-bottom-width":Qn,"border-collapse":["collapse","separate"],"border-color":["transparent",4,$n],"border-left":[!0,"border-left-color","border-left-style","border-left-width"],"border-left-color":$n,"border-left-style":g,"border-left-width":Qn,"border-radius":function(){function e(e){var t=1;e&&Jt(e);if(!Jn())return!1;while(X.id==="(number)"){if(!Jn())return!1;t+=1}return t>4&&qt("bad_style"),!0}return e()&&(X.id!=="/"||e("/"))},"border-right":[!0,"border-right-color","border-right-style","border-right-width"],"border-right-color":$n,"border-right-style":g,"border-right-width":Qn,"border-spacing":[2,Jn],"border-style":[4,g],"border-top":[!0,"border-top-color","border-top-style","border-top-width"],"border-top-color":$n,"border-top-left-radius":tr,"border-top-right-radius":tr,"border-top-style":g,"border-top-width":Qn,"border-width":[4,Qn],bottom:[Jn,"auto"],"caption-side":["bottom","left","right","top"],clear:["both","left","none","right"],clip:[nr,"auto"],color:$n,content:["open-quote","close-quote","no-open-quote","no-close-quote",Vn,rr,er,Yn],"counter-increment":[Wn,"none"],"counter-reset":[Wn,"none"],cursor:[rr,"auto","crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","s-resize","se-resize","sw-resize","w-resize","text","wait"],direction:["ltr","rtl"],display:["block","compact","inline","inline-block","inline-table","list-item","marker","none","run-in","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group"],"empty-cells":["show","hide"],"float":["left","none","right"],font:["caption","icon","menu","message-box","small-caption","status-bar",!0,"font-size","font-style","font-weight","font-family"],"font-family":Zn,"font-size":["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller",Jn],"font-size-adjust":["none",Xn],"font-stretch":["normal","wider","narrower","ultra-condensed","extra-condensed","condensed","semi-condensed","semi-expanded","expanded","extra-expanded"],"font-style":["normal","italic","oblique"],"font-variant":["normal","small-caps"],"font-weight":["normal","bold","bolder","lighter",Xn],height:[Jn,"auto"],left:[Jn,"auto"],"letter-spacing":["normal",Jn],"line-height":["normal",Kn],"list-style":[!0,"list-style-image","list-style-position","list-style-type"],"list-style-image":["none",rr],"list-style-position":["inside","outside"],"list-style-type":["circle","disc","square","decimal","decimal-leading-zero","lower-roman","upper-roman","lower-greek","lower-alpha","lower-latin","upper-alpha","upper-latin","hebrew","katakana","hiragana-iroha","katakana-oroha","none"],margin:[4,Gn],"margin-bottom":Gn,"margin-left":Gn,"margin-right":Gn,"margin-top":Gn,"marker-offset":[Jn,"auto"],"max-height":[Jn,"none"],"max-width":[Jn,"none"],"min-height":Jn,"min-width":Jn,opacity:Xn,outline:[!0,"outline-color","outline-style","outline-width"],"outline-color":["invert",$n],"outline-style":["dashed","dotted","double","groove","inset","none","outset","ridge","solid"],"outline-width":Qn,overflow:E,"overflow-x":E,"overflow-y":E,padding:[4,Jn],"padding-bottom":Jn,"padding-left":Jn,"padding-right":Jn,"padding-top":Jn,"page-break-after":y,"page-break-before":y,position:["absolute","fixed","relative","static"],quotes:[8,Vn],right:[Jn,"auto"],"table-layout":["auto","fixed"],"text-align":["center","justify","left","right"],"text-decoration":["none","underline","overline","line-through","blink"],"text-indent":Jn,"text-shadow":["none",4,[$n,Jn]],"text-transform":["capitalize","uppercase","lowercase","none"],top:[Jn,"auto"],"unicode-bidi":["normal","embed","bidi-override"],"vertical-align":["baseline","bottom","sub","super","top","text-top","middle","text-bottom",Jn],visibility:["visible","hidden","collapse"],"white-space":["normal","nowrap","pre","pre-line","pre-wrap","inherit"],width:[Jn,"auto"],"word-spacing":["normal",Jn],"word-wrap":["break-word","normal"],"z-index":["auto",Xn]},B=function(s,o){var a,f,c;JSLINT.errors=[],JSLINT.tree="",l=K=ft=X=Object.create(ut["(begin)"]),$={},Bt(it),Q=Object.create(st);if(o){V=Object.create(o),f=V.predef;if(f)if(Array.isArray(f))for(a=0;a<f.length;a+=1)$[f[a]]=!0;else typeof f=="object"&&Bt(f);Qt()}else V={};V.indent=+V.indent||4,V.maxerr=+V.maxerr||50,t="",n=r=i=!1,u={};if(V.approved)for(a=0;a<V.approved.length;a+=1)u[V.approved[a]]=V.approved[a];else u.test="test";at="";for(a=0;a<V.indent;a+=1)at+=" ";O=et={},A=C={"(scope)":et,"(breakage)":0,"(loopage)":0},L=[C],p=!1,_={},D=!1,P=null,j=!1,q=[],R={},z=!1,J=!0,nt=!1,rt=null,ot=!1,lt=[],ct=null,ht=0,vt="",F.init(s),jt();try{Jt();if(X.id==="(number)")Ut("unexpected_a");else if(X.string.charAt(0)==="<")gr(),V.adsafe&&!i&&qt("adsafe_go",this);else switch(X.id){case"{":case"[":j=!0,zn();break;case"@":case"*":case"#":case".":case":":vt="style",Jt(),(ft.id!=="@"||!X.identifier||X.string!=="charset"||ft.line!==1||ft.from!==1)&&Ut("css"),Jt(),X.id!=="(string)"&&X.string!=="UTF-8"&&Ut("css"),Jt(),ln(),hr();break;default:V.adsafe&&V.fragment&&Ut("expected_a_b",X,"<div>",Ft()),tn(1),X.id===";"&&!z&&ln(),r=!0,c=jn(),l.first=c,JSLINT.tree=l,V.adsafe&&(c.length!==1||Xt(c[0],"id","(")||Xt(c[0].first,"id",".")||Xt(c[0].first.first,"string","ADSAFE")||Xt(c[0].first.second,"string","lib")||c[0].second.length!==2||c[0].second[0].id!=="(string)"||Xt(c[0].second[1],"id","function"))&&Ut("adsafe_lib"),c.disrupt&&qt("weird_program",K)}P=null,Jt("(end)")}catch(h){h&&JSLINT.errors.push({reason:h.message,line:h.line||X.line,character:h.character||X.from},null)}return JSLINT.errors.length===0},B.data=function(){var e={functions:[]},t,n,r,i,s,o=[],u,a,f=[],l=[];B.errors.length&&(e.errors=B.errors),j&&(e.json=!0),lt.length>0&&(e.urls=lt),n=Object.keys(O).filter(function(e){return e.charAt(0)!=="("&&typeof it[e]!="boolean"}),n.length>0&&(e.globals=n);for(r=1;r<L.length;r+=1){a=L[r],t={};for(i=0;i<k.length;i+=1)t[k[i]]=[];for(u in a)if(Object.prototype.hasOwnProperty.call(a,u)&&u.charAt(0)!=="("){s=a[u];if(s==="unction"||s==="unparam")s="unused";Array.isArray(t[s])&&(t[s].push(u),s==="unused"?l.push({name:u,line:a["(line)"],"function":a["(name)"]}):s==="undef"&&f.push({name:u,line:a["(line)"],"function":a["(name)"]}))}for(i=0;i<k.length;i+=1)t[k[i]].length===0&&delete t[k[i]];t.name=a["(name)"],t.params=a["(params)"],t.line=a["(line)"],e.functions.push(t)}l.length>0&&(e.unused=l),f.length>0&&(e["undefined"]=f),o=[];for(u in R)if(typeof R[u]=="number"){e.member=R;break}return e},B.report=function(e){function y(e,t){var n,r;Array.isArray(t)?(p.push("<div><i>"+e+"</i> "),t.sort().forEach(function(e){e!==r&&(r=e,p.push((n?", ":"")+r),n=!0)}),p.push("</div>")):t&&p.push("<div><i>"+e+"</i> "+t+"</div>")}var t=B.data(),n,r,i,s,o,u,a,f,l="",c,h,p=[],d,v,m,g;if(t.errors||t.unused||t["undefined"]){n=!0,p.push("<div id=errors><i>Error:</i>");if(t.errors)for(i=0;i<t.errors.length;i+=1)g=t.errors[i],g&&(r=g.evidence||"",p.push("<p>Problem"+(isFinite(g.line)?" at line "+String(g.line)+" character "+String(g.character):"")+": "+g.reason.entityify()+"</p><p class=evidence>"+(r&&(r.length>80?r.slice(0,77)+"...":r).entityify())+"</p>"));if(t["undefined"]){d=[];for(i=0;i<t["undefined"].length;i+=1)d[i]="<code><u>"+t["undefined"][i].name+"</u></code>&nbsp;<i>"+String(t["undefined"][i].line)+" </i> <small>"+t["undefined"][i]["function"]+"</small>";p.push("<p><i>Undefined variable:</i> "+d.join(", ")+"</p>")}if(t.unused){d=[];for(i=0;i<t.unused.length;i+=1)d[i]="<code><u>"+t.unused[i].name+"</u></code>&nbsp;<i>"+String(t.unused[i].line)+" </i> <small>"+t.unused[i]["function"]+"</small>";p.push("<p><i>Unused variable:</i> "+d.join(", ")+"</p>")}t.json&&p.push("<p>JSON: bad.</p>"),p.push("</div>")}if(!e){p.push("<br><div id=functions>"),t.urls&&y("URLs<br>",t.urls,"<br>"),vt==="style"?p.push("<p>CSS.</p>"):t.json&&!n?p.push("<p>JSON: good.</p>"):t.globals?p.push("<div><i>Global</i> "+t.globals.sort().join(", ")+"</div>"):p.push("<div><i>No new global variables introduced.</i></div>");for(i=0;i<t.functions.length;i+=1){v=t.functions[i],h=[];if(v.params)for(o=0;o<v.params.length;o+=1)h[o]=v.params[o].string;p.push("<br><div class=function><i>"+String(v.line)+"</i> "+v.name.entityify()+"("+h.join(", ")+")</div>"),y("<big><b>Undefined</b></big>",v["undefined"]),y("<big><b>Unused</b></big>",v.unused),y("Closure",v.closure),y("Variable",v["var"]),y("Exception",v.exception),y("Outer",v.outer),y("Global",v.global),y("Label",v.label)}if(t.member){a=Object.keys(t.member);if(a.length){a=a.sort(),p.push("<br><pre id=properties>/*properties<br>"),l="    ",s=0,o=0;if(V.confusion)for(i=0;i<a.length;i+=1)u=a[i],typeof st[u]!="string"&&(c=xt.test(u)?u:"'"+u.entityify().replace(Ct,Ht)+"'",t.member[u]===1&&(c="<i>"+c+"</i>",s+=1,o=1),i<a.length-1&&(c+=", "),l.length+c.length-s*7>80&&(p.push(l+"<br>"),l="    ",s=o),l+=c,o=0);else for(i=0;i<a.length;i+=1)u=a[i],m=Q[u],typeof m!="string"&&(m=""),st[u]!==m&&(c=xt.test(u)?u:"'"+u.entityify().replace(Ct,Ht)+"'",f+=c.length+2,t.member[u]===1&&(c="<i>"+c+"</i>",s+=1,o=1),m&&(c+=": "+m),i<a.length-1&&(c+=", "),l.length+c.length-s*7>80&&(p.push(l+"<br>"),l="    ",s=o),l+=c,o=0);p.push(l+"<br>*/</pre>")}p.push("</div>")}}return p.join("")},B.jslint=B,B.edition="2012-01-13",B}();define("thirdparty/jslint/jslint",function(){}),define("language/JSLintUtils",["require","exports","module","thirdparty/path-utils/path-utils.min","thirdparty/jslint/jslint","utils/Global","command/Commands","command/CommandManager","document/DocumentManager","editor/EditorManager","preferences/PreferencesManager","utils/PerfUtils","strings","utils/StringUtils","utils/AppInit","widgets/StatusBar"],function(e,t,n){function y(){return g}function w(e){s.get(i.NAVIGATE_GOTO_JSLINT_ERROR).setEnabled(e),e||(b=null)}function E(){var e=o.getCurrentDocument(),t,r,i=e?PathUtils.filenameExtension(e.file.fullPath):"",s=$("#jslint-results"),a=$("#gold-star");if(y()&&/^(\.js|\.htm|\.html)$/i.test(i)){r=f.markStart("JSLint linting:	"+(!e||e.file.fullPath));var h=e.getText(),d,v=h.split("\n");for(d=0;d<v.length;d++)v[d].match(/\S/)||(v[d]="");h=v.join("\n");var m=JSLINT(h,null);f.addMeasurement(r),t=f.markStart("JSLint DOM:	"+(!e||e.file.fullPath));if(!m){var g=$("<table class='zebra-striped condensed-table' />").append("<tbody>"),E;JSLINT.errors.forEach(function(e,t){if(e){var n=function(e){return $("<td/>").text(e)},r=$("<tr/>").append(n(e.line)).append(n(e.reason)).append(n(e.evidence||"")).appendTo(g),i=function(){E&&E.removeClass("selected"),r.addClass("selected"),E=r;var t=u.getCurrentFullEditor();t.setCursorPos(e.line-1,e.character-1,!0),u.focusEditor()};r.click(i),t===0&&(b=i)}}),$("#jslint-results .table-container").empty().append(g).scrollTop(0),s.show(),a.hide();if(JSLINT.errors.length===1)p.updateIndicator(n.id,!0,"jslint-errors",l.JSLINT_ERROR_INFORMATION);else{var S=JSLINT.errors.filter(function(e){return e!==null}).length;S!==JSLINT.errors.length&&(S-=1,S+="+"),p.updateIndicator(n.id,!0,"jslint-errors",c.format(l.JSLINT_ERRORS_INFORMATION,S))}w(!0)}else s.hide(),a.show(),p.updateIndicator(n.id,!0,"jslint-valid",l.JSLINT_NO_ERRORS),w(!1);f.addMeasurement(t)}else s.hide(),a.hide(),p.updateIndicator(n.id,!0,"jslint-disabled",l.JSLINT_DISABLED),w(!1);u.resizeEditor()}function S(){g?$(o).on("currentDocumentChange.jslint",function(){E()}).on("documentSaved.jslint documentRefreshed.jslint",function(e,t){t===o.getCurrentDocument()&&E()}):$(o).off(".jslint")}function x(e){g=e,s.get(i.TOGGLE_JSLINT).setChecked(g),S(),m.setValue("enabled",g),E()}function T(e){g!==e&&x(e)}function N(){T(!y())}function C(){E(),b&&b()}e("thirdparty/path-utils/path-utils.min"),e("thirdparty/jslint/jslint");var r=e("utils/Global"),i=e("command/Commands"),s=e("command/CommandManager"),o=e("document/DocumentManager"),u=e("editor/EditorManager"),a=e("preferences/PreferencesManager"),f=e("utils/PerfUtils"),l=e("strings"),c=e("utils/StringUtils"),h=e("utils/AppInit"),p=e("widgets/StatusBar"),d=n.id,v={enabled:!!brackets.config.enable_jslint},m=null,g=!0,b=null;s.register(l.CMD_JSLINT,i.TOGGLE_JSLINT,N),s.register(l.CMD_JSLINT_FIRST_ERROR,i.NAVIGATE_GOTO_JSLINT_ERROR,C),m=a.getPreferenceStorage(d,v),h.htmlReady(function(){var e=$("#jslint-results"),t=$("#jslint-results .table-container");p.addIndicator(n.id,$("#gold-star")),x(m.getValue("enabled"))}),t.run=E,t.getEnabled=y,t.setEnabled=T}),define("widgets/ModalBar",["require","exports","module","editor/EditorManager","utils/KeyEvent"],function(e,t,n){function s(e,t){this._handleInputKeydown=this._handleInputKeydown.bind(this),this._handleFocusChange=this._handleFocusChange.bind(this),this._$root=$("<div class='modal-bar'/>").html(e).appendTo("#main-toolbar");if(t){this._autoClose=!0;var n=this._getFirstInput().on("keydown",this._handleInputKeydown);window.document.body.addEventListener("focusin",this._handleFocusChange,!0),n.length>0?n.focus():$("button",this._$root).first().focus()}var i=r.getCurrentFullEditor(),s;i&&(s=i.getScrollPos()),r.resizeEditor(),i&&i._codeMirror.scrollTo(s.x,s.y+this._$root.outerHeight())}var r=e("editor/EditorManager"),i=e("utils/KeyEvent");s.prototype._$root=null,s.prototype._autoClose=!1,s.prototype._getFirstInput=function(){return $("input[type='text']",this._$root).first()},s.prototype.close=function(){var e=this._$root.outerHeight();this._autoClose&&window.document.body.removeEventListener("focusin",this._handleFocusChange,!0),this._$root.remove();var t=r.getCurrentFullEditor(),n;t&&(n=t.getScrollPos()),r.resizeEditor(),t&&t._codeMirror.scrollTo(n.x,n.y-e),r.focusEditor()},s.prototype._handleInputKeydown=function(e){if(e.keyCode===i.DOM_VK_RETURN||e.keyCode===i.DOM_VK_ESCAPE){e.stopPropagation(),e.preventDefault();var t=this._getFirstInput().val();this.close(),$(this).triggerHandler(e.keyCode===i.DOM_VK_RETURN?"closeOk":"closeCancel",[t])}},s.prototype._handleFocusChange=function(e){if(!$.contains(this._$root.get(0),e.target)){var t=this._getFirstInput().val();this.close(),$(this).triggerHandler("closeBlur",[t])}},s.prototype.getRoot=function(){return this._$root},t.ModalBar=s}),define("utils/StringMatch",["require","exports","module"],function(e,t,n){function r(e){this.label=e}function i(e){var t,n,r=[0],i=0,s=!1;for(t=0;t<e.length;t++)n=e[t],n==="/"?(r.push(t++),r.push(t),i=r.length-1,s=!1):n==="."||n==="-"||n==="_"?(r.push(t++),r.push(t),s=!1):n.toUpperCase()===n?(s&&r.push(t),s=!1):s=!0;return{specials:r,lastSegmentSpecialsIndex:i}}function a(e){u=e}function m(e){this.index=e}function g(e){this.index=e}function y(e,t,n,r){function h(){var r;for(r=u;r<n.length;r++){if(n[r]>=l[f])break;if(n[r]<a)u=r;else if(e[f]===t[n[r]])return u=r,f++,a=n[r],i.push(new m(a++)),!0}return!1}function p(){while(i.length>0){var e=i.pop();if(!e)return!1;f--;if(e instanceof m){u--;if(e.index<l[f])return l[f]=e.index-1,c=o,e=i[i.length-1],e?(a=e.index+1,!0):(a=n[r]+1,!0)}}return!1}var i=[],u=r,a=n[r],f,l=[];for(f=0;f<e.length;f++)l[f]=Infinity;f=0;var c=s;for(;;){while(f<e.length&&a<t.length&&a<=l[f])c===s&&(h()||(c=o)),c===o&&(e[f]===t[a]?(f++,i.push(new g(a++)),c=s):a++);if(f>=e.length||f<e.length&&!p())break}return f<e.length||i.length===0?null:i}function b(e,t,n,r,i){var s,o,u="",a=n[r]+e.length-t.length;a>0&&(u=e.substring(0,a),e=e.substring(a));for(s=0;s<e.length;s++){o=y(e.substring(s),t,n,r);if(o||r===0)break}return s===e.length||!o?null:{remainder:u+e.substring(0,s),matchList:o}}function w(e,t,n,r){e=e.toLowerCase();var i=t.toLowerCase(),s=n[r],o,u;o=b(e,i,n,r,s);if(o){u=o.matchList;if(o.remainder){var a=y(o.remainder,i.substring(0,s),n.slice(0,r),0);if(!a)return null;u.unshift.apply(u,a)}}else u=y(e,i,n,0,s);return u}function E(e,t,n){function w(e){b&&(b.includesLastSegment=s>=n,b.matched&&b.includesLastSegment&&(u&&(y.lastSegment+=o*c),g+=o*c),b.matched&&!a&&(u&&(y.notStartingOnSpecial-=v),g-=v),i.push(b)),s+1<e&&i.push({text:t.substring(s+1,e),matched:!1,includesLastSegment:e>n}),b=null,o=0}function S(e){var r=e.index,i=0;u&&(y.match+=l),i+=l,r===n&&(u&&(y.beginning+=h),i+=h),g>0&&s+1===r?(a&&E++,u&&(y.consecutive+=d*E),i+=d*E):E=1,e instanceof m&&(u&&(y.special+=f),i+=f),g+=i,r>=n&&(o+=i),(b&&!b.matched||r>s+1)&&w(r),s=r,b?b.text+=t[r]:(b={text:t[r],matched:!0},a=e instanceof m)}var r,i=[],s=-1,o=0,a=!1,g=0,y;u&&(y={special:0,match:0,lastSegment:0,beginning:0,lengthDeduction:0,consecutive:0,notStartingOnSpecial:0});var b=null,E=0;for(r=0;r<e.length;r++){var x=e[r];S(x)}w(t.length);var T=-1*Math.round(t.length*p);u&&(y.lengthDeduction=T),g+=T;var N={ranges:i,matchGoodness:g};return u&&(N.scoreDebug=y),N}function S(e,t,n){var s;if(!t)return s=new r(e),s.matchGoodness=0,u&&(s.scoreDebug={}),s.stringRanges=[{text:e,matched:!1,includesLastSegment:!0}],s;n||(n=i(e));var o=n.specials[n.lastSegmentSpecialsIndex],a=w(t,e,n.specials,n.lastSegmentSpecialsIndex);if(a){var f=E(a,e,o);s=new r(e),s.stringRanges=f.ranges,s.matchGoodness=-1*f.matchGoodness,u&&(s.scoreDebug=f.scoreDebug)}return s}function x(e,t){var n=[];$.each(t,function(e,t){n[t]=e}),e.sort(function(e,t){var r;for(r=0;r<n.length;r++){var i=n[r],s=e[i],o=t[i];typeof s=="string"&&(s=s.toLowerCase(),o=o.toLowerCase());if(s<o)return-1;if(s>o)return 1}return 0})}function T(e){x(e,{matchGoodness:0,label:1})}function N(){this._lastQuery=null,this._specialsCache={},this._noMatchCache={}}var s=0,o=1,u=!1,f=35,l=10,c=1,h=25,p=.2,d=10,v=25;N.prototype._specialsCache=null,N.prototype._noMatchCache=null,N.prototype.match=function(e,t){this._lastQuery!==null&&this._lastQuery!==t.substring(0,this._lastQuery.length)&&(this._noMatchCache={}),this._lastQuery=t;if(this._noMatchCache.hasOwnProperty(e))return undefined;var n=this._specialsCache.hasOwnProperty(e)?this._specialsCache[e]:undefined;n===undefined&&(n=i(e),this._specialsCache[e]=n);var r=S(e,t,n);return r||(this._noMatchCache[e]=!0),r},t._findSpecialCharacters=i,t._wholeStringSearch=w,t._lastSegmentSearch=b,t._setDebugScores=a,t._generateMatchList=y,t._SpecialMatch=m,t._NormalMatch=g,t._computeRangesAndScore=E,t.SearchResult=r,t.stringMatch=S,t.basicMatchSort=T,t.multiFieldSort=x,t.StringMatcher=N}),define("search/QuickOpen",["require","exports","module","project/FileIndexManager","document/DocumentManager","editor/EditorManager","command/CommandManager","strings","utils/StringUtils","command/Commands","project/ProjectManager","utils/KeyEvent","widgets/ModalBar","utils/StringMatch"],function(e,t,n){function S(e,t,n,r,i,s,o,u){this.name=e,this.fileTypes=t,this.done=n,this.search=r,this.match=i,this.itemFocus=s,this.itemSelect=o,this.resultsFormatter=u}function x(e){d.push(new S(e.name,e.fileTypes,e.done,e.search,e.match,e.itemFocus,e.itemSelect,e.resultsFormatter))}function T(){this.$searchField=undefined,this._handleItemSelect=this._handleItemSelect.bind(this),this._handleItemFocus=this._handleItemFocus.bind(this),this._handleKeyUp=this._handleKeyUp.bind(this),this._handleResultsReady=this._handleResultsReady.bind(this),this._handleShowResults=this._handleShowResults.bind(this),this._handleBlur=this._handleBlur.bind(this),this._handleDocumentMouseDown=this._handleDocumentMouseDown.bind(this),this._filterCallback=this._filterCallback.bind(this),this._resultsFormatterCallback=this._resultsFormatterCallback.bind(this),this._filenameMatcher=new p.StringMatcher,this._matchers={}}function N(e,t){var n;return t?n=e.length:(n=e.lastIndexOf("."),n===-1&&(n=e.length)),e.slice(e.lastIndexOf("/")+1,n)}function C(e){if(e.indexOf(":")!==0)return NaN;var t=NaN,n=e.match(/(!?:)(\d+)/);return n&&(t=n[2]-1),t}function k(){var e=$("input#quickOpenSearch").data("smart-autocomplete").rawResults;return e||[]}function L(e){if(!e)return null;var t=$(e).index(),n=k();return n[t]}function A(e){var t=$("input#quickOpenSearch").val();return t!==e}function O(e,t){if(!m){var n=new $.Deferred;return g.done(function(){A(e)?n.reject():n.resolve(O(e,t))}),n.promise()}var r=$.map(m,function(n){var r=t.match(l.makeProjectRelativeIfPossible(n.fullPath),e);return r&&(r.label=n.name,r.fullPath=n.fullPath,r.filenameWithoutExtension=N(n.name,!1)),r});return p.multiFieldSort(r,{matchGoodness:0,filenameWithoutExtension:1,label:2,fullPath:3}),r}function M(e,t,n){var r=e.label||e;t=t||"quicksearch-namematch";var i=e.stringRanges;i||(i=[{text:r,matched:!1,includesLastSegment:!0}]);var s="";if(e.scoreDebug){var o=e.scoreDebug;s+='<span title="sp:'+o.special+", m:"+o.match+", ls:"+o.lastSegment+", b:"+o.beginning+", ld:"+o.lengthDeduction+", c:"+o.consecutive+", nsos: "+o.notStartingOnSpecial+'">('+e.matchGoodness+") </span>"}return i.forEach(function(e){e.matched&&(s+="<span class='"+t+"'>");var r=n?n(e.includesLastSegment,e.text):e.text;s+=a.breakableUrl(a.htmlEscape(r)),e.matched&&(s+="</span>")}),s}function _(e,t){t=t.slice(t.indexOf("@")+1,t.length);var n=M(e);return"<li>"+n+"</li>"}function D(e,t){function n(e,t){if(e){var n=t.lastIndexOf("/");return t.substring(n+1)}return""}var r=M(e,null,n),i=M(e,"quicksearch-pathmatch");return"<li>"+r+"<br /><span class='quick-open-path'>"+i+"</span></li>"}function P(){var e=s.getActiveEditor();return e&&e.getSelectedText()||""}function H(e,t){w?E.setSearchFieldValue(e,t):(E=new T,E.showDialog(e,t))}function B(){H("",P())}function j(){i.getCurrentDocument()&&H(":","")}function F(){i.getCurrentDocument()&&H("@",P())}var r=e("project/FileIndexManager"),i=e("document/DocumentManager"),s=e("editor/EditorManager"),o=e("command/CommandManager"),u=e("strings"),a=e("utils/StringUtils"),f=e("command/Commands"),l=e("project/ProjectManager"),c=e("utils/KeyEvent"),h=e("widgets/ModalBar").ModalBar,p=e("utils/StringMatch"),d=[],v=null,m,g,y,b,w=!1,E;T.prototype._filenameMatcher=null,T.prototype._matchers=null,T.prototype._handleItemSelect=function(e,t){t||(t=$(".smart_autocomplete_container > li:first-child").get(0));var n=L(t);if(v)v.itemSelect(n);else{var r=this.$searchField.val(),i=C(r),u=n&&n.fullPath;u?o.execute(f.FILE_ADD_TO_WORKING_SET,{fullPath:u}).done(function(){if(!isNaN(i)){var e=s.getCurrentFullEditor();e.setCursorPos(i,0,!0)}}):isNaN(i)||s.getCurrentFullEditor().setCursorPos(i,0,!0)}this._close(),s.focusEditor()},T.prototype._handleItemFocus=function(e,t){var n=L(t);v&&v.itemFocus(n)},T.prototype._handleKeyUp=function(e){if(e.keyCode===c.DOM_VK_RETURN||e.keyCode===c.DOM_VK_ESCAPE){e.stopImmediatePropagation(),e.preventDefault();var t=this;setTimeout(function(){e.keyCode===c.DOM_VK_ESCAPE?(y&&o.execute(f.FILE_OPEN,{fullPath:y}).done(function(){b&&s.getCurrentFullEditor().setSelection(b.start,b.end,!0)}),t._close()):e.keyCode===c.DOM_VK_RETURN&&t._handleItemSelect(null,$(".smart_autocomplete_highlight").get(0))},0)}},T.prototype._isValidLineNumberQuery=function(e){if(e===":")return!0;var t=C(e),n=s.getCurrentFullEditor();return!isNaN(t)&&n&&t>=n.getFirstVisibleLine()&&t<=n.getLastVisibleLine()},T.prototype._handleResultsReady=function(e,t){var n=t.length===0&&!this._isValidLineNumberQuery(this.$searchField.val());this.$searchField.toggleClass("no-results",n)},T.prototype._handleShowResults=function(e,t){$(".smart_autocomplete_highlight").length===0&&this._handleItemFocus(null,$(".smart_autocomplete_container > li:first-child").get(0))},T.prototype._close=function(){if(!w)return;w=!1;var e;for(e=0;e<d.length;e++){var t=d[e];t.done()}this.$searchField.trigger("lostFocus"),s.focusEditor();var n=this;setTimeout(function(){n.modalBar.close()},0),$(".smart_autocomplete_container").remove(),$(window.document).off("mousedown",this._handleDocumentMouseDown)},T.prototype._filterCallback=function(e){if(A(e))return k();this._updateDialogLabel(e);var t=C(e);if(!isNaN(t)){var n={line:t,ch:0},r={line:t,ch:99999};s.getCurrentFullEditor().setSelection(n,r,!0)}var o=i.getCurrentDocument();if(o){var u=N(o.file.fullPath,!0),a=u.slice(u.lastIndexOf(".")+1,u.length),f;for(f=0;f<d.length;f++){var l=d[f],c=l.fileTypes.indexOf(a)!==-1||l.fileTypes.length===0;if(c&&l.match&&l.match(e)){v=l;var h=this._matchers[v.name];return h||(h=new p.StringMatcher,this._matchers[v.name]=h),l.search(e,h)}}}return v=null,O(e,this._filenameMatcher)},T.prototype._resultsFormatterCallback=function(e){var t=this.$searchField.val(),n;return v?n=v.resultsFormatter||_:n=D,n(e,t)},T.prototype.setSearchFieldValue=function(e,t){e=e||"",t=t||"",t=e+t;var n=this.$searchField;n.val(t),n.get(0).setSelectionRange(e.length,t.length),n.trigger("keyIn",[t]),this._updateDialogLabel(t)},T.prototype._updateDialogLabel=function(e){var t=e.length>0?e.charAt(0):"",n="";switch(t){case":":n=u.CMD_GOTO_LINE;break;case"@":n=u.CMD_GOTO_DEFINITION;break;default:n=u.CMD_QUICK_OPEN}$(".find-dialog-label",this.dialog).text(n)},T.prototype._handleDocumentMouseDown=function(e){this.modalBar.getRoot().find(e.target).length===0&&$(".smart_autocomplete_container").find(e.target).length===0?this._close():$("input#quickOpenSearch").get(0)!==e.target&&(e.preventDefault(),e.stopPropagation())},T.prototype._handleBlur=function(e){this._close()},T.prototype.showDialog=function(e,t){if(w)return;w=!0,$(window.document).on("mousedown",this._handleDocumentMouseDown);var n=i.getCurrentDocument();y=n?n.file.fullPath:null,n?b=s.getCurrentFullEditor().getSelection():b=null;var o="<div align='right'><span class='find-dialog-label'></span>: <input type='text' autocomplete='off' id='quickOpenSearch' style='width: 30em'></div>";this.modalBar=new h(o,!1),this.$searchField=$("input#quickOpenSearch"),this.$searchField.bind({resultsReady:this._handleResultsReady,showResults:this._handleShowResults,itemSelect:this._handleItemSelect,itemFocus:this._handleItemFocus,keyup:this._handleKeyUp,blur:this._handleBlur}),this.$searchField.smartAutoComplete({source:[],maxResults:20,minCharLimit:0,autocompleteFocused:!0,forceSelect:!1,typeAhead:!1,filter:this._filterCallback,resultFormatter:this._resultsFormatterCallback}),this.setSearchFieldValue(e,t),m=null,g=r.getFileInfoList("all").done(function(e){m=e,g=null})},o.register(u.CMD_QUICK_OPEN,f.NAVIGATE_QUICK_OPEN,B),o.register(u.CMD_GOTO_DEFINITION,f.NAVIGATE_GOTO_DEFINITION,F),o.register(u.CMD_GOTO_LINE,f.NAVIGATE_GOTO_LINE,j),t.beginSearch=H,t.addQuickOpenPlugin=x,t.highlightMatch=M,t.stringMatch=p.stringMatch,t.SearchResult=p.SearchResult,t.basicMatchSort=p.basicMatchSort,t.multiFieldSort=p.multiFieldSort}),define("text!htmlContent/main-view.html",[],function(){return'<!-- \n  Copyright (c) 2012 Adobe Systems Incorporated. All rights reserved.\n   \n  Permission is hereby granted, free of charge, to any person obtaining a\n  copy of this software and associated documentation files (the "Software"), \n  to deal in the Software without restriction, including without limitation \n  the rights to use, copy, modify, merge, publish, distribute, sublicense, \n  and/or sell copies of the Software, and to permit persons to whom the \n  Software is furnished to do so, subject to the following conditions:\n   \n  The above copyright notice and this permission notice shall be included in\n  all copies or substantial portions of the Software.\n   \n  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING \n  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER \n  DEALINGS IN THE SOFTWARE.\n-->\n\n\n<!--\n    HTML template for the body tag of index.html. It is rendered dynamically in\n    brackets.js with Mustache and localized with the i18n RequireJS plugin.\n\n    LOCALIZATION NOTE:\n    All display text for this file must use templating so the text can be localized.\n    \n    English text goes in src/nls/root/strings.js. All other translations go in the strings.js file for\n    the specific local in the nls folder. If a translation is missing for a specific key English\n    is used as a fallback\n\n    Strings should be referenced using the double brackets syntax.\n    Example: {{keyname}}. Note, all strings are HTML escaped unless the form \n    {{&keyname}} is used.\n\n-->\n\n<!-- Main UI -->\n    <div class="main-view">\n        <div id="sidebar" class="sidebar quiet-scrollbars horz-resizable right-resizer collapsible" data-minsize="0" data-forcemargin=".content">\n            <!-- Left-hand \'Project panel\' -->\n            <div id="projects" class="panel">\n                <div id="project-header"></div>\n                <div id="file-section">\n                    <div id="open-files-container">\n                        <!-- This will contain a dynamically generated <ul> at runtime -->\n                        <ul>\n                        </ul>\n                    </div>\n                \n                    <div id="project-files-header" class="project-file-header-area">\n                        <span id="project-title" class="title"></span>\n                    </div>\n                    <div id="project-files-container">\n                    <!-- This will contain a dynamically generated <ul> hierarchy at runtime -->\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <!--\n            Right-hand content: vertical stack of toolbar, editor, bottom panels, status bar\n                (status bar is injected later - see StatusBar.init()).\n            Note: all children must be in a vertical stack with heights explicitly set in a fixed\n                unit such as px (not percent/em/auto). If you change the height later, you must\n                call EditorManager.resizeEditor() each time. Otherwise editor-holder\'s height will\n                not get set correctly.\n         -->\n        <div class="content">\n            <!-- Toolbar containing menus, filename, and icons -->\n            <div id="main-toolbar" class="toolbar no-focus">\n                <!-- Menu bar -->\n                <ul class="nav" data-dropdown="dropdown">\n                </ul>\n                \n                <!-- Toolbar -->\n                <div class="buttons">\n                    <span id="update-notification" title="{{UPDATE_NOTIFICATION_TOOLTIP}}"></span>\n                    \n                    <a href="#" id="toolbar-go-live"></a> <!-- tooltip for this is set in JS -->\n                </div>\n                \n                <!-- Filename label -->\n                <div class="title-wrapper">\n                    <span class="title"></span>&nbsp;<span class=\'dirty-dot\' style="visibility:hidden;">•</span>\n                </div>\n            </div>\n            \n            <div id="editor-holder">\n                <div id="not-editor">\n                </div>\n            </div>\n            \n            <div id="jslint-results" class="bottom-panel vert-resizable top-resizer no-focus">\n                <div class="toolbar simple-toolbar-layout">\n                    <div class="title">{{JSLINT_ERRORS}}</div>\n                </div>\n                <div class="table-container resizable-content"></div>\n            </div>\n            \n            <div id="search-results" class="bottom-panel vert-resizable top-resizer no-focus">\n                <div class="toolbar simple-toolbar-layout">\n                    <div class="title">{{SEARCH_RESULTS}}</div>\n                    <div class="title" id="search-result-summary"></div>\n                    <a href="#" class="close">&times;</a>\n                </div>\n                <div class="table-container resizable-content"></div>\n            </div>\n            \n        </div>\n\n        <!-- Hack to ensure that the code editor\'s web font is loaded early. -->\n        <!-- For more info, see note in brackets.less for class .dummy-text, or issue 76 -->\n        <div class="dummy-text">x</div>\n    </div>\n\n    <!-- Modal Windows -->\n    <div class="error-dialog template modal hide">\n        <div class="modal-header">\n            <a href="#" class="close">&times;</a>\n            <h1 class="dialog-title">Error</h1>\n        </div>\n        <div class="modal-body">\n            <p class="dialog-message">Message goes here</p>\n        </div>\n        <div class="modal-footer">\n            <a href="#" class="dialog-button btn primary" data-button-id="ok">{{OK}}</a>\n        </div>\n    </div>\n    <div class="save-close-dialog template modal hide">\n        <div class="modal-header">\n            <a href="#" class="close">&times;</a>\n            <h1 class="dialog-title">{{SAVE_CHANGES}}</h1>\n        </div>\n        <div class="modal-body">\n            <p class="dialog-message">Message goes here</p>\n        </div>\n        <div class="modal-footer">\n            <a href="#" class="dialog-button btn left" data-button-id="dontsave">{{DONT_SAVE}}</a>\n            <a href="#" class="dialog-button btn primary" data-button-id="ok">{{SAVE}}</a>\n            <a href="#" class="dialog-button btn" data-button-id="cancel">{{CANCEL}}</a>\n        </div>\n    </div>\n    <div class="ext-changed-dialog template modal hide">\n        <div class="modal-header">\n            <h1 class="dialog-title">Title goes here</h1>\n        </div>\n        <div class="modal-body">\n            <p class="dialog-message">Message goes here</p>\n        </div>\n        <div class="modal-footer">\n            <a href="#" class="dialog-button btn left" data-button-id="dontsave">{{RELOAD_FROM_DISK}}</a>\n            <a href="#" class="dialog-button btn primary" data-button-id="cancel">{{KEEP_CHANGES_IN_EDITOR}}</a>\n        </div>\n    </div>\n    <div class="ext-deleted-dialog template modal hide">\n        <div class="modal-header">\n            <h1 class="dialog-title">Title goes here</h1>\n        </div>\n        <div class="modal-body">\n            <p class="dialog-message">Message goes here</p>\n        </div>\n        <div class="modal-footer">\n            <a href="#" class="dialog-button btn left" data-button-id="dontsave">{{CLOSE_DONT_SAVE}}</a>\n            <a href="#" class="dialog-button btn primary" data-button-id="cancel">{{KEEP_CHANGES_IN_EDITOR}}</a>\n        </div>\n    </div>\n    <div class="live-development-error-dialog template modal hide">\n        <div class="modal-header">\n            <h1 class="dialog-title">Title goes here</h1>\n        </div>\n        <div class="modal-body">\n            <p class="dialog-message">Message goes here</p>\n        </div>\n        <div class="modal-footer">\n            <a href="#" class="dialog-button btn left" data-button-id="cancel">{{CANCEL}}</a>\n            <a href="#" class="dialog-button btn primary" data-button-id="ok">{{RELAUNCH_CHROME}}</a>\n        </div>\n    </div>\n    <div id="context-menu-bar">\n        <ul data-dropdown="dropdown"></ul>\n    </div>\n    <div id="codehint-menu-bar">\n        <ul data-dropdown="dropdown"></ul>\n    </div>'}),define("utils/ExtensionLoader",["require","exports","module","utils/Global","file/NativeFileSystem","file/FileUtils","utils/Async"],function(e,t,n){function l(){return brackets.app.getApplicationSupportDirectory()+"/extensions/user"}function c(e){return u[e]}function h(e,t,n){var r=new $.Deferred,i=brackets.libRequire.config({context:e,baseUrl:t.baseUrl,paths:f,locale:brackets.getLocale()});return u[e]=i,i([n],function(){r.resolve()},function(n){console.error("[Extension] failed to load "+t.baseUrl,n),n.requireType==="define"&&console.log(n.stack),r.reject()}),r.promise()}function p(e,t,n){var r=new $.Deferred,i=t.baseUrl+"/"+n+".js",s=!1,o=!1;return brackets.fs.stat(i,function(i,s){o=!0;if(i===brackets.fs.NO_ERROR&&s.isFile()){var u=brackets.libRequire.config({context:e,baseUrl:t.baseUrl,paths:$.extend({},t.paths,f)});u([n],function(){r.resolve()})}else r.reject()}),r.promise()}function d(e,t,n,i){var o=new $.Deferred;return r.requestNativeFileSystem(e,function(r){r.root.createReader().readEntries(function(e){var r,u=[];for(r=0;r<e.length;r++)e[r].isDirectory&&u.push(e[r].name);if(u.length===0){o.resolve();return}s.doInParallel(u,function(e){var r={baseUrl:t.baseUrl+"/"+e,paths:t.paths};return i(e,r,n)}).always(function(){o.resolve()})},function(t){console.error("[Extension] Error -- could not read native directory: "+e),o.reject()})},function(t){console.error("[Extension] Error -- could not open native directory: "+e),o.reject()}),o.promise()}function v(e){return d(e,{baseUrl:e},"main",h)}function m(e){var t=i.getNativeBracketsDirectoryPath(),n={baseUrl:e};return n.paths={perf:t+"/perf",spec:t+"/spec"},d(e,n,"unittests",p)}function g(e){if(o)return(new $.Deferred).resolve().promise();e||(e="default,dev,"+l());var t=l();(new r.DirectoryEntry).getDirectory(t,{create:!0});var n=t.replace(/\/user$/,"/disabled");(new r.DirectoryEntry).getDirectory(n,{create:!0});var u=s.doInParallel(e.split(","),function(e){var t=e;return e.indexOf("/")===-1&&(t=i.getNativeBracketsDirectoryPath()+"/extensions/"+e),v(t)});return u.always(function(){o=!0}),u}e("utils/Global");var r=e("file/NativeFileSystem").NativeFileSystem,i=e("file/FileUtils"),s=e("utils/Async"),o=!1,u={},a=i.getNativeBracketsDirectoryPath();a=a.replace(/\/test$/,"/src");var f={text:a+"/thirdparty/text",i18n:a+"/thirdparty/i18n"};t.init=g,t.getUserExtensionPath=l,t.getRequireContextForExtension=c,t.loadExtension=h,t.testExtension=p,t.loadAllExtensionsInNativeDirectory=v,t.testAllExtensionsInNativeDirectory=m}),define("utils/Resizer",["require","exports","module","utils/AppInit","preferences/PreferencesManager","editor/EditorManager"],function(e,t,n){function g(e){var t=$(e).data("show");t&&t.apply(e)}function y(e){var t=$(e).data("hide");t&&t.apply(e)}function b(e){$(e).is(":visible")?y(e):g(e)}function w(e,t,n,r,f,l){function k(e){l!==undefined&&$(l,p.parent()).css("margin-left",e)}function L(e,t){T.apply(p,[e]),d.length&&C.apply(d,[t])}function A(e){var t=e||1;(n===a||n===o)&&c.css(N,t)}var c=$('<div class="'+t+'-resizer"></div>'),p=$(e),d=$(p.find(".resizable-content:first")[0]),m=$(window.document.body),g=p.attr("id"),w=v.getValue(g)||{},E=null,S=t===i?"clientX":"clientY",x=n===s||n===u?1:-1,T=t===i?p.width:p.height,N=t===i?"left":"top",C=t===i?d.width:d.height;r=r||0,f=f||!1,p.prepend(c),p.data("show",function(){var e=p.offset(),t=T.apply(p)||w.size,r=C.apply(d)||w.contentSize,i=T.apply(c);L(t,r),p.show(),w.visible=!0,f&&(p.prepend(c),n===s?c.css(N,""):n===a&&c.css(N,e[N]+t)),k(t),h.resizeEditor(),p.trigger("panelExpanded",[t]),v.setValue(g,w)}),p.data("hide",function(){var e=p.offset(),t=T.apply(p),r=T.apply(c);p.hide(),w.visible=!1,f&&(c.insertBefore(p),n===a?c.css(N,""):n===s&&c.css(N,e[N]+t-r)),k(0),h.resizeEditor(),p.trigger("panelCollapsed",[t]),v.setValue(g,w)}),c.on("mousedown",function(e){function N(){if(!c)return;u!==a&&(a=u,p.is(":visible")?u<10?(b(p),T.apply(p,[0])):(y||(y=!0,p.trigger("panelResizeStart",u)),L(u,u-l),k(u),p.trigger("panelResizeUpdate",[u])):u>10&&(T.apply(p,[u]),b(p),y||(y=!0,p.trigger("panelResizeStart",u))),h.resizeEditor()),E=window.webkitRequestAnimationFrame(N)}function O(e){u=Math.max(o+x*(s-e[S]),r),e.preventDefault(),E===null&&(E=window.webkitRequestAnimationFrame(N))}function M(e){if(c){var t=T.apply(p);p.is(":visible")&&(w.size=t,d.length&&(w.contentSize=C.apply(d)),v.setValue(g,w),A(t)),c=!1,y&&p.trigger("panelResizeEnd",[t]),window.setTimeout(function(){$(window.document).off("mousemove",O),n.off("mousedown"),n.remove(),E=null},300)}}var n=$("<div class='resizing-container "+t+"-resizing' />"),s=e[S],o=p.is(":visible")?T.apply(p):0,u=o,a=o,l=0,c=!0,y=!1;m.append(n),d.length&&p.children().not(".horz-resizer, .vert-resizer, .resizable-content").each(function(e,n){t===i?l+=$(n).outerWidth():l+=$(n).outerHeight()}),$(window.document).on("mousemove",O),f&&n.on("mousedown",function(e){$(window.document).off("mousemove",O),n.off("mousedown"),n.remove(),E=null,b(p)}),$(window.document).one("mouseup",M),e.preventDefault()}),w&&(w.size!==undefined&&T.apply(p,[w.size]),w.contentSize!==undefined&&C.apply(d,[w.contentSize]),w.visible!==undefined&&!w.visible?y(p):(k(T.apply(p)),A(T.apply(p))))}var r="vert",i="horz",s="top",o="bottom",u="left",a="right",f=100,l=e("utils/AppInit"),c=e("preferences/PreferencesManager"),h=e("editor/EditorManager"),p=n.id,d={},v=null,m;v=c.getPreferenceStorage(p,d),l.htmlReady(function(){var e=f;m=$(".main-view"),$(".vert-resizable").each(function(t,n){$(n).data().minsize!==undefined&&(e=$(n).data().minsize),$(n).hasClass("top-resizer")&&w(n,r,s,e,$(n).hasClass("collapsible"))}),$(".horz-resizable").each(function(t,n){$(n).data().minsize!==undefined&&(e=$(n).data().minsize),$(n).hasClass("right-resizer")&&w(n,i,a,e,$(n).hasClass("collapsible"),$(n).data().forcemargin)})}),t.makeResizable=w,t.toggle=b,t.show=g,t.hide=y}),define("project/SidebarView",["require","exports","module","utils/AppInit","project/ProjectManager","project/WorkingSetView","command/CommandManager","command/Commands","strings","editor/EditorManager","utils/Global","utils/Resizer"],function(e,t,n){function g(){var e=i.getProjectRoot().name,t=i.getProjectRoot().fullPath;e===""&&t==="/"&&(e="/"),v.html(e),v.attr("title",t)}function y(e){c.toggle(h)}var r=e("utils/AppInit"),i=e("project/ProjectManager"),s=e("project/WorkingSetView"),o=e("command/CommandManager"),u=e("command/Commands"),a=e("strings"),f=e("editor/EditorManager"),l=e("utils/Global"),c=e("utils/Resizer"),h,p,d,v,m;r.htmlReady(function(){h=$("#sidebar"),p=$("#menu-view-hide-sidebar span"),d=$("#open-files-container"),v=$("#project-title"),m=$("#project-files-container"),s.create(d),h.on("panelResizeStart",function(e,t){h.find(".sidebar-selection-triangle").css("display","none"),h.find(".scroller-shadow").css("display","none")}),h.on("panelResizeUpdate",function(e,t){h.find(".sidebar-selection").width(t)}),h.on("panelResizeEnd",function(e,t){h.find(".sidebar-selection").width(t),h.find(".sidebar-selection-triangle").css("display","block").css("left",t),h.find(".scroller-shadow").css("display","block"),m.triggerHandler("scroll"),d.triggerHandler("scroll")}),h.on("panelCollapsed",function(e,t){o.get(u.VIEW_HIDE_SIDEBAR).setName(a.CMD_SHOW_SIDEBAR)}),h.on("panelExpanded",function(e,t){h.find(".sidebar-selection").width(t),h.find(".scroller-shadow").css("display","block"),h.find(".sidebar-selection-triangle").css("left",t),m.triggerHandler("scroll"),d.triggerHandler("scroll"),o.get(u.VIEW_HIDE_SIDEBAR).setName(a.CMD_HIDE_SIDEBAR)}),h.is(":visible")||h.trigger("panelCollapsed")}),$(i).on("projectOpen",g),o.register(a.CMD_HIDE_SIDEBAR,u.VIEW_HIDE_SIDEBAR,y),t.toggleSidebar=y}),define("text!htmlContent/update-dialog.html",[],function(){return'<div class="update-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{UPDATE_AVAILABLE_TITLE}}</h1>\n    </div>\n    <div class="modal-body">\n        <img class="update-icon" src="styles/images/update_large_icon.svg">\n        <div class="update-text">\n            <p class="dialog-message">{{UPDATE_MESSAGE}}</p>\n            <div class="update-info">\n            </div>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <a href="#" class="dialog-button btn left" data-button-id="cancel">{{CANCEL}}</a>\n        <a href="#" class="dialog-button btn primary" data-button-id="download">{{GET_IT_NOW}}</a>\n    </div>\n</div>\n'}),define("utils/UpdateNotification",["require","exports","module","widgets/Dialogs","utils/NativeApp","preferences/PreferencesManager","strings","utils/StringUtils","utils/Global","text!htmlContent/update-dialog.html"],function(e,t,n){function m(e,t){var n=new $.Deferred,r=!1,i;return e&&(r=!0),i=c.getValue("updateInfo"),i||(r=!0),(new Date).getTime()>p+864e5&&(r=!0),r?$.ajax(d,{dataType:"text",cache:!1,complete:function(e,r){if(r==="success")try{i=JSON.parse(e.responseText),t||(p=(new Date).getTime(),c.setValue("lastInfoURLFetchTime",p),c.setValue("updateInfo",i)),n.resolve(i)}catch(s){console.log("Error parsing version information"),console.log(s),n.reject()}},error:function(e,t,r){if(!e.responseText){n.reject();return}try{i=JSON.parse(e.responseText),n.resolve(i)}catch(s){n.reject()}}}):n.resolve(i),n.promise()}function g(e,t){var n=0,r=e.length;while(n<r){if(e[n].buildNumber<=t)break;n++}return n>0?e.slice(0,n):null}function y(e){r.showModalDialogUsingTemplate(Mustache.render(f,o)).done(function(t){t===r.DIALOG_BTN_DOWNLOAD&&i.openURLInDefaultBrowser(e[0].downloadURL)});var t=$(".update-dialog.instance"),n=t.find(".update-info");e.forEach(function(e,t){var r=$("<ul>");e.newFeatures.forEach(function(e,t){r.append("<li><b>"+u.htmlEscape(e.name)+"</b> - "+u.htmlEscape(e.description)+"</li>")});var i=$("<div>").append("<h3>"+u.htmlEscape(e.versionString)+" - "+u.htmlEscape(e.dateString)+" (<a href='#' data-url='"+e.releaseNotesURL+"'>"+o.RELEASE_NOTES+"</a>)</h3>").append(r).appendTo(n)}),t.on("click","a",function(e){var t=$(e.target).attr("data-url");t&&/(brackets\.io|github\.com|adobe\.com)$/i.test(PathUtils.parseUrl(t).hostname)&&i.openURLInDefaultBrowser(t)})}function b(e,t){var n,i=!1,s=new $.Deferred;return t&&(n={},t.hasOwnProperty("_buildNumber")&&(n._buildNumber=l,l=t._buildNumber,i=!0),t.hasOwnProperty("_lastNotifiedBuildNumber")&&(n._lastNotifiedBuildNumber=h,h=t._lastNotifiedBuildNumber,i=!0),t.hasOwnProperty("_versionInfoURL")&&(n._versionInfoURL=d,d=t._versionInfoURL,i=!0)),m(e||i,i).done(function(t){var u=g(t,l);if(l===0&&!e){s.resolve();return}if(u){var a=$("#update-notification");a.css("display","inline-block"),v||(v=!0,a.on("click",function(){b(!0)}));if(e||u[0].buildNumber>h)y(u),h=u[0].buildNumber,i||c.setValue("lastNotifiedBuildNumber",h)}else e&&r.showModalDialog(r.DIALOG_ID_ERROR,o.NO_UPDATE_TITLE,o.NO_UPDATE_MESSAGE);n&&(n.hasOwnProperty("_buildNumber")&&(l=n._buildNumber),n.hasOwnProperty("_lastNotifiedBuildNumber")&&(h=n._lastNotifiedBuildNumber),n.hasOwnProperty("_versionInfoURL")&&(d=n._versionInfoURL)),s.resolve()}).fail(function(){e&&r.showModalDialog(r.DIALOG_ID_ERROR,o.ERROR_FETCHING_UPDATE_INFO_TITLE,o.ERROR_FETCHING_UPDATE_INFO_MSG),s.reject()}),s.promise()}var r=e("widgets/Dialogs"),i=e("utils/NativeApp"),s=e("preferences/PreferencesManager"),o=e("strings"),u=e("utils/StringUtils"),a=e("utils/Global"),f=e("text!htmlContent/update-dialog.html"),l=Number(/-([0-9]+)/.exec(brackets.metadata.version)[1]),c=s.getPreferenceStorage(n.id,{lastNotifiedBuildNumber:0}),h=c.getValue("lastNotifiedBuildNumber"),p=c.getValue("lastInfoURLFetchTime"),d,v=!1;d=brackets.config.update_info_url+brackets.getLocale()+".json",t.checkForUpdate=b}),define("utils/UrlParams",["require","exports","module"],function(e,t,n){function r(){this._store={}}r.prototype.parse=function(e){e?e=e.substring(e.indexOf("?")+1):e=window.document.location.search.substring(1);var t=e.split("&"),n,r=this;t.forEach(function(e){n=e.split("="),r._store[decodeURIComponent(n[0])]=decodeURIComponent(n[1])})},r.prototype.put=function(e,t){this._store[e]=t},r.prototype.get=function(e){return this._store[e]},r.prototype.toString=function(){var e=[],t=this;return Object.keys(t._store).forEach(function(n){e.push(encodeURIComponent(n)+"="+encodeURIComponent(t._store[n]))}),e.join("&")},t.UrlParams=r}),define("LiveDevelopment/Inspector/Inspector",["require","exports","module"],function(t,n,r){function p(e,t){return t===undefined&&console.assert(e.optional===!0,"Missing argument: "+e.name),!0}function d(e,t,n){if(!u)return;console.assert(u,"You must connect to the WebSocket before sending messages.");var r,i,a,f,l={};a=Array.prototype.slice.call(arguments,2),typeof a[a.length-1]=="function"?(r=s++,o[r]=a.pop()):r=s++;for(f in t)p(a[f],t[f])&&(l[t[f].name]=a[f]);u&&u.send(JSON.stringify({method:e,id:r,params:l}))}function v(){u=undefined,f&&f[0]&&(w(!1),f.remove()),f=undefined,i.triggerHandler("disconnect")}function m(e){i.triggerHandler("error",[e])}function g(){i.triggerHandler("connect")}function y(e){var t=JSON.parse(e.data);i.triggerHandler("message",[t]);if(t.error)i.triggerHandler("error",[t.error]);else if(t.result)o[t.id]&&o[t.id](t.result);else{var r=t.method.split("."),s=r[0],u=r[1];$(n[s]).triggerHandler(u,t.params)}}function b(){var e=$("#main-toolbar").outerHeight();$("#dev-tools").height($(".content").outerHeight()-e)}function w(e){e?(l=$(".content > :not(#main-toolbar),  #status-bar, .nav, .title-wrapper, #sidebar").filter(":visible"),$(".content").css("marginLeft",0)):$(".content").css("marginLeft",200),l&&(l.toggle(!e),$("#dev-tools").toggle(e))}function E(e){c=e}function S(e,t){if(c)return c();e||(e="127.0.0.1"),t||(t=9222);var n=new $.Deferred,r=new XMLHttpRequest;return r.open("GET","http://"+e+":"+t+"/json"),r.onload=function(){var t=JSON.parse(r.response);n.resolve(t)},r.onerror=function(){n.reject(r.response)},r.send(null),n.promise()}function x(e,t){i.on(e,t)}function T(e,t){i.off(e,t)}function N(){u&&(u.readyState===1?(u.onmessage=null,u.onclose=null,u.close(),v()):(delete u.onmessage,delete u.onopen,delete u.onclose,delete u.onerror),u=undefined),f&&f[0]&&v()}function C(e,t,n){N(),h=t;if(t){var r=$("#main-toolbar"),i=$("#dev-tools")[0]||$("<div id='dev-tools'/>").appendTo(".content")[0],s=r.outerHeight();f=$('<iframe frameborder="0" style="overflow:hidden;width:100%;height:100%" height="100%" width="100%"></iframe>').attr("src",e.replace("ws://","http://").replace(/\/devtools\/.*/,n)).load(function(){var e=$(this).contents()[0].defaultView,n=e.InspectorFrontendAPI.loadCompleted;e.InspectorFrontendAPI.loadCompleted=function(){function t(e,t,n){var r=e[t];e[t]=function(){n.apply(null,arguments),r&&r.apply(null,arguments)}}var r=e.WebInspector.socket;t(r,"onmessage",y),t(r,"onopen",g),t(r,"onclose",v),t(r,"onerror",m),g(),n()},t&&(w(!0),b())}).appendTo(i)}else u=new WebSocket(e),u.onmessage=y,u.onopen=g,u.onclose=v,u.onerror=m}function k(e,t){a&&a.reject("CANCEL");var n=new $.Deferred;a=n;var r=S();return r.done(function(i){if(n.isRejected())return;var s,o;for(s in i){o=i[s];if(o.webSocketDebuggerUrl&&o.url.indexOf(e)===0){C(o.webSocketDebuggerUrl,t,o.devtoolsFrontendUrl),n.resolve();return}}n.reject(FileError.ERR_NOT_FOUND)}),r.fail(function(t){n.reject(t)}),n.promise()}function L(){return u!==undefined||f&&f.parent()[0]}function A(){return h?!0:!1}function O(e){var t=new XMLHttpRequest,r=new $.Deferred;return t.open("GET","LiveDevelopment/Inspector/"+e),t.onload=function(){var i=JSON.parse(t.response),s,o,u,a,f;for(s in i.domains){u=i.domains[s],n[u.domain]={};for(o in u.commands)f=u.commands[o],n[u.domain][f.name]=d.bind(undefined,u.domain+"."+f.name,f.parameters)}r.resolve()},t.send(null),r}function M(e){n.config=e,$(window).resize(b),n.Inspector||O("Inspector.json"),setInterval(function(){var e=$("#main-toolbar");e.offset({top:0,left:e.offset().left}),$("#dev-tools").offset({top:e.outerHeight(),left:e.offset().left})},500)}var i=$(n),s=1,o={},u,a,f,l,c,h;n.getAvailableSockets=S,n.on=x,n.off=T,n.disconnect=N,n.connect=C,n.connectToURL=k,n.setSocketsGetter=E,n.setInspectorJson=O,n.connected=L,n.usingDevTool=A,n.init=M}),define("LiveDevelopment/Agents/CSSAgent",["require","exports","module","thirdparty/path-utils/path-utils.min","LiveDevelopment/Inspector/Inspector"],function(t,n,r){function u(e){return PathUtils.parseUrl(e).hrefNoSearch}function a(e,t){o={},i.CSS.getAllStyleSheets(function(t){var n,r;for(n in t.headers)r=t.headers[n],o[u(r.sourceURL)]=r;s.resolve()})}function f(e){return o[u(e)]}function l(){var e=[],t;for(t in o)o.hasOwnProperty(t)&&e.push(t);return e}function c(e){var t=f(e.url);console.assert(t,"Style Sheet for document not loaded: "+e.url),i.CSS.setStyleSheetText(t.styleSheetId,e.getText(!0))}function h(e){var t=f(e.url);console.assert(t,"Style Sheet for document not loaded: "+e.url),i.CSS.setStyleSheetText(t.styleSheetId,"")}function p(){return s=new $.Deferred,$(i.Network).on("loadingFinished.CSSAgent",a),s.promise()}function d(){$(i.Page).off(".CSSAgent")}t("thirdparty/path-utils/path-utils.min");var i=t("LiveDevelopment/Inspector/Inspector"),s,o;n.styleForURL=f,n.getStylesheetURLs=l,n.reloadCSSForDocument=c,n.clearCSSForDocument=h,n.load=p,n.unload=d}),define("LiveDevelopment/Agents/RemoteAgent",["require","exports","module","LiveDevelopment/LiveDevelopment","LiveDevelopment/Inspector/Inspector"],function(t,n,r){function l(e,t){var n=new XMLHttpRequest;n.open("GET","LiveDevelopment/Agents/RemoteFunctions.js"),n.onload=function(){var t="window._LD="+n.response+"("+s.config.experimental+")";u.resolve()},n.send(null)}function c(e,t){var n=/^data-ld-(.*)/.exec(t.name);n&&i.triggerHandler(n[1],t)}function h(e,t){if(!a)return;console.assert(a,"Attempted to call remote method without objectId set.");var n=Array.prototype.slice.call(arguments,1),r;typeof n[n.length-1]=="function"&&(r=n.pop());var i;for(i in n)n[i].nodeId&&(n[i]=n[i].resolve());$.when.apply(undefined,n).done(function(){var i,s,u=[];for(i in arguments)s=n[i],s.objectId?u.push({objectId:s.objectId}):u.push({value:s});o.Runtime.callFunctionOn(a,"_LD."+e,u,undefined,r)})}function p(){return u=new $.Deferred,$(o.Page).on("loadEventFired.RemoteAgent",l),$(o.DOM).on("attributeModified.RemoteAgent",c),u.done(function(){f=window.setInterval(function(){h("keepAlive")},1e3)}),u.promise()}function d(){$(o.Page).off(".RemoteAgent"),$(o.DOM).off(".RemoteAgent"),f&&window.clearInterval(f)}var i=$(n),s=t("LiveDevelopment/LiveDevelopment"),o=t("LiveDevelopment/Inspector/Inspector"),u,a,f;n.call=h,n.load=p,n.unload=d}),define("LiveDevelopment/Agents/ScriptAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/DOMAgent"],function(t,n,r){function p(e,t){var n=s.nodeWithId(e);n.trace=t}function d(e){return a[e]}function v(e){return u[e]}function m(e){var t=[];return $.each(c[e],function(e,n){$.merge(t,f[n])}),t}function g(){var e=[],t;for(t in u)u.hasOwnProperty(t)&&e.push(t);return e}function y(e,t){o.resolve()}function b(e,t){var n=f[t.context.frameId]=f[t.context.frameId]||[];n.indexOf(t.context.id)===-1&&n.push(t.context.id)}function w(e,t){if(h){var n=s.nodeWithId(t.node.nodeId);n.trace=h,h=undefined}}function E(e,t){i.Page.getResourceTree(function(t){var n=function(e){$.each(e.resources,function(t,n){var r=u[n.url],i;r&&(i=c[r.scriptId]=c[r.scriptId]||[],i.indexOf(e.frame.id)===-1&&i.push(e.frame.id))}),e.childFrames&&$.each(e.childFrames,function(e,t){n(t)})};n(t.frameTree)})}function S(e,t){a[t.scriptId]=t,t.url&&(u[t.url]=t)}function x(e,t){}function T(e,t){switch(t.reason){case"exception":i.Debugger.resume();break;case"DOM":i.Debugger.resume(),t.data.type==="subtree-modified"&&t.data.insertion===!0&&(h=t.callFrames)}}function N(){return u={},a={},c={},f={},o=new $.Deferred,i.Debugger.enable(),i.Debugger.setPauseOnExceptions("uncaught"),$(s).on("getDocument.ScriptAgent",y),i.Runtime.setReportExecutionContextCreation?(i.Runtime.setReportExecutionContextCreation(!0),$(i.Runtime).on("isolatedContextCreated.ScriptAgent",b),$(i.Runtime).on("executionContextCreated.ScriptAgent",b)):(i.Runtime.enable(),$(i.Runtime).on("executionContextCreated.ScriptAgent",b)),$(i.Debugger).on("scriptParsed.ScriptAgent",S).on("scriptFailedToParse.ScriptAgent",x).on("paused.ScriptAgent",T),$(i.DOM).on("childNodeInserted.ScriptAgent",w),$(i.Network).on("loadingFinished.ScriptAgent",E),o}function C(){$(s).off(".ScriptAgent"),$(i.Debugger).off(".ScriptAgent"),$(i.DOM).off(".ScriptAgent"),$(i.Runtime).off(".ScriptAgent")}var i=t("LiveDevelopment/Inspector/Inspector"),s=t("LiveDevelopment/Agents/DOMAgent"),o,u,a,f,l,c,h;n.scriptWithId=d,n.scriptForURL=v,n.contextIdsForScript=m,n.getScriptURLs=g,n.load=N,n.unload=C}),define("LiveDevelopment/Agents/GotoAgent",["require","exports","module","utils/Global","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/ScriptAgent","LiveDevelopment/Agents/RemoteAgent","document/DocumentManager","editor/EditorManager"],function(t,n,r){function l(e){var t=e.search(/[#\?]/);return t>=0&&(e=e.substr(0,t)),e}function c(e){var t=e.split("/");return t[t.length-1]}function h(e,t){if(t.location){var n={},r=s.url,i=t.location;t.canHaveChildren()&&(i+=t.length),r+=":"+i;var o="&lt;"+t.name+"&gt;",u=c(r);e.push({type:"html",url:r,name:o,file:u})}}function p(e,t){if(t.sourceURL){var n={},r=t.sourceURL;r+=":"+t.style.range.start;var i=t.selectorList.text,s=c(r);e.push({type:"css",url:r,name:i,file:s})}}function d(e,t){var n=o.scriptWithId(t.location.scriptId);if(n&&n.url){var r={},i=n.url;i+=":"+t.location.lineNumber+","+t.location.columnNumber;var s=t.functionName;s===""&&(s="anonymous function");var u=c(i);e.push({type:"js",url:i,name:s,file:u})}}function v(e,t){var n=s.nodeWithId(t.nodeId);i.CSS.getMatchedStylesForNode(n.nodeId,function(t){var r,i,s,o,a,f,l=[];h(l,n);for(r in n.trace)d(l,n.trace[r]);for(r in n.events){var c=n.events[r];d(l,c.callFrames[0])}for(r in t.matchedCSSRules.reverse())p(l,t.matchedCSSRules[r].rule);u.call("showGoto",l)})}function m(e,t){var n=f.getCurrentFullEditor(),r=n._codeMirror;typeof e=="number"&&(e=r.posFromIndex(e)),r.setCursor(e),n.focus(),t||(r.addLineClass(e.line,"wrap","flash"),window.setTimeout(function(){r.removeLineClass(e.line,"wrap","flash")},1e3))}function g(e,t,n){console.assert(e.substr(0,7)==="file://","Cannot open non-file URLs");var r=new $.Deferred;e=l(e);var i=e.slice(brackets.platform==="win"?8:7);i=decodeURI(i);var s=a.getDocumentForPath(i);return s.done(function(i){a.setCurrentDocument(i),t&&m(t,n),r.resolve()}),s.fail(function(t){console.error(t),r.reject(t)}),r.promise()}function y(e,t){var n,r=t.value,i=/^(.*):([^:]+)$/.exec(r);i&&(r=i[1],n=i[2].split(","),n.length===1?n=parseInt(n[0],10):n={line:parseInt(n[0],10),ch:parseInt(n[1],10)}),g(r,n)}function b(){$(u).on("showgoto.GotoAgent",v).on("goto.GotoAgent",y)}function w(){$(u).off(".GotoAgent")}t("utils/Global");var i=t("LiveDevelopment/Inspector/Inspector"),s=t("LiveDevelopment/Agents/DOMAgent"),o=t("LiveDevelopment/Agents/ScriptAgent"),u=t("LiveDevelopment/Agents/RemoteAgent"),a=t("document/DocumentManager"),f=t("editor/EditorManager");n.openLocation=m,n.open=g,n.load=b,n.unload=w}),define("LiveDevelopment/Agents/EditAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/RemoteAgent","LiveDevelopment/Agents/GotoAgent","editor/EditorManager"],function(t,n,r){function l(e,t){if(e===t)return undefined;var n=e.length,r=0,i;for(i=0;i<n;i++)if(t[i]!==e[i])break;r+=i,t=t.substr(i),n-=i;for(i=0;i<n;i++)if(t[t.length-1-i]!==e[e.length-1-i])break;return n-=i,t=t.substr(0,t.length-i),{from:r,to:r+n,text:t}}function c(e,t){if(f.nodeId!==t.nodeId)return;u.open(s.url);var r=a.getCurrentFullEditor(),i=r._codeMirror,o=l(f.value,t.characterData);if(o){var c=i.posFromIndex(f.location+o.from),h=i.posFromIndex(f.location+o.to);n.isEditing=!0,r.document.replaceRange(o.text,c,h),n.isEditing=!1;var p=i.posFromIndex(f.location+o.from+o.text.length);r.setCursorPos(p.line,p.ch)}}function h(e,t){if(t.value==="0"){$(i.DOM).off(".EditAgent");return}var n=s.nodeWithId(t.nodeId);n=n.children[0];if(!n.location)return;f=n,$(i.DOM).on("characterDataModified.EditAgent",c)}function p(){$(o).on("edit.EditAgent",h)}function d(){$(o).off(".EditAgent")}var i=t("LiveDevelopment/Inspector/Inspector"),s=t("LiveDevelopment/Agents/DOMAgent"),o=t("LiveDevelopment/Agents/RemoteAgent"),u=t("LiveDevelopment/Agents/GotoAgent"),a=t("editor/EditorManager"),f;n.load=p,n.unload=d}),define("LiveDevelopment/Agents/DOMHelpers",["require","exports","module"],function(t,n,r){function i(e,t,n){return t==="\\"?!1:n!==undefined?e===n:e==='"'||e==="'"}function s(e){if(i(e[0])&&e[e.length-1]===e[0]){var t=e[0];e=e.substr(1,e.length-2),e=e.replace("\\"+t,t)}return e}function o(e,t,n,r,s){typeof t=="string"&&(t=[t,t.length]),n===undefined&&(n=0);var o,u,a=!1;for(o=n;o<e.length;o++)if(r&&i(e[o],e[o-1],u))u=u?undefined:e[o];else if(!u)if(s&&!a&&e.substr(o,s[0].length)===s[0])a=!0,o+=s[0].length-1;else if(a)e.substr(o,s[1].length)===s[1]&&(a=!1,o+=s[1].length-1);else if(e.substr(o,t[1]).search(t[0])===0)return o;return-1}function u(e,t,n,r,i){var s=0,u;while(s<e.length)u=o(e,t,s,n,r),u<0&&(u=e.length),i(e.substr(s,u-s)),s=u+1}function a(e,t){var n,r,i;return n=o(e,[/<[a-z!\/]/,2],t),n<0?null:(e.substr(n,4)==="<!--"?(r=o(e,"-->",n+4),i=3):e.substr(n,7)==="<script"?(r=o(e,"</script>",n+7),i=9):(r=o(e,">",n+1,!0),i=1),r<0?null:{from:n,length:r+i-n})}function f(e){e=e.replace(/^<\S+\s*/,""),e=e.replace(/\s*\/?>$/,"");if(e.length===0)return;var t,n,r,i={};return u(e,[/\s/,1],!0,undefined,function(o){t=o.search("=");if(t<0)return;n=o.substr(0,t).trim();if(n.length===0)return;r=o.substr(t+1).trim(),r=s(r),i[n]=r}),i}function l(e){var t={};return e[0]!=="<"?(t.nodeType=3,t.nodeValue=e):e.substr(0,4)==="<!--"?(t.nodeType=8,t.nodeValue=e.substr(4,e.length-7)):e[1]==="!"?t.nodeType=10:(t.nodeType=1,t.nodeName=/^<([^>\s]+)/.exec(e)[1].toUpperCase(),t.attributes=f(e),t.nodeName[0]==="/"&&(t.nodeName=t.nodeName.substr(1),t.closing=!0),e[e.length-2]==="/"&&(t.closed=!0)),t}function c(e,t){var n=0,r,i,s,o,u=0;while(n<e.length)i=a(e,n),i||(i={from:e.length,length:0}),s=i.from-n,s>0&&(r=e.substr(n,s),/\S/.test(r)&&(o=l(r),o.sourceOffset=n,o.sourceLength=s,t(o))),i.length>0&&(o=l(e.substr(i.from,i.length)),o.sourceOffset=i.from,o.sourceLength=i.length,t(o)),n=i.from+i.length}n.extractPayload=l,n.eachNode=c}),define("LiveDevelopment/Agents/DOMNode",["require","exports","module","LiveDevelopment/Agents/DOMHelpers"],function(t,n,r){function s(e,t,n){n===undefined&&(n=" ");while(e.length<t)e+=n;return e}function o(e){switch(typeof e){case"function":return e;case"string":return function(t,n){return n.name===t}.bind(undefined,e.toUpperCase());case"number":return function(t,n){return n.type===t}.bind(undefined,e);default:console.error("Invalid find condition: "+e)}}var i=t("LiveDevelopment/Agents/DOMHelpers"),u=function(t,n){this.agent=t,this.children=[],this.attributes={},typeof n=="string"&&(n=i.extractPayload(n)),n&&this.setPayload(n),this.agent.addNode(this)},a=u.TYPE_ELEMENT=1,f=u.TYPE_ATTRIBUTE=2,l=u.TYPE_TEXT=3,c=u.TYPE_COMMENT=8,h=u.TYPE_DOCUMENT=9;return u.prototype.remove=function(){this.agent.removeNode(this),this.parent&&this.parent.removeChild(this)},u.prototype.setPayload=function(t){this.nodeId=t.nodeId,this.type=t.nodeType,t.contentDocument&&this.appendChild(new u(this.agent,t.contentDocument)),t.nodeName&&(this.name=t.nodeName),t.nodeValue&&(this.value=t.nodeValue),this.attributes={};if(t.attributes){var n,r,i;for(n=0;n<t.attributes.length;n+=2)r=t.attributes[n],i=t.attributes[n+1],this.attributes[r]=i}t.sourceOffset&&(this.location=t.sourceOffset),t.sourceLength?this.length=t.sourceLength:this.value?this.length=this.value.length:this.name&&(this.length=this.name.length+2),t.children?this.setChildrenPayload(t.children):t.childNodeCount&&this.agent.requestChildNodes(this)},u.prototype.setChildrenPayload=function(t){var n,r,i;for(n in t)r=t[n],i=new u(this.agent,r),this.appendChild(i)},u.prototype.payload=function(){var t={type:this.type};return this.nodeType===a?t.nodeName=this.name:t.value=this.value,t},u.prototype.findParentForNextNodeMatchingPayload=function(t){var n=this.canHaveChildren()?this:this.parent;while(n&&!n.matchesPayload(t))n=n.parent;return n},u.prototype.findNextNodeMatchingPayload=function(t){var n=this.nextNode();while(n&&!n.matchesPayload(t))n=n.nextNode();return n},u.prototype.matchesPayload=function(t){var n=!1;if(this.type===t.nodeType)switch(this.type){case 1:n=this.name===t.nodeName;break;case 3:n=!0;break;default:n=!0}return n},u.prototype.resolve=function(){var t=new $.Deferred;return this.objectId?t.resolve(this):this.nodeId?this.agent.resolveNode(this,function(n){this.objectId=n.object.objectId,t.resolve(this)}.bind(this)):t.reject(),t.promise()},u.prototype.canHaveChildren=function(){return this.type===1&&!this.closed&&!this.closing&&this.nodeName!=="LINK"},u.prototype.removeChild=function(t){this.children.splice(this.indexOfChild(t),1),delete t.parent},u.prototype.insertChildAt=function(t,n){t.parent&&t.parent.removeChild(t);if(!n||n<0||n>this.children.length)n=this.children.length;return this.children.splice(n,0,t),t.parent=this,t},u.prototype.appendChild=function(t){return this.insertChildAt(t)},u.prototype.insertChildAfter=function(t,n){var r=this.indexOfChild(n);return r>=0&&r++,this.insertChildAt(t,r)},u.prototype.insertChildBefore=function(t,n){var r=this.indexOfChild(n);return this.insertChildAt(t,r)},u.prototype.indexOfChild=function(t){if(!t)return-1;var n;for(n in this.children)if(this.children[n]===t)return parseInt(n,0);return-1},u.prototype.previousSibling=function(){return this.parent?this.parent.children[this.parent.indexOfChild(this)-1]:null},u.prototype.nextSibling=function(){return this.parent?this.parent.children[this.parent.indexOfChild(this)+1]:null},u.prototype.previousNode=function(){var t=this.previousSibling();return t?t.children.length>0&&(t=t.children[t.children.length-1]):t=this.parent,t},u.prototype.nextNode=function(){if(this.children.length>0)return this.children[0];var t,n=this;while(n){t=n.nextSibling();if(t)return t;n=n.parent}return null},u.prototype.each=function(t){if(t(this)===!1)return!1;var n;for(n in this.children)if(this.children[n].each(t)===!1)return!1;return!0},u.prototype.find=function(t){var n=o(t),r=null;return this.each(function(t){if(n(t))return r=t,!1}),r},u.prototype.findAll=function(t){var n=[],r=o(t);return this.each(function(t){r(t)&&n.push(t)}),n},u.prototype.eachParent=function(t){var n=this.parent;while(n){if(t(n)===!1)return;n=n.parent}return null},u.prototype.findParent=function(t){var n=null;return this.eachParent(function(r){if(t(r))return n=r,!1}),n},u.prototype.root=function(){var t=this;while(t.parent)t=t.parent;return t},u.prototype.isAtLocation=function(t,n){n===undefined&&(n=!0);if(!this.location||t<this.location)return!1;var r;return n&&this.closeLocation?r=this.closeLocation+this.closeLength:r=this.location+this.length,this.type===l&&(r+=1),t<r},u.prototype.isEmpty=function(){return this.type===l&&/^\s*$/.test(this.value)},u.prototype.toString=function p(){var e;switch(this.type){case a:e="<"+this.name+">";break;case f:e="[ATTRIBUTE]";break;case l:e=this.value.replace(/\s+/," ").substr(0,40);break;case c:e="<!--"+this.value.replace(/\s+/," ").substr(0,33)+"-->";break;case h:e="<!DOCTYPE>"}return e},u.prototype.dump=function(t){t===undefined&&(t="");var n=t+this.toString();this.location&&(n=s(n,60),n+=" ("+this.location+","+(this.location+this.length)+")",this.closeLocation&&(n+=" ("+this.closeLocation+","+(this.closeLocation+this.closeLength)+")")),this.nodeId&&(n=s(n,80),n+=" {"+this.nodeId+"}"),console.info(n),t+=". ";var r;for(r in this.children)this.children[r].dump(t)},u}),define("LiveDevelopment/Agents/DOMAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/RemoteAgent","LiveDevelopment/Agents/EditAgent","LiveDevelopment/Agents/DOMNode","LiveDevelopment/Agents/DOMHelpers"],function(t,n,r){function p(e){var t;return n.root.each(function(r){if(!r.location||e<r.location)return!0;if(!t||t.location<r.location)t=r}),t}function d(e){var t=[];return n.root.each(function(r){r.type===a.TYPE_ELEMENT&&r.isAtLocation(e)&&t.push(r)}),t}function v(e){return n.root.find(function(n){return n.isAtLocation(e,!1)})}function m(e){return c[e]}function g(e){e.nodeId&&delete c[e.nodeId]}function y(e){e.nodeId&&(c[e.nodeId]=e)}function b(e){h>=0&&h++,s.DOM.requestChildNodes(e.nodeId)}function w(e,t){console.assert(e.nodeId,"Attempted to resolve node without id"),s.DOM.resolveNode(e.nodeId,t)}function E(e){var t=e.search(/[#\?]/);return t>=0&&(e=e.substr(0,t)),e}function S(e){var t=n.root;f.eachNode(e,function(n){if(!t)return!0;if(n.closing){var r=t.findParentForNextNodeMatchingPayload(n);if(!r)return console.warn("Matching Parent not at "+n.sourceOffset+" ("+n.nodeName+")");r.closeLocation=n.sourceOffset,r.closeLength=n.sourceLength}else{var i=t.findNextNodeMatchingPayload(n);if(!i)return console.warn("Skipping Source Node at "+n.sourceOffset);t=i,t.location=n.sourceOffset,t.length=n.sourceLength,n.closed&&(t.closed=n.closed)}})}function x(){s.Page.getResourceContent(n.frameId,n.url,function(e){S(e.content),l.resolve()})}function T(e,t){s.DOM.getDocument(function(t){i.triggerHandler("getDocument",t),c={},h=0,n.root=new a(n,t.root)})}function N(e,t){n.url=E(t.frame.url),n.frameId=t.frame.id}function C(e,t){}function k(e,t){try{var n=m(t.parentId);n.setChildrenPayload(t.nodes),h>0&&--h===0&&x()}catch(r){console.error("setChildNodes error",r)}}function L(e,t){t.nodeId>0&&s.DOM.requestChildNodes(t.nodeId)}function A(e,t){if(t.node.nodeId>0){var r=m(t.parentNodeId),i=m(t.previousNodeId),s=new a(n,t.node);r.insertChildAfter(s,i)}}function O(e,t){if(t.nodeId>0){var n=m(t.nodeId);n.remove()}}function M(e,t,r){var i=e-t+r.length,o=v(e);if(!o)/^\s*$/.test(r)||(console.warn("Inserting nodes not supported."),o=p(e));else if(o.type===3){var a=o.value.substr(0,e-o.location);a+=r,a+=o.value.substr(t-o.location),o.value=a,u.isEditing||s.DOM.setNodeValue(o.nodeId,o.value)}else console.warn("Changing non-text nodes not supported.");o&&(o.length+=i,n.root.each(function(t){t.location>o.location&&(t.location+=i)}))}function _(){return l=new $.Deferred,$(s.Page).on("frameNavigated.DOMAgent",N).on("loadEventFired.DOMAgent",T),$(s.DOM).on("documentUpdated.DOMAgent",C).on("setChildNodes.DOMAgent",k).on("childNodeCountUpdated.DOMAgent",L).on("childNodeInserted.DOMAgent",A).on("childNodeRemoved.DOMAgent",O),s.Page.enable(),l.promise()}function D(){$(s.Page).off(".DOMAgent"),$(s.DOM).off(".DOMAgent")}var i=$(n),s=t("LiveDevelopment/Inspector/Inspector"),o=t("LiveDevelopment/Agents/RemoteAgent"),u=t("LiveDevelopment/Agents/EditAgent"),a=t("LiveDevelopment/Agents/DOMNode"),f=t("LiveDevelopment/Agents/DOMHelpers"),l,c,h;n.nodeBeforeLocation=p,n.allNodesAtLocation=d,n.nodeAtLocation=v,n.nodeWithId=m,n.removeNode=g,n.addNode=y,n.requestChildNodes=b,n.applyChange=M,n.load=_,n.unload=D}),define("LiveDevelopment/Agents/HighlightAgent",["require","exports","module","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Inspector/Inspector","LiveDevelopment/LiveDevelopment","LiveDevelopment/Agents/RemoteAgent"],function(t,n,r){function f(e,t){var r;t.value==="1"&&(r=i.nodeWithId(t.nodeId)),$(n).triggerHandler("highlight",[r])}function l(){switch(a.type){case"node":s.DOM.hideHighlight();break;case"css":u.call("hideHighlight")}a={}}function c(e){if(!o.config.experimental)return;if(!s.config.highlight)return;e&&e.type===3&&(e=e.parent);if(!e||!e.nodeId||e.type!==1)return l();if(a.type==="node"&&a.ref===e.nodeId)return;a={type:"node",ref:e.nodeId},s.DOM.highlightNode(e.nodeId,s.config.highlightConfig)}function h(e){if(a.ref===e)return;l(),a={type:"css",ref:e},u.call("highlightRule",e)}function p(){u.call("redrawHighlights")}function d(){a={},o.config.experimental&&$(u).on("highlight.HighlightAgent",f)}function v(){o.config.experimental&&$(u).off(".HighlightAgent")}var i=t("LiveDevelopment/Agents/DOMAgent"),s=t("LiveDevelopment/Inspector/Inspector"),o=t("LiveDevelopment/LiveDevelopment"),u=t("LiveDevelopment/Agents/RemoteAgent"),a;n.hide=l,n.node=c,n.rule=h,n.redraw=p,n.load=d,n.unload=v}),define("LiveDevelopment/Documents/CSSDocument",["require","exports","module","LiveDevelopment/Agents/CSSAgent","language/CSSUtils","editor/EditorManager","LiveDevelopment/Agents/HighlightAgent","LiveDevelopment/Inspector/Inspector"],function(t,n,r){var i=t("LiveDevelopment/Agents/CSSAgent"),s=t("language/CSSUtils"),o=t("editor/EditorManager"),u=t("LiveDevelopment/Agents/HighlightAgent"),a=t("LiveDevelopment/Inspector/Inspector"),f=function(t,n){this.doc=t,this._highlight=[],this.onHighlight=this.onHighlight.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),this.doc.addRef(),this.onChange=this.onChange.bind(this),this.onDeleted=this.onDeleted.bind(this),$(this.doc).on("change",this.onChange),$(this.doc).on("deleted",this.onDeleted),this.styleSheet=i.styleForURL(this.doc.url),t.isDirty&&i.reloadCSSForDocument(this.doc),this.onActiveEditorChange=this.onActiveEditorChange.bind(this),$(o).on("activeEditorChange",this.onActiveEditorChange),n&&this.attachToEditor(n)};f.prototype.getStyleSheetFromBrowser=function(){var t=new $.Deferred;return a.CSS.getStyleSheet(this.styleSheet.styleSheetId,function(n){n.styleSheet?t.resolve(n.styleSheet):t.reject()}),t.promise()},f.prototype.getSourceFromBrowser=function(){var t=new $.Deferred;return this.getStyleSheetFromBrowser().done(function(n){t.resolve(n.text)}).fail(function(){t.reject()}),t.promise()},f.prototype.close=function(){$(this.doc).off("change",this.onChange),$(this.doc).off("deleted",this.onDeleted),this.doc.releaseRef(),this.detachFromEditor()},f.prototype.attachToEditor=function(e){this.editor=e,this.editor&&($(u).on("highlight",this.onHighlight),$(this.editor).on("cursorActivity",this.onCursorActivity),this.updateHighlight())},f.prototype.detachFromEditor=function(){this.editor&&(u.hide(),$(u).off("highlight",this.onHighlight),$(this.editor).off("cursorActivity",this.onCursorActivity),this.onHighlight(),this.editor=null)},f.prototype.updateHighlight=function(){if(a.config.highlight&&this.editor){var e=this.editor._codeMirror,t=s.findSelectorAtDocumentPos(this.editor,e.getCursor());t?u.rule(t):u.hide()}},f.prototype.onCursorActivity=function(t,n){this.updateHighlight()},f.prototype.onChange=function(t,n,r){i.reloadCSSForDocument(this.doc),a.config.highlight},f.prototype.onDeleted=function(t,n,r){i.clearCSSForDocument(this.doc),this.close(),$(this).triggerHandler("deleted",[this])},f.prototype.onActiveEditorChange=function(e,t,n){this.detachFromEditor(),t&&t.document===this.doc&&this.attachToEditor(t)},f.prototype.onHighlight=function(t,n){var r;for(r in this._highlight)this._highlight[r].clear();this._highlight=[];if(!n||!n.location)return;a.CSS.getMatchedStylesForNode(n.nodeId,function(t){var n=this.editor._codeMirror,r,i,s,o;for(r in t.matchedCSSRules)i=t.matchedCSSRules[r],i.ruleId&&i.ruleId.styleSheetId===this.styleSheet.styleSheetId&&(s=n.posFromIndex(i.selectorRange.start),o=n.posFromIndex(i.style.range.end),this._highlight.push(n.markText(s,o,{className:"highlight"})))}.bind(this))},r.exports=f}),define("LiveDevelopment/Documents/HTMLDocument",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/HighlightAgent"],function(t,n,r){var i=t("LiveDevelopment/Inspector/Inspector"),s=t("LiveDevelopment/Agents/DOMAgent"),o=t("LiveDevelopment/Agents/HighlightAgent"),u=function(t,n){if(!n)return;this.doc=t,this.editor=n,this.onHighlight=this.onHighlight.bind(this),this.onChange=this.onChange.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),$(o).on("highlight",this.onHighlight),$(this.editor).on("change",this.onChange),$(this.editor).on("cursorActivity",this.onCursorActivity),this.onCursorActivity()};u.prototype.close=function(){if(!this.editor)return;$(o).off("highlight",this.onHighlight),$(this.editor).off("change",this.onChange),$(this.editor).off("cursorActivity",this.onCursorActivity),this.onHighlight()},u.prototype.onCursorActivity=function(t,n){var r=this.editor._codeMirror;if(i.config.highlight){var u=r.indexFromPos(r.getCursor()),a=s.allNodesAtLocation(u).pop();o.node(a)}},u.prototype.onChange=function(t,n,r){var i=this.editor._codeMirror;while(r){var o=i.indexFromPos(r.from),u=i.indexFromPos(r.to),a=r.text.join("\n");s.applyChange(o,u,a),r=r.next}},u.prototype.onHighlight=function(t,n){if(!n||!n.location){this._highlight&&(this._highlight.clear(),delete this._highlight);return}var r=this.editor._codeMirror,i,s=r.posFromIndex(n.location);n.closeLocation?i=n.closeLocation+n.closeLength:i=n.location+n.length,i=r.posFromIndex(i),this._highlight&&this._highlight.clear(),this._highlight=r.markText(s,i,{className:"highlight"})},r.exports=u}),define("LiveDevelopment/Documents/JSDocument",["require","exports","module","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Agents/ScriptAgent","LiveDevelopment/Agents/HighlightAgent"],function(t,n,r){var i=t("LiveDevelopment/Inspector/Inspector"),s=t("LiveDevelopment/Agents/ScriptAgent"),o=t("LiveDevelopment/Agents/HighlightAgent"),u=function(t,n){if(!n)return;this.doc=t,this.editor=n,this.onHighlight=this.onHighlight.bind(this),this.onChange=this.onChange.bind(this),this.onCursorActivity=this.onCursorActivity.bind(this),$(o).on("highlight",this.onHighlight),$(this.editor).on("change",this.onChange),$(this.editor).on("cursorActivity",this.onCursorActivity),this.onCursorActivity()};u.prototype.close=function(){if(!this.editor)return;$(o).off("highlight",this.onHighlight),$(this.editor).off("change",this.onChange),$(this.editor).off("cursorActivity",this.onCursorActivity),this.onHighlight()},u.prototype.script=function(){return s.scriptForURL(this.doc.url)},u.prototype.onCursorActivity=function(t,n){},u.prototype.onChange=function(t,n,r){var o=this.doc.getText(!0);i.Debugger.setScriptSource(this.script().scriptId,o,function(t){$.each(s.contextIdsForScript(this.script().scriptId),function(e,t){i.Runtime.evaluate('if($)$("canvas").each(function(i,e){if(e.rerender)e.rerender()})',"",!1,!1,t)})}.bind(this))},u.prototype.onHighlight=function(t,n){var r=this.editor._codeMirror,i;for(i in this._highlight)r.removeLineClass(this._highlight[i],"wrap","highlight");this._highlight=[];if(!n||!n.trace)return;var s=this.script().scriptId,o,u;for(i in n.trace)o=n.trace[i],o.location&&o.location.scriptId===s&&(u=o.location.lineNumber,r.addLineClass(u,"wrap","highlight"),this._highlight.push(u))},r.exports=u}),define("LiveDevelopment/Agents/ConsoleAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector"],function(t,n,r){function o(e){var t=e.level;t==="warning"&&(t="warn");var n="ConsoleAgent: "+e.text;if(e.stackTrace){var r=e.stackTrace[0];n+=" in "+r.functionName+":"+r.columnNumber}console[t]?console[t](n):console.log(t+":"+n)}function u(e,t){s=t.message,o(s)}function a(e,t){s&&o(s)}function f(e,t){}function l(){i.Console.enable(),$(i.Console).on("messageAdded.ConsoleAgent",u).on("messageRepeatCountUpdated.ConsoleAgent",a).on("messagesCleared.ConsoleAgent",f)}function c(){$(i.Console).off(".ConsoleAgent")}var i=t("LiveDevelopment/Inspector/Inspector"),s;n.load=l,n.unload=c}),define("LiveDevelopment/Agents/NetworkAgent",["require","exports","module","LiveDevelopment/Inspector/Inspector"],function(t,n,r){function o(e){var t=e.search(/[#\?]/);return t>=0&&(e=e.substr(0,t)),e}function u(e){return s&&s[e]}function a(e,t){var n=o(t.request.url);s[n]=!0}function f(){s={},i.Network.enable(),$(i.Network).on("requestWillBeSent.NetworkAgent",a)}function l(){$(i.Network).off(".NetworkAgent")}var i=t("LiveDevelopment/Inspector/Inspector"),s;n.wasURLRequested=u,n.load=f,n.unload=l}),define("LiveDevelopment/LiveDevelopment",["require","exports","module","utils/Global","widgets/Dialogs","document/DocumentManager","editor/EditorManager","file/FileUtils","file/NativeFileError","utils/NativeApp","preferences/PreferencesDialogs","project/ProjectManager","strings","utils/StringUtils","LiveDevelopment/Inspector/Inspector","LiveDevelopment/Documents/CSSDocument","LiveDevelopment/Documents/HTMLDocument","LiveDevelopment/Documents/JSDocument","LiveDevelopment/Agents/ConsoleAgent","LiveDevelopment/Agents/RemoteAgent","LiveDevelopment/Agents/NetworkAgent","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Agents/CSSAgent","LiveDevelopment/Agents/ScriptAgent","LiveDevelopment/Agents/HighlightAgent","LiveDevelopment/Agents/GotoAgent","LiveDevelopment/Agents/EditAgent"],function(t,n,r){function P(e){O.push(e)}function H(e){M.push(e)}function B(e){var t=M.indexOf(e);t!==-1&&M.splice(t,1)}function j(e){_=e}function F(e){return p.isStaticHtmlFileExt(e)||g.getBaseUrl()&&p.isServerHtmlFileExt(e)}function I(e){var t=e,n=g.getBaseUrl();return n!==""&&e.indexOf(n)===0?t=e.replace(n,encodeURI(g.getProjectRoot().fullPath)):e.indexOf("file://")===0&&(t=e.slice(7),t&&!brackets.inBrowser&&brackets.platform==="win"&&t.charAt(0)==="/"&&(t=t.slice(1))),decodeURI(t)}function q(e){var t,n=g.getBaseUrl();if(n!==""&&g.isWithinProject(e)){var r=encodeURI(e),i=encodeURI(g.getProjectRoot().fullPath);t=r.replace(i,n)}else{var s=location.origin;brackets.platform==="win"&&e.charAt(0)!=="/"&&(s+="/"),t=encodeURI(s+e)}return M.forEach(function(e){t=e(t)}),t}function R(e){var t,n,r;r=/^(.*\/)(.+\.([^.]+))$/.exec(e.file.fullPath);if(!r)return;e.extension=r[3],t=q(r[1]),e.url=t+encodeURI(r[2]),n=F(r[3])?e.url:t+"index.html",e.root={url:n}}function U(){var e=c.getCurrentDocument();return e&&R(e),e}function z(e){switch(e.extension){case"css":return E;case"js":return n.config.experimental?x:null}return n.config.experimental&&F(e.extension)?S:null}function W(e){var t=[];A&&(t=t.concat(A)),L&&(t=t.concat(L));var n;return t.some(function(r){return r.doc.file.fullPath===e?(n=r,!0):!1}),n}function X(e){return e?W(e.document.file.fullPath):null}function V(e,t){var n=A.indexOf(t);n!==-1&&($(t).on("deleted",V),A.splice(n,1))}function J(){L&&(L.close(),L=undefined),A&&(A.forEach(function(e){e.close(),$(e).off("deleted",V)}),A=undefined)}function K(e,t){var n=z(e);if(!n)return null;try{return new n(e,t)}catch(r){return console.warn("create document problem:"+e),null}}function Q(e,t){var r;J(),L=K(e,t),A=[],r=T.css.getStylesheetURLs(),n.config.experimental&&(r=$.merge([],r,T.script.getScriptURLs())),r.forEach(function(e){c.getDocumentForPath(I(e)).done(function(e){if(!L||e!==L.doc){R(e);var t=K(e);t&&(A.push(t),$(t).on("deleted",V))}})})}function G(){k.forEach(function(e){T[e].unload()}),k=[]}function Y(){var e,t=[],r;n.config.experimental?r=T:r=C;for(e in r)r.hasOwnProperty(e)&&T[e]&&T[e].load&&(t.push(T[e].load()),k.push(e));return t}function Z(e){T.hasOwnProperty(e)&&!C.hasOwnProperty(e)&&(C[e]=!0)}function et(e){C.hasOwnProperty(e)&&delete C[e]}function tt(e){n.status=e,$(n).triggerHandler("statusChange",e)}function nt(e,t){var n;!t||!t.message?(console.warn("Expected a non-empty string in error.message, got this instead:",t?t.message:null),n=JSON.stringify(t)):n=t.message,n&&n.substr(0,8)==="Uncaught"&&(n=n.substr(9));var r=t?t.data:null;Array.isArray(r)&&(n+="\n"+r.join("\n")),console.error(n,t),tt(i)}function rt(){var e=U();if(!e)return;var t=h.getCurrentFullEditor(),n=a;Q(e,t),e.isDirty&&z(e)!==E&&(n=f),tt(n)}function it(e,t){}function st(e){if(D){rt();return}$(w.Inspector).on("detached",it),tt(u);var t=Y();$.when.apply(undefined,t).done(rt).fail(nt);var n=U();n?w.Page.reload():w.Page.reload()}function ot(e){$(w.Inspector).off("detached",it),G(),J(),tt(s)}function ut(){G();var e=Y();tt(u),$.when.apply(undefined,e).done(rt).fail(nt)}function at(e){function E(){l.showModalDialog(l.DIALOG_ID_ERROR,y.LIVE_DEVELOPMENT_ERROR_TITLE,y.LIVE_DEV_NEED_HTML_MESSAGE),t.reject()}function S(){m.showProjectPreferencesDialog("",y.LIVE_DEV_NEED_BASEURL_MESSAGE).done(function(e){e===l.DIALOG_BTN_OK&&g.getBaseUrl()?(at(),t.resolve()):t.reject()}).fail(function(){t.reject()})}var t=new $.Deferred,r=t.promise(),u=U(),a=u.root.url,f,c=!1,h=0;O.forEach(function(e){a=e(a)}),f=a.split(" "),D=e,f=f[f.length-1].split("-app="),f=f[f.length-1],u.root.url=f;if(!u||!u.root)E();else{if(!n.config.experimental)if(p.isServerHtmlFileExt(u.extension)){if(!g.getBaseUrl())return S(),r}else if(!p.isStaticHtmlFileExt(u.extension))return E(),r;var f=u.root.url;tt(o),OpenBrowserWindowIfNeeded(f),w.connectToURL(f,e).done(t.resolve).fail(function x(r){if(r==="CANCEL"){t.reject(r);return}if(h>6){tt(i),l.showModalDialog(l.DIALOG_ID_LIVE_DEVELOPMENT,y.LIVE_DEVELOPMENT_RELAUNCH_TITLE,y.LIVE_DEVELOPMENT_ERROR_MESSAGE).done(function(e){e===l.DIALOG_BTN_OK?(tt(s),v.closeLiveBrowser().done(function(){c=!1,window.setTimeout(function(){at().done(t.resolve).fail(t.reject)})}).fail(function(e){tt(i),c=!1,t.reject("CLOSE_LIVE_BROWSER")})):t.reject("CANCEL")});return}h++,!c&&n.status!==i?v.openLiveBrowser(a,r!==d.ERR_NOT_FOUND).done(function(){c=!0,n.status!==i&&window.setTimeout(function(){w.connectToURL(f,e).then(t.resolve,x)},100)}).fail(function(e){var n;tt(i),e===d.NOT_FOUND_ERR?n=y.ERROR_CANT_FIND_CHROME:n=b.format(y.ERROR_LAUNCHING_BROWSER,e),n&&(n+=" "+b.format(y.LIVE_DEVELOPMENT_TROUBLESHOOTING,brackets.config.troubleshoot_url)),l.showModalDialog(l.DIALOG_ID_ERROR,y.ERROR_LAUNCHING_BROWSER_TITLE,n),t.reject("OPEN_LIVE_BROWSER")}):n.status!==i&&window.setTimeout(function(){w.connectToURL(f,e).done(t.resolve).fail(x)},500)})}return r}function ft(){v.closeLiveBrowser(),w.disconnect(),tt(s)}function lt(){var e=X(h.getActiveEditor());e instanceof E&&e.updateHighlight()}function ct(){w.connected()&&T.highlight&&T.highlight.hide()}function ht(){w.connected()&&T.highlight}function pt(){var e=U(),t=a;if(!e)return;if(w.connected()){ct();if(T.network&&T.network.wasURLRequested(e.url)){J();var n=h.getCurrentFullEditor();Q(e,n)}else F(e.extension)&&(ft(),window.setTimeout(at,300));e.isDirty&&z(e)!==E&&(t=f),tt(t)}}function dt(e,t){t&&w.connected()&&z(t)!==E&&T.network&&T.network.wasURLRequested(t.url)&&($(n).triggerHandler("liveHTMLSaved",t),w.Page.reload(),ut())}function vt(e,t){t&&w.connected()&&z(t)!==E&&T.network&&T.network.wasURLRequested(t.url)&&tt(t.isDirty?f:a)}function mt(e){n.config=e,$(w).on("connect",st).on("disconnect",ot).on("error",nt),$(c).on("currentDocumentChange",pt).on("documentSaved",dt).on("dirtyFlagChange",vt)}t("utils/Global");var i=n.STATUS_ERROR=-1,s=n.STATUS_INACTIVE=0,o=n.STATUS_CONNECTING=1,u=n.STATUS_LOADING_AGENTS=2,a=n.STATUS_ACTIVE=3,f=n.STATUS_OUT_OF_SYNC=4,l=t("widgets/Dialogs"),c=t("document/DocumentManager"),h=t("editor/EditorManager"),p=t("file/FileUtils"),d=t("file/NativeFileError"),v=t("utils/NativeApp"),m=t("preferences/PreferencesDialogs"),g=t("project/ProjectManager"),y=t("strings"),b=t("utils/StringUtils"),w=t("LiveDevelopment/Inspector/Inspector"),E=t("LiveDevelopment/Documents/CSSDocument"),S=t("LiveDevelopment/Documents/HTMLDocument"),x=t("LiveDevelopment/Documents/JSDocument"),T={console:t("LiveDevelopment/Agents/ConsoleAgent"),remote:t("LiveDevelopment/Agents/RemoteAgent"),network:t("LiveDevelopment/Agents/NetworkAgent"),dom:t("LiveDevelopment/Agents/DOMAgent"),css:t("LiveDevelopment/Agents/CSSAgent"),script:t("LiveDevelopment/Agents/ScriptAgent"),highlight:t("LiveDevelopment/Agents/HighlightAgent"),"goto":t("LiveDevelopment/Agents/GotoAgent"),edit:t("LiveDevelopment/Agents/EditAgent")},N=window.location.href.replace(/\/index.html.*/,"")+"/LiveDevelopment/launch.html",C={console:!0,remote:!0,network:!0,dom:!0,css:!0,highlight:!0},k=[],L,A,O=[],M=[],_,D;n._pathToUrl=q,n._urlToPath=I,n.agents=T,n.open=at,n.close=ft,n.enableAgent=Z,n.disableAgent=et,n.getLiveDocForPath=W,n.showHighlight=lt,n.hideHighlight=ct,n.redrawHighlight=ht,n.addUrlWrapper=P,n.addUrlMapper=H,n.removeUrlMapper=B,n.setCloseScript=j,n.init=mt}),define("utils/ExtensionUtils",["require","exports","module","file/FileUtils"],function(e,t,n){function r(e){return $("<style>").text(e).appendTo("head")[0]}function i(e,t){var n={type:"text/css",rel:"stylesheet",href:e},r=$("<link/>").attr(n);return t&&r.load(t.resolve).error(t.reject),r.appendTo("head"),r[0]}function s(e,t){var n=new $.Deferred,r;if(t){var i=t.slice(0,t.lastIndexOf("/")+1),s=t.slice(i.length);r={filename:s,paths:[i]}}var o=new less.Parser(r);return o.parse(e,function(t,r){t?n.reject(t):n.resolve(r.toCSS())}),n.promise()}function o(t,n){var r=e("file/FileUtils").getNativeModuleDirectoryPath(t);return n&&(r+="/"+n),r}function u(e,t){var n=encodeURI(o(e,t));return brackets.platform==="win"&&n.indexOf(":")!==-1?n=location.origin+"/"+n:n=location.origin+n,n}function a(e,t){var n=u(e,t),r=$.get(n);return r}function f(e,t){var n=new $.Deferred;return a(e,t).done(function(e){var t=this.url;if(t.slice(-5)===".less")s(e,t).done(function(e){n.resolve(r(e))}).fail(n.reject);else{var o=new $.Deferred,u=i(t,o);o.done(function(){n.resolve(u)}).fail(n.reject)}}).fail(n.reject),n.promise()}t.addEmbeddedStyleSheet=r,t.addLinkedStyleSheet=i,t.parseLessCode=s,t.getModulePath=o,t.getModuleUrl=u,t.loadFile=a,t.loadStyleSheet=f}),define("LiveDevelopment/main",["require","exports","module","document/DocumentManager","command/Commands","utils/AppInit","LiveDevelopment/LiveDevelopment","LiveDevelopment/Inspector/Inspector","command/CommandManager","preferences/PreferencesManager","widgets/Dialogs","utils/UrlParams","strings","utils/ExtensionUtils"],function(t,n,r){function T(e,t,n,r){$("span",e).remove(),e.removeClass(E),t&&t.length>0?$('<span class="label">').addClass(n).text(t).appendTo(e):e.addClass(n),r&&e.attr("title",r)}function N(){u.status>=u.STATUS_CONNECTING?u.close():!m.get("skipLiveDevelopmentInfo")&&!v.getValue("afterFirstLaunch")?(v.setValue("afterFirstLaunch","true"),c.showModalDialog(c.DIALOG_ID_INFO,p.LIVE_DEVELOPMENT_INFO_TITLE,p.LIVE_DEVELOPMENT_INFO_MESSAGE).done(function(e){u.open.apply(u,this)}.bind(arguments))):u.open.apply(u,arguments)}function C(){S=$("#toolbar-go-live"),S.click(function(){N()}),$(u).on("statusChange",function(t,n){T(S,null,w[n+1],b[n+1]),g.autoconnect&&window.sessionStorage.setItem("live.enabled",n===3)}),T(S,null,w[1],b[1])}function k(){$(u).on("statusChange",function(t,n){f.get(s.FILE_LIVE_FILE_PREVIEW).setChecked(n===u.STATUS_ACTIVE),f.get(s.FILE_LIVE_HIGHLIGHT).setEnabled(n===u.STATUS_ACTIVE)})}function L(){f.get(s.FILE_LIVE_HIGHLIGHT).setChecked(g.highlight)}function A(){g.highlight=!g.highlight,L(),g.highlight?u.showHighlight():u.hideHighlight(),v.setValue("highlight",g.highlight)}function O(){window.ld=u,window.i=a,window.report=function(t){window.params=t,console.info(t)}}var i=t("document/DocumentManager"),s=t("command/Commands"),o=t("utils/AppInit"),u=t("LiveDevelopment/LiveDevelopment"),a=t("LiveDevelopment/Inspector/Inspector"),f=t("command/CommandManager"),l=t("preferences/PreferencesManager"),c=t("widgets/Dialogs"),h=t("utils/UrlParams").UrlParams,p=t("strings"),d="com.adobe.brackets.live-development",v,m=new h,g={experimental:!0,debug:!0,autoconnect:!1,highlight:!0,highlightConfig:{borderColor:{r:255,g:229,b:153,a:.66},contentColor:{r:111,g:168,b:220,a:.55},marginColor:{r:246,g:178,b:107,a:.66},paddingColor:{r:147,g:196,b:125,a:.66},showInfo:!0}},y="✓",b=[p.LIVE_DEV_STATUS_TIP_NOT_CONNECTED,p.LIVE_DEV_STATUS_TIP_NOT_CONNECTED,p.LIVE_DEV_STATUS_TIP_PROGRESS1,p.LIVE_DEV_STATUS_TIP_PROGRESS2,p.LIVE_DEV_STATUS_TIP_CONNECTED,p.LIVE_DEV_STATUS_TIP_OUT_OF_SYNC],w=["warning","","info","info","success","out-of-sync"],E=w.join(" "),S,x;o.appReady(function(){m.parse(),a.init(g),u.init(g),t("utils/ExtensionUtils").loadStyleSheet(r,"main.less"),C(),k(),L(),g.debug&&O(),g.autoconnect&&window.sessionStorage.getItem("live.enabled")==="true"&&i.getCurrentDocument()&&N(),$(window).focus(function(){a.connected()&&g.highlight&&u.redrawHighlight()})}),v=l.getPreferenceStorage(d,{highlight:!0}),g.highlight=v.getValue("highlight"),f.register(p.CMD_LIVE_FILE_PREVIEW,s.FILE_LIVE_FILE_PREVIEW,N),f.register(p.CMD_LIVE_HIGHLIGHT,s.FILE_LIVE_HIGHLIGHT,A),f.get(s.FILE_LIVE_HIGHLIGHT).setEnabled(!1)}),define("editor/EditorCommandHandlers",["require","exports","module","command/Commands","strings","command/CommandManager","editor/EditorManager","utils/StringUtils","utils/TokenUtils"],function(e,t,n){function c(e,t,n){var r=!1,i,s;for(i=t;i<=n;i++){s=e.document.getLine(i);if(!s.match(/^\s*\/\//)&&s.match(/\S/)){r=!0;break}}return r}function h(e){var t=e.document,n=e.getSelection(),r=n.start.line,i=n.end.line,s=r!==i||n.start.ch!==n.end.ch;n.end.ch===0&&s&&i--;var o=c(e,r,i),u,a,f=!1;t.batchOperation(function(){if(o){for(u=r;u<=i;u++)t.replaceRange("//",{line:u,ch:0});n.start.ch===0&&s&&(f=!0)}else for(u=r;u<=i;u++){a=t.getLine(u);var e=a.indexOf("//");e!==-1&&t.replaceRange("",{line:u,ch:e},{line:u,ch:e+2})}}),f&&e.setSelection({line:r,ch:0},e.getSelection().end)}function p(e,t){var n=!0;while(n&&!e.token.string.match(t))n=a.moveSkippingWhitespace(a.movePrevToken,e);return n?{line:e.pos.line,ch:e.token.start}:null}function d(e,t,n){var r=!0;while(r&&!e.token.string.match(t))r=a.moveSkippingWhitespace(a.moveNextToken,e);return r?{line:e.pos.line,ch:e.token.end-n}:null}function v(e,t,n){var r=e.editor.indexFromPos(t),i=e.editor.indexFromPos(e.pos)<=r,s=!0;while(s&&i&&!e.token.string.match(n))s=a.moveSkippingWhitespace(a.moveNextToken,e),i=e.editor.indexFromPos(e.pos)<=r;return s&&i&&!!e.token.string.match(n)}function m(e,t,n,r){var i=e.document,s=e.getSelection(),o=a.getInitialContext(e._codeMirror,{line:s.start.line,ch:s.start.ch}),f=a.getInitialContext(e._codeMirror,{line:s.start.line,ch:s.start.ch}),l=a.getInitialContext(e._codeMirror,{line:s.end.line,ch:s.end.ch}),m=new RegExp("^"+u.regexEscape(t),"g"),g=new RegExp(u.regexEscape(n)+"$","g"),y=new RegExp("^//"),b=null,w=null,E=!1,S=!1,x=!1,T,N,C,k;!o.token.className&&o.token.string.trim().length===0&&(N=a.moveSkippingWhitespace(a.moveNextToken,o));if(r&&(o.token.string.match(y)||l.token.string.match(y))){var L=e.indexFromPos({line:o.pos.line,ch:o.token.start}),A=e.indexFromPos({line:l.pos.line,ch:l.token.start+l.token.string.length});N=!0;while(N&&o.token.string.match(y))N=a.moveSkippingWhitespace(a.movePrevToken,o);if(!N||o.token.className!=="comment"||o.token.string.match(g)){var O=s.start.line!==s.end.line||s.start.ch!==s.end.ch,M=s.end.line;s.end.ch===0&&O&&M--,c(e,s.start.line,M)?E=!0:x=!0}else b=p(f,m),w=d(f,g,n.length)}else f.token.className===null&&l.token.className===null&&!e.posWithinRange(o.pos,f.pos,l.pos)?(N=a.moveSkippingWhitespace(a.moveNextToken,f),f.token.className==="comment"?(b=p(f,m),w=d(f,g,n.length),b!==null&&n!==null&&!e.posWithinRange(s.start,b,w)&&(E=!0)):E=!0):o.token.className==="comment"?(b=p(o,m),w=d(o,g,n.length)):(N=v(o,s.end,m),N?(o.token.string.match(m)?b={line:o.pos.line,ch:o.token.start}:b=p(o,m),w=d(o,g,n.length)):E=!0);if(!E&&!S&&!x&&w){var _={line:w.line,ch:w.ch+n.length+1};e.posWithinRange(_,s.start,s.end)&&(N=a.moveSkippingWhitespace(a.moveNextToken,o)&&v(o,s.end,m),N&&(S=!0))}if(S)return;x?h(e):(i.batchOperation(function(){if(E){var e=s.start.ch===0&&s.end.ch===0&&s.start.line<s.end.line;e?(i.replaceRange(n+"\n",s.end),i.replaceRange(t+"\n",s.start)):(i.replaceRange(n,s.end),i.replaceRange(t,s.start));if(e)T={start:{line:s.start.line+1,ch:0},end:{line:s.end.line+1,ch:0}};else{var r={line:s.start.line,ch:s.start.ch+t.length};s.start.line===s.end.line?T={start:r,end:{line:s.end.line,ch:s.end.ch+t.length}}:T={start:r,end:{line:s.end.line,ch:s.end.ch}}}}else{var o=!1,u=!1;k=i.getLine(b.line).trim(),o=b.ch===0&&t.length===k.length,w&&(k=i.getLine(w.line).trim(),u=w.ch===0&&n.length===k.length),w&&(o&&u?i.replaceRange("",w,{line:w.line+1,ch:0}):i.replaceRange("",w,{line:w.line,ch:w.ch+n.length})),o&&u?i.replaceRange("",b,{line:b.line+1,ch:0}):i.replaceRange("",b,{line:b.line,ch:b.ch+t.length})}}),T&&e.setSelection(T.start,T.end))}function g(e,t,n){var r=e.getSelection(),i=r.start,s=r.end,o=new RegExp("^"+u.regexEscape(t),"g"),f=r.start.ch===0&&r.end.ch===0&&r.start.line!==r.end.line,l=r.start.line!==r.end.line,c=e.document.getLine(r.start.line).length;f||(l?(i={line:r.start.line,ch:0},s={line:r.end.line+1,ch:0}):(i={line:r.start.line,ch:0},s={line:r.end.line,ch:c}));var h=a.getInitialContext(e._codeMirror,{line:i.line,ch:i.ch}),p=a.moveSkippingWhitespace(a.moveNextToken,h),d=h.token.className;p=p&&v(h,s,o),d==="comment"||p||f?m(e,t,n,!1):(e.setSelection(i,s),m(e,t,n,!1),l?(r.start.line++,r.end.line++):(r.start.ch+=t.length,r.end.ch+=t.length),e.setSelection(r.start,r.end))}function y(e){e=e||o.getFocusedEditor();if(!e)return;var t=e.getModeForSelection();t==="javascript"||t==="less"?m(e,"/*","*/",!0):t==="css"?m(e,"/*","*/",!1):t==="html"&&m(e,"<!--","-->",!1)}function b(e){e=e||o.getFocusedEditor();if(!e)return;var t=e.getModeForSelection();t==="javascript"||t==="less"?h(e):t==="css"?g(e,"/*","*/"):t==="html"&&g(e,"<!--","-->")}function w(e){e=e||o.getFocusedEditor();if(!e)return;var t=e.getSelection(),n=t.start.line!==t.end.line||t.start.ch!==t.end.ch,r="";n||(t.start.ch=0,t.end={line:t.start.line+1,ch:0},t.end.line===e.lineCount()&&(r="\n"));var i=e.document,s=i.getRange(t.start,t.end)+r;i.replaceRange(s,t.start)}function E(e){e=e||o.getFocusedEditor();if(!e)return;var t,n,r=e.getSelection(),i=e.document;t={line:r.start.line,ch:0},n={line:r.end.line+1,ch:0},n.line===e.getLastVisibleLine()+1&&(t.line>e.getFirstVisibleLine()&&(t.line-=1,t.ch=i.getLine(t.line).length),n.line-=1,n.ch=i.getLine(n.line).length),i.replaceRange("",t,n)}function S(e,t){e=e||o.getFocusedEditor();if(!e)return;var n=e.document,r=e.getSelection(),i=e.getSelection(),s=r.start.line!==r.end.line||r.start.ch!==r.end.ch;r.start.ch=0;if(!s||r.end.ch!==0)r.end={line:r.end.line+1,ch:0};switch(t){case f:r.start.line!==0&&(n.batchOperation(function(){var t=n.getRange({line:r.start.line-1,ch:0},r.start);r.end.line===e.lineCount()&&(t="\n"+t.substring(0,t.length-1)),n.replaceRange("",{line:r.start.line-1,ch:0},r.start),n.replaceRange(t,{line:r.end.line-1,ch:0}),i.start.line--,i.end.line--}),e.setSelection(i.start,i.end));break;case l:r.end.line<e.lineCount()&&n.batchOperation(function(){var t=n.getRange(r.end,{line:r.end.line+1,ch:0}),i=r.end;r.end.line===e.lineCount()-1&&(t+="\n",i={line:r.end.line-1,ch:n.getLine(r.end.line-1).length}),n.replaceRange("",i,{line:r.end.line+1,ch:0}),n.replaceRange(t,{line:r.start.line,ch:0})})}}function x(e){S(e,f)}function T(e){S(e,l)}function N(){var e=o.getFocusedEditor();if(!e)return;e._codeMirror.execCommand("indentMore")}function C(){var e=o.getFocusedEditor();if(!e)return;e._codeMirror.execCommand("indentLess")}function k(e){e=e||o.getFocusedEditor();if(e){var t=e.getSelection(),n={line:t.start.line,ch:0},r={line:t.end.line+1,ch:0};r.line===e.getLastVisibleLine()+1&&(r.line-=1,r.ch=e.document.getLine(r.line).length),e.setSelection(n,r)}}function L(e){var t=o.getFocusedEditor(),n=new $.Deferred;return t?(t[e](),n.resolve()):n.reject(),n.promise()}function A(){return L("undo")}function O(){return L("redo")}function M(){return(new $.Deferred).reject().promise()}var r=e("command/Commands"),i=e("strings"),s=e("command/CommandManager"),o=e("editor/EditorManager"),u=e("utils/StringUtils"),a=e("utils/TokenUtils"),f=-1,l=1;s.register(i.CMD_INDENT,r.EDIT_INDENT,N),s.register(i.CMD_UNINDENT,r.EDIT_UNINDENT,C),s.register(i.CMD_COMMENT,r.EDIT_LINE_COMMENT,b),s.register(i.CMD_BLOCK_COMMENT,r.EDIT_BLOCK_COMMENT,y),s.register(i.CMD_DUPLICATE,r.EDIT_DUPLICATE,w),s.register(i.CMD_DELETE_LINES,r.EDIT_DELETE_LINES,E),s.register(i.CMD_LINE_UP,r.EDIT_LINE_UP,x),s.register(i.CMD_LINE_DOWN,r.EDIT_LINE_DOWN,T),s.register(i.CMD_SELECT_LINE,r.EDIT_SELECT_LINE,k),s.register(i.CMD_UNDO,r.EDIT_UNDO,A),s.register(i.CMD_REDO,r.EDIT_REDO,O),s.register(i.CMD_CUT,r.EDIT_CUT,M),s.register(i.CMD_COPY,r.EDIT_COPY,M),s.register(i.CMD_PASTE,r.EDIT_PASTE,M)}),define("view/ViewCommandHandlers",["require","exports","module","command/Commands","command/CommandManager","strings","project/ProjectManager","editor/EditorManager"],function(e,t,n){function f(e){$("#"+a).remove(),e&&u.getCurrentFullEditor().refreshAll()}function l(e){var t="codemirror-dynamic-fonts",n=$(".CodeMirror").css("font-size"),r=$(".CodeMirror").css("line-height"),i=/^[\d\.]+(px|em)$/;if(n.search(i)===-1||r.search(i)===-1)return;var s=n.substring(n.length-2,n.length),o=r.substring(r.length-2,r.length),l=parseFloat(n.substring(0,n.length-2)),c=parseFloat(r.substring(0,r.length-2)),h=s==="px"?1:.1,p=o==="px"?1:.1;e===-1&&(h*=-1,p*=-1);var d=l+h,v=c+p,m=d+s,g=v+o;if(e===-1&&(s==="px"&&d<=1||s==="em"&&d<=.1))return;f(!1);var y=$("<style type='text/css'></style>").attr("id",a);y.html(".CodeMirror {font-size: "+m+" !important;"+"line-height: "+g+" !important;}"),$("head").append(y);var b=u.getCurrentFullEditor();b.refreshAll();if(s==="px"){var w=b.getScrollPos(),E=Math.round(w.x/c),S=Math.round(w.y/c);b.setScrollPos(w.x+E*e,w.y+S*e)}}function c(){l(1)}function h(){l(-1)}function p(){f(!0)}var r=e("command/Commands"),i=e("command/CommandManager"),s=e("strings"),o=e("project/ProjectManager"),u=e("editor/EditorManager"),a="codemirror-dynamic-fonts";i.register(s.CMD_INCREASE_FONT_SIZE,r.VIEW_INCREASE_FONT_SIZE,c),i.register(s.CMD_DECREASE_FONT_SIZE,r.VIEW_DECREASE_FONT_SIZE,h),i.register(s.CMD_RESTORE_FONT_SIZE,r.VIEW_RESTORE_FONT_SIZE,p)}),define("debug/DebugCommandHandlers",["require","exports","module","command/Commands","command/CommandManager","editor/Editor","file/FileUtils","strings","utils/PerfUtils","utils/NativeApp","file/NativeFileSystem"],function(e,t,n){function c(e){brackets.app.showDeveloperTools()}function p(e){var t=e?"?spec="+e:"";if(h)try{h.location.search!==t?h.location.href="../test/SpecRunner.html"+t:h.location.reload(!0)}catch(n){h=null}h||(h=window.open("../test/SpecRunner.html"+t,"brackets-test","width="+$(window).width()+",height="+$(window).height()),h.location.reload(!0))}function d(){var e=$("<div class='modal-header' />").append("<a href='#' class='close'>&times;</a>").append("<h1 class='dialog-title'>Performance Data</h1>").append("<div align=right>Raw data (copy paste out): <textarea rows=1 style='width:30px; height:8px; overflow: hidden; resize: none' id='brackets-perf-raw-data'>"+a.getDelimitedPerfData()+"</textarea></div>"),t=$("<div class='modal-body' style='padding: 0; max-height: 500px; overflow: auto;' />"),n=$("<table class='zebra-striped condensed-table'>").append("<thead><th>Operation</th><th>Time (ms)</th></thead>").append("<tbody />").appendTo(t),r=function(e){return $("<td/>").text(e)},i=function(e){if(Array.isArray(e)){var t,n,r,i=0,s=Number.MAX_VALUE,o=0;for(t=0;t<e.length;t++)n=e[t],s=Math.min(s,n),i+=n,o=Math.max(o,n);return r=Math.round(i/e.length),String(s)+"/"+String(r)+"/"+String(o)+"/"+String(n)}return e},s,o=a.getData();for(s in o)o.hasOwnProperty(s)&&$("<tr/>").append(r(s)).append(r(i(o[s]))).appendTo(n);$("<div class='modal hide' />").append(e).append(t).appendTo(window.document.body).modal({backdrop:"static",show:!0}),$("#brackets-perf-raw-data").click(function(){$(this).focus().select()})}function v(){window.open(window.location.href)}function m(){var e=o.getNativeBracketsDirectoryPath()+"/nls";l.requestNativeFileSystem(e,function(e){e.root.createReader().readEntries(function(e){function o(e){t&&t.css("font-weight","normal"),t=$(e.currentTarget),s=t.data("locale"),t.css("font-weight","bold"),n.attr("disabled",!1)}var t,n,s,a=$("<div class='modal hide' />"),f=$("<div class='modal-header' />").append("<a href='#' class='close'>&times;</a>").append("<h1 class='dialog-title'>"+u.LANGUAGE_TITLE+"</h1>").appendTo(a),l=$("<div class='modal-body' style='max-height: 500px; overflow: auto;' />").appendTo(a),c=$("<p class='dialog-message'>").text(u.LANGUAGE_MESSAGE).appendTo(l),h=$("<ul>").on("click","li",o).appendTo(c),p=$("<div class='modal-footer' />").appendTo(a),d=$("<button class='dialog-button btn left'>").on("click",function(){a.modal("hide")}).text(u.LANGUAGE_CANCEL).appendTo(p);n=$("<button class='dialog-button btn primary'>").text(u.LANGUAGE_SUBMIT).on("click",function(){if(!t)return;brackets.setLocale(s),i.execute(r.DEBUG_REFRESH_WINDOW)}).attr("disabled","disabled").appendTo(p),a.appendTo(window.document.body).modal({backdrop:"static",show:!0}).on("hidden",function(){$(this).remove()});var v=$("<li>").text("system default").data("locale",null).appendTo(h);v=$("<li>").text("en").data("locale","en").appendTo(h),e.forEach(function(e){if(e.isDirectory){var t=e.name.match(/^([a-z]{2})(-[a-z]{2})?$/);if(t){var n=e.name,r=t[1];t[2]&&(r+=t[2].toUpperCase());var i=$("<li>").text(r).data("locale",n).appendTo(h)}}})})})}function g(){if(brackets.inBrowser)return;var e=new l.FileEntry(o.getNativeBracketsDirectoryPath()+"/../test/SpecRunner.html");e.getMetadata(function(e){i.get(r.DEBUG_RUN_UNIT_TESTS).setEnabled(!0)},function(e){})}var r=e("command/Commands"),i=e("command/CommandManager"),s=e("editor/Editor").Editor,o=e("file/FileUtils"),u=e("strings"),a=e("utils/PerfUtils"),f=e("utils/NativeApp"),l=e("file/NativeFileSystem").NativeFileSystem,h=null;i.register(u.CMD_SHOW_DEV_TOOLS,r.DEBUG_SHOW_DEVELOPER_TOOLS,c).setEnabled(!!brackets.app.showDeveloperTools),i.register(u.CMD_NEW_BRACKETS_WINDOW,r.DEBUG_NEW_BRACKETS_WINDOW,v),i.register(u.CMD_RUN_UNIT_TESTS,r.DEBUG_RUN_UNIT_TESTS,p).setEnabled(!1),i.register(u.CMD_SHOW_PERF_DATA,r.DEBUG_SHOW_PERF_DATA,d),i.register(u.CMD_SWITCH_LANGUAGE,r.DEBUG_SWITCH_LANGUAGE,m),g(),t._runUnitTests=p}),define("utils/BuildInfoUtils",["require","exports","module","utils/Global","file/FileUtils","file/NativeFileSystem"],function(e,t,n){function u(e,t){var n=new $.Deferred;if(brackets.inBrowser)n.reject();else{var r=new s.FileEntry(e);i.readAsText(r).done(function(r){if(r.indexOf("ref: ")===0){var i=e.substr(0,e.lastIndexOf("/")),s=r.substr(5).trim(),o=r.substr(16).trim();u(i+"/"+s,t).done(function(e){n.resolve({branch:o,sha:e.sha.trim()})}).fail(function(){n.resolve({branch:o})})}else n.resolve({sha:r})}).fail(function(){n.reject()})}return n.promise()}function a(){var e=new $.Deferred,t=i.getNativeBracketsDirectoryPath(),n=t.substr(0,t.lastIndexOf("/"))+"/.git/HEAD";return u(n).done(function(t){e.resolve(t.branch,t.sha,!0)}).fail(function(){e.resolve(brackets.metadata.repository.branch,brackets.metadata.repository.SHA,!1)}),e.promise()}var r=e("utils/Global"),i=e("file/FileUtils"),s=e("file/NativeFileSystem").NativeFileSystem,o;t.getBracketsSHA=a}),define("text!htmlContent/about-dialog.html",[],function(){return'<div class="about-dialog modal">\n    <div class="modal-header">\n        <h1 class="dialog-title">{{ABOUT}}</h1>\n    </div>\n    <div class="modal-body">\n        <img class="about-icon" src="{{ABOUT_ICON}}">\n        <div class="about-text">\n            <h2>{{APP_NAME_ABOUT_BOX}}</h2>\n            <p class="dialog-message">{{ABOUT_TEXT_LINE1}} <span id="about-build-number">{{BUILD_INFO}}</span></p>\n            <p class="dialog-message"><!-- $NON-NLS$ -->Copyright 2012 - 2013 Adobe Systems Incorporated and its licensors. All rights reserved.</p>\n            <p class="dialog-message">{{{ABOUT_TEXT_LINE3}}}</p>\n            <p class="dialog-message">{{{ABOUT_TEXT_LINE4}}}</p>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <a href="#" class="dialog-button btn primary" data-button-id="ok">{{CLOSE}}</a>\n    </div>\n</div>\n'}),define("help/HelpCommandHandlers",["require","exports","module","utils/AppInit","utils/Global","utils/BuildInfoUtils","command/Commands","command/CommandManager","widgets/Dialogs","strings","utils/UpdateNotification","file/FileUtils","utils/NativeApp","utils/StringUtils","text!htmlContent/about-dialog.html"],function(e,t,n){function m(){l.checkForUpdate(!0)}function g(e){return function(){if(!e)return;h.openURLInDefaultBrowser(e)}}function y(){brackets.app.showExtensionsFolder(c.convertToNativePath(decodeURI(window.location.href)),function(e){})}function b(){var e=$.extend({ABOUT_ICON:brackets.config.about_icon,APP_NAME_ABOUT_BOX:brackets.config.app_name_about,BUILD_INFO:v||""},f);a.showModalDialogUsingTemplate(Mustache.render(d,e))}var r=e("utils/AppInit"),i=e("utils/Global"),s=e("utils/BuildInfoUtils"),o=e("command/Commands"),u=e("command/CommandManager"),a=e("widgets/Dialogs"),f=e("strings"),l=e("utils/UpdateNotification"),c=e("file/FileUtils"),h=e("utils/NativeApp"),p=e("utils/StringUtils"),d=e("text!htmlContent/about-dialog.html"),v;r.appReady(function(){s.getBracketsSHA().done(function(e,t,n){t=t?t.substr(0,9):"";if(e||t)v=p.format("({0} {1})",e,t).trim()})}),u.register(f.CMD_CHECK_FOR_UPDATE,o.HELP_CHECK_FOR_UPDATE,m),u.register(f.CMD_HOW_TO_USE_BRACKETS,o.HELP_HOW_TO_USE_BRACKETS,g(brackets.config.how_to_use_url)),u.register(f.CMD_FORUM,o.HELP_FORUM,g(brackets.config.forum_url)),u.register(f.CMD_RELEASE_NOTES,o.HELP_RELEASE_NOTES,g(brackets.config.release_notes_url)),u.register(f.CMD_REPORT_AN_ISSUE,o.HELP_REPORT_AN_ISSUE,g(brackets.config.report_issue_url)),u.register(f.CMD_SHOW_EXTENSIONS_FOLDER,o.HELP_SHOW_EXT_FOLDER,y),u.register(f.CMD_TWITTER,o.HELP_TWITTER,g(brackets.config.twitter_url)),u.register(f.CMD_ABOUT,o.HELP_ABOUT,b)}),define("search/FindInFiles",["require","exports","module","utils/Async","command/CommandManager","command/Commands","strings","utils/StringUtils","project/ProjectManager","document/DocumentManager","editor/EditorManager","project/FileIndexManager","utils/KeyEvent","utils/AppInit","widgets/StatusBar","widgets/ModalBar"],function(e,t,n){function E(e){$(".modal-bar .message").css("display","inline-block"),$(".modal-bar .error").css("display","none");var t=e.match(/^\/(.*)\/(g|i)*$/);if(t){var n=t[2]||"g";n.search("g")===-1&&(n+="g");try{return new RegExp(t[1],n)}catch(r){return $(".modal-bar .message").css("display","none"),$(".modal-bar .error").css("display","inline-block").html("<div class='alert-message' style='margin-bottom: 0'>"+r.message+"</div>"),null}}return e=u.regexEscape(e),new RegExp(e,"gi")}function S(e){var t=a.getProjectRoot().name;if(e){var n=u.htmlEscape(a.makeProjectRelativeIfPossible(e.fullPath));return u.format(o.FIND_IN_FILES_SCOPED,n)}return o.FIND_IN_FILES_NO_SCOPE}function x(){this.closed=!1,this.result=null}function T(e,t){if(e.search(t)===-1)return null;var n=e,r=0,i,s=[],o,a=u.getLines(e);while((o=t.exec(e))!==null){var f=u.offsetToLineNum(a,o.index),l=a[f],c=o.index-e.lastIndexOf("\n",o.index)-1,h=o[0].length;l=l.substr(0,Math.min(200,l.length)),s.push({start:{line:f,ch:c},end:{line:f,ch:c+h},line:l});if(s.length>=g){t.lastIndex=0,y=!0;break}}return s}function N(e,t,n){var r=$("#search-results");if(e&&e.length){var a=$("<table class='zebra-striped condensed-table' />").append("<tbody>"),f=0;e.forEach(function(e){f+=e.matches.length});var c="";y&&(c=o.FIND_IN_FILES_MORE_THAN),c+=String(f);var h=u.format(o.FIND_IN_FILES_TITLE,c,f>1?o.FIND_IN_FILES_MATCHES:o.FIND_IN_FILES_MATCH,e.length,e.length>1?o.FIND_IN_FILES_FILES:o.FIND_IN_FILES_FILE,u.htmlEscape(t),n?S(n):"");$("#search-result-summary").html(h+(f>g?u.format(o.FIND_IN_FILES_MAX,g):"")).prepend("&nbsp;");var p=0;e.forEach(function(e){if(e&&p<g){var t=function(e){return $("<td/>").html(e)},n=u.htmlEscape,r=function(e,t,r){return n(e.substr(0,t))+"<span class='highlight'>"+n(e.substring(t,r))+"</span>"+n(e.substr(r))},f=u.format(o.FIND_IN_FILES_FILE_PATH,u.breakableUrl(n(e.fullPath)));$("<tr class='file-section' />").append("<td colspan='3'><span class='disclosure-triangle expanded'></span>"+f+"</td>").click(function(){var e=$(this);e.nextUntil(".file-section").toggle();var t=$(".disclosure-triangle",e);t.toggleClass("expanded").toggleClass("collapsed")}).appendTo(a),e.matches.forEach(function(n){if(p<g){var f=$("<tr/>").append(t(" ")).append(t(u.format(o.FIND_IN_FILES_LINE,n.start.line+1))).append(t(r(n.line,n.start.ch,n.end.ch))).appendTo(a);f.click(function(){i.execute(s.FILE_OPEN,{fullPath:e.fullPath}).done(function(e){l.getCurrentFullEditor().setSelection(n.start,n.end,!0)})}),p++}})}}),$("#search-results .table-container").empty().append(a).scrollTop(0),$("#search-results .close").one("click",function(){r.hide(),l.resizeEditor()}),r.show()}else r.hide();l.resizeEditor()}function C(e,t){return t?t.isDirectory?e.fullPath.indexOf(t.fullPath)===0:e.fullPath===t.fullPath:!0}function k(e){var t=new x,n=l.getActiveEditor(),i=n&&n.getSelectedText();b="",w=e,m=[],y=!1,t.showDialog(i,e).done(function(t){if(t){b=t;var n=E(t);if(!n)return;d.showBusyIndicator(!0),c.getFileInfoList("all").done(function(i){r.doInParallel(i,function(t){var r=new $.Deferred;return C(t,e)?f.getDocumentForPath(t.fullPath).done(function(e){var i=T(e.getText(),n);i&&i.length&&m.push({fullPath:t.fullPath,matches:i}),r.resolve()}).fail(function(e){r.resolve()}):r.resolve(),r.promise()}).done(function(){N(m,t,e),d.hideBusyIndicator()}).fail(function(){console.log("find in files failed."),d.hideBusyIndicator()})})}})}function L(){var e=a.getSelectedItem();if(!e){var t=f.getCurrentDocument();e=t&&t.file}k(e)}function A(e,t,n){$("#search-results").is(":visible")&&(m.forEach(function(e){e.fullPath=e.fullPath.replace(t,n)}),N(m,b,w))}var r=e("utils/Async"),i=e("command/CommandManager"),s=e("command/Commands"),o=e("strings"),u=e("utils/StringUtils"),a=e("project/ProjectManager"),f=e("document/DocumentManager"),l=e("editor/EditorManager"),c=e("project/FileIndexManager"),h=e("utils/KeyEvent"),p=e("utils/AppInit"),d=e("widgets/StatusBar"),v=e("widgets/ModalBar").ModalBar,m=[],g=100,y=!1,b="",w;x.prototype._close=function(e){if(this.closed)return;this.closed=!0,this.modalBar.close(),l.focusEditor(),this.result.resolve(e)},x.prototype.showDialog=function(e,t){var n=o.CMD_FIND+": <input type='text' id='findInFilesInput' style='width: 10em'> <span id='findInFilesScope'></span> &nbsp;"+"<div class='message'><span style='color: #888'>("+o.SEARCH_REGEXP_INFO+")</span></div><div class='error'></div>";this.result=new $.Deferred,this.modalBar=new v(n,!1);var r=$("input#findInFilesInput"),i=this;return r.attr("value",e||""),r.get(0).select(),$("#findInFilesScope").html(S(t)),r.bind("keydown",function(e){if(e.keyCode===h.DOM_VK_RETURN||e.keyCode===h.DOM_VK_ESCAPE){e.stopPropagation(),e.preventDefault();var t=r.val();e.keyCode===h.DOM_VK_ESCAPE&&(t=null),i._close(t)}}).bind("input",function(e){E(r.val())}).blur(function(){i._close(null)}).focus(),this.result.promise()},p.htmlReady(function(){var e=$("#search-results"),t=$("#search-results .table-container")}),$(f).on("fileNameChange",A),i.register(o.CMD_FIND_IN_FILES,s.EDIT_FIND_IN_FILES,k),i.register(o.CMD_FIND_IN_SUBTREE,s.EDIT_FIND_IN_SUBTREE,L)}),define("search/FindReplace",["require","exports","module","command/CommandManager","command/Commands","strings","editor/Editor","editor/EditorManager","widgets/ModalBar"],function(e,t,n){function c(){this.posFrom=this.posTo=this.query=null,this.marked=[]}function h(e){return e._searchState||(e._searchState=new c),e._searchState}function p(e,t,n){return e.getSearchCursor(t,n,typeof t=="string"&&t===t.toLowerCase())}function d(){return $("input[type='text']",f.getRoot())}function v(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);$(".modal-bar .message").css("display","inline-block"),$(".modal-bar .error").css("display","none");try{return t&&t[1]?new RegExp(t[1],t[2].indexOf("i")===-1?"":"i"):e}catch(n){return $(".modal-bar .message").css("display","none"),$(".modal-bar .error").css("display","inline-block").html("<div class='alert-message' style='margin-bottom: 0'>"+n.message+"</div>"),""}}function m(e,t){var n=e._codeMirror,r=!0;return n.operation(function(){var i=h(n),s=p(n,i.query,t?i.posFrom:i.posTo);if(!s.find(t)){s=p(n,i.query,t?{line:n.lineCount()-1}:{line:0,ch:0});if(!s.find(t)){n.setCursor(n.getCursor()),r=!1;return}}var u=l?o.BOUNDARY_IGNORE_TOP:o.BOUNDARY_CHECK_NORMAL;e.setSelection(s.from(),s.to(),!0,u),i.posFrom=s.from(),i.posTo=s.to(),i.findNextCalled=!0}),r}function g(e){e.marked.forEach(function(e){e.clear()}),e.marked.length=0}function y(e){e.operation(function(){var t=h(e);if(!t.query)return;t.query=null,g(t)})}function b(e,t){f&&f.close(),f=new a(e,t),$(f).on("closeOk closeBlur closeCancel",function(){f=null})}function E(e,t,n){function o(n){l=!0,r.operation(function(){i.query&&g(h(r)),i.query=v(n);if(!i.query){r.setCursor(s);return}if(r.getValue().length<5e5){$(r.getWrapperElement()).addClass("find-highlighting");var o=p(r,i.query);while(o.findNext()){i.marked.push(r.markText(o.from(),o.to(),{className:"CodeMirror-searching"}));if(o.pos.match&&o.pos.match[0]===""){if(o.to().line+1===r.lineCount())break;o=p(r,i.query,{line:o.to().line+1,ch:0})}}}i.posFrom=i.posTo=s;var u=m(e,t);f&&d().toggleClass("no-results",!u)}),l=!1}var r=e._codeMirror,i=h(r);if(i.query){m(e,t);return}var s=r.getCursor(!0);f&&(n=d().attr("value")),b(w,!0),$(f).on("closeOk",function(e,t){i.findNextCalled||(s=r.getCursor(!1),o(t))}),$(f).on("closeOk closeCancel closeBlur",function(e,t){g(i),$(r.getWrapperElement()).removeClass("find-highlighting")});var u=d();u.on("input",function(){o(u.attr("value"))}),n!==undefined&&(u.attr("value",n).get(0).select(),o(n),i.findNextCalled=!1)}function C(e,t){var n=e._codeMirror;b(S,!0),$(f).on("closeOk",function(r,i){if(!i)return;i=v(i),b(x,!0),$(f).on("closeOk",function(r,s){s=s||"";var u,a=function(e,t){return u[t]};if(t)n.compoundChange(function(){n.operation(function(){var e=p(n,i);while(e.findNext())typeof i!="string"?(u=n.getRange(e.from(),e.to()).match(i),e.replace(s.replace(/\$(\d)/,a))):e.replace(s)})});else{y(n);var l=p(n,i,n.getCursor(!0)),c=function(){var t=l.from(),r=l.findNext();if(!r){l=p(n,i),r=l.findNext();if(!r||t&&l.from().line===t.line&&l.from().ch===t.ch)return}e.setSelection(l.from(),l.to(),!0,o.BOUNDARY_CHECK_NORMAL),b(N,!0),f.getRoot().on("click",function(e){f.close(),e.target.id==="replace-yes"?h(r):e.target.id==="replace-no"&&c()})},h=function(e){l.replace(typeof i=="string"?s:s.replace(/\$(\d)/,a)),c()};c()}})}),d().attr("value",n.getSelection()).get(0).select()}function k(){var e=u.getActiveEditor();if(e){var t=e._codeMirror;y(t),E(e,!1,t.getSelection())}}function L(){var e=u.getActiveEditor();e&&E(e)}function A(){var e=u.getActiveEditor();e&&E(e,!0)}function O(){var e=u.getActiveEditor();e&&C(e)}var r=e("command/CommandManager"),i=e("command/Commands"),s=e("strings"),o=e("editor/Editor"),u=e("editor/EditorManager"),a=e("widgets/ModalBar").ModalBar,f,l=!1,w=s.CMD_FIND+': <input type="text" style="width: 10em"/> <div class="message"><span style="color: #888">('+s.SEARCH_REGEXP_INFO+')</span></div><div class="error"></div>',S=s.CMD_REPLACE+': <input type="text" style="width: 10em"/> <div class="message"><span style="color: #888">('+s.SEARCH_REGEXP_INFO+')</span></div><div class="error"></div>',x=s.WITH+': <input type="text" style="width: 10em"/>',T=' style="padding:5px 15px;border:1px #999 solid;border-radius:3px;margin:2px 2px 5px;"',N=s.CMD_REPLACE+'? <button id="replace-yes"'+T+">"+s.BUTTON_YES+'</button> <button id="replace-no"'+T+">"+s.BUTTON_NO+"</button> <button"+T+">"+s.BUTTON_STOP+"</button>";r.register(s.CMD_FIND,i.EDIT_FIND,k),r.register(s.CMD_FIND_NEXT,i.EDIT_FIND_NEXT,L),r.register(s.CMD_REPLACE,i.EDIT_REPLACE,O),r.register(s.CMD_FIND_PREVIOUS,i.EDIT_FIND_PREVIOUS,A)}),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P={}.hasOwnProperty;t=function(){function e(e,t,n){var r;this.method=t,this.url=n,this.status=e.status,e.responseType?r=e.response||e.responseText:r=e.responseText;if(r)try{this.responseText=r.toString(),this.response=JSON.parse(r)}catch(i){this.response=null}else this.responseText="(no response)",this.response=null}return e.prototype.toString=function(){return"Dropbox API error "+this.status+" from "+this.method+" "+this.url+" :: "+this.responseText},e.prototype.inspect=function(){return this.toString()},e}(),typeof window!="undefined"&&window!==null?window.atob&&window.btoa?(w=function(e){return window.atob(e)},N=function(e){return window.btoa(e)}):(S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",C=function(e,t,n){var r,i;i=3-t,e<<=i*8,r=3;while(r>=i)n.push(S.charAt(e>>r*6&63)),r-=1;r=t;while(r<3)n.push("="),r+=1;return null},E=function(e,t,n){var r,i;i=4-t,e<<=i*6,r=2;while(r>=i)n.push(String.fromCharCode(e>>8*r&255)),r-=1;return null},N=function(e){var t,n,r,i,s,o;i=[],t=0,n=0;for(r=s=0,o=e.length;0<=o?s<o:s>o;r=0<=o?++s:--s)t=t<<8|e.charCodeAt(r),n+=1,n===3&&(C(t,n,i),t=n=0);return n>0&&C(t,n,i),i.join("")},w=function(e){var t,n,r,i,s,o,u;s=[],t=0,r=0;for(i=o=0,u=e.length;0<=u?o<u:o>u;i=0<=u?++o:--o){n=e.charAt(i);if(n==="=")break;t=t<<6|S.indexOf(n),r+=1,r===4&&(E(t,r,s),t=r=0)}return r>0&&E(t,r,s),s.join("")}):(w=function(e){var t,n;return t=new Buffer(e,"base64"),function(){var e,r,i;i=[];for(n=e=0,r=t.length;0<=r?e<r:e>r;n=0<=r?++e:--e)i.push(String.fromCharCode(t[n]));return i}().join("")},N=function(e){var t,n;return t=new Buffer(function(){var t,r,i;i=[];for(n=t=0,r=e.length;0<=r?t<r:t>r;n=0<=r?++t:--t)i.push(e.charCodeAt(n));return i}()),t.toString("base64")}),r=function(){function t(e){this.sandbox=e.sandbox||!1,this.apiServer=e.server||this.defaultApiServer(),this.authServer=e.authServer||this.defaultAuthServer(),this.fileServer=e.fileServer||this.defaultFileServer(),this.oauth=new o(e),this.uid=null,this.authState=null,this.authError=null,this._credentials=null,this.setCredentials(e),this.setupUrls()}return t.prototype.authDriver=function(e){return this.authDriver=e,this},t.prototype.dropboxUid=function(){return this.uid},t.prototype.credentials=function(e){return this._credentials||this.computeCredentials(),this._credentials},t.prototype.authenticate=function(n){var r,i,s=this;return r=null,i=function(){var o;if(r!==s.authState){r=s.authState;if(s.authDriver.onAuthStateChange)return s.authDriver.onAuthStateChange(s,i)}switch(s.authState){case t.RESET:return s.requestToken(function(e,n){var r,o;return e?(s.authError=e,s.authState=t.ERROR):(r=n.oauth_token,o=n.oauth_token_secret,s.oauth.setToken(r,o),s.authState=t.REQUEST),s._credentials=null,i()});case t.REQUEST:return o=s.authorizeUrl(s.oauth.token),s.authDriver.doAuthorize(o,s.oauth.token,s.oauth.tokenSecret,function(){return s.authState=t.AUTHORIZED,s._credentials=null,i()});case t.AUTHORIZED:return s.getAccessToken(function(e,n){return e?(s.authError=e,s.authState=t.ERROR):(s.oauth.setToken(n.oauth_token,n.oauth_token_secret),s.uid=n.uid,s.authState=t.DONE),s._credentials=null,i()});case t.DONE:return n(null,s);case e.SIGNED_OFF:return s.reset(),i();case t.ERROR:return n(s.authError)}},i(),this},t.prototype.signOut=function(e){var n,r,i=this;return r=this.urls.signOut,n=this.oauth.addAuthParams("POST",r,{}),d.request("POST",r,n,null,function(n){return n?e(n):(i.reset(),i.authState=t.SIGNED_OFF,i.authDriver.onAuthStateChange?i.authDriver.onAuthStateChange(i,function(){return e(n)}):e(n))})},t.prototype.signOff=function(e){return this.signOut(e)},t.prototype.getUserInfo=function(e){var t,n;return n=this.urls.accountInfo,t=this.oauth.addAuthParams("GET",n,{}),d.request("GET",n,t,null,function(t,n){return e(t,p.parse(n),n)})},t.prototype.readFile=function(e,t,n){var r,i,s;return!n&&typeof t=="function"&&(n=t,t=null),s=""+this.urls.getFile+"/"+this.urlEncodePath(e),r={},i=null,t&&(t.versionTag?r.rev=t.versionTag:t.rev&&(r.rev=t.rev),t.blob&&(i="blob"),t.binary&&(i="b")),this.oauth.addAuthParams("GET",s,r),d.request2("GET",s,r,null,null,i,function(e,t,r){return n(e,t,h.parse(r))})},t.prototype.writeFile=function(e,t,n,r){var i;return!r&&typeof n=="function"&&(r=n,n=null),i=d.canSendForms&&typeof t=="object",i?this.writeFileUsingForm(e,t,n,r):this.writeFileUsingPut(e,t,n,r)},t.prototype.writeFileUsingForm=function(e,t,n,r){var i,s,o,u,a;u=e.lastIndexOf("/"),u===-1?(s=e,e=""):(s=e.substring(u),e=e.substring(0,u)),a=""+this.urls.postFile+"/"+this.urlEncodePath(e),o={file:s};if(n){n.noOverwrite&&(o.overwrite="false");if(n.lastVersionTag)o.parent_rev=n.lastVersionTag;else if(n.parentRev||n.parent_rev)o.parent_rev=n.parentRev||n.parent_rev}return this.oauth.addAuthParams("POST",a,o),delete o.file,i={name:"file",value:t,fileName:s,contentType:"application/octet-stream"},d.multipartRequest(a,i,o,null,function(e,t){return r(e,h.parse(t))})},t.prototype.writeFileUsingPut=function(e,t,n,r){var i,s;s=""+this.urls.putFile+"/"+this.urlEncodePath(e),i={};if(n){n.noOverwrite&&(i.overwrite="false");if(n.lastVersionTag)i.parent_rev=n.lastVersionTag;else if(n.parentRev||n.parent_rev)i.parent_rev=n.parentRev||n.parent_rev}return this.oauth.addAuthParams("POST",s,i),d.request2("POST",s,i,null,t,null,function(e,t){return r(e,h.parse(t))})},t.prototype.stat=function(e,t,n){var r,i;!n&&typeof t=="function"&&(n=t,t=null),i=""+this.urls.metadata+"/"+this.urlEncodePath(e),r={};if(t){t.version!=null&&(r.rev=t.version);if(t.removed||t.deleted)r.include_deleted="true";t.readDir&&(r.list="true",t.readDir!==!0&&(r.file_limit=t.readDir.toString())),t.cacheHash&&(r.hash=t.cacheHash)}return r.include_deleted||(r.include_deleted="false"),r.list||(r.list="false"),this.oauth.addAuthParams("GET",i,r),d.request("GET",i,r,null,function(e,t){var r,i,s;return s=h.parse(t),(t!=null?t.contents:void 0)?r=function(){var e,n,r,s;r=t.contents,s=[];for(e=0,n=r.length;e<n;e++)i=r[e],s.push(h.parse(i));return s}():r=void 0,n(e,s,r)})},t.prototype.readdir=function(e,t,n){var r;return!n&&typeof t=="function"&&(n=t,t=null),r={readDir:!0},t&&(t.limit!=null&&(r.readDir=t.limit),t.versionTag&&(r.versionTag=t.versionTag)),this.stat(e,r,function(e,t,r){var i,s;return r?i=function(){var e,t,n;n=[];for(e=0,t=r.length;e<t;e++)s=r[e],n.push(s.name);return n}():i=null,n(e,i,t,r)})},t.prototype.metadata=function(e,t,n){return this.stat(e,t,n)},t.prototype.makeUrl=function(e,t,n){var r,i,s;return!n&&typeof t=="function"&&(n=t,t=null),e=this.urlEncodePath(e),t&&t.download?(r=!0,s=""+this.urls.media+"/"+e):(r=!1,s=""+this.urls.shares+"/"+e),t&&t.long?i={short_url:"false"}:i={},this.oauth.addAuthParams("POST",s,i),d.request("POST",s,i,null,function(e,t){return n(e,a.parse(t,r))})},t.prototype.history=function(e,t,n){var r,i;return!n&&typeof t=="function"&&(n=t,t=null),i=""+this.urls.revisions+"/"+this.urlEncodePath(e),r={},t&&t.limit!=null&&(r.rev_limit=t.limit),this.oauth.addAuthParams("GET",i,r),d.request("GET",i,r,null,function(e,t){var r,i;return t?i=function(){var e,n,i;i=[];for(e=0,n=t.length;e<n;e++)r=t[e],i.push(h.parse(r));return i}():i=void 0,n(e,i)})},t.prototype.revisions=function(e,t,n){return this.history(e,t,n)},t.prototype.thumbnailUrl=function(t,n){var r,i;return i=""+this.urls.thumbnails+"/"+this.urlEncodePath(t),r={},n&&(n.format?r.format=n.format:n.png&&(r.format="png"),n.size&&(r.size=n.size)),this.oauth.addAuthParams("GET",i,r),""+i+"?"+e.Xhr.urlEncode(r)},t.prototype.readThumbnail=function(e,t,n){var r,i;return!n&&typeof t=="function"&&(n=t,t=null),i=this.thumbnailUrl(e,t),r="b",t&&t.blob&&(r="blob"),d.request2("GET",i,{},null,null,r,function(e,t,r){return n(e,t,h.parse(r))})},t.prototype.revertFile=function(e,t,n){var r,i;return i=""+this.urls.restore+"/"+this.urlEncodePath(e),r={rev:t},this.oauth.addAuthParams("POST",i,r),d.request("POST",i,r,null,function(e,t){return n(e,h.parse(t))})},t.prototype.restore=function(e,t,n){return this.revertFile(e,t,n)},t.prototype.findByName=function(e,t,n,r){var i,s;!r&&typeof n=="function"&&(r=n,n=null),s=""+this.urls.search+"/"+this.urlEncodePath(e),i={query:t};if(n){n.limit!=null&&(i.file_limit=n.limit);if(n.removed||n.deleted)i.include_deleted=!0}return this.oauth.addAuthParams("GET",s,i),d.request("GET",s,i,null,function(e,t){var n,i;return t?i=function(){var e,r,i;i=[];for(e=0,r=t.length;e<r;e++)n=t[e],i.push(h.parse(n));return i}():i=void 0,r(e,i)})},t.prototype.search=function(e,t,n,r){return this.findByName(e,t,n,r)},t.prototype.makeCopyReference=function(e,t){var n,r;return r=""+this.urls.copyRef+"/"+this.urlEncodePath(e),n=this.oauth.addAuthParams("GET",r,{}),d.request("GET",r,n,null,function(e,n){return t(e,i.parse(n))})},t.prototype.copyRef=function(e,t){return this.makeCopyReference(e,t)},t.prototype.pullChanges=function(t,n){var r,i;return!n&&typeof t=="function"&&(n=t,t=null),i=this.urls.delta,r={},t?t.cursorTag?r={cursor:t.cursorTag}:r={cursor:t}:r={},this.oauth.addAuthParams("POST",i,r),d.request("POST",i,r,null,function(t,r){return n(t,e.PulledChanges.parse(r))})},t.prototype.delta=function(e,t){return this.pullChanges(e,t)},t.prototype.mkdir=function(e,t){var n,r;return r=this.urls.fileopsCreateFolder,n={root:this.fileRoot,path:this.normalizePath(e)},this.oauth.addAuthParams("POST",r,n),d.request("POST",r,n,null,function(e,n){return t(e,h.parse(n))})},t.prototype.remove=function(e,t){var n,r;return r=this.urls.fileopsDelete,n={root:this.fileRoot,path:this.normalizePath(e)},this.oauth.addAuthParams("POST",r,n),d.request("POST",r,n,null,function(e,n){return t(e,h.parse(n))})},t.prototype.unlink=function(e,t){return this.remove(e,t)},t.prototype["delete"]=function(e,t){return this.remove(e,t)},t.prototype.copy=function(e,t,n){var r,s,o;return!n&&typeof r=="function"&&(n=r,r=null),s={root:this.fileRoot,to_path:this.normalizePath(t)},e instanceof i?s.from_copy_ref=e.tag:s.from_path=this.normalizePath(e),o=this.urls.fileopsCopy,this.oauth.addAuthParams("POST",o,s),d.request("POST",o,s,null,function(e,t){return n(e,h.parse(t))})},t.prototype.move=function(e,t,n){var r,i,s;return!n&&typeof r=="function"&&(n=r,r=null),e=this.normalizePath(e),t=this.normalizePath(t),s=this.urls.fileopsMove,i={root:this.fileRoot,from_path:e,to_path:t},this.oauth.addAuthParams("POST",s,i),d.request("POST",s,i,null,function(e,t){return n(e,h.parse(t))})},t.prototype.reset=function(){return this.uid=null,this.oauth.setToken(null,""),this.authState=t.RESET,this.authError=null,this._credentials=null,this},t.prototype.setCredentials=function(e){return this.oauth.reset(e),this.uid=e.uid||null,e.authState?this.authState=e.authState:e.token?this.authState=t.DONE:this.authState=t.RESET,this.authError=null,this._credentials=null,this},t.prototype.appHash=function(){return this.oauth.appHash()},t.prototype.setupUrls=function(){return this.fileRoot=this.sandbox?"sandbox":"dropbox",this.urls={requestToken:""+this.apiServer+"/1/oauth/request_token",authorize:""+this.authServer+"/1/oauth/authorize",accessToken:""+this.apiServer+"/1/oauth/access_token",signOut:""+this.apiServer+"/1/unlink_access_token",accountInfo:""+this.apiServer+"/1/account/info",getFile:""+this.fileServer+"/1/files/"+this.fileRoot,postFile:""+this.fileServer+"/1/files/"+this.fileRoot,putFile:""+this.fileServer+"/1/files_put/"+this.fileRoot,metadata:""+this.apiServer+"/1/metadata/"+this.fileRoot,delta:""+this.apiServer+"/1/delta",revisions:""+this.apiServer+"/1/revisions/"+this.fileRoot,restore:""+this.apiServer+"/1/restore/"+this.fileRoot,search:""+this.apiServer+"/1/search/"+this.fileRoot,shares:""+this.apiServer+"/1/shares/"+this.fileRoot,media:""+this.apiServer+"/1/media/"+this.fileRoot,copyRef:""+this.apiServer+"/1/copy_ref/"+this.fileRoot,thumbnails:""+this.fileServer+"/1/thumbnails/"+this.fileRoot,fileopsCopy:""+this.apiServer+"/1/fileops/copy",fileopsCreateFolder:""+this.apiServer+"/1/fileops/create_folder",fileopsDelete:""+this.apiServer+"/1/fileops/delete",fileopsMove:""+this.apiServer+"/1/fileops/move"}},t.ERROR=0,t.RESET=1,t.REQUEST=2,t.AUTHORIZED=3,t.DONE=4,t.SIGNED_OFF=5,t.prototype.urlEncodePath=function(e){return d.urlEncodeValue(this.normalizePath(e)).replace(/%2F/gi,"/")},t.prototype.normalizePath=function(e){var t;if(e.substring(0,1)==="/"){t=1;while(e.substring(t,t+1)==="/")t+=1;return e.substring(t)}return e},t.prototype.requestToken=function(e){var t;return t=this.oauth.addAuthParams("POST",this.urls.requestToken,{}),d.request("POST",this.urls.requestToken,t,null,e)},t.prototype.authorizeUrl=function(e){var t;return t={oauth_token:e,oauth_callback:this.authDriver.url()},""+this.urls.authorize+"?"+d.urlEncode(t)},t.prototype.getAccessToken=function(e){var t;return t=this.oauth.addAuthParams("POST",this.urls.accessToken,{}),d.request("POST",this.urls.accessToken,t,null,e)},t.prototype.defaultApiServer=function(){return"https://api.dropbox.com"},t.prototype.defaultAuthServer=function(){return this.apiServer.replace("api.","www.")},t.prototype.defaultFileServer=function(){return this.apiServer.replace("api.","api-content.")},t.prototype.computeCredentials=function(){var e;return e={key:this.oauth.key,sandbox:this.sandbox},this.oauth.secret&&(e.secret=this.oauth.secret),this.oauth.token&&(e.token=this.oauth.token,e.tokenSecret=this.oauth.tokenSecret),this.uid&&(e.uid=this.uid),this.authState!==t.ERROR&&this.authState!==t.RESET&&this.authState!==t.DONE&&this.authState!==t.SIGNED_OFF&&(e.authState=this.authState),this.apiServer!==this.defaultApiServer()&&(e.server=this.apiServer),this.authServer!==this.defaultAuthServer()&&(e.authServer=this.authServer),this.fileServer!==this.defaultFileServer()&&(e.fileServer=this.fileServer),this._credentials=e},t}(),n=function(){function e(){}return e.prototype.url=function(){return"https://some.url"},e.prototype.doAuthorize=function(e,t,n,r){return r("oauth-token")},e.prototype.onAuthStateChange=function(e,t){return t()},e}(),c=function(){function t(e){this.rememberUser=(e!=null?e.rememberUser:void 0)||!1,this.scope=(e!=null?e.scope:void 0)||"default",this.useQuery=(e!=null?e.useQuery:void 0)||!1,this.receiverUrl=this.computeUrl(e),this.tokenRe=new RegExp("(#|\\?|&)oauth_token=([^&#]+)(&|#|$)")}return t.prototype.url=function(){return this.receiverUrl},t.prototype.doAuthorize=function(e,t,n,r){return window.location.assign(e)},t.prototype.onAuthStateChange=function(t,n){var i,s=this;this.storageKey="dropbox-auth:"+this.scope+":"+t.appHash();switch(t.authState){case e.Client.RESET:if(!(i=this.loadCredentials()))return n();if(i.authState)return i.token===this.locationToken()&&(i.authState===r.REQUEST&&(this.forgetCredentials(),i.authState=r.AUTHORIZED),t.setCredentials(i)),n();if(!this.rememberUser)return this.forgetCredentials(),n();return t.setCredentials(i),t.getUserInfo(function(e,r){return e&&(t.reset(),s.forgetCredentials()),n()});case r.REQUEST:return this.storeCredentials(t.credentials()),n();case r.DONE:return this.rememberUser&&this.storeCredentials(t.credentials()),n();case r.SIGNED_OFF:return this.forgetCredentials(),n();case r.ERROR:return this.forgetCredentials(),n();default:return n()}},t.prototype.computeUrl=function(){var e,n,r,i;return i="_dropboxjs_scope="+encodeURIComponent(this.scope),n=t.currentLocation(),n.indexOf("#")===-1?e=null:(r=n.split("#",2),n=r[0],e=r[1]),this.useQuery?n.indexOf("?")===-1?n+="?"+i:n+="&"+i:e="?"+i,e?n+"#"+e:n},t.prototype.locationToken=function(){var e,n,r;return e=t.currentLocation(),r="_dropboxjs_scope="+encodeURIComponent(this.scope)+"&",(typeof e.indexOf=="function"?e.indexOf(r):void 0)===-1?null:(n=this.tokenRe.exec(e),n?decodeURIComponent(n[2]):null)},t.currentLocation=function(){return window.location.href},t.prototype.storeCredentials=function(e){return localStorage.setItem(this.storageKey,JSON.stringify(e))},t.prototype.loadCredentials=function(){var e;e=localStorage.getItem(this.storageKey);if(!e)return null;try{return JSON.parse(e)}catch(t){return null}},t.prototype.forgetCredentials=function(){return localStorage.removeItem(this.storageKey)},t}(),u=function(){function e(e){this.receiverUrl=this.computeUrl(e),this.tokenRe=new RegExp("(#|\\?|&)oauth_token=([^&#]+)(&|#|$)")}return e.prototype.doAuthorize=function(e,t,n,r){return this.listenForMessage(t,r),this.openWindow(e)},e.prototype.url=function(){return this.receiverUrl},e.prototype.computeUrl=function(t){var n;if(t){if(t.receiverUrl)return t.noFragment||t.receiverUrl.indexOf("#")!==-1?t.receiverUrl:t.receiverUrl+"#";if(t.receiverFile)return n=e.currentLocation().split("/"),n[n.length-1]=t.receiverFile,t.noFragment?n.join("/"):n.join("/")+"#"}return e.currentLocation()},e.currentLocation=function(){return window.location.href},e.prototype.openWindow=function(e){return window.open(e,"_dropboxOauthSigninWindow",this.popupWindowSpec(980,980))},e.prototype.popupWindowSpec=function(e,t){var n,r,i,s,o,u,a,f,l,c;return o=(a=window.screenX)!=null?a:window.screenLeft,u=(f=window.screenY)!=null?f:window.screenTop,s=(l=window.outerWidth)!=null?l:document.documentElement.clientWidth,n=(c=window.outerHeight)!=null?c:document.documentElement.clientHeight,r=Math.round(o+(s-e)/2),i=Math.round(u+(n-t)/2.5),"width="+e+",height="+t+","+("left="+r+",top="+i)+"dialog=yes,dependent=yes,scrollbars=yes,location=yes"},e.prototype.listenForMessage=function(e,t){var n,r;return r=this.tokenRe,n=function(i){var s;s=r.exec(i.data.toString());if(s&&decodeURIComponent(s[2])===e)return window.removeEventListener("message",n),t()},window.addEventListener("message",n,!1)},e}(),s=function(){function e(e){this.port=(e!=null?e.port:void 0)||8912,this.faviconFile=(e!=null?e.favicon:void 0)||null,this.fs=require("fs"),this.http=require("http"),this.open=require("open"),this.callbacks={},this.urlRe=new RegExp("^/oauth_callback\\?"),this.tokenRe=new RegExp("(\\?|&)oauth_token=([^&]+)(&|$)"),this.createApp()}return e.prototype.url=function(){return"http://localhost:"+this.port+"/oauth_callback"},e.prototype.doAuthorize=function(e,t,n,r){return this.callbacks[t]=r,this.openBrowser(e)},e.prototype.openBrowser=function(e){if(!e.match(/^https?:\/\//))throw new Error("Not a http/https URL: "+e);return this.open(e)},e.prototype.createApp=function(){var e=this;return this.app=this.http.createServer(function(t,n){return e.doRequest(t,n)}),this.app.listen(this.port)},e.prototype.closeServer=function(){return this.app.close()},e.prototype.doRequest=function(e,t){var n,r,i,s=this;return this.urlRe.exec(e.url)&&(r=this.tokenRe.exec(e.url),r&&(i=decodeURIComponent(r[2]),this.callbacks[i]&&(this.callbacks[i](),delete this.callbacks[i]))),n="",e.on("data",function(e){return n+=e}),e.on("end",function(){return s.faviconFile&&e.url==="/favicon.ico"?s.sendFavicon(t):s.closeBrowser(t)})},e.prototype.closeBrowser=function(e){var t;return t='<!doctype html>\n<script type="text/javascript">window.close();</script>\n<p>Please close this window.</p>',e.writeHead(200,{"Content-Length":t.length,"Content-Type":"text/html"}),e.write(t),e.end},e.prototype.sendFavicon=function(e){return this.fs.readFile(this.faviconFile,function(t,n){return e.writeHead(200,{"Content-Length":n.length,"Content-Type":"image/x-icon"}),e.write(n),e.end})},e}(),e=function(){function e(e){this.client=new r(e)}return e}(),x=function(e,t){return b(A(_(e),_(t),e.length,t.length))},T=function(e){return b(M(_(e),e.length))};if(typeof window=="undefined"||window===null)k=require("crypto"),x=function(e,t){var n;return n=k.createHmac("sha1",t),n.update(e),n.digest("base64")},T=function(e){var t;return t=k.createHash("sha1"),t.update(e),t.digest("base64")};A=function(e,t,n,r){var i,s,o,u;return t.length>16&&(t=M(t,r)),o=function(){var e,n;n=[];for(s=e=0;e<16;s=++e)n.push(t[s]^909522486);return n}(),u=function(){var e,n;n=[];for(s=e=0;e<16;s=++e)n.push(t[s]^1549556828);return n}(),i=M(o.concat(e),64+n),M(u.concat(i),84)},M=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,b,w;e[t>>2]|=1<<31-((t&3)<<3),e[(t+8>>6<<4)+15]=t<<3,g=Array(80),n=1732584193,i=-271733879,o=-1732584194,a=271733878,l=-1009589776,p=0,m=e.length;while(p<m){r=n,s=i,u=o,f=a,c=l;for(d=w=0;w<80;d=++w)d<16?g[d]=e[p+d]:g[d]=O(g[d-3]^g[d-8]^g[d-14]^g[d-16],1),d<20?(h=i&o|~i&a,v=1518500249):d<40?(h=i^o^a,v=1859775393):d<60?(h=i&o|i&a|o&a,v=-1894007588):(h=i^o^a,v=-899497514),b=y(y(O(n,5),h),y(y(l,g[d]),v)),l=a,a=o,o=O(i,30),i=n,n=b;n=y(n,r),i=y(i,s),o=y(o,u),a=y(a,f),l=y(l,c),p+=16}return[n,i,o,a,l]},O=function(e,t){return e<<t|e>>>32-t},y=function(e,t){var n,r;return r=(e&65535)+(t&65535),n=(e>>16)+(t>>16)+(r>>16),n<<16|r&65535},b=function(e){var t,n,r,i,s;i="",t=0,r=e.length*4;while(t<r)n=t,s=(e[n>>2]>>(3-(n&3)<<3)&255)<<16,n+=1,s|=(e[n>>2]>>(3-(n&3)<<3)&255)<<8,n+=1,s|=e[n>>2]>>(3-(n&3)<<3)&255,i+=D[s>>18&63],i+=D[s>>12&63],t+=1,t>=r?i+="=":i+=D[s>>6&63],t+=1,t>=r?i+="=":i+=D[s&63],t+=1;return i},D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_=function(e){var t,n,r,i,s;t=[],r=255;for(n=i=0,s=e.length;0<=s?i<s:i>s;n=0<=s?++i:--i)t[n>>2]|=(e.charCodeAt(n)&r)<<(3-(n&3)<<3);return t},o=function(){function e(e){this.key=this.k=null,this.secret=this.s=null,this.token=null,this.tokenSecret=null,this._appHash=null,this.reset(e)}return e.prototype.reset=function(e){var t,n,r,i;return e.secret?(this.k=this.key=e.key,this.s=this.secret=e.secret,this._appHash=null):e.key&&(this.key=e.key,this.secret=null,r=w(L(this.key).split("|",2)[1]),i=r.split("?",2),t=i[0],n=i[1],this.k=decodeURIComponent(t),this.s=decodeURIComponent(n),this._appHash=null),e.token?this.setToken(e.token,e.tokenSecret):this.setToken(null,"")},e.prototype.setToken=function(e,t){if(e&&!t)throw new Error("No secret supplied with the user token");return this.token=e,this.tokenSecret=t||"",this.hmacKey=d.urlEncodeValue(this.s)+"&"+d.urlEncodeValue(t),null},e.prototype.authHeader=function(e,t,n){var r,i,s,o,u,a;this.addAuthParams(e,t,n),i=[];for(s in n)o=n[s],s.substring(0,6)==="oauth_"&&i.push(s);i.sort(),r=[];for(u=0,a=i.length;u<a;u++)s=i[u],r.push(d.urlEncodeValue(s)+'="'+d.urlEncodeValue(n[s])+'"'),delete n[s];return"OAuth "+r.join(",")},e.prototype.addAuthParams=function(e,t,n){return this.boilerplateParams(n),n.oauth_signature=this.signature(e,t,n),n},e.prototype.boilerplateParams=function(e){return e.oauth_consumer_key=this.k,e.oauth_nonce=this.nonce(),e.oauth_signature_method="HMAC-SHA1",this.token&&(e.oauth_token=this.token),e.oauth_timestamp=Math.floor(Date.now()/1e3),e.oauth_version="1.0",e},e.prototype.nonce=function(){return Date.now().toString(36)+Math.random().toString(36)},e.prototype.signature=function(e,t,n){var r;return r=e.toUpperCase()+"&"+d.urlEncodeValue(t)+"&"+d.urlEncodeValue(d.urlEncode(n)),x(r,this.hmacKey)},e.prototype.appHash=function(){return this._appHash?this._appHash:this._appHash=T(this.k).replace(/\=/g,"")},e}(),Date.now==null&&(Date.now=function(){return(new Date).getTime()}),L=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p;t?(t=[encodeURIComponent(e),encodeURIComponent(t)].join("?"),e=function(){var t,r,i;i=[];for(n=t=0,r=e.length/2;0<=r?t<r:t>r;n=0<=r?++t:--t)i.push((e.charCodeAt(n*2)&15)*16+(e.charCodeAt(n*2+1)&15));return i}()):(c=e.split("|",2),e=c[0],t=c[1],e=w(e),e=function(){var t,r,i;i=[];for(n=t=0,r=e.length;0<=r?t<r:t>r;n=0<=r?++t:--t)i.push(e.charCodeAt(n));return i}(),t=w(t)),s=function(){p=[];for(f=0;f<256;f++)p.push(f);return p}.apply(this),u=0;for(o=l=0;l<256;o=++l)u=(u+s[n]+e[o%e.length])%256,h=[s[u],s[o]],s[o]=h[0],s[u]=h[1];return o=u=0,i=function(){var e,n,i,f;f=[];for(a=e=0,n=t.length;0<=n?e<n:e>n;a=0<=n?++e:--e)o=(o+1)%256,u=(u+s[o])%256,i=[s[u],s[o]],s[o]=i[0],s[u]=i[1],r=s[(s[o]+s[u])%256],f.push(String.fromCharCode((r^t.charCodeAt(a))%256));return f}(),e=function(){var t,r,i;i=[];for(n=t=0,r=e.length;0<=r?t<r:t>r;n=0<=r?++t:--t)i.push(String.fromCharCode(e[n]));return i}(),[N(e.join("")),N(i.join(""))].join("|")},l=function(){function e(e){var t;this.blankSlate=e.reset||!1,this.cursorTag=e.cursor,this.shouldPullAgain=e.has_more,this.shouldBackOff=!this.shouldPullAgain,e.cursor&&e.cursor.length?this.changes=function(){var n,r,i,s;i=e.entries,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(f.parse(t));return s}():this.changes=[]}return e.parse=function(t){return t&&typeof t=="object"?new e(t):t},e.prototype.blankSlate=void 0,e.prototype.cursorTag=void 0,e.prototype.changes=void 0,e.prototype.shouldPullAgain=void 0,e.prototype.shouldBackOff=void 0,e}(),f=function(){function e(e){this.path=e[0],this.stat=h.parse(e[1]),this.stat?this.wasRemoved=!1:(this.stat=null,this.wasRemoved=!0)}return e.parse=function(t){return t&&typeof t=="object"?new e(t):t},e.prototype.path=void 0,e.prototype.wasRemoved=void 0,e.prototype.stat=void 0,e}(),a=function(){function e(e,t){this.url=e.url,this.expiresAt=new Date(Date.parse(e.expires)),t===!0?this.isDirect=!0:t===!1?this.isDirect=!1:this.isDirect=Date.now()-this.expiresAt<=864e5,this.isPreview=!this.isDirect}return e.parse=function(t,n){return t&&typeof t=="object"?new e(t,n):t},e.prototype.url=void 0,e.prototype.expiresAt=void 0,e.prototype.isDirect=void 0,e.prototype.isPreview=void 0,e}(),i=function(){function e(e){typeof e=="object"?(this.tag=e.copy_ref,this.expiresAt=new Date(Date.parse(e.expires))):(this.tag=e,this.expiresAt=new Date)}return e.parse=function(t){return!t||typeof t!="object"&&typeof t!="string"?t:new e(t)},e.prototype.tag=void 0,e.prototype.expiresAt=void 0,e}(),h=function(){function e(e){var t,n,r,i;this.path=e.path,this.path.substring(0,1)!=="/"&&(this.path="/"+this.path),t=this.path.length-1,t>=0&&this.path.substring(t)==="/"&&(this.path=this.path.substring(0,t)),n=this.path.lastIndexOf("/"),this.name=this.path.substring(n+1),this.isFolder=e.is_dir||!1,this.isFile=!this.isFolder,this.isRemoved=e.is_deleted||!1,this.typeIcon=e.icon,((r=e.modified)!=null?r.length:void 0)?this.modifiedAt=new Date(Date.parse(e.modified)):this.modifiedAt=null,((i=e.client_mtime)!=null?i.length:void 0)?this.clientModifiedAt=new Date(Date.parse(e.client_mtime)):this.clientModifiedAt=null;switch(e.root){case"dropbox":this.inAppFolder=!1;break;case"app_folder":this.inAppFolder=!0;break;default:this.inAppFolder=null}this.size=e.bytes||0,this.humanSize=e.size||"",this.hasThumbnail=e.thumb_exists||!1,this.isFolder?(this.versionTag=e.hash,this.mimeType=e.mime_type||"inode/directory"):(this.versionTag=e.rev,this.mimeType=e.mime_type||"application/octet-stream")}return e.parse=function(t){return t&&typeof t=="object"?new e(t):t},e.prototype.path=null,e.prototype.name=null,e.prototype.inAppFolder=null,e.prototype.isFolder=null,e.prototype.isFile=null,e.prototype.isRemoved=null,e.prototype.typeIcon=null,e.prototype.versionTag=null,e.prototype.mimeType=null,e.prototype.size=null,e.prototype.humanSize=null,e.prototype.hasThumbnail=null,e.prototype.modifiedAt=null,e.prototype.clientModifiedAt=null,e}(),p=function(){function e(e){var t;this.name=e.display_name,this.email=e.email,this.countryCode=e.country||null,this.uid=e.uid.toString(),e.public_app_url?(this.publicAppUrl=e.public_app_url,t=this.publicAppUrl.length-1,t>=0&&this.publicAppUrl.substring(t)==="/"&&(this.publicAppUrl=this.publicAppUrl.substring(0,t))):this.publicAppUrl=null,this.referralUrl=e.referral_link,this.quota=e.quota_info.quota,this.privateBytes=e.quota_info.normal||0,this.sharedBytes=e.quota_info.shared||0,this.usedQuota=this.privateBytes+this.sharedBytes}return e.parse=function(t){return t&&typeof t=="object"?new e(t):t},e.prototype.name=null,e.prototype.email=null,e.prototype.countryCode=null,e.prototype.uid=null,e.prototype.referralUrl=null,e.prototype.publicAppUrl=null,e.prototype.quota=null,e.prototype.usedQuota=null,e.prototype.privateBytes=null,e.prototype.sharedBytes=null,e}(),typeof window!="undefined"&&window!==null?!window.XDomainRequest||"withCredentials"in new XMLHttpRequest?(g=window.XMLHttpRequest,m=!1,v=window.navigator.userAgent.indexOf("Firefox")===-1):(g=window.XDomainRequest,m=!0,v=!1):(g=require("xmlhttprequest").XMLHttpRequest,m=!1,v=!1),d=function(){function e(){}return e.Request=g,e.ieMode=m,e.canSendForms=v,e.request=function(e,t,n,r,i){return this.request2(e,t,n,r,null,null,i)},e.request2=function(t,n,r,i,s,o,u){var a,f,l;return f=t==="GET"||s!=null||this.ieMode,f&&(l=e.urlEncode(r),l.length!==0&&(n=[n,"?",e.urlEncode(r)].join(""))),a={},i&&(a.Authorization=i),s!=null?typeof s=="string"&&(a["Content-Type"]="text/plain; charset=utf8"):f||(a["Content-Type"]="application/x-www-form-urlencoded",s=e.urlEncode(r)),e.xhrRequest(t,n,a,s,o,u)},e.multipartRequest=function(t,n,r,i,s){var o,u,a,f,l,c;return t=[t,"?",e.urlEncode(r)].join(""),a=n.value,c=typeof a=="object"&&(typeof Blob!="undefined"&&Blob!==null&&n.value instanceof Blob||typeof File!="undefined"&&File!==null&&n.value instanceof File),c?(l={},o=new FormData,o.append(n.name,a,n.fileName)):(f=n.contentType||"application/octet-stream",u=this.multipartBoundary(),l={"Content-Type":"multipart/form-data; boundary="+u},o=["--",u,"\r\n",'Content-Disposition: form-data; name="',n.name,'"; filename="',n.fileName,'"\r\n',"Content-Type: ",f,"\r\n","Content-Transfer-Encoding: binary\r\n\r\n",a,"\r\n","--",u,"--","\r\n"].join("")),i&&(l.Authorization=i),e.xhrRequest("POST",t,l,o,null,s)},e.multipartBoundary=function(){return[Date.now().toString(36),Math.random().toString(36)].join("----")},e.xhrRequest=function(t,n,r,i,s,o){var u,a,f;f=new this.Request,this.ieMode?(f.onload=function(){return e.onLoad(f,t,n,o)},f.onerror=function(){return e.onError(f,t,n,o)}):f.onreadystatechange=function(){return e.onReadyStateChange(f,t,n,s,o)},f.open(t,n,!0),s&&(s==="b"?f.overrideMimeType&&f.overrideMimeType("text/plain; charset=x-user-defined"):f.responseType=s);if(!this.ieMode)for(u in r){if(!P.call(r,u))continue;a=r[u],f.setRequestHeader(u,a)}return i!=null?f.send(i):f.send(),f},e.urlEncode=function(e){var t,n,r;t=[];for(n in e)r=e[n],t.push(this.urlEncodeValue(n)+"="+this.urlEncodeValue(r));return t.sort().join("&")},e.urlEncodeValue=function(e){return encodeURIComponent(e.toString()).replace(/\!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")},e.urlDecode=function(e){var t,n,r,i,s,o;n={},o=e.split("&");for(i=0,s=o.length;i<s;i++)r=o[i],t=r.split("="),n[decodeURIComponent(t[0])]=decodeURIComponent(t[1]);return n},e.onReadyStateChange=function(n,r,i,s,o){var u,a,f,l,c,h,p,d,v;if(n.readyState!==4)return!0;if(n.status<200||n.status>=300)return u=new t(n,r,i),o(u),!0;h=n.getResponseHeader("x-dropbox-metadata");if(h!=null?h.length:void 0)try{c=JSON.parse(h)}catch(m){c=void 0}else c=void 0;if(s){if(s==="b"){f=n.responseText!=null?n.responseText:n.response,a=[];for(l=d=0,v=f.length;0<=v?d<v:d>v;l=0<=v?++d:--d)a.push(String.fromCharCode(f.charCodeAt(l)&255));p=a.join(""),o(null,p,c)}else o(null,n.response,c);return!0}p=n.responseText!=null?n.responseText:n.response;switch(n.getResponseHeader("Content-Type")){case"application/x-www-form-urlencoded":o(null,e.urlDecode(p),c);break;case"application/json":case"text/javascript":o(null,JSON.parse(p),c);break;default:o(null,p,c)}return!0},e.onLoad=function(t,n,r,i){var s;s=t.responseText;switch(t.contentType){case"application/x-www-form-urlencoded":i(null,e.urlDecode(s),void 0);break;case"application/json":case"text/javascript":i(null,JSON.parse(s),void 0);break;default:i(null,s,void 0)}return!0},e.onError=function(e,n,r,i){var s;return s=new t(e,n,r),i(s),!0},e}();if((typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null)module.exports=e;else{if(typeof window=="undefined"||window===null)throw new Error("This library only supports node.js and modern browsers.");window.Dropbox=e}e.ApiError=t,e.Client=r,e.CopyReference=i,e.Drivers={Popup:u,Redirect:c,NodeServer:s},e.Oauth=o,e.PublicUrl=a,e.PulledChanges=l,e.PullChange=f,e.Stat=h,e.UserInfo=p,e.Xhr=d,e.atob=w,e.btoa=N,e.hmac=x,e.sha1=T,e.encodeKey=L}.call(this),define("extensions/default/dropbox/dropbox",function(){}),require.config({paths:{text:"thirdparty/text",i18n:"thirdparty/i18n"},locale:window.localStorage.getItem("locale")||(typeof brackets!="undefined"?brackets.app.language:navigator.language)}),define("brackets",["require","exports","module","widgets/bootstrap-dropdown","widgets/bootstrap-modal","thirdparty/path-utils/path-utils.min","thirdparty/smart-auto-complete/jquery.smart_autocomplete","utils/Global","utils/AppInit","project/ProjectManager","document/DocumentManager","editor/EditorManager","editor/CSSInlineEditor","language/JSUtils","project/WorkingSetView","project/WorkingSetSort","document/DocumentCommandHandlers","project/FileViewController","project/FileSyncManager","command/KeyBindingManager","command/Commands","command/CommandManager","editor/CodeHintManager","language/JSLintUtils","utils/PerfUtils","project/FileIndexManager","search/QuickOpen","command/Menus","file/FileUtils","text!htmlContent/main-view.html","strings","widgets/Dialogs","utils/ExtensionLoader","project/SidebarView","utils/Async","utils/UpdateNotification","utils/UrlParams","file/NativeFileSystem","preferences/PreferencesManager","utils/Resizer","LiveDevelopment/main","utils/ExtensionUtils","document/ChangedDocumentTracker","editor/EditorCommandHandlers","view/ViewCommandHandlers","debug/DebugCommandHandlers","help/HelpCommandHandlers","search/FindInFiles","search/FindReplace","extensions/default/dropbox/dropbox","language/CSSUtils","LiveDevelopment/LiveDevelopment","LiveDevelopment/Agents/DOMAgent","LiveDevelopment/Inspector/Inspector","utils/NativeApp","utils/UpdateNotification"],function(e,t,n){function q(){brackets.test={PreferencesManager:P,ProjectManager:s,DocumentCommandHandlers:h,FileViewController:p,DocumentManager:o,EditorManager:u,Commands:m,WorkingSetView:l,JSLintUtils:b,PerfUtils:w,JSUtils:f,CommandManager:g,FileSyncManager:d,FileIndexManager:E,Menus:x,KeyBindingManager:v,CodeHintManager:y,CSSUtils:e("language/CSSUtils"),LiveDevelopment:e("LiveDevelopment/LiveDevelopment"),DOMAgent:e("LiveDevelopment/Agents/DOMAgent"),Inspector:e("LiveDevelopment/Inspector/Inspector"),NativeApp:e("utils/NativeApp"),ExtensionUtils:j,UpdateNotification:e("utils/UpdateNotification"),doneLoading:!1},i.appReady(function(){brackets.test.doneLoading=!0})}function R(){w.addMeasurement("window.document Ready"),u.setEditorHolder($("#editor-holder")),brackets.fs||k.showModalDialog(k.DIALOG_ID_ERROR,C.ERROR_IN_BROWSER_TITLE,C.ERROR_IN_BROWSER);var e=/Mac OS X 10\D([\d+])\D/.exec(navigator.userAgent);if(e&&e[1]&&Number(e[1])>=7){var t=$("<div style='position:fixed;left:-50px;width:50px;height:50px;overflow:auto;'><div style='width:100px;height:100px;'/></div>").appendTo(window.document.body);t.outerWidth()===t.get(0).clientWidth&&$(".sidebar").removeClass("quiet-scrollbars"),t.remove()}var n=L.init(F.get("extensions"));n.always(function(){var e=s.getInitialProjectPath();s.openProject(e).always(function(){q();var t=P.getPreferenceStorage(I),n=new $.Deferred;if(!F.get("skipSampleProjectLoad")&&!t.getValue("afterFirstLaunch")){t.setValue("afterFirstLaunch","true");if(s.isWelcomeProjectPath(e)){var r=new D.DirectoryEntry(e);r.getFile("index.html",{},function(e){var t=g.execute(m.FILE_ADD_TO_WORKING_SET,{fullPath:e.fullPath});t.pipe(n.resolve,n.reject)},n.reject)}else n.resolve()}else n.resolve();n.always(function(){i._dispatchReady(i.APP_READY),w.addMeasurement("Application Startup")}),brackets.app.getPendingFilesToOpen&&brackets.app.getPendingFilesToOpen(function(e,t){t.forEach(function(e){g.execute(m.FILE_OPEN,{fullPath:e})})})})}),!F.get("skipUpdateCheck")&&!brackets.inBrowser&&(window.setInterval(M.checkForUpdate,8652e4),M.checkForUpdate())}function U(){$("body").addClass("platform-"+brackets.platform),$("body").html(Mustache.render(N,C)),$("title").text(brackets.config.app_title),$(window.document.body).on("dragover",function(e){e.originalEvent.dataTransfer.files&&(e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="none")}).on("drop",function(e){e.originalEvent.dataTransfer.files&&(e.stopPropagation(),e.preventDefault())}),$(window).focus(function(){d.syncOpenDocuments(),E.markDirty()}),$("html").on("mousedown",".inline-widget",function(e){e.button===1&&e.preventDefault()}),$("html").on("mousedown",".no-focus",function(e){var t=$(e.target),n=t.is("input[type=text]")||t.is("input[type=number]")||t.is("input[type=password]")||t.is("input:not([type])")||t.is("select")||t.is("textarea");n||e.preventDefault()})}e("widgets/bootstrap-dropdown"),e("widgets/bootstrap-modal"),e("thirdparty/path-utils/path-utils.min"),e("thirdparty/smart-auto-complete/jquery.smart_autocomplete");var r=e("utils/Global"),i=e("utils/AppInit"),s=e("project/ProjectManager"),o=e("document/DocumentManager"),u=e("editor/EditorManager"),a=e("editor/CSSInlineEditor"),f=e("language/JSUtils"),l=e("project/WorkingSetView"),c=e("project/WorkingSetSort"),h=e("document/DocumentCommandHandlers"),p=e("project/FileViewController"),d=e("project/FileSyncManager"),v=e("command/KeyBindingManager"),m=e("command/Commands"),g=e("command/CommandManager"),y=e("editor/CodeHintManager"),b=e("language/JSLintUtils"),w=e("utils/PerfUtils"),E=e("project/FileIndexManager"),S=e("search/QuickOpen"),x=e("command/Menus"),T=e("file/FileUtils"),N=e("text!htmlContent/main-view.html"),C=e("strings"),k=e("widgets/Dialogs"),L=e("utils/ExtensionLoader"),A=e("project/SidebarView"),O=e("utils/Async"),M=e("utils/UpdateNotification"),_=e("utils/UrlParams").UrlParams,D=e("file/NativeFileSystem").NativeFileSystem,P=e("preferences/PreferencesManager"),H=e("utils/Resizer"),B=e("LiveDevelopment/main"),j=e("utils/ExtensionUtils");e("document/ChangedDocumentTracker"),e("editor/EditorCommandHandlers"),e("view/ViewCommandHandlers"),e("debug/DebugCommandHandlers"),e("help/HelpCommandHandlers"),e("search/FindInFiles"),e("search/FindReplace"),e("extensions/default/dropbox/dropbox"),w.addMeasurement("brackets module dependencies resolved");var F=new _,I="com.adobe.brackets.startup";F.parse(),U(),i._dispatchReady(i.HTML_READY),$(window.document).ready(R)}),require(["brackets"]);